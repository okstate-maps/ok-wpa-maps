{"version":3,"file":"static/js/72962.221526a4.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/widgets/Editor/AddAssociationWorkflowData.js","../node_modules/@arcgis/core/widgets/Editor/AddAssociationWorkflow.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as t}from\"tslib\";import o from\"../../core/Accessor.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as e}from\"../../core/accessorSupport/decorators/subclass.js\";import{findEditorItemForLayerOrThrow as i}from\"./workflowUtils.js\";var s;let a=s=class extends o{constructor(t){super(t),this.editorItem=null,this.feature=null,this.utilityNetwork=null,this.associationType=null,this.parent=null,this.associationInput=null,this.viewModel=null}static async create(t){const{feature:o,parent:r,viewModel:e,utilityNetwork:a,associationType:p,associationInput:c}=t,n=i(e.editorItems,o.sourceLayer);return new s({editorItem:n,feature:o,parent:r,viewModel:e,utilityNetwork:a,associationType:p,associationInput:c})}};t([r({constructOnly:!0})],a.prototype,\"editorItem\",void 0),t([r()],a.prototype,\"feature\",void 0),t([r({constructOnly:!0})],a.prototype,\"utilityNetwork\",void 0),t([r({constructOnly:!0})],a.prototype,\"associationType\",void 0),t([r()],a.prototype,\"parent\",void 0),t([r()],a.prototype,\"associationInput\",void 0),t([r()],a.prototype,\"viewModel\",void 0),a=s=t([e(\"esri.widgets.Editor.AddAssociationWorkflowData\")],a);export{a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as t}from\"tslib\";import e from\"../../core/Error.js\";import{makeHandle as i,abortHandle as o}from\"../../core/handleUtils.js\";import{isAborted as s}from\"../../core/promiseUtils.js\";import{watch as r}from\"../../core/reactiveUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as l}from\"../../core/accessorSupport/decorators/subclass.js\";import{isSubtypeSublayer as n}from\"../../layers/support/layerUtils.js\";import{createFeatureServices as d}from\"../../rest/featureService/utils.js\";import c from\"../../views/draw/support/HighlightHelper.js\";import{temporaryHighlightName as u}from\"../../views/support/HighlightDefaults.js\";import p from\"./AddAssociationWorkflowData.js\";import w from\"./Workflow.js\";import{fetchFullFeatures as h}from\"./workflowUtils.js\";import m from\"../FeatureForm/UtilityNetworkAssociationAddAssociationViewModel.js\";import{getFeatureTitle as y}from\"../support/UtilityNetworkAssociations/utils/getFeatureTitle.js\";var A;const f={exit:Symbol()};let g=class extends w{static{A=this}constructor(t){super(t),this._utilityNetworkAssociationAddAssociationViewModel=new m,this._highlightHelper=null,this.sourceFeatureItem=null,this.type=\"add-association\"}initialize(){const{data:t}=this,{view:e}=t.viewModel;e&&(this._highlightHelper=new c({view:e,highlightName:u}),this.addHandles(i(()=>this._highlightHelper?.removeAll())));const s=new AbortController;this.addHandles(o(s)),this._updatingHandles.addPromise(this._setup(s))}get editorItem(){return this.data.editorItem}get formViewModel(){return this._formViewModel}get utilityNetworkAssociationAddAssociationViewModel(){return this._utilityNetworkAssociationAddAssociationViewModel}get hasPendingEdits(){return!!this._utilityNetworkAssociationAddAssociationViewModel.selectedFeature}get layer(){return this.data.editorItem.layer}get parent(){return this.data.parent}get reliesOnOwnerAdminPrivileges(){return this.editorItem.capabilities.create.reliesOnOwnerAdminPrivileges}async enter(){this._addHandles()}exit(){this.removeHandles(f.exit)}async start(){return await super.start(),null}async _setup(t){const{data:i}=this,{feature:o}=i;try{const[e]=await h([o],o.sourceLayer,i.viewModel.view.spatialReference,t.signal);if(s(t))return;const r=e.sourceLayer&&\"getFeatureTitle\"in e.sourceLayer?await e.sourceLayer.getFeatureTitle(e):y(e);if(s(t))return;this.sourceFeatureItem={feature:o,label:r},this._initializeUtilityNetworkAssociationAddAssociationViewModel()}catch(r){await this.cancel({force:!0,error:new e(\"editor:failed-to-fetch-full-feature\",\"Failed to retrieve all information for this feature. The update cannot proceed.\",{detail:{error:r}})})}}_initializeUtilityNetworkAssociationAddAssociationViewModel(){const{viewModel:{view:t},utilityNetwork:e,associationType:i}=this.data,o=this._utilityNetworkAssociationAddAssociationViewModel;o.graphic=this.sourceFeatureItem.feature,o.map=t?.map,o.utilityNetwork=e,o.layer=this.layer,o.associationType=i,o.highlightHelper=this._highlightHelper,e.networkSystemLayers.loadAssociationsTable()}_addHandles(){const t=this._utilityNetworkAssociationAddAssociationViewModel;this.addHandles([r(()=>t.selectedLayer,t=>{t&&this.go(\"add-association-select-feature\")}),r(()=>t.selectedFeature,t=>{t&&this.go(\"add-association-create-association\")})],f.exit)}static async create(t){const e=new A({data:await p.create(t),onCommit:this._onCommitFactory(t.applyEditsFeatureService)});return e._set(\"steps\",this._createWorkflowSteps(e)),e}static _createWorkflowSteps(t){return[{id:\"add-association-select-layer\",async setUp(){const{utilityNetworkAssociationAddAssociationViewModel:e}=t.data.viewModel;e&&(e.selectedLayer=null,e.selectedFeature=null,e.association=null)},async tearDown(){}},{id:\"add-association-select-feature\",async setUp(){const{utilityNetworkAssociationAddAssociationViewModel:e}=t.data.viewModel;e&&(e.selectedFeature=null,e.association=null)},async tearDown(){}},{id:\"add-association-create-association\",async setUp(){},async tearDown(){}}]}static{this._onCommitFactory=t=>async i=>{const{feature:o,utilityNetwork:s,associationInput:r}=i,{utilityNetworkAssociationAddAssociationViewModel:a}=i.viewModel,{association:l}=a;await s.networkSystemLayers.loadAssociationsTable();const c=s?.generateAddAssociations([l]);if(!c)throw new e(\"editor:failed-to-add-association\",\"Could not create payload needed to add association\");const u=o.sourceLayer,p=n(u)&&u.parent?u.parent:u,w=d([p]),h=w.values().next().value?.featureService;if(!h)throw new e(\"editor:failed-to-delete-association\",\"Could not retrieve feature service needed to delete association\");await(h?.load());const m=s?.gdbVersion??void 0;await t(h,[c],{gdbVersion:m}),await r.refresh()}}};t([a()],g.prototype,\"_utilityNetworkAssociationAddAssociationViewModel\",void 0),t([a()],g.prototype,\"_formViewModel\",void 0),t([a()],g.prototype,\"editorItem\",null),t([a()],g.prototype,\"formViewModel\",null),t([a()],g.prototype,\"utilityNetworkAssociationAddAssociationViewModel\",null),t([a()],g.prototype,\"sourceFeatureItem\",void 0),t([a()],g.prototype,\"hasPendingEdits\",null),t([a()],g.prototype,\"layer\",null),t([a()],g.prototype,\"parent\",null),t([a()],g.prototype,\"reliesOnOwnerAdminPrivileges\",null),g=A=t([l(\"esri.widgets.Editor.AddAssociationWorkflow\")],g);export{g as AddAssociationWorkflow};\n"],"names":["s","a","o","constructor","t","super","this","editorItem","feature","utilityNetwork","associationType","parent","associationInput","viewModel","create","r","e","p","c","n","i","editorItems","sourceLayer","constructOnly","prototype","A","f","exit","Symbol","g","_class","w","_utilityNetworkAssociationAddAssociationViewModel","m","_highlightHelper","sourceFeatureItem","type","initialize","data","view","highlightName","u","addHandles","_this$_highlightHelpe","removeAll","AbortController","_updatingHandles","addPromise","_setup","formViewModel","_formViewModel","utilityNetworkAssociationAddAssociationViewModel","hasPendingEdits","selectedFeature","layer","reliesOnOwnerAdminPrivileges","capabilities","enter","_addHandles","removeHandles","start","h","spatialReference","signal","getFeatureTitle","y","label","_initializeUtilityNetworkAssociationAddAssociationViewModel","cancel","force","error","detail","graphic","map","highlightHelper","networkSystemLayers","loadAssociationsTable","selectedLayer","go","onCommit","_onCommitFactory","applyEditsFeatureService","_set","_createWorkflowSteps","id","setUp","association","tearDown","async","_w$values$next$value","_s$gdbVersion","l","generateAddAssociations","d","values","next","value","featureService","load","gdbVersion","refresh"],"sourceRoot":""}