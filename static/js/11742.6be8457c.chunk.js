"use strict";(self.webpackChunkok_wpa_maps=self.webpackChunkok_wpa_maps||[]).push([[11742],{11742:(t,e,s)=>{s.r(e),s.d(e,{default:()=>h});var i=s(6326),a=s(5632),o=s(50346),r=s(68134),n=s(46053),l=(s(81806),s(76460),s(47249),s(87990)),u=s(19451),d=s(9912),p=s(48397),c=s(91039);let y=class extends((0,a.sA)(p.A)){constructor(t){super(t),this.group=null,this.type="utilityNetworkAssociations",this.featureItem=null,this._updatingHandlesSetUp=new u.U,this.addHandles([(0,r.wB)(()=>({feature:this.feature,element:this.element,layer:this.layer}),t=>this._createAssociationVM(t),r.Vh),(0,r.wB)(()=>this.feature,()=>this._setFeatureItem()),(0,r.wB)(()=>this.associatedLayer,(t,e)=>this._updateLayerEditHandle(t,e),r.Vh)])}destroy(){var t;null!==(t=this._associationsVM)&&void 0!==t&&t.destroy(),this._updatingHandlesSetUp.destroy()}get activeAssociationType(){var t;return null===(t=this._associationsVM)||void 0===t?void 0:t.activeAssociationType}get associatedFeatures(){const{associatedLayer:t}=this;if(t)return this.associatedFeatureInfos.get(t)}get associatedFeatureInfos(){var t;const{_associationsVM:e}=this;if(null===e||void 0===e||null===(t=e.associationFeatures)||void 0===t||!t.size||null===e||void 0===e||!e.utilityNetwork)return new Map;const{associationFeatures:s}=e,i=new Map;return s.forEach((t,e)=>{i.set(e,t)}),i}get associatedLayer(){return this._get("associatedLayer")}set associatedLayer(t){this._associationsVM.showAllEnabled=null!=t,this._set("associatedLayer",t)}get associationsViewModel(){return this._associationsVM}get canAddAssociation(){const{editable:t,utilityNetwork:e}=this;return!(!e||!this.loaded)&&t}get editable(){var t;return null===(t=this.evaluatedEditableExpression)||void 0===t||t}get featureCount(){var t,e;return null!==(t=null===(e=this._associationsVM)||void 0===e?void 0:e.featureCount)&&void 0!==t?t:0}get viewModel(){return this._associationsVM}get loaded(){var t;return"loading"!==(null===(t=this._associationsVM)||void 0===t?void 0:t.state)&&!this._updatingHandlesSetUp.updating}get map(){return this._get("map")}set map(t){var e;t&&null!==(e=this._associationsVM)&&void 0!==e&&e.set("map",t),this._set("map",t)}get utilityNetwork(){var t;return null===(t=this._associationsVM)||void 0===t?void 0:t.utilityNetwork}get associationTypes(){var t,e;return null!==(t=null===(e=this._associationsVM)||void 0===e?void 0:e.associationTypes)&&void 0!==t?t:this.element.associationTypes}get visible(){const{utilityNetwork:t}=this;return!!t&&(null!=this.evaluatedVisibilityExpression?this.evaluatedVisibilityExpression:null!=this.element)}get updating(){var t,e;return"loading"===(null===(t=this._associationsVM)||void 0===t?void 0:t.state)||"querying"===(null===(e=this._associationsVM)||void 0===e?void 0:e.state)}async refresh(){await(0,o.QZ)(this._associationsVM.refresh())}_updateLayerEditHandle(t,e){e&&"layerId"in e&&this.removeHandles(null===e||void 0===e?void 0:e.layerId),(0,d.isAssociatedFeatureSupportedLayer)(t)&&this.addHandles((0,r.on)(()=>t,"edits",()=>this.refresh()),t.layerId)}_createAssociationVM(t){var e;const{feature:s,element:i,layer:a}=t;if(null!==(e=this._associationsVM)&&void 0!==e&&e.destroy(),!s||!i||!a)return;const{map:o,associationTypes:r}=this;(0,d.isAssociatedFeatureSupportedLayer)(a)&&(this._associationsVM=new c.A({graphic:s,layer:a,map:o,associationTypes:r,source:"featureForm",title:this.label,description:this.description}))}_setFeatureItem(){this._updatingHandlesSetUp.addPromise((async()=>{const{feature:t,layer:e}=this;t&&e&&"getFeatureTitle"in e&&(this.featureItem={feature:t,label:await e.getFeatureTitle(t)})})())}};(0,i.Cg)([(0,n.MZ)()],y.prototype,"_associationsVM",void 0),(0,i.Cg)([(0,n.MZ)()],y.prototype,"activeAssociationType",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"associatedFeatures",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"associatedFeatureInfos",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"associatedLayer",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"associationsViewModel",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"canAddAssociation",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"editable",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"featureCount",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"viewModel",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"group",void 0),(0,i.Cg)([(0,n.MZ)()],y.prototype,"loaded",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"map",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"utilityNetwork",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"associationTypes",null),(0,i.Cg)([(0,n.MZ)({readOnly:!0})],y.prototype,"type",void 0),(0,i.Cg)([(0,n.MZ)()],y.prototype,"visible",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"updating",null),(0,i.Cg)([(0,n.MZ)()],y.prototype,"featureItem",void 0),y=(0,i.Cg)([(0,l.$)("esri.widgets.FeatureForm.UtilityNetworkAssociationInput")],y);const h=y}}]);
//# sourceMappingURL=11742.6be8457c.chunk.js.map