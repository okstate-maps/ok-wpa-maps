(this["webpackJsonpok-wpa-maps"]=this["webpackJsonpok-wpa-maps"]||[]).push([[7],{538:function(e,t,n){"use strict";function r(e){for(var t="",n=0;n<(arguments.length<=1?0:arguments.length-1);n++)t+=e[n]+(n+1<1||arguments.length<=n+1?void 0:arguments[n+1]);return t+=e[e.length-1]}n.d(t,"a",(function(){return r})),function(e){e.int=function(e){return Math.round(e).toString()},e.float=function(e){return e.toPrecision(8)}}(r||(r={}))},542:function(e,t,n){"use strict";function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}n.d(t,"a",(function(){return r}))},546:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(10),i=n(2),a=n(3),o=n(65),c=n(7),s=n(549),u=n(548),f=n(622),l=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(i.a)(this,e),this._context=t,this.type="texture",this._glName=null,this._descriptor=void 0,this._samplingModeDirty=!1,this._wrapModeDirty=!1,t.instanceCounter.increment(u.c.Texture,this),this._descriptor=Object(r.a)({target:3553,samplingMode:9729,wrapMode:10497,flipped:!1,hasMipmap:!1,isOpaque:!1,unpackAlignment:4,preMultiplyAlpha:!1},n),34067===this._descriptor.target?this.setDataCubeMap(a):this.setData(a)}return Object(a.a)(e,[{key:"glName",get:function(){return this._glName}},{key:"descriptor",get:function(){return this._descriptor}},{key:"dispose",value:function(){this._context.gl&&this._glName&&(this._context.unbindTextureAllUnits(this),this._context.gl.deleteTexture(this._glName),this._glName=null,this._context.instanceCounter.decrement(u.c.Texture,this))}},{key:"release",value:function(){this.dispose()}},{key:"resize",value:function(e,t){var n=this._descriptor;n.width===e&&n.height===t||(n.width=e,n.height=t,34067===this._descriptor.target?this.setDataCubeMap(null):this.setData(null))}},{key:"setDataCubeMap",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=34069;t<=34074;t++)this.setData(e,t)}},{key:"setData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3553;if(this._context&&this._context.gl){var r=this._context.gl;this._glName||(this._glName=r.createTexture()),void 0===t&&(t=null),null===t&&(this._descriptor.width=this._descriptor.width||4,this._descriptor.height=this._descriptor.height||4);var i=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES),a=this._descriptor;e._validateTexture(this._context,a),r.pixelStorei(r.UNPACK_ALIGNMENT,a.unpackAlignment),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,a.flipped?1:0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.preMultiplyAlpha?1:0);var o=a.pixelFormat,u=a.internalFormat?a.internalFormat:this._deriveInternalFormat(o,a.dataType);if(t instanceof ImageData||t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){var f=t.width,l=t.height;t instanceof HTMLVideoElement&&(f=t.videoWidth,l=t.videoHeight),a.width&&a.height,r.texImage2D(n,0,u,o,a.dataType,t),Object(s.a)(r),a.hasMipmap&&this.generateMipmap(),void 0===a.width&&(a.width=f),void 0===a.height&&(a.height=l)}else{null!=a.width&&null!=a.height||console.error("Width and height must be specified!"),r.DEPTH24_STENCIL8&&u===r.DEPTH_STENCIL&&(u=r.DEPTH24_STENCIL8);var h=a.width,v=a.height;if(d(t)){var p=Math.round(Math.log(Math.max(h,v))/Math.LN2)+1;a.hasMipmap=a.hasMipmap&&p===t.levels.length;for(var b=0;;++b){var m=t.levels[Math.min(b,t.levels.length-1)];if(r.compressedTexImage2D(n,b,u,h,v,0,m),1===h&&1===v||!a.hasMipmap)break;h=Math.max(1,h>>1),v=Math.max(1,v>>1)}}else if(Object(c.k)(t))r.texImage2D(n,0,u,h,v,0,o,a.dataType,t),Object(s.a)(r),a.hasMipmap&&this.generateMipmap();else for(var g=0;r.texImage2D(n,g,u,h,v,0,o,a.dataType,null),Object(s.a)(r),(1!==h||1!==v)&&a.hasMipmap;++g)h=Math.max(1,h>>1),v=Math.max(1,v>>1)}e._applySamplingMode(r,this._descriptor),e._applyWrapMode(r,this._descriptor),e._applyAnisotropicFilteringParameters(this._context,this._descriptor),Object(s.a)(r),this._context.bindTexture(i,e.TEXTURE_UNIT_FOR_UPDATES)}}},{key:"updateData",value:function(t,n,r,i,a,o){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:3553;o||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");var s=this._context.gl,u=this._descriptor,f=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);(n<0||r<0||i>u.width||a>u.height||n+i>u.width||r+a>u.height)&&console.error("An attempt to update out of bounds of the texture!"),s.pixelStorei(s.UNPACK_ALIGNMENT,u.unpackAlignment),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,u.flipped?1:0),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u.preMultiplyAlpha?1:0),o instanceof ImageData||o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement?s.texSubImage2D(c,t,n,r,u.pixelFormat,u.dataType,o):s.texSubImage2D(c,t,n,r,i,a,u.pixelFormat,u.dataType,o),this._context.bindTexture(f,e.TEXTURE_UNIT_FOR_UPDATES)}},{key:"generateMipmap",value:function(){var t=this._descriptor;t.hasMipmap||(t.hasMipmap=!0,this._samplingModeDirty=!0,e._validateTexture(this._context,t)),9729===t.samplingMode?(this._samplingModeDirty=!0,t.samplingMode=9985):9728===t.samplingMode&&(this._samplingModeDirty=!0,t.samplingMode=9984);var n=this._context.bindTexture(this,e.TEXTURE_UNIT_FOR_UPDATES);this._context.gl.generateMipmap(t.target),this._context.bindTexture(n,e.TEXTURE_UNIT_FOR_UPDATES)}},{key:"setSamplingMode",value:function(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}},{key:"setWrapMode",value:function(t){t!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=t,e._validateTexture(this._context,this._descriptor),this._wrapModeDirty=!0)}},{key:"applyChanges",value:function(){var t=this._context.gl,n=this._descriptor;this._samplingModeDirty&&(e._applySamplingMode(t,n),this._samplingModeDirty=!1),this._wrapModeDirty&&(e._applyWrapMode(t,n),this._wrapModeDirty=!1)}},{key:"_deriveInternalFormat",value:function(e,t){if("webgl"===this._context.webglVersion)return e;if(5126===t)switch(e){case 6408:return 34836;case 6407:return 34837;default:throw new Error("Unable to derive format")}return e}}],[{key:"_validateTexture",value:function(e,t){(t.width<0||t.height<0)&&console.error("Negative dimension parameters are not allowed!");var n=Object(o.i)(t.width)&&Object(o.i)(t.height);Object(f.a)(e.gl)||n||("number"==typeof t.wrapMode?33071!==t.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):33071===t.wrapMode.s&&33071===t.wrapMode.t||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),t.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))}},{key:"_applySamplingMode",value:function(e,t){var n=t.samplingMode,r=t.samplingMode;9985===n||9987===n?(n=9729,t.hasMipmap||(r=9729)):9984!==n&&9986!==n||(n=9728,t.hasMipmap||(r=9728)),e.texParameteri(t.target,e.TEXTURE_MAG_FILTER,n),e.texParameteri(t.target,e.TEXTURE_MIN_FILTER,r)}},{key:"_applyWrapMode",value:function(e,t){"number"==typeof t.wrapMode?(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode)):(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode.s),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode.t))}},{key:"_applyAnisotropicFilteringParameters",value:function(e,t){var n,r=e.capabilities.textureFilterAnisotropic;r&&e.gl.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY,null!=(n=t.maxAnisotropy)?n:1)}}]),e}();function d(e){return Object(c.k)(e)&&"type"in e&&"compressed"===e.type}l.TEXTURE_UNIT_FOR_UPDATES=0},547:function(e,t,n){"use strict";function r(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]}function a(e,t,n,r,i,a,o,c,s,u,f,l,d,h,v,p){return[e,t,n,r,i,a,o,c,s,u,f,l,d,h,v,p]}function o(e,t){return new Float64Array(e,t,16)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return a}));var c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze({__proto__:null,create:r,clone:i,fromValues:a,createView:o,IDENTITY:c})},548:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r}));var r,i=33984;!function(e){e[e.Texture=0]="Texture",e[e.Buffer=1]="Buffer",e[e.VAO=2]="VAO",e[e.Program=3]="Program",e[e.Framebuffer=4]="Framebuffer",e[e.Renderbuffer=5]="Renderbuffer",e[e.COUNT=6]="COUNT"}(r||(r={}));var a=33306},549:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s}));var r=n(18),i=n(12),a=n(11).a.getLogger("esri/views/webgl");var o=!!Object(i.a)("enable-feature:webgl-debug");function c(){return o}function s(){return o}function u(e){if(c()){var t=e.getError();if(t){var n=function(e,t){switch(t){case e.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case e.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case e.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case e.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case e.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case e.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(e,t),i=(new Error).stack;a.error(new r.a("webgl-error","WebGL error occured",{message:n,stack:i}))}}}},557:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return v}));var r,i,a,o,c,s=n(542),u=n(7),f=n(58),l=n(79),d=n(538);function h(e,t){if(t.slicePlaneEnabled){e.extensions.add("GL_OES_standard_derivatives"),t.sliceEnabledForVertexPrograms&&(e.vertex.uniforms.add("slicePlaneOrigin","vec3"),e.vertex.uniforms.add("slicePlaneBasis1","vec3"),e.vertex.uniforms.add("slicePlaneBasis2","vec3")),e.fragment.uniforms.add("slicePlaneOrigin","vec3"),e.fragment.uniforms.add("slicePlaneBasis1","vec3"),e.fragment.uniforms.add("slicePlaneBasis2","vec3");var n=Object(d.a)(r||(r=Object(s.a)(["struct SliceFactors {\nfloat front;\nfloat side0;\nfloat side1;\nfloat side2;\nfloat side3;\n};\nSliceFactors calculateSliceFactors(vec3 pos) {\nvec3 rel = pos - slicePlaneOrigin;\nvec3 slicePlaneNormal = -cross(slicePlaneBasis1, slicePlaneBasis2);\nfloat slicePlaneW = -dot(slicePlaneNormal, slicePlaneOrigin);\nfloat basis1Len2 = dot(slicePlaneBasis1, slicePlaneBasis1);\nfloat basis2Len2 = dot(slicePlaneBasis2, slicePlaneBasis2);\nfloat basis1Dot = dot(slicePlaneBasis1, rel);\nfloat basis2Dot = dot(slicePlaneBasis2, rel);\nreturn SliceFactors(\ndot(slicePlaneNormal, pos) + slicePlaneW,\n-basis1Dot - basis1Len2,\nbasis1Dot - basis1Len2,\n-basis2Dot - basis2Len2,\nbasis2Dot - basis2Len2\n);\n}\nbool sliceByFactors(SliceFactors factors) {\nreturn factors.front < 0.0\n&& factors.side0 < 0.0\n&& factors.side1 < 0.0\n&& factors.side2 < 0.0\n&& factors.side3 < 0.0;\n}\nbool sliceEnabled() {\nreturn dot(slicePlaneBasis1, slicePlaneBasis1) != 0.0;\n}\nbool sliceByPlane(vec3 pos) {\nreturn sliceEnabled() && sliceByFactors(calculateSliceFactors(pos));\n}\n#define rejectBySlice(_pos_) sliceByPlane(_pos_)\n#define discardBySlice(_pos_) { if (sliceByPlane(_pos_)) discard; }"]))),u=Object(d.a)(i||(i=Object(s.a)(["vec4 applySliceHighlight(vec4 color, vec3 pos) {\nSliceFactors factors = calculateSliceFactors(pos);\nif (sliceByFactors(factors)) {\nreturn color;\n}\nconst float HIGHLIGHT_WIDTH = 1.0;\nconst vec4 HIGHLIGHT_COLOR = vec4(0.0, 0.0, 0.0, 0.3);\nfactors.front /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.front);\nfactors.side0 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side0);\nfactors.side1 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side1);\nfactors.side2 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side2);\nfactors.side3 /= (2.0 * HIGHLIGHT_WIDTH) * fwidth(factors.side3);\nfloat highlightFactor = (1.0 - step(0.5, factors.front))\n* (1.0 - step(0.5, factors.side0))\n* (1.0 - step(0.5, factors.side1))\n* (1.0 - step(0.5, factors.side2))\n* (1.0 - step(0.5, factors.side3));\nreturn mix(color, vec4(HIGHLIGHT_COLOR.rgb, color.a), highlightFactor * HIGHLIGHT_COLOR.a);\n}"]))),f=t.sliceHighlightDisabled?Object(d.a)(a||(a=Object(s.a)(["#define highlightSlice(_color_, _pos_) (_color_)"]))):Object(d.a)(o||(o=Object(s.a)(["\n        ","\n        #define highlightSlice(_color_, _pos_) (sliceEnabled() ? applySliceHighlight(_color_, _pos_) : (_color_))\n      "])),u);t.sliceEnabledForVertexPrograms&&e.vertex.code.add(n),e.fragment.code.add(n),e.fragment.code.add(f)}else{var l=Object(d.a)(c||(c=Object(s.a)(["#define rejectBySlice(_pos_) false\n#define discardBySlice(_pos_) {}\n#define highlightSlice(_color_, _pos_) (_color_)"])));t.sliceEnabledForVertexPrograms&&e.vertex.code.add(l),e.fragment.code.add(l)}}function v(e,t,n){p(e,t,n.slicePlane,n.origin)}function p(e,t,n,r){t.slicePlaneEnabled&&(Object(u.k)(n)?(r?(Object(f.j)(b,n.origin,r),e.setUniform3fv("slicePlaneOrigin",b)):e.setUniform3fv("slicePlaneOrigin",n.origin),e.setUniform3fv("slicePlaneBasis1",n.basis1),e.setUniform3fv("slicePlaneBasis2",n.basis2)):(e.setUniform3fv("slicePlaneBasis1",l.b),e.setUniform3fv("slicePlaneBasis2",l.b),e.setUniform3fv("slicePlaneOrigin",l.b)))}var b=Object(l.e)()},558:function(e,t,n){"use strict";function r(){return[0,0,0,0]}function i(e){return[e[0],e[1],e[2],e[3]]}function a(e,t,n,r){return[e,t,n,r]}function o(e){for(var t=[0,0,0,0],n=Math.min(4,e.length),r=0;r<n;++r)t[r]=e[r];return t}function c(e,t){return new Float64Array(e,t,4)}function s(){return[0,0,0,0]}function u(){return a(1,1,1,1)}function f(){return a(1,0,0,0)}function l(){return a(0,1,0,0)}function d(){return a(0,0,1,0)}function h(){return a(0,0,0,1)}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return a}));var v=[0,0,0,0],p=u(),b=f(),m=l(),g=d(),O=h();Object.freeze({__proto__:null,create:r,clone:i,fromValues:a,fromArray:o,createView:c,zeros:s,ones:u,unitX:f,unitY:l,unitZ:d,unitW:h,ZEROS:v,ONES:p,UNIT_X:b,UNIT_Y:m,UNIT_Z:g,UNIT_W:O})},561:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(5),i=n(6),a=n(2),o=n(3),c=n(11).a.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder"),s=function(){function e(){Object(a.a)(this,e),this.includedModules=new Map}return Object(o.a)(e,[{key:"include",value:function(e,t){this.includedModules.has(e)?this.includedModules.get(e)!==t&&c.error("Trying to include shader module multiple times with different sets of options."):(this.includedModules.set(e,t),e(this.builder,t))}}]),e}(),u=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).vertex=new d,e.fragment=new d,e.attributes=new h,e.varyings=new v,e.extensions=new p,e.constants=new b,e}return Object(o.a)(n,[{key:"fragmentUniforms",get:function(){return this.fragment.uniforms}},{key:"builder",get:function(){return this}},{key:"generateSource",value:function(e){var t=this.extensions.generateSource(e),n=this.attributes.generateSource(e),r=this.varyings.generateSource(),i="vertex"===e?this.vertex:this.fragment,a=i.uniforms.generateSource(),o=i.code.generateSource(),c="vertex"===e?g:m,s=this.constants.generateSource().concat(i.constants.generateSource());return"\n".concat(t.join("\n"),"\n\n").concat(c,"\n\n").concat(s.join("\n"),"\n\n").concat(a.join("\n"),"\n\n").concat(n.join("\n"),"\n\n").concat(r.join("\n"),"\n\n").concat(o.join("\n"))}}]),n}(s),f=function(){function e(){Object(a.a)(this,e),this._entries=new Map}return Object(o.a)(e,[{key:"add",value:function(e,t,n){var r="".concat(e,"_").concat(t,"_").concat(n);return this._entries.set(r,{name:e,type:t,arraySize:n}),this}},{key:"generateSource",value:function(){return Array.from(this._entries.values()).map((function(e){return"uniform ".concat(e.type," ").concat(e.name).concat((t=e.arraySize)?"[".concat(t,"]"):"",";");var t}))}},{key:"entries",get:function(){return Array.from(this._entries.values())}}]),e}(),l=function(){function e(){Object(a.a)(this,e),this._entries=new Array}return Object(o.a)(e,[{key:"add",value:function(e){this._entries.push(e)}},{key:"generateSource",value:function(){return this._entries}}]),e}(),d=function(e){Object(r.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(a.a)(this,n),(e=t.apply(this,arguments)).uniforms=new f,e.code=new l,e.constants=new b,e}return Object(o.a)(n,[{key:"builder",get:function(){return this}}]),n}(s),h=function(){function e(){Object(a.a)(this,e),this._entries=new Array}return Object(o.a)(e,[{key:"add",value:function(e,t){this._entries.push([e,t])}},{key:"generateSource",value:function(e){return"fragment"===e?[]:this._entries.map((function(e){return"attribute ".concat(e[1]," ").concat(e[0],";")}))}}]),e}(),v=function(){function e(){Object(a.a)(this,e),this._entries=new Array}return Object(o.a)(e,[{key:"add",value:function(e,t){this._entries.push([e,t])}},{key:"generateSource",value:function(){return this._entries.map((function(e){return"varying ".concat(e[1]," ").concat(e[0],";")}))}}]),e}(),p=function(){function e(){Object(a.a)(this,e),this._entries=new Set}return Object(o.a)(e,[{key:"add",value:function(e){this._entries.add(e)}},{key:"generateSource",value:function(t){var n="vertex"===t?e.ALLOWLIST_VERTEX:e.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((function(e){return n.includes(e)})).map((function(e){return"#extension ".concat(e," : enable")}))}}]),e}();p.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],p.ALLOWLIST_VERTEX=[];var b=function(){function e(){Object(a.a)(this,e),this._entries=[]}return Object(o.a)(e,[{key:"add",value:function(t,n,r){var i="ERROR_CONSTRUCTOR_STRING";switch(n){case"float":i=e.numberToFloatStr(r);break;case"int":i=e.numberToIntStr(r);break;case"bool":i=r.toString();break;case"vec2":i="vec2(".concat(e.numberToFloatStr(r[0]),",                            ").concat(e.numberToFloatStr(r[1]),")");break;case"vec3":i="vec3(".concat(e.numberToFloatStr(r[0]),",                            ").concat(e.numberToFloatStr(r[1]),",                            ").concat(e.numberToFloatStr(r[2]),")");break;case"vec4":i="vec4(".concat(e.numberToFloatStr(r[0]),",                            ").concat(e.numberToFloatStr(r[1]),",                            ").concat(e.numberToFloatStr(r[2]),",                            ").concat(e.numberToFloatStr(r[3]),")");break;case"ivec2":i="ivec2(".concat(e.numberToIntStr(r[0]),",                             ").concat(e.numberToIntStr(r[1]),")");break;case"ivec3":i="ivec3(".concat(e.numberToIntStr(r[0]),",                             ").concat(e.numberToIntStr(r[1]),",                             ").concat(e.numberToIntStr(r[2]),")");break;case"ivec4":i="ivec4(".concat(e.numberToIntStr(r[0]),",                             ").concat(e.numberToIntStr(r[1]),",                             ").concat(e.numberToIntStr(r[2]),",                             ").concat(e.numberToIntStr(r[3]),")");break;case"mat2":case"mat3":case"mat4":i="".concat(n,"(").concat(Array.prototype.map.call(r,(function(t){return e.numberToFloatStr(t)})).join(", "),")")}return this._entries.push("const ".concat(n," ").concat(t," = ").concat(i,";")),this}},{key:"generateSource",value:function(){return Array.from(this._entries)}}],[{key:"numberToIntStr",value:function(e){return e.toFixed(0)}},{key:"numberToFloatStr",value:function(e){return Number.isInteger(e)?e.toFixed(1):e.toString()}}]),e}(),m="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif",g="precision highp float;\nprecision highp sampler2D;"},563:function(e,t,n){"use strict";function r(){return[1,0,0,0,1,0,0,0,1]}function i(e,t){return new Float64Array(e,t,9)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));Object.freeze({__proto__:null,create:r,clone:function(e){return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},fromValues:function(e,t,n,r,i,a,o,c,s){return[e,t,n,r,i,a,o,c,s]},createView:i})},567:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return _})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return g}));var r=n(2),i=n(3),a=n(65),o=(n(100),n(30)),c=(n(60),n(79),n(407),n(558)),s=(Object(c.e)(),function(){function e(t){Object(r.a)(this,e),this.message=t}return Object(i.a)(e,[{key:"toString",value:function(){return"AssertException: ".concat(this.message)}}]),e}());function u(e,t){if(!e){t=t||"assert";var n=new Error(t);throw n.stack&&console.log(n.stack),new s(t)}}function f(e,t,n,r){var i,a=(n[0]-e[0])/t[0],o=(r[0]-e[0])/t[0];a>o&&(i=a,a=o,o=i);var c=(n[1]-e[1])/t[1],s=(r[1]-e[1])/t[1];if(c>s&&(i=c,c=s,s=i),a>s||c>o)return!1;c>a&&(a=c),s<o&&(o=s);var u=(n[2]-e[2])/t[2],f=(r[2]-e[2])/t[2];return u>f&&(i=u,u=f,f=i),!(a>f||u>o)&&(f<o&&(o=f),!(o<0))}function l(e,t,n,r){e[12]=t,e[13]=n,e[14]=r}function d(e){return 1===e[0]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&1===e[5]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&1===e[10]&&0===e[11]&&1===e[15]}function h(e,t,n){return 2*Math.atan(Math.sqrt(t*t+n*n)*Math.tan(.5*e)/t)}function v(e,t,n){return 2*Math.atan(Math.sqrt(t*t+n*n)*Math.tan(.5*e)/n)}function p(e,t,n){return 2*Math.atan(t*Math.tan(.5*e)/Math.sqrt(t*t+n*n))}function b(e,t,n){return 2*Math.atan(n*Math.tan(.5*e)/Math.sqrt(t*t+n*n))}function m(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Object(a.d)(e,0,x),i=0;i<4;i++)t[n+i]=Math.floor(256*y(r*O[i]))}function g(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0,r=0;r<4;r++)n+=e[t+r]*j[r];return n}var O=[1,256,65536,16777216],j=[1/256,1/65536,1/16777216,1/4294967296],x=g(new Uint8ClampedArray([255,255,255,255]));function y(e){return e-Math.floor(e)}function _(e,t,n,r,i){var a=e;0===e[11]?(r[0]=2/(t*a[0]),r[1]=2/(n*a[5]),r[2]=(1+a[12])/a[0],r[3]=(1+a[13])/a[5],Object(o.s)(i,0,1)):(r[0]=-2/(t*a[0]),r[1]=-2/(n*a[5]),r[2]=(1-a[8])/a[0],r[3]=(1-a[9])/a[5],Object(o.s)(i,1,0))}},568:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var r,i=n(542),a=n(538);function o(e,t){e.fragment.uniforms.add("terrainDepthTexture","sampler2D"),e.fragment.uniforms.add("cameraNearFar","vec2"),e.fragment.uniforms.add("inverseViewport","vec2"),e.fragment.code.add(Object(a.a)(r||(r=Object(i.a)(["\n    // Compare the linearized depths of fragment and terrain. Discard fragments on the wrong side of the terrain.\n    void terrainDepthTest(vec4 fragCoord, float fragmentDepth){\n\n      float terrainDepth = linearDepthFromTexture(terrainDepthTexture, fragCoord.xy * inverseViewport, cameraNearFar);\n      if(fragmentDepth "," terrainDepth){\n        discard;\n      }\n    }\n  "])),t.cullAboveGround?">":"<="))}function c(e,t){t.multipassTerrainEnabled&&t.terrainLinearDepthTexture&&e.bindTexture(t.terrainLinearDepthTexture,"terrainDepthTexture")}},570:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return m}));var r=n(2),i=n(3),a=n(7),o=n(386),c=n(563),s=n(547),u=n(611),f=n(60),l=n(79),d=n(558),h=function(){function e(t,n,i){var a=this;Object(r.a)(this,e),this.itemByteSize=t,this.itemCreate=n,this.buffers=[],this.items=[],this.itemsPerBuffer=0,this.itemsPtr=0,this.itemsPerBuffer=Math.ceil(i/this.itemByteSize),this.tickHandle=o.a.before((function(){return a.reset()}))}return Object(i.a)(e,[{key:"destroy",value:function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(a.p)(this.tickHandle)),this.itemsPtr=0,this.items=Object(a.p)(this.items),this.buffers=Object(a.p)(this.buffers)}},{key:"get",value:function(){0===this.itemsPtr&&Object(o.a)((function(){}));for(var e=Math.floor(this.itemsPtr/this.itemsPerBuffer);this.buffers.length<=e;){for(var t=new ArrayBuffer(this.itemsPerBuffer*this.itemByteSize),n=0;n<this.itemsPerBuffer;++n)this.items.push(this.itemCreate(t,n*this.itemByteSize));this.buffers.push(t)}return this.items[this.itemsPtr++]}},{key:"reset",value:function(){for(var e=2*(Math.floor(this.itemsPtr/this.itemsPerBuffer)+1);this.buffers.length>e;)this.buffers.pop(),this.items.length=this.buffers.length*this.itemsPerBuffer;this.itemsPtr=0}},{key:"test",get:function(){return{size:this.buffers.length*this.itemsPerBuffer*this.itemByteSize}}}],[{key:"createVec2f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(16,f.c,t)}},{key:"createVec3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(24,l.d,t)}},{key:"createVec4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(32,d.c,t)}},{key:"createMat3f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(72,c.a,t)}},{key:"createMat4f64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(128,s.b,t)}},{key:"createQuatf64",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v;return new e(32,u.d,t)}}]),e}(),v=4096,p=h.createVec2f64(),b=h.createVec3f64(),m=h.createVec4f64(),g=(h.createMat3f64(),h.createMat4f64()),O=h.createQuatf64()},575:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return f}));var r,i=n(542),a=n(558),o=n(538),c=Object(a.g)(1,1,0,1),s=Object(a.g)(1,0,1,1);function u(e){e.fragment.uniforms.add("depthTex","sampler2D"),e.fragment.uniforms.add("highlightViewportPixelSz","vec4"),e.fragment.constants.add("occludedHighlightFlag","vec4",c).add("unoccludedHighlightFlag","vec4",s),e.fragment.code.add(Object(o.a)(r||(r=Object(i.a)(["void outputHighlight() {\nvec4 fragCoord = gl_FragCoord;\nfloat sceneDepth = texture2D(depthTex, (fragCoord.xy - highlightViewportPixelSz.xy) * highlightViewportPixelSz.zw).r;\nif (fragCoord.z > sceneDepth + 5e-7) {\ngl_FragColor = occludedHighlightFlag;\n}\nelse {\ngl_FragColor = unoccludedHighlightFlag;\n}\n}"]))))}function f(e,t){e.bindTexture(t.highlightDepthTexture,"depthTex"),e.setUniform4f("highlightViewportPixelSz",0,0,t.inverseViewport[0],t.inverseViewport[1])}},578:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return f}));var r,i,a,o,c=n(542),s=n(538),u=.1,f=.001;function l(e,t){var n=e.fragment;switch(t.alphaDiscardMode){case 0:n.code.add(Object(s.a)(r||(r=Object(c.a)(["\n        #define discardOrAdjustAlpha(color) { if (color.a < ",") { discard; } }\n      "])),s.a.float(f)));break;case 1:n.code.add(Object(s.a)(i||(i=Object(c.a)(["void discardOrAdjustAlpha(inout vec4 color) {\ncolor.a = 1.0;\n}"]))));break;case 2:n.uniforms.add("textureAlphaCutoff","float"),n.code.add(Object(s.a)(a||(a=Object(c.a)(["#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } else { color.a = 1.0; } }"]))));break;case 3:e.fragment.uniforms.add("textureAlphaCutoff","float"),e.fragment.code.add(Object(s.a)(o||(o=Object(c.a)(["#define discardOrAdjustAlpha(color) { if (color.a < textureAlphaCutoff) { discard; } }"]))))}}},579:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return s}));var r=n(641),i=n(58),a=n(79),o=n(570);function c(e){return e?{origin:Object(a.c)(e.origin),direction:Object(a.c)(e.direction)}:{origin:Object(a.e)(),direction:Object(a.e)()}}function s(e,t){var n=v.get();return n.origin=e,n.direction=t,n}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c();return l(e.origin,e.direction,t)}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return Object(i.k)(n.origin,e),Object(i.j)(n.direction,t,e),n}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c();return Object(i.k)(n.origin,e),Object(i.k)(n.direction,t),n}function d(e,t){var n=Object(i.g)(o.d.get(),Object(i.r)(o.d.get(),e.direction),Object(i.j)(o.d.get(),t,e.origin));return Object(i.h)(n,n)}function h(e,t,n){var r=Object(i.h)(e.direction,Object(i.j)(n,t,e.origin));return Object(i.f)(n,e.origin,Object(i.e)(n,e.direction,r)),n}var v=new r.a((function(){return{origin:null,direction:null}}))},580:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,i=n(542),a=n(715),o=n(538);function c(e){e.include(a.a),e.code.add(Object(o.a)(r||(r=Object(i.a)(["float linearDepthFromFloat(float depth, vec2 nearFar) {\nreturn -(depth * (nearFar[1] - nearFar[0]) + nearFar[0]);\n}\nfloat linearDepthFromTexture(sampler2D depthTex, vec2 uv, vec2 nearFar) {\nreturn linearDepthFromFloat(rgba2float(texture2D(depthTex, uv)), nearFar);\n}"]))))}},607:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,i,a=n(542),o=n(538);function c(e,t){t.linearDepth?e.vertex.code.add(Object(o.a)(r||(r=Object(a.a)(["vec4 transformPositionWithDepth(mat4 proj, mat4 view, vec3 pos, vec2 nearFar, out float depth) {\nvec4 eye = view * vec4(pos, 1.0);\ndepth = (-eye.z - nearFar[0]) / (nearFar[1] - nearFar[0]) ;\nreturn proj * eye;\n}"])))):e.vertex.code.add(Object(o.a)(i||(i=Object(a.a)(["vec4 transformPosition(mat4 proj, mat4 view, vec3 pos) {\nreturn proj * (view * vec4(pos, 1.0));\n}"]))))}},609:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4),i=n.n(r),a=n(9),o=n(2),c=n(3),s=function(){function e(t,n){Object(o.a)(this,e),this._module=t,this._loadModule=n}return Object(c.a)(e,[{key:"get",value:function(){return this._module}},{key:"reload",value:function(){var e=Object(a.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._loadModule();case 2:return this._module=e.sent,e.abrupt("return",this._module);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}()},610:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),i=n(3),a=n(5),o=n(6),c=n(7),s=n(212),u=n(549),f=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(e,i,a){var o;return Object(r.a)(this,n),(o=t.call(this,e,i.generateSource("vertex"),i.generateSource("fragment"),a))._textures=new Map,o._freeTextureUnits=new s.a({deallocator:null}),o._fragmentUniforms=Object(u.b)()?i.fragmentUniforms.entries:null,o}return Object(i.a)(n,[{key:"stop",value:function(){this._textures.clear(),this._freeTextureUnits.clear()}},{key:"bindTexture",value:function(e,t){if(Object(c.j)(e)||null==e.glName){var n=this._textures.get(t);return n&&(this._context.bindTexture(null,n.unit),this._freeTextureUnit(n),this._textures.delete(t)),null}var r=this._textures.get(t);return null==r?(r=this._allocTextureUnit(e),this._textures.set(t,r)):r.texture=e,this._context.useProgram(this),this.setUniform1i(t,r.unit),this._context.bindTexture(e,r.unit),r.unit}},{key:"rebindTextures",value:function(){var e=this;this._context.useProgram(this),this._textures.forEach((function(t,n){e._context.bindTexture(t.texture,t.unit),e.setUniform1i(n,t.unit)})),Object(c.k)(this._fragmentUniforms)&&this._fragmentUniforms.forEach((function(t){if(("sampler2D"===t.type||"samplerCube"===t.type)&&!e._textures.has(t.name))throw new Error("Texture sampler ".concat(t.name," has no bound texture"))}))}},{key:"_allocTextureUnit",value:function(e){return{texture:e,unit:0===this._freeTextureUnits.length?this._textures.size:this._freeTextureUnits.pop()}}},{key:"_freeTextureUnit",value:function(e){this._freeTextureUnits.push(e.unit)}}]),n}(n(683).a)},611:function(e,t,n){"use strict";function r(){return[0,0,0,1]}function i(e){return[e[0],e[1],e[2],e[3]]}function a(e,t){return new Float64Array(e,t,4)}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return a}));var o=[0,0,0,1];Object.freeze({__proto__:null,create:r,clone:i,fromValues:function(e,t,n,r){return[e,t,n,r]},createView:a,IDENTITY:o})},613:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return l}));var r=n(544),i=Object(r.g)(770,1,771,771),a=Object(r.h)(1,1),o=Object(r.h)(0,771);function c(e){return 2===e?null:1===e?o:a}function s(e){return 2===e?r.d:null}var u=5e5,f={factor:-1,units:-2};function l(e){return e?f:null}function d(e){return 3===e||2===e?513:515}},618:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(3),a=n(7),o=function(){function e(t,n){var i=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return i.dispose()};Object(r.a)(this,e),this.release=a,n&&(this._config=n.snapshot()),this._program=this.initializeProgram(t),this._pipeline=this.initializePipeline(t)}return Object(i.a)(e,[{key:"dispose",value:function(){this._program=Object(a.f)(this._program),this._pipeline=this._config=null}},{key:"reload",value:function(e){Object(a.f)(this._program),this._program=this.initializeProgram(e)}},{key:"program",get:function(){return this._program}},{key:"pipeline",get:function(){return this._pipeline}},{key:"key",get:function(){return this._config.key}},{key:"configuration",get:function(){return this._config}},{key:"bindPass",value:function(e,t){}},{key:"bindMaterial",value:function(e,t){}},{key:"bindDraw",value:function(e,t,n){}},{key:"bindPipelineState",value:function(e){e.setPipelineState(this.pipeline)}},{key:"ensureAttributeLocations",value:function(e){this.program.assertCompatibleVertexAttributeLocations(e)}},{key:"primitiveType",get:function(){return 4}}]),e}()},619:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=new Map([["position",0],["normal",1],["uv0",2],["color",3],["size",4],["tangent",4],["auxpos1",5],["symbolColor",5],["auxpos2",6],["featureAttribute",6],["instanceFeatureAttribute",6],["instanceColor",7],["model",8],["modelNormal",12],["modelOriginHi",11],["modelOriginLo",15]])},620:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return k})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return x})),n.d(t,"e",(function(){return M})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return T})),n.d(t,"i",(function(){return y}));var r=n(23),i=n(65),a=n(7),o=n(58),c=n(79),s=n(304),u=n(923),f=n(567),l=n(654),d=Object(s.f)();function h(e,t,n,r,i,a,o){if(!Object(l.e)(t))if(e.boundingInfo){Object(f.a)(0===e.primitiveType);var c=n.tolerance;p(e.boundingInfo,r,i,c,a,o)}else{var s=e.indices.get("position"),u=e.vertexAttributes.get("position");m(r,i,0,s.length/3,s,u,void 0,a,o)}}var v=Object(c.e)();function p(e,t,n,r,i,c){if(!Object(a.j)(e)){var u=function(e,t,n){return Object(o.w)(n,1/(t[0]-e[0]),1/(t[1]-e[1]),1/(t[2]-e[2]))}(t,n,v);if(Object(s.y)(d,e.getBBMin()),Object(s.x)(d,e.getBBMax()),Object(a.k)(i)&&i.applyToAabb(d),x(d,t,u,r)){var f=e.primitiveIndices,l=e.indices,h=e.position,b=f?f.length:l.length/3;if(b>P){var g=e.getChildren();if(void 0!==g){for(var O=0;O<8;++O)void 0!==g[O]&&p(g[O],t,n,r,i,c);return}}m(t,n,0,b,l,h,f,i,c)}}}var b=Object(c.e)();function m(e,t,n,i,o,c,s,u,f){if(s)return function(e,t,n,i,o,c,s,u,f){for(var l=c.data,d=c.stride||c.size,h=e[0],v=e[1],p=e[2],m=t[0]-h,g=t[1]-v,O=t[2]-p,x=n;x<i;++x){var y,_,w,T,M,S,k=s[x],P=3*k,A=d*o[P++],I=l[A++],F=l[A++],z=l[A];A=d*o[P++];var D=l[A++],C=l[A++],E=l[A];A=d*o[P];var L=l[A++],N=l[A++],U=l[A];Object(a.k)(u)&&(y=u.applyToVertex(I,F,z,x),I=(_=Object(r.a)(y,3))[0],F=_[1],z=_[2],w=u.applyToVertex(D,C,E,x),D=(T=Object(r.a)(w,3))[0],C=T[1],E=T[2],M=u.applyToVertex(L,N,U,x),L=(S=Object(r.a)(M,3))[0],N=S[1],U=S[2]);var R=D-I,V=C-F,H=E-z,B=L-I,q=N-F,G=U-z,W=g*G-q*O,X=O*B-G*m,K=m*q-B*g,Y=R*W+V*X+H*K;if(!(Math.abs(Y)<=Number.EPSILON)){var Z=h-I,J=v-F,Q=p-z,$=Z*W+J*X+Q*K;if(Y>0){if($<0||$>Y)continue}else if($>0||$<Y)continue;var ee=J*H-V*Q,te=Q*R-H*Z,ne=Z*V-R*J,re=m*ee+g*te+O*ne;if(Y>0){if(re<0||$+re>Y)continue}else if(re>0||$+re<Y)continue;var ie=(B*ee+q*te+G*ne)/Y;ie>=0&&f(ie,j(R,V,H,B,q,G,b),k)}}}(e,t,n,i,o,c,s,u,f);for(var l=c.data,d=c.stride||c.size,h=e[0],v=e[1],p=e[2],m=t[0]-h,g=t[1]-v,O=t[2]-p,x=n,y=3*n;x<i;++x){var _,w,T,M,S,k,P=d*o[y++],A=l[P++],I=l[P++],F=l[P];P=d*o[y++];var z=l[P++],D=l[P++],C=l[P];P=d*o[y++];var E=l[P++],L=l[P++],N=l[P];Object(a.k)(u)&&(_=u.applyToVertex(A,I,F,x),A=(w=Object(r.a)(_,3))[0],I=w[1],F=w[2],T=u.applyToVertex(z,D,C,x),z=(M=Object(r.a)(T,3))[0],D=M[1],C=M[2],S=u.applyToVertex(E,L,N,x),E=(k=Object(r.a)(S,3))[0],L=k[1],N=k[2]);var U=z-A,R=D-I,V=C-F,H=E-A,B=L-I,q=N-F,G=g*q-B*O,W=O*H-q*m,X=m*B-H*g,K=U*G+R*W+V*X;if(!(Math.abs(K)<=Number.EPSILON)){var Y=h-A,Z=v-I,J=p-F,Q=Y*G+Z*W+J*X;if(K>0){if(Q<0||Q>K)continue}else if(Q>0||Q<K)continue;var $=Z*V-R*J,ee=J*U-V*Y,te=Y*R-U*Z,ne=m*$+g*ee+O*te;if(K>0){if(ne<0||Q+ne>K)continue}else if(ne>0||Q+ne<K)continue;var re=(H*$+B*ee+q*te)/K;re>=0&&f(re,j(U,R,V,H,B,q,b),x)}}}var g=Object(c.e)(),O=Object(c.e)();function j(e,t,n,r,i,a,c){return Object(o.w)(g,e,t,n),Object(o.w)(O,r,i,a),Object(o.g)(c,g,O),Object(o.r)(c,c),c}function x(e,t,n,r){return function(e,t,n,r,i){var a=(e[0]-r-t[0])*n[0],o=(e[3]+r-t[0])*n[0],c=Math.min(a,o),s=Math.max(a,o),u=(e[1]-r-t[1])*n[1],f=(e[4]+r-t[1])*n[1];if((s=Math.min(s,Math.max(u,f)))<0)return!1;if((c=Math.max(c,Math.min(u,f)))>s)return!1;var l=(e[2]-r-t[2])*n[2],d=(e[5]+r-t[2])*n[2];return!((s=Math.min(s,Math.max(l,d)))<0)&&!((c=Math.max(c,Math.min(l,d)))>s)&&c<i}(e,t,n,r,1/0)}function y(e,t,n,r,a){var o=(n.screenLength||0)*e.pixelRatio;a&&(o=Object(u.d)(o,r,t,a));var c=o*Math.tan(.5*e.fovY)/(.5*e.fullHeight);return Object(i.d)(c*t,n.minWorldLength||0,null!=n.maxWorldLength?n.maxWorldLength:1/0)}function _(e,t,n){if(e){var r=e.parameters,i=e.paddingPixelsOverride;t.setUniform4f(n,r.divisor,r.offset,r.minPixelSize,i)}}function w(e,t){var n=t?w(t):{};for(var r in e){var i=e[r];i&&i.forEach&&(i=S(i)),null==i&&r in n||(n[r]=i)}return n}function T(e,t){var n=!1;for(var r in t){var i=t[r];void 0!==i&&(n=!0,Array.isArray(i)?e[r]=i.slice():e[r]=i)}return n}function M(e,t,n,r,a){if(t.options.selectionMode){for(var o=e.vertexAttributes.get("position").data,c=e.vertexAttributes.get("size"),s=c&&c.data[0],u=n[0],f=n[1],l=((s+r)/2+4)*e.screenToWorldRatio,d=Number.MAX_VALUE,h=0;h<o.length-5;h+=3){var v=o[h],p=o[h+1],b=u-v,m=f-p,g=o[h+3]-v,O=o[h+4]-p,j=Object(i.d)((g*b+O*m)/(g*g+O*O),0,1),x=g*j-b,y=O*j-m,_=x*x+y*y;_<d&&(d=_)}d<l*l&&a()}}function S(e){var t=[];return e.forEach((function(e){return t.push(e)})),t}var k={multiply:1,ignore:2,replace:3,tint:4},P=1e3},621:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,i=n(542),a=n(538);function o(e){e.code.add(Object(a.a)(r||(r=Object(i.a)(["vec4 premultiplyAlpha(vec4 v) {\nreturn vec4(v.rgb * v.a, v.a);\n}\nvec3 rgb2hsv(vec3 c) {\nvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d = q.x - min(q.w, q.y);\nfloat e = 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nfloat rgb2v(vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}"]))))}},622:function(e,t,n){"use strict";function r(e){return window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext}n.d(t,"a",(function(){return r}))},624:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}));var r=n(13),i=n(2),a=n(3),o=n(65),c=function(){function e(){Object(i.a)(this,e),this._key="",this._keyDirty=!1,this._parameterBits=this._parameterBits.map((function(){return 0}))}return Object(a.a)(e,[{key:"key",get:function(){return this._keyDirty&&(this._keyDirty=!1,this._key=String.fromCharCode.apply(String,this._parameterBits)),this._key}},{key:"snapshot",value:function(){var e,t=this._parameterNames,n={key:this.key},i=Object(r.a)(t);try{for(i.s();!(e=i.n()).done;){var a=e.value;n[a]=this[a]}}catch(o){i.e(o)}finally{i.f()}return n}}]),e}();function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,n){var r,i;t._parameterNames=null!=(r=t._parameterNames)?r:[],t._parameterNames.push(n);for(var a=t._parameterNames.length-1,c=e.count||2,s=Math.ceil(Object(o.k)(c)),u=null!=(i=t._parameterBits)?i:[0],f=0;u[f]+s>16;)++f>=u.length&&u.push(0);t._parameterBits=u;var l=u[f],d=(1<<s)-1<<l;u[f]+=s,Object.defineProperty(t,n,{get:function(){return this[a]},set:function(e){if(this[a]!==e&&(this[a]=e,this._keyDirty=!0,this._parameterBits[f]=this._parameterBits[f]&~d|+e<<l&d,"number"!=typeof e&&"boolean"!=typeof e))throw"Configuration value for "+n+" must be boolean or number, got "+typeof e}})}}},625:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return d}));var r=n(2),i=n(3),a=n(5),o=n(6),c=n(7),s=n(745),u=n(619),f=n(620),l=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(e,i){var a;return Object(r.a)(this,n),(a=t.call(this)).type=3,a.supportsEdges=!1,a._visible=!0,a._renderPriority=0,a._insertOrder=0,a._vertexAttributeLocations=u.a,a._params=Object(f.c)(e,i),a.validateParameterValues(a._params),a}return Object(i.a)(n,[{key:"dispose",value:function(){}},{key:"params",get:function(){return this._params}},{key:"update",value:function(e){return!1}},{key:"setParameterValues",value:function(e){Object(f.h)(this._params,e)&&(this.validateParameterValues(this._params),this.parametersChanged())}},{key:"validateParameterValues",value:function(e){}},{key:"visible",get:function(){return this._visible},set:function(e){e!==this._visible&&(this._visible=e,this.parametersChanged())}},{key:"isVisibleInPass",value:function(e){return!0}},{key:"renderOccluded",get:function(){return this.params.renderOccluded}},{key:"renderPriority",get:function(){return this._renderPriority},set:function(e){e!==this._renderPriority&&(this._renderPriority=e,this.parametersChanged())}},{key:"insertOrder",get:function(){return this._insertOrder},set:function(e){e!==this._insertOrder&&(this._insertOrder=e,this.parametersChanged())}},{key:"vertexAttributeLocations",get:function(){return this._vertexAttributeLocations}},{key:"isVisible",value:function(){return this._visible}},{key:"parametersChanged",value:function(){Object(c.k)(this.materialRepository)&&this.materialRepository.materialChanged(this)}}]),n}(s.a);function d(e,t){return e.isVisible()&&e.isVisibleInPass(t.pass)&&0!=(e.renderOccluded&t.renderOccludedMask)}var h={renderOccluded:1}},641:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),i=n(3),a=n(7),o=n(386),c=function(){function e(t){var n=this;Object(r.a)(this,e),this.allocator=t,this.items=[],this.itemsPtr=0,this.tickHandle=o.a.before((function(){return n.reset()})),this.grow()}return Object(i.a)(e,[{key:"destroy",value:function(){this.tickHandle&&(this.tickHandle.remove(),this.tickHandle=Object(a.p)(this.tickHandle)),this.items=Object(a.p)(this.items)}},{key:"get",value:function(){return 0===this.itemsPtr&&Object(o.a)((function(){})),this.itemsPtr===this.items.length&&this.grow(),this.items[this.itemsPtr++]}},{key:"reset",value:function(){var e=Math.min(3*Math.max(8,this.itemsPtr),this.itemsPtr+3*s);this.items.length=Math.min(e,this.items.length),this.itemsPtr=0}},{key:"grow",value:function(){for(var e=0;e<Math.max(8,Math.min(this.items.length,s));e++)this.items.push(this.allocator())}}]),e}(),s=1024},642:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return f}));var r=n(100),i=n(396);function a(e,t,n){e.setUniform3f("camPos",n[3]-t[0],n[7]-t[1],n[11]-t[2])}function o(e,t){e.setUniformMatrix4fv("proj",t)}function c(e,t){e.setUniform2fv("nearFar",t)}function s(e,t,n){Object(r.t)(l,n,t),e.setUniform3fv("localOrigin",t),e.setUniformMatrix4fv("view",l)}function u(e,t){s(e,t.origin,t.camera.viewMatrix)}function f(e,t){e.setUniform4fv("viewport",t.camera.fullViewport)}var l=Object(i.a)()},643:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return u}));var r,i=n(542),a=n(715),o=n(538);function c(e){e.fragment.include(a.a),e.fragment.uniforms.add("uShadowMapTex","sampler2D"),e.fragment.uniforms.add("uShadowMapNum","int"),e.fragment.uniforms.add("uShadowMapDistance","vec4"),e.fragment.uniforms.add("uShadowMapMatrix","mat4",4),e.fragment.uniforms.add("uDepthHalfPixelSz","float"),e.fragment.code.add(Object(o.a)(r||(r=Object(i.a)(["int chooseCascade(float _linearDepth, out mat4 mat) {\nvec4 distance = uShadowMapDistance;\nfloat depth = _linearDepth;\nint i = depth < distance[1] ? 0 : depth < distance[2] ? 1 : depth < distance[3] ? 2 : 3;\nmat = i == 0 ? uShadowMapMatrix[0] : i == 1 ? uShadowMapMatrix[1] : i == 2 ? uShadowMapMatrix[2] : uShadowMapMatrix[3];\nreturn i;\n}\nvec3 lightSpacePosition(vec3 _vpos, mat4 mat) {\nvec4 lv = mat * vec4(_vpos, 1.0);\nlv.xy /= lv.w;\nreturn 0.5 * lv.xyz + vec3(0.5);\n}\nvec2 cascadeCoordinates(int i, vec3 lvpos) {\nreturn vec2(float(i - 2 * (i / 2)) * 0.5, float(i / 2) * 0.5) + 0.5 * lvpos.xy;\n}\nfloat readShadowMapDepth(vec2 uv, sampler2D _depthTex) {\nreturn rgba2float(texture2D(_depthTex, uv));\n}\nfloat posIsInShadow(vec2 uv, vec3 lvpos, sampler2D _depthTex) {\nreturn readShadowMapDepth(uv, _depthTex) < lvpos.z ? 1.0 : 0.0;\n}\nfloat filterShadow(vec2 uv, vec3 lvpos, float halfPixelSize, sampler2D _depthTex) {\nfloat texSize = 0.5 / halfPixelSize;\nvec2 st = fract((vec2(halfPixelSize) + uv) * texSize);\nfloat s00 = posIsInShadow(uv + vec2(-halfPixelSize, -halfPixelSize), lvpos, _depthTex);\nfloat s10 = posIsInShadow(uv + vec2(halfPixelSize, -halfPixelSize), lvpos, _depthTex);\nfloat s11 = posIsInShadow(uv + vec2(halfPixelSize, halfPixelSize), lvpos, _depthTex);\nfloat s01 = posIsInShadow(uv + vec2(-halfPixelSize, halfPixelSize), lvpos, _depthTex);\nreturn mix(mix(s00, s10, st.x), mix(s01, s11, st.x), st.y);\n}\nfloat readShadowMap(const in vec3 _vpos, float _linearDepth) {\nmat4 mat;\nint i = chooseCascade(_linearDepth, mat);\nif (i >= uShadowMapNum) { return 0.0; }\nvec3 lvpos = lightSpacePosition(_vpos, mat);\nif (lvpos.z >= 1.0) { return 0.0; }\nif (lvpos.x < 0.0 || lvpos.x > 1.0 || lvpos.y < 0.0 || lvpos.y > 1.0) { return 0.0; }\nvec2 uv = cascadeCoordinates(i, lvpos);\nreturn filterShadow(uv, lvpos, uDepthHalfPixelSz, uShadowMapTex);\n}"]))))}function s(e,t){t.shadowMappingEnabled&&(t.shadowMap.bind(e),t.shadowMap.bindView(e,t.origin))}function u(e,t,n){t.shadowMappingEnabled&&t.shadowMap.bindView(e,n)}function f(e,t){t.shadowMappingEnabled&&t.shadowMap.bindView(e,t.origin)}},647:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(13),i=n(2),a=n(3),o=n(598),c=n(779),s=function(){function e(t,n){Object(i.a)(this,e),this.layout=t,this.buffer="number"==typeof n?new ArrayBuffer(n*t.stride):n;var a,o=Object(r.a)(t.fieldNames);try{for(o.s();!(a=o.n()).done;){var c=a.value,s=t.fields.get(c);this[c]=new s.constructor(this.buffer,s.offset,this.stride)}}catch(u){o.e(u)}finally{o.f()}}return Object(a.a)(e,[{key:"stride",get:function(){return this.layout.stride}},{key:"count",get:function(){return this.buffer.byteLength/this.stride}},{key:"byteLength",get:function(){return this.buffer.byteLength}},{key:"getField",value:function(e,t){var n=this[e];return n&&n.elementCount===t.ElementCount&&n.elementType===t.ElementType?n:null}},{key:"slice",value:function(t,n){return new e(this.layout,this.buffer.slice(t*this.stride,n*this.stride))}},{key:"copyFrom",value:function(e,t,n,r){var i=this.stride;if(i%4==0){var a=new Uint32Array(e.buffer,t*i,r*i/4);new Uint32Array(this.buffer,n*i,r*i/4).set(a)}else{var o=new Uint8Array(e.buffer,t*i,r*i);new Uint8Array(this.buffer,n*i,r*i).set(o)}}}]),e}(),u=function(){function e(){Object(i.a)(this,e),this.stride=0,this.fields=new Map,this.fieldNames=[]}return Object(a.a)(e,[{key:"vec2f",value:function(e,t){return this.appendField(e,o.m,t),this}},{key:"vec2f64",value:function(e,t){return this.appendField(e,o.n,t),this}},{key:"vec3f",value:function(e,t){return this.appendField(e,o.u,t),this}},{key:"vec3f64",value:function(e,t){return this.appendField(e,o.v,t),this}},{key:"vec4f",value:function(e,t){return this.appendField(e,o.C,t),this}},{key:"vec4f64",value:function(e,t){return this.appendField(e,o.D,t),this}},{key:"mat3f",value:function(e,t){return this.appendField(e,o.f,t),this}},{key:"mat3f64",value:function(e,t){return this.appendField(e,o.g,t),this}},{key:"mat4f",value:function(e,t){return this.appendField(e,o.h,t),this}},{key:"mat4f64",value:function(e,t){return this.appendField(e,o.i,t),this}},{key:"vec4u8",value:function(e,t){return this.appendField(e,o.J,t),this}},{key:"f32",value:function(e,t){return this.appendField(e,o.a,t),this}},{key:"f64",value:function(e,t){return this.appendField(e,o.b,t),this}},{key:"u8",value:function(e,t){return this.appendField(e,o.l,t),this}},{key:"u16",value:function(e,t){return this.appendField(e,o.j,t),this}},{key:"i8",value:function(e,t){return this.appendField(e,o.e,t),this}},{key:"vec2i8",value:function(e,t){return this.appendField(e,o.q,t),this}},{key:"vec2i16",value:function(e,t){return this.appendField(e,o.o,t),this}},{key:"vec2u8",value:function(e,t){return this.appendField(e,o.t,t),this}},{key:"vec4u16",value:function(e,t){return this.appendField(e,o.H,t),this}},{key:"u32",value:function(e,t){return this.appendField(e,o.k,t),this}},{key:"appendField",value:function(e,t,n){var r=t.ElementCount*Object(c.a)(t.ElementType),i=this.stride;this.fields.set(e,{size:r,constructor:t,offset:i,optional:n}),this.stride+=r,this.fieldNames.push(e)}},{key:"alignTo",value:function(e){return this.stride=Math.floor((this.stride+e-1)/e)*e,this}},{key:"hasField",value:function(e){return this.fieldNames.indexOf(e)>=0}},{key:"createBuffer",value:function(e){return new s(this,e)}},{key:"createView",value:function(e){return new s(this,e)}},{key:"clone",value:function(){var t=new e;return t.stride=this.stride,t.fields=new Map,this.fields.forEach((function(e,n){return t.fields.set(n,e)})),t.fieldNames=this.fieldNames.slice(),t.BufferType=this.BufferType,t}}]),e}();function f(){return new u}},654:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return u}));var r=n(7),i=n(100),a=n(547),o=n(817),c=n(567);function s(e,t){return Object(r.j)(e)&&(e=[]),e.push(t),e}function u(e,t){if(Object(r.j)(e))return e;var n=e.filter((function(e){return e!==t}));return 0===n.length?null:n}function f(e){return!!Object(r.k)(e)&&!e.visible}function l(e,t){var n=new Map;return n.set(0,t.acquire(e,0)),n.set(1,t.acquire(e,7)),n.set(4,t.acquire(e,3)),n.set(3,t.acquire(e,2)),n.set(2,t.acquire(e,1)),n.set(5,t.acquire(e,4)),n.set(7,t.acquire(e,3)),n.set(6,t.acquire(e,3)),n}function d(e,t){t.release(e,0),t.release(e,7),t.release(e,3),t.release(e,2),t.release(e,1),t.release(e,4)}function h(e,t,n){var a=e.origin.vec3;Object(c.j)(m,-a[0],-a[1],-a[2]),Object(r.k)(e.transformation)?Object(i.n)(t,m,e.transformation):Object(i.f)(t,m),n&&(Object(i.c)(n,t),Object(i.b)(n,n))}function v(e,t,n,r,i){p[0]=e.get(t,0),p[1]=e.get(t,1),p[2]=e.get(t,2),Object(o.a)(p,b,3),n.set(i,0,b[0]),r.set(i,0,b[1]),n.set(i,1,b[2]),r.set(i,1,b[3]),n.set(i,2,b[4]),r.set(i,2,b[5])}var p=new Float64Array(3),b=new Float32Array(6),m=Object(a.d)()},655:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return v}));var r,i,a,o,c,s,u,f=n(542),l=n(538);function d(e,t){t.vvInstancingEnabled&&(t.vvSize||t.vvColor)&&e.attributes.add("instanceFeatureAttribute","vec4"),t.vvSize?(e.vertex.uniforms.add("vvSizeMinSize","vec3"),e.vertex.uniforms.add("vvSizeMaxSize","vec3"),e.vertex.uniforms.add("vvSizeOffset","vec3"),e.vertex.uniforms.add("vvSizeFactor","vec3"),e.vertex.uniforms.add("vvSymbolRotationMatrix","mat3"),e.vertex.uniforms.add("vvSymbolAnchor","vec3"),e.vertex.code.add(Object(l.a)(r||(r=Object(f.a)(["vec3 vvScale(vec4 _featureAttribute) {\nreturn clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize, vvSizeMaxSize);\n}\nvec4 vvTransformPosition(vec3 position, vec4 _featureAttribute) {\nreturn vec4(vvSymbolRotationMatrix * ( vvScale(_featureAttribute) * (position + vvSymbolAnchor)), 1.0);\n}"])))),e.vertex.code.add(Object(l.a)(i||(i=Object(f.a)(["\n      const float eps = 1.192092896e-07;\n      vec4 vvTransformNormal(vec3 _normal, vec4 _featureAttribute) {\n        vec3 vvScale = clamp(vvSizeOffset + _featureAttribute.x * vvSizeFactor, vvSizeMinSize + eps, vvSizeMaxSize);\n        return vec4(vvSymbolRotationMatrix * _normal / vvScale, 1.0);\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?Object(l.a)(a||(a=Object(f.a)(["\n      vec4 vvLocalNormal(vec3 _normal) {\n        return vvTransformNormal(_normal, instanceFeatureAttribute);\n      }\n\n      vec4 localPosition() {\n        return vvTransformPosition(position, instanceFeatureAttribute);\n      }"]))):""))):e.vertex.code.add(Object(l.a)(o||(o=Object(f.a)(["vec4 localPosition() { return vec4(position, 1.0); }\nvec4 vvLocalNormal(vec3 _normal) { return vec4(_normal, 1.0); }"])))),t.vvColor?(e.vertex.constants.add("vvColorNumber","int",8),e.vertex.code.add(Object(l.a)(c||(c=Object(f.a)(["\n      uniform float vvColorValues[vvColorNumber];\n      uniform vec4 vvColorColors[vvColorNumber];\n\n      vec4 vvGetColor(vec4 featureAttribute, float values[vvColorNumber], vec4 colors[vvColorNumber]) {\n        float value = featureAttribute.y;\n        if (value <= values[0]) {\n          return colors[0];\n        }\n\n        for (int i = 1; i < vvColorNumber; ++i) {\n          if (values[i] >= value) {\n            float f = (value - values[i-1]) / (values[i] - values[i-1]);\n            return mix(colors[i-1], colors[i], f);\n          }\n        }\n        return colors[vvColorNumber - 1];\n      }\n\n      ","\n    "])),t.vvInstancingEnabled?Object(l.a)(s||(s=Object(f.a)(["\n      vec4 vvColor() {\n        return vvGetColor(instanceFeatureAttribute, vvColorValues, vvColorColors);\n      }"]))):""))):e.vertex.code.add(Object(l.a)(u||(u=Object(f.a)(["vec4 vvColor() { return vec4(1.0); }"]))))}function h(e,t){t.vvSizeEnabled&&(e.setUniform3fv("vvSizeMinSize",t.vvSizeMinSize),e.setUniform3fv("vvSizeMaxSize",t.vvSizeMaxSize),e.setUniform3fv("vvSizeOffset",t.vvSizeOffset),e.setUniform3fv("vvSizeFactor",t.vvSizeFactor)),t.vvColorEnabled&&(e.setUniform1fv("vvColorValues",t.vvColorValues),e.setUniform4fv("vvColorColors",t.vvColorColors))}function v(e,t){h(e,t),t.vvOpacityEnabled&&(e.setUniform1fv("vvOpacityValues",t.vvOpacityValues),e.setUniform1fv("vvOpacityOpacities",t.vvOpacityOpacities))}function p(e,t){h(e,t),t.vvSizeEnabled&&(e.setUniform3fv("vvSymbolAnchor",t.vvSymbolAnchor),e.setUniformMatrix3fv("vvSymbolRotationMatrix",t.vvSymbolRotationMatrix))}},661:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return h}));var r=n(58),i=n(79),a=n(641),o=(n(30),n(663));n(570);new a.a(o.d),new a.a((function(){return{p0:null,p1:null,p2:null}}));var c=Object(i.e)(),s=Object(i.e)(),u=function(){for(var e=new Uint32Array(131072),t=0;t<e.length;++t)e[t]=t;return e}(),f=new Uint16Array([0]),l=function(){for(var e=new Uint16Array(65536),t=0;t<e.length;++t)e[t]=t;return e}();function d(e){if(1===e)return f;if(e<l.length)return new Uint16Array(l.buffer,0,e);if(e>u.length){var t=Math.max(2*u.length,e);u=new Uint32Array(t);for(var n=0;n<u.length;n++)u[n]=n}return new Uint32Array(u.buffer,0,e)}function h(e){if(1===e)return new Uint16Array(f);if(e<l.length)return new Uint16Array(l.slice(0,e));if(e>u.length){for(var t=new Uint32Array(e),n=0;n<t.length;n++)t[n]=n;return t}return new Uint32Array(u.slice(0,e))}function v(e,t,n){if(!e)return!1;var i=e.size,a=e.data;Object(r.w)(n,0,0,0),Object(r.w)(j,0,0,0);for(var o,u,f,l=0,d=0,h=0;h<t.length-2;h+=3){var v=t[h+0]*i,p=t[h+1]*i,b=t[h+2]*i;Object(r.w)(m,a[v+0],a[v+1],a[v+2]),Object(r.w)(g,a[p+0],a[p+1],a[p+2]),Object(r.w)(O,a[b+0],a[b+1],a[b+2]);var x=(o=m,u=g,f=O,Object(r.j)(c,u,o),Object(r.j)(s,f,o),Object(r.p)(Object(r.g)(c,c,s))/2);x?(Object(r.f)(m,m,g),Object(r.f)(m,m,O),Object(r.e)(m,m,1/3*x),Object(r.f)(n,n,m),l+=x):(Object(r.f)(j,j,m),Object(r.f)(j,j,g),Object(r.f)(j,j,O),d+=3)}return(0!==d||0!==l)&&(0!==l?(Object(r.e)(n,n,1/l),!0):0!==d&&(Object(r.e)(n,j,1/d),!0))}function p(e,t,n){if(!e||!t)return!1;var i=e.size,a=e.data;Object(r.w)(n,0,0,0);for(var o=-1,c=0,s=0;s<t.length;s++){var u=t[s]*i;o!==u&&(n[0]+=a[u+0],n[1]+=a[u+1],n[2]+=a[u+2],c++),o=u}return c>1&&Object(r.e)(n,n,1/c),c>0}function b(e,t,n,i){if(!e)return!1;var a=e.size,o=e.data;Object(r.w)(i,0,0,0),Object(r.w)(j,0,0,0);for(var c=0,s=0,u=t?t.length-1:o.length/a-1,f=u+(n?2:0),l=0;l<f;l+=2){var d=l<u?l:u,h=l<u?l+1:0,v=(t?t[d]:d)*a,p=(t?t[h]:h)*a;m[0]=o[v+0],m[1]=o[v+1],m[2]=o[v+2],g[0]=o[p+0],g[1]=o[p+1],g[2]=o[p+2],Object(r.e)(m,Object(r.f)(m,m,g),.5);var b=Object(r.n)(m,g);b>0?(Object(r.f)(i,i,Object(r.e)(m,m,b)),c+=b):(Object(r.f)(j,j,m),s++)}return 0!==c?(Object(r.e)(i,i,1/c),!0):0!==s&&(Object(r.e)(i,j,1/s),!0)}var m=Object(i.e)(),g=Object(i.e)(),O=Object(i.e)(),j=Object(i.e)()},662:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(10),i=n(23),a=n(13),o=n(2),c=n(3),s=n(5),u=n(6),f=n(7),l=n(212),d=n(58),h=n(79),v=n(567),p=function(){function e(t,n,r,i){Object(o.a)(this,e),this.primitiveIndices=t,this._numIndexPerPrimitive=n,this.indices=r,this.position=i,this.center=Object(h.e)(),Object(v.a)(t.length>=1),Object(v.a)(r.length%this._numIndexPerPrimitive==0),Object(v.a)(r.length>=t.length*this._numIndexPerPrimitive),Object(v.a)(3===i.size||4===i.size);var a=i.data,c=i.size,s=t.length,u=c*r[this._numIndexPerPrimitive*t[0]];b.clear(),b.push(u),this.bbMin=Object(h.g)(a[u],a[u+1],a[u+2]),this.bbMax=Object(h.c)(this.bbMin);for(var f=0;f<s;++f)for(var l=this._numIndexPerPrimitive*t[f],p=0;p<this._numIndexPerPrimitive;++p){u=c*r[l+p],b.push(u);var m=a[u];this.bbMin[0]=Math.min(m,this.bbMin[0]),this.bbMax[0]=Math.max(m,this.bbMax[0]),m=a[u+1],this.bbMin[1]=Math.min(m,this.bbMin[1]),this.bbMax[1]=Math.max(m,this.bbMax[1]),m=a[u+2],this.bbMin[2]=Math.min(m,this.bbMin[2]),this.bbMax[2]=Math.max(m,this.bbMax[2])}Object(d.i)(this.center,this.bbMin,this.bbMax,.5),this.radius=.5*Math.max(Math.max(this.bbMax[0]-this.bbMin[0],this.bbMax[1]-this.bbMin[1]),this.bbMax[2]-this.bbMin[2]);for(var g=this.radius*this.radius,O=0;O<b.length;++O){var j=a[u=b.getItemAt(O)]-this.center[0],x=a[u+1]-this.center[1],y=a[u+2]-this.center[2],_=j*j+x*x+y*y;if(!(_<=g)){var w=Math.sqrt(_),T=.5*(w-this.radius);this.radius=this.radius+T,g=this.radius*this.radius;var M=T/w;this.center[0]+=j*M,this.center[1]+=x*M,this.center[2]+=y*M}}b.clear()}return Object(c.a)(e,[{key:"getCenter",value:function(){return this.center}},{key:"getBSRadius",value:function(){return this.radius}},{key:"getBBMin",value:function(){return this.bbMin}},{key:"getBBMax",value:function(){return this.bbMax}},{key:"getChildren",value:function(){if(this._children)return this._children;if(Object(d.l)(this.bbMin,this.bbMax)>1){for(var t=Object(d.i)(Object(h.e)(),this.bbMin,this.bbMax,.5),n=this.primitiveIndices.length,r=new Uint8Array(n),i=new Array(8),a=0;a<8;++a)i[a]=0;for(var o=this.position,c=o.data,s=o.size,u=0;u<n;++u){for(var f=0,l=this._numIndexPerPrimitive*this.primitiveIndices[u],v=s*this.indices[l],p=c[v],b=c[v+1],m=c[v+2],g=1;g<this._numIndexPerPrimitive;++g){var O=c[v=s*this.indices[l+g]],j=c[v+1],x=c[v+2];O<p&&(p=O),j<b&&(b=j),x<m&&(m=x)}p<t[0]&&(f|=1),b<t[1]&&(f|=2),m<t[2]&&(f|=4),r[u]=f,++i[f]}for(var y=0,_=0;_<8;++_)i[_]>0&&++y;if(y<2)return;for(var w=new Array(8),T=0;T<8;++T)w[T]=i[T]>0?new Uint32Array(i[T]):void 0;for(var M=0;M<8;++M)i[M]=0;for(var S=0;S<n;++S){var k=r[S];w[k][i[k]++]=this.primitiveIndices[S]}this._children=new Array(8);for(var P=0;P<8;++P)void 0!==w[P]&&(this._children[P]=new e(w[P],this._numIndexPerPrimitive,this.indices,this.position))}return this._children}}],[{key:"prune",value:function(){b.prune()}}]),e}(),b=new l.a({deallocator:null}),m=n(745),g=n(661),O=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var c,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,f=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;Object(o.a)(this,n),(c=t.call(this))._primitiveType=u,c.edgeIndicesLength=f,c.type=2,c._vertexAttributes=new Map,c._indices=new Map,c._boundingInfo=null;var l,d=Object(a.a)(e);try{for(d.s();!(l=d.n()).done;){var h=Object(i.a)(l.value,2),v=h[0],p=h[1];p&&c._vertexAttributes.set(v,Object(r.a)({},p))}}catch(P){d.e(P)}finally{d.f()}if(null==s||0===s.length){var b=j(c._vertexAttributes),m=Object(g.d)(b);c.edgeIndicesLength=c.edgeIndicesLength<0?b:c.edgeIndicesLength;var O,y=Object(a.a)(c._vertexAttributes.keys());try{for(y.s();!(O=y.n()).done;){var _=O.value;c._indices.set(_,m)}}catch(P){y.e(P)}finally{y.f()}}else{var w,T=Object(a.a)(s);try{for(T.s();!(w=T.n()).done;){var M=Object(i.a)(w.value,2),S=M[0],k=M[1];k&&(c._indices.set(S,x(k)),"position"===S&&(c.edgeIndicesLength=c.edgeIndicesLength<0?c._indices.get(S).length:c.edgeIndicesLength))}}catch(P){T.e(P)}finally{T.f()}}return c}return Object(c.a)(n,[{key:"vertexAttributes",get:function(){return this._vertexAttributes}},{key:"getMutableAttribute",value:function(e){var t=this._vertexAttributes.get(e);return t&&!t.exclusive&&(t.data=Array.from(t.data),t.exclusive=!0),t}},{key:"indices",get:function(){return this._indices}},{key:"indexCount",get:function(){var e=this._indices.values().next().value;return e?e.length:0}},{key:"primitiveType",get:function(){return this._primitiveType}},{key:"faceCount",get:function(){return this.indexCount/3}},{key:"boundingInfo",get:function(){return Object(f.j)(this._boundingInfo)&&(this._boundingInfo=this._calculateBoundingInfo()),this._boundingInfo}},{key:"computeAttachmentOrigin",value:function(e){return 0===this.primitiveType?this.computeAttachmentOriginTriangles(e):this.computeAttachmentOriginPoints(e)}},{key:"computeAttachmentOriginTriangles",value:function(e){var t=this.indices.get("position"),n=this.vertexAttributes.get("position");return Object(g.c)(n,t,e)}},{key:"computeAttachmentOriginPoints",value:function(e){var t=this.indices.get("position"),n=this.vertexAttributes.get("position");return Object(g.b)(n,t,e)}},{key:"invalidateBoundingInfo",value:function(){this._boundingInfo=null}},{key:"_calculateBoundingInfo",value:function(){var e=this.indices.get("position");if(0===e.length)return null;var t=0===this.primitiveType?3:1;Object(v.a)(e.length%t==0,"Indexing error: "+e.length+" not divisible by "+t);var n=Object(g.d)(e.length/t),r=this.vertexAttributes.get("position");return new p(n,t,e,r)}}]),n}(m.a);function j(e){var t=e.values().next().value;return null==t?0:t.data.length/t.size}function x(e){if(e.BYTES_PER_ELEMENT===Uint16Array.BYTES_PER_ELEMENT)return e;var t,n=Object(a.a)(e);try{for(n.s();!(t=n.n()).done;){if(t.value>=65536)return e}}catch(r){n.e(r)}finally{n.f()}return new Uint16Array(e)}},663:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return v}));var r=n(65),i=n(641),a=n(58),o=n(79),c=n(570);function s(e){return e?{origin:Object(o.c)(e.origin),vector:Object(o.c)(e.vector)}:{origin:Object(o.e)(),vector:Object(o.e)()}}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s();return f(e.origin,e.vector,t)}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return Object(a.k)(n.origin,e),Object(a.k)(n.vector,t),n}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();return Object(a.k)(n.origin,e),Object(a.j)(n.vector,t,e),n}function d(e,t){var n=Object(a.j)(c.d.get(),t,e.origin),i=Object(a.h)(e.vector,n),o=Object(a.h)(e.vector,e.vector),s=Object(r.d)(i/o,0,1),u=Object(a.j)(c.d.get(),Object(a.e)(c.d.get(),e.vector,s),n);return Object(a.h)(u,u)}function h(e,t,n){return Object(a.f)(n,e.origin,Object(a.e)(n,e.vector,t))}function v(e,t,n,i,o){var s=e.vector,u=e.origin,f=Object(a.j)(c.d.get(),t,u),l=Object(a.h)(s,f)/Object(a.t)(s);return Object(a.e)(o,s,Object(r.d)(l,n,i)),Object(a.f)(o,o,e.origin)}function p(e,t){if(m(e,function(e,t){var n=O.get();return n.origin=e,n.vector=t,n}(t.origin,t.direction),!1,g)){var n=g.tA,r=g.pB,i=g.distance2;if(n>=0&&n<=1)return i;if(n<0)return Object(a.l)(e.origin,r);if(n>1)return Object(a.l)(Object(a.f)(c.d.get(),e.origin,e.vector),r)}return null}function b(e,t,n){return!!m(e,t,!0,g)&&(Object(a.k)(n,g.pA),!0)}function m(e,t,n,i){var o=1e-6,s=e.origin,u=Object(a.f)(c.d.get(),s,e.vector),f=t.origin,l=Object(a.f)(c.d.get(),f,t.vector),d=c.d.get(),h=c.d.get();if(d[0]=s[0]-f[0],d[1]=s[1]-f[1],d[2]=s[2]-f[2],h[0]=l[0]-f[0],h[1]=l[1]-f[1],h[2]=l[2]-f[2],Math.abs(h[0])<o&&Math.abs(h[1])<o&&Math.abs(h[2])<o)return!1;var v=c.d.get();if(v[0]=u[0]-s[0],v[1]=u[1]-s[1],v[2]=u[2]-s[2],Math.abs(v[0])<o&&Math.abs(v[1])<o&&Math.abs(v[2])<o)return!1;var p=d[0]*h[0]+d[1]*h[1]+d[2]*h[2],b=h[0]*v[0]+h[1]*v[1]+h[2]*v[2],m=d[0]*v[0]+d[1]*v[1]+d[2]*v[2],g=h[0]*h[0]+h[1]*h[1]+h[2]*h[2],O=(v[0]*v[0]+v[1]*v[1]+v[2]*v[2])*g-b*b;if(Math.abs(O)<o)return!1;var j=(p*b-m*g)/O,x=(p+b*j)/g;n&&(j=Object(r.d)(j,0,1),x=Object(r.d)(x,0,1));var y=c.d.get(),_=c.d.get();return y[0]=s[0]+j*v[0],y[1]=s[1]+j*v[1],y[2]=s[2]+j*v[2],_[0]=f[0]+x*h[0],_[1]=f[1]+x*h[1],_[2]=f[2]+x*h[2],i.tA=j,i.tB=x,i.pA=y,i.pB=_,i.distance2=Object(a.l)(y,_),!0}var g={tA:0,tB:0,pA:Object(o.e)(),pB:Object(o.e)(),distance2:0},O=new i.a((function(){return{origin:null,vector:null}}))},668:function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return P})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return I})),n.d(t,"h",(function(){return u}));var r=n(563),i=n(611),a=n(79),o=n(46),c=n(58),s=n(407);function u(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function f(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>o.a?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function l(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],c=n[0],s=n[1],u=n[2],f=n[3];return e[0]=r*f+o*c+i*u-a*s,e[1]=i*f+o*s+a*c-r*u,e[2]=a*f+o*u+r*s-i*c,e[3]=o*f-r*c-i*s-a*u,e}function d(e,t,n,r){var i,a,c,s,u,f=t[0],l=t[1],d=t[2],h=t[3],v=n[0],p=n[1],b=n[2],m=n[3];return(a=f*v+l*p+d*b+h*m)<0&&(a=-a,v=-v,p=-p,b=-b,m=-m),1-a>o.a?(i=Math.acos(a),c=Math.sin(i),s=Math.sin((1-r)*i)/c,u=Math.sin(r*i)/c):(s=1-r,u=r),e[0]=s*f+u*v,e[1]=s*l+u*p,e[2]=s*d+u*b,e[3]=s*h+u*m,e}function h(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=n*n+r*r+i*i+a*a,c=o?1/o:0;return e[0]=-n*c,e[1]=-r*c,e[2]=-i*c,e[3]=a*c,e}function v(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function p(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}function b(e,t,n,r){var i=.5*Math.PI/180;t*=i,n*=i,r*=i;var a=Math.sin(t),o=Math.cos(t),c=Math.sin(n),s=Math.cos(n),u=Math.sin(r),f=Math.cos(r);return e[0]=a*s*f-o*c*u,e[1]=o*c*f+a*s*u,e[2]=o*s*u-a*c*f,e[3]=o*s*f+a*c*u,e}var m=s.c,g=s.l,O=s.a,j=l,x=s.b,y=s.d,_=s.j,w=s.e,T=w,M=s.f,S=M,k=s.k,P=s.g,A=s.h;function I(e,t,n){var r=Object(c.h)(t,n);return r<-.999999?(Object(c.g)(F,z,t),Object(c.y)(F)<1e-6&&Object(c.g)(F,D,t),Object(c.r)(F,F),u(e,F,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Object(c.g)(F,t,n),e[0]=F[0],e[1]=F[1],e[2]=F[2],e[3]=1+r,k(e,e))}var F=Object(a.e)(),z=Object(a.g)(1,0,0),D=Object(a.g)(0,1,0);var C=Object(i.b)(),E=Object(i.b)();var L=Object(r.b)();Object.freeze({__proto__:null,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},setAxisAngle:u,getAxisAngle:f,multiply:l,rotateX:function(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],c=Math.sin(n),s=Math.cos(n);return e[0]=r*s+o*c,e[1]=i*s+a*c,e[2]=a*s-i*c,e[3]=o*s-r*c,e},rotateY:function(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],c=Math.sin(n),s=Math.cos(n);return e[0]=r*s-a*c,e[1]=i*s+o*c,e[2]=a*s+r*c,e[3]=o*s-i*c,e},rotateZ:function(e,t,n){n*=.5;var r=t[0],i=t[1],a=t[2],o=t[3],c=Math.sin(n),s=Math.cos(n);return e[0]=r*s+i*c,e[1]=i*s-r*c,e[2]=a*s+o*c,e[3]=o*s-a*c,e},calculateW:function(e,t){var n=t[0],r=t[1],i=t[2];return e[0]=n,e[1]=r,e[2]=i,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),e},slerp:d,random:function(e){var t=Object(o.b)(),n=Object(o.b)(),r=Object(o.b)(),i=Math.sqrt(1-t),a=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*n),e[1]=i*Math.cos(2*Math.PI*n),e[2]=a*Math.sin(2*Math.PI*r),e[3]=a*Math.cos(2*Math.PI*r),e},invert:h,conjugate:v,fromMat3:p,fromEuler:b,str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},copy:m,set:g,add:O,mul:j,scale:x,dot:y,lerp:_,length:w,len:T,squaredLength:M,sqrLen:S,normalize:k,exactEquals:P,equals:A,rotationTo:I,sqlerp:function(e,t,n,r,i,a){return d(C,t,i,a),d(E,n,r,a),d(e,C,E,2*a*(1-a)),e},setAxes:function(e,t,n,r){var i=L;return i[0]=n[0],i[3]=n[1],i[6]=n[2],i[1]=r[0],i[4]=r[1],i[7]=r[2],i[2]=-t[0],i[5]=-t[1],i[8]=-t[2],k(e,p(e,i))}})},678:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"f",(function(){return m}));n(12);var r=n(11),i=n(65),a=n(7),o=n(100),c=n(58),s=n(79),u=n(407),f=n(558),l=n(579),d=n(679),h=n(570),v=r.a.getLogger("esri.geometry.support.sphere");function p(){return Object(f.e)()}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p();return Object(u.c)(t,e)}function m(e){return e}function g(e){e[0]=e[1]=e[2]=e[3]=0}function O(e){return Array.isArray(e)?e[3]:e}function j(e){return Array.isArray(e)?e:P}function x(e,t,n){if(Object(a.j)(t))return!1;var r=Object(c.j)(h.d.get(),t.origin,j(e)),i=Object(c.h)(t.direction,t.direction),o=2*Object(c.h)(t.direction,r),s=o*o-4*i*(Object(c.h)(r,r)-e[3]*e[3]);if(s<0)return!1;var u=Math.sqrt(s),f=(-o-u)/(2*i),l=(-o+u)/(2*i);return(f<0||l<f&&l>0)&&(f=l),!(f<0)&&(n&&Object(c.f)(n,t.origin,Object(c.e)(h.d.get(),t.direction,f)),!0)}function y(e,t){return x(e,t,null)}function _(e,t,n){var r=h.d.get(),i=h.a.get();Object(c.g)(r,t.origin,t.direction);var a=O(e);Object(c.g)(n,r,t.origin),Object(c.e)(n,n,1/Object(c.p)(n)*a);var s=T(e,t.origin),u=Object(d.a)(t.origin,n);return Object(o.j)(i),Object(o.e)(i,i,u+s,r),Object(c.q)(n,n,i),n}function w(e,t,n){var r=Object(c.j)(h.d.get(),t,j(e)),i=Object(c.e)(h.d.get(),r,e[3]/Object(c.p)(r));return Object(c.f)(n,i,j(e))}function T(e,t){var n=Object(c.j)(h.d.get(),t,j(e)),r=Object(c.p)(n),a=O(e),o=a+Math.abs(a-r);return Object(i.a)(a/o)}var M=Object(s.e)();function S(e,t,n,r){var a=Object(c.j)(M,t,j(e));switch(n){case 0:var o=Object(i.c)(a,M)[2];return Object(c.w)(r,-Math.sin(o),Math.cos(o),0);case 1:var s=Object(i.c)(a,M),u=s[1],f=s[2],l=Math.sin(u);return Object(c.w)(r,-l*Math.cos(f),-l*Math.sin(f),Math.cos(u));case 2:return Object(c.r)(r,a);default:return}}function k(e,t){var n=Object(c.j)(A,t,j(e));return Object(c.p)(n)-e[3]}var P=Object(s.e)(),A=Object(s.e)();Object.freeze({__proto__:null,create:p,copy:b,fromCenterAndRadius:function(e,t){return Object(f.g)(e[0],e[1],e[2],t)},wrap:m,clear:g,fromRadius:function(e){return e},getRadius:O,getCenter:j,fromValues:function(e,t,n,r){return Object(f.g)(e,t,n,r)},elevate:function(e,t,n){return e!==n&&Object(c.k)(n,e),n[3]=e[3]+t,n},setExtent:function(e,t,n){return v.error("sphere.setExtent is not yet supported"),e===n?n:b(e,n)},intersectRay:x,intersectsRay:y,intersectRayClosestSilhouette:function(e,t,n){if(x(e,t,n))return n;var r=_(e,t,h.d.get());return Object(c.f)(n,t.origin,Object(c.e)(h.d.get(),t.direction,Object(c.m)(t.origin,r)/Object(c.p)(t.direction))),n},closestPointOnSilhouette:_,closestPoint:function(e,t,n){return x(e,t,n)?n:(Object(l.a)(t,j(e),n),w(e,n,n))},projectPoint:w,distanceToSilhouette:function(e,t){var n=Object(c.j)(h.d.get(),t,j(e)),r=Object(c.t)(n),i=e[3]*e[3];return Math.sqrt(Math.abs(r-i))},angleToSilhouette:T,axisAt:S,altitudeAt:k,setAltitudeAt:function(e,t,n,r){var i=k(e,t),a=S(e,t,2,A),o=Object(c.e)(A,a,n-i);return Object(c.f)(r,t,o)}})},679:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return c}));var r=n(65),i=n(58),a=n(79);function o(e,t,n){var r=Object(i.h)(e,t)/Object(i.h)(e,e);return Object(i.e)(n,e,r)}function c(e,t){return Object(i.h)(e,t)/Object(i.p)(e)}function s(e,t){var n=Object(i.h)(e,t)/(Object(i.p)(e)*Object(i.p)(t));return-Object(r.a)(n)}function u(e,t,n){Object(i.r)(f,e),Object(i.r)(l,t);var a=Object(i.h)(f,l),o=Object(r.a)(a),c=Object(i.g)(f,f,l);return Object(i.h)(c,n)<0?2*Math.PI-o:o}var f=Object(a.e)(),l=Object(a.e)()},681:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2),i=n(3),a=n(5),o=n(6),c=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(e){var i;return Object(r.a)(this,n),(i=t.call(this))._material=e.material,i._techniqueRep=e.techniqueRep,i._output=e.output,i}return Object(i.a)(n,[{key:"technique",get:function(){return this._technique}},{key:"getPipelineState",value:function(e,t){return this.technique.pipeline}},{key:"ensureResources",value:function(e){return 2}},{key:"ensureParameters",value:function(e){}}]),n}(n(866).a)},682:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,i,a,o=n(542),c=n(538);function s(e,t){t.attributeColor?(e.attributes.add("color","vec4"),e.varyings.add("vColor","vec4"),e.vertex.code.add(Object(c.a)(r||(r=Object(o.a)(["void forwardVertexColor() { vColor = color; }"])))),e.vertex.code.add(Object(c.a)(i||(i=Object(o.a)(["void forwardNormalizedVertexColor() { vColor = color * 0.003921568627451; }"]))))):e.vertex.code.add(Object(c.a)(a||(a=Object(o.a)(["void forwardVertexColor() {}\nvoid forwardNormalizedVertexColor() {}"]))))}},695:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,i,a=n(542),o=n(715),c=n(538);function s(e,t){e.fragment.include(o.a),3===t.output?(e.extensions.add("GL_OES_standard_derivatives"),e.fragment.code.add(Object(c.a)(r||(r=Object(a.a)(["float _calculateFragDepth(const in float depth) {\nconst float SLOPE_SCALE = 2.0;\nconst float BIAS = 2.0 * .000015259;\nfloat m = max(abs(dFdx(depth)), abs(dFdy(depth)));\nfloat result = depth + SLOPE_SCALE * m + BIAS;\nreturn clamp(result, .0, .999999);\n}\nvoid outputDepth(float _linearDepth) {\ngl_FragColor = float2rgba(_calculateFragDepth(_linearDepth));\n}"]))))):1===t.output&&e.fragment.code.add(Object(c.a)(i||(i=Object(a.a)(["void outputDepth(float _linearDepth) {\ngl_FragColor = float2rgba(_linearDepth);\n}"]))))}},696:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return f}));var r=n(13),i=n(100),a=n(598),o=n(567);function c(e,t,n,r){var i=n.typedBuffer,a=n.typedBufferStride,o=e.length;r*=a;for(var c=0;c<o;++c){var s=2*e[c];i[r]=t[s],i[r+1]=t[s+1],r+=a}}function s(e,t,n,r,i){var a=n.typedBuffer,o=n.typedBufferStride,c=e.length;if(r*=o,null==i||1===i)for(var s=0;s<c;++s){var u=3*e[s];a[r]=t[u],a[r+1]=t[u+1],a[r+2]=t[u+2],r+=o}else for(var f=0;f<c;++f)for(var l=3*e[f],d=0;d<i;++d)a[r]=t[l],a[r+1]=t[l+1],a[r+2]=t[l+2],r+=o}function u(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=n.typedBuffer,o=n.typedBufferStride,c=e.length;if(r*=o,1===i)for(var s=0;s<c;++s){var u=4*e[s];a[r]=t[u],a[r+1]=t[u+1],a[r+2]=t[u+2],a[r+3]=t[u+3],r+=o}else for(var f=0;f<c;++f)for(var l=4*e[f],d=0;d<i;++d)a[r]=t[l],a[r+1]=t[l+1],a[r+2]=t[l+2],a[r+3]=t[l+3],r+=o}function f(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;if(n){var o=r.typedBuffer,c=r.typedBufferStride,u=e.length,f=n[0],l=n[1],d=n[2],h=n[4],v=n[5],p=n[6],b=n[8],m=n[9],g=n[10],O=n[12],j=n[13],x=n[14];if(i*=c,1===a)for(var y=0;y<u;++y){var _=3*e[y],w=t[_],T=t[_+1],M=t[_+2];o[i]=f*w+h*T+b*M+O,o[i+1]=l*w+v*T+m*M+j,o[i+2]=d*w+p*T+g*M+x,i+=c}else for(var S=0;S<u;++S)for(var k=3*e[S],P=t[k],A=t[k+1],I=t[k+2],F=f*P+h*A+b*I+O,z=l*P+v*A+m*I+j,D=d*P+p*A+g*I+x,C=0;C<a;++C)o[i]=F,o[i+1]=z,o[i+2]=D,i+=c}else s(e,t,r,i,a)}function l(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;if(n){var c=n,u=r.typedBuffer,f=r.typedBufferStride,l=e.length,d=c[0],h=c[1],v=c[2],p=c[4],b=c[5],m=c[6],g=c[8],O=c[9],j=c[10],x=!Object(i.q)(c),y=1e-6,_=1-y;if(a*=f,1===o)for(var w=0;w<l;++w){var T=3*e[w],M=t[T],S=t[T+1],k=t[T+2],P=d*M+p*S+g*k,A=h*M+b*S+O*k,I=v*M+m*S+j*k;if(x){var F=P*P+A*A+I*I;if(F<_&&F>y){var z=1/Math.sqrt(F);P*=z,A*=z,I*=z}}u[a+0]=P,u[a+1]=A,u[a+2]=I,a+=f}else for(var D=0;D<l;++D){var C=3*e[D],E=t[C],L=t[C+1],N=t[C+2],U=d*E+p*L+g*N,R=h*E+b*L+O*N,V=v*E+m*L+j*N;if(x){var H=U*U+R*R+V*V;if(H<_&&H>y){var B=1/Math.sqrt(H);U*=B,R*=B,V*=B}}for(var q=0;q<o;++q)u[a+0]=U,u[a+1]=R,u[a+2]=V,a+=f}}else s(e,t,r,a,o)}function d(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;if(n){var c=n,s=r.typedBuffer,f=r.typedBufferStride,l=e.length,d=c[0],h=c[1],v=c[2],p=c[4],b=c[5],m=c[6],g=c[8],O=c[9],j=c[10],x=!Object(i.q)(c),y=1e-6,_=1-y;if(a*=f,1===o)for(var w=0;w<l;++w){var T=4*e[w],M=t[T],S=t[T+1],k=t[T+2],P=t[T+3],A=d*M+p*S+g*k,I=h*M+b*S+O*k,F=v*M+m*S+j*k;if(x){var z=A*A+I*I+F*F;if(z<_&&z>y){var D=1/Math.sqrt(z);A*=D,I*=D,F*=D}}s[a+0]=A,s[a+1]=I,s[a+2]=F,s[a+3]=P,a+=f}else for(var C=0;C<l;++C){var E=4*e[C],L=t[E],N=t[E+1],U=t[E+2],R=t[E+3],V=d*L+p*N+g*U,H=h*L+b*N+O*U,B=v*L+m*N+j*U;if(x){var q=V*V+H*H+B*B;if(q<_&&q>y){var G=1/Math.sqrt(q);V*=G,H*=G,B*=G}}for(var W=0;W<o;++W)s[a+0]=V,s[a+1]=H,s[a+2]=B,s[a+3]=R,a+=f}}else u(e,t,r,a,o)}function h(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=r.typedBuffer,c=r.typedBufferStride,s=e.length;if(i*=c,1===a){if(4===n)for(var u=0;u<s;++u){var f=4*e[u];o[i]=t[f],o[i+1]=t[f+1],o[i+2]=t[f+2],o[i+3]=t[f+3],i+=c}else if(3===n)for(var l=0;l<s;++l){var d=3*e[l];o[i]=t[d],o[i+1]=t[d+1],o[i+2]=t[d+2],o[i+3]=255,i+=c}}else if(4===n)for(var h=0;h<s;++h)for(var v=4*e[h],p=0;p<a;++p)o[i]=t[v],o[i+1]=t[v+1],o[i+2]=t[v+2],o[i+3]=t[v+3],i+=c;else if(3===n)for(var b=0;b<s;++b)for(var m=3*e[b],g=0;g<a;++g)o[i]=t[m],o[i+1]=t[m+1],o[i+2]=t[m+2],o[i+3]=255,i+=c}function v(e,t,n,i,s,u){var v,p=Object(r.a)(t.fieldNames);try{for(p.s();!(v=p.n()).done;){var b=v.value,m=e.vertexAttributes.get(b),g=e.indices.get(b);if(m&&g)switch(b){case"position":Object(o.a)(3===m.size);var O=s.getField(b,a.u);O&&f(g,m.data,n,O,u);break;case"normal":Object(o.a)(3===m.size);var j=s.getField(b,a.u);j&&l(g,m.data,i,j,u);break;case"uv0":Object(o.a)(2===m.size);var x=s.getField(b,a.m);x&&c(g,m.data,x,u);break;case"color":Object(o.a)(3===m.size||4===m.size);var y=s.getField(b,a.J);y&&h(g,m.data,m.size,y,u);break;case"symbolColor":Object(o.a)(3===m.size||4===m.size);var _=s.getField(b,a.J);_&&h(g,m.data,m.size,_,u);break;case"tangent":Object(o.a)(4===m.size);var w=s.getField(b,a.C);w&&d(g,m.data,i,w,u)}}}catch(T){p.e(T)}finally{p.f()}}},701:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return a}));var r={func:513},i={func:519},a={mask:255},o={mask:0},c={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:0}},s={function:{func:519,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7681}},u={function:{func:514,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}},f={function:{func:517,ref:2,mask:2},operation:{fail:7680,zFail:7680,zPass:7680}}},702:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var r,i,a,o,c,s,u=n(542),f=n(747),l=n(538);function d(e,t){var n=e.vertex.code;t.verticalOffsetEnabled?(e.vertex.uniforms.add("verticalOffset","vec4"),t.screenSizePerspectiveEnabled&&(e.include(f.a),e.vertex.uniforms.add("screenSizePerspectiveAlignment","vec4")),n.add(Object(l.a)(r||(r=Object(u.a)(["\n    vec3 calculateVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      float viewDistance = length((view * vec4(worldPos, 1.0)).xyz);\n      ","\n      ","\n      // Screen sized offset in world space, used for example for line callouts\n      float worldOffset = clamp(verticalOffsetScreenHeight * verticalOffset.y * viewDistance, verticalOffset.z, verticalOffset.w);\n      return worldNormal * worldOffset;\n    }\n\n    vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) {\n      return worldPos + calculateVerticalOffset(worldPos, localOrigin);\n    }\n    "])),1===t.viewingMode?Object(l.a)(i||(i=Object(u.a)(["vec3 worldNormal = normalize(worldPos + localOrigin);"]))):Object(l.a)(a||(a=Object(u.a)(["vec3 worldNormal = vec3(0.0, 0.0, 1.0);"]))),t.screenSizePerspectiveEnabled?Object(l.a)(o||(o=Object(u.a)(["\n          float cosAngle = dot(worldNormal, normalize(worldPos - camPos));\n          float verticalOffsetScreenHeight = screenSizePerspectiveScaleFloat(verticalOffset.x, abs(cosAngle), viewDistance, screenSizePerspectiveAlignment);"]))):Object(l.a)(c||(c=Object(u.a)(["\n          float verticalOffsetScreenHeight = verticalOffset.x;"])))))):n.add(Object(l.a)(s||(s=Object(u.a)(["vec3 addVerticalOffset(vec3 worldPos, vec3 localOrigin) { return worldPos; }"]))))}function h(e,t,n){if(t.verticalOffset){var r=v(t.verticalOffset,n.camera.fovY,n.camera.fullViewport[3]),i=n.camera.pixelRatio||1;e.setUniform4f("verticalOffset",r.screenLength*i,r.perDistance,r.minWorldLength,r.maxWorldLength)}}function v(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p;return r.screenLength=e.screenLength,r.perDistance=Math.tan(.5*t)/(.5*n),r.minWorldLength=e.minWorldLength,r.maxWorldLength=e.maxWorldLength,r}var p={screenLength:0,perDistance:0,minWorldLength:0,maxWorldLength:0}},703:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,i,a,o=n(542),c=n(538);function s(e,t){0===t.output&&t.receiveShadows?(e.varyings.add("linearDepth","float"),e.vertex.code.add(Object(c.a)(r||(r=Object(o.a)(["void forwardLinearDepth() { linearDepth = gl_Position.w; }"]))))):1===t.output||3===t.output?(e.varyings.add("linearDepth","float"),e.vertex.uniforms.add("cameraNearFar","vec2"),e.vertex.code.add(Object(c.a)(i||(i=Object(o.a)(["void forwardLinearDepth() {\nlinearDepth = (-position_view().z - cameraNearFar[0]) / (cameraNearFar[1] - cameraNearFar[0]);\n}"]))))):e.vertex.code.add(Object(c.a)(a||(a=Object(o.a)(["void forwardLinearDepth() {}"]))))}},713:function(e,t,n){"use strict";function r(){return new Float32Array(3)}function i(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function a(e,t,n){var r=new Float32Array(3);return r[0]=e,r[1]=t,r[2]=n,r}function o(){return r()}function c(){return a(1,1,1)}function s(){return a(1,0,0)}function u(){return a(0,1,0)}function f(){return a(0,0,1)}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a}));var l=o(),d=c(),h=s(),v=u(),p=f();Object.freeze({__proto__:null,create:r,clone:i,fromValues:a,createView:function(e,t){return new Float32Array(e,t,3)},zeros:o,ones:c,unitX:s,unitY:u,unitZ:f,ZEROS:l,ONES:d,UNIT_X:h,UNIT_Y:v,UNIT_Z:p})},715:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,i=n(542),a=n(538);function o(e){e.code.add(Object(a.a)(r||(r=Object(i.a)(["const float MAX_RGBA_FLOAT =\n255.0 / 256.0 +\n255.0 / 256.0 / 256.0 +\n255.0 / 256.0 / 256.0 / 256.0 +\n255.0 / 256.0 / 256.0 / 256.0 / 256.0;\nconst vec4 FIXED_POINT_FACTORS = vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0);\nvec4 float2rgba(const float value) {\nfloat valueInValidDomain = clamp(value, 0.0, MAX_RGBA_FLOAT);\nvec4 fixedPointU8 = floor(fract(valueInValidDomain * FIXED_POINT_FACTORS) * 256.0);\nconst float toU8AsFloat = 1.0 / 255.0;\nreturn fixedPointU8 * toU8AsFloat;\n}\nconst vec4 RGBA_2_FLOAT_FACTORS = vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, RGBA_2_FLOAT_FACTORS);\n}"]))))}},718:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r,i,a,o=n(542),c=n(538);function s(e){var t=e.fragment.code;t.add(Object(c.a)(r||(r=Object(o.a)(["vec3 evaluateDiffuseIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float NdotNG)\n{\nreturn ((1.0 - NdotNG) * ambientGround + (1.0 + NdotNG) * ambientSky) * 0.5;\n}"])))),t.add(Object(c.a)(i||(i=Object(o.a)(["float integratedRadiance(float cosTheta2, float roughness)\n{\nreturn (cosTheta2 - 1.0) / (cosTheta2 * (1.0 - roughness * roughness) - 1.0);\n}"])))),t.add(Object(c.a)(a||(a=Object(o.a)(["vec3 evaluateSpecularIlluminationHemisphere(vec3 ambientGround, vec3 ambientSky, float RdotNG, float roughness)\n{\nfloat cosTheta2 = 1.0 - RdotNG * RdotNG;\nfloat intRadTheta = integratedRadiance(cosTheta2, roughness);\nfloat ground = RdotNG < 0.0 ? 1.0 - intRadTheta : 1.0 + intRadTheta;\nfloat sky = 2.0 - ground;\nreturn (ground * ambientGround + sky * ambientSky) * 0.5;\n}"]))))}var u,f,l,d,h,v,p,b,m,g,O,j=n(791);function x(e,t){var n=e.fragment.code;e.include(j.a),3===t.pbrMode||4===t.pbrMode?(n.add(Object(c.a)(u||(u=Object(o.a)(["\n    struct PBRShadingWater\n    {\n        float NdotL;   // cos angle between normal and light direction\n        float NdotV;   // cos angle between normal and view direction\n        float NdotH;   // cos angle between normal and half vector\n        float VdotH;   // cos angle between view direction and half vector\n        float LdotH;   // cos angle between light direction and half vector\n        float VdotN;   // cos angle between view direction and normal vector\n    };\n\n    float dtrExponent = ",";\n    "])),t.useCustomDTRExponentForWater?"2.2":"2.0")),n.add(Object(c.a)(f||(f=Object(o.a)(["vec3 fresnelReflection(float angle, vec3 f0, float f90) {\nreturn f0 + (f90 - f0) * pow(1.0 - angle, 5.0);\n}"])))),n.add(Object(c.a)(l||(l=Object(o.a)(["float normalDistributionWater(float NdotH, float roughness)\n{\nfloat r2 = roughness * roughness;\nfloat NdotH2 = NdotH * NdotH;\nfloat denom = pow((NdotH2 * (r2 - 1.0) + 1.0), dtrExponent) * PI;\nreturn r2 / denom;\n}"])))),n.add(Object(c.a)(d||(d=Object(o.a)(["float geometricOcclusionKelemen(float LoH)\n{\nreturn 0.25 / (LoH * LoH);\n}"])))),n.add(Object(c.a)(h||(h=Object(o.a)(["vec3 brdfSpecularWater(in PBRShadingWater props, float roughness, vec3 F0, float F0Max)\n{\nvec3  F = fresnelReflection(props.VdotH, F0, F0Max);\nfloat dSun = normalDistributionWater(props.NdotH, roughness);\nfloat V = geometricOcclusionKelemen(props.LdotH);\nfloat diffusionSunHaze = mix(roughness + 0.045, roughness + 0.385, 1.0 - props.VdotH);\nfloat strengthSunHaze  = 1.2;\nfloat dSunHaze = normalDistributionWater(props.NdotH, diffusionSunHaze)*strengthSunHaze;\nreturn ((dSun + dSunHaze) * V) * F;\n}\nvec3 tonemapACES(const vec3 x) {\nreturn (x * (2.51 * x + 0.03)) / (x * (2.43 * x + 0.59) + 0.14);\n}"]))))):1!==t.pbrMode&&2!==t.pbrMode||(e.include(s),n.add(Object(c.a)(v||(v=Object(o.a)(["struct PBRShadingInfo\n{\nfloat NdotL;\nfloat NdotV;\nfloat NdotH;\nfloat VdotH;\nfloat LdotH;\nfloat NdotNG;\nfloat RdotNG;\nfloat NdotAmbDir;\nfloat NdotH_Horizon;\nvec3 skyRadianceToSurface;\nvec3 groundRadianceToSurface;\nvec3 skyIrradianceToSurface;\nvec3 groundIrradianceToSurface;\nfloat averageAmbientRadiance;\nfloat ssao;\nvec3 albedoLinear;\nvec3 f0;\nvec3 f90;\nvec3 diffuseColor;\nfloat metalness;\nfloat roughness;\n};"])))),n.add(Object(c.a)(p||(p=Object(o.a)(["float normalDistribution(float NdotH, float roughness)\n{\nfloat a = NdotH * roughness;\nfloat b = roughness / (1.0 - NdotH * NdotH + a * a);\nreturn b * b * INV_PI;\n}"])))),n.add(Object(c.a)(b||(b=Object(o.a)(["const vec4 c0 = vec4(-1.0, -0.0275, -0.572,  0.022);\nconst vec4 c1 = vec4( 1.0,  0.0425,  1.040, -0.040);\nconst vec2 c2 = vec2(-1.04, 1.04);\nvec2 prefilteredDFGAnalytical(float roughness, float NdotV) {\nvec4 r = roughness * c0 + c1;\nfloat a004 = min(r.x * r.x, exp2(-9.28 * NdotV)) * r.x + r.y;\nreturn c2 * a004 + r.zw;\n}"])))),n.add(Object(c.a)(m||(m=Object(o.a)(["vec3 evaluateEnvironmentIllumination(PBRShadingInfo inputs) {\nvec3 indirectDiffuse = evaluateDiffuseIlluminationHemisphere(inputs.groundIrradianceToSurface, inputs.skyIrradianceToSurface, inputs.NdotNG);\nvec3 indirectSpecular = evaluateSpecularIlluminationHemisphere(inputs.groundRadianceToSurface, inputs.skyRadianceToSurface, inputs.RdotNG, inputs.roughness);\nvec3 diffuseComponent = inputs.diffuseColor * indirectDiffuse * INV_PI;\nvec2 dfg = prefilteredDFGAnalytical(inputs.roughness, inputs.NdotV);\nvec3 specularColor = inputs.f0 * dfg.x + inputs.f90 * dfg.y;\nvec3 specularComponent = specularColor * indirectSpecular;\nreturn (diffuseComponent + specularComponent);\n}"])))),n.add(Object(c.a)(g||(g=Object(o.a)(["float gamutMapChanel(float x, vec2 p){\nreturn (x < p.x) ? mix(0.0, p.y, x/p.x) : mix(p.y, 1.0, (x - p.x) / (1.0 - p.x) );\n}"])))),n.add(Object(c.a)(O||(O=Object(o.a)(["vec3 blackLevelSoftCompression(vec3 inColor, PBRShadingInfo inputs){\nvec3 outColor;\nvec2 p = vec2(0.02 * (inputs.averageAmbientRadiance), 0.0075 * (inputs.averageAmbientRadiance));\noutColor.x = gamutMapChanel(inColor.x, p) ;\noutColor.y = gamutMapChanel(inColor.y, p) ;\noutColor.z = gamutMapChanel(inColor.z, p) ;\nreturn outColor;\n}"])))))}},745:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(3),a=n(236),o=function(){function e(){Object(r.a)(this,e),this.id=Object(a.a)()}return Object(i.a)(e,[{key:"unload",value:function(){}}]),e}()},747:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return v}));var r,i,a,o,c,s,u,f=n(542),l=n(538),d=n(620);function h(e){e.vertex.code.add(Object(l.a)(r||(r=Object(f.a)(["float screenSizePerspectiveMinSize(float size, vec4 factor) {\nfloat nonZeroSize = 1.0 - step(size, 0.0);\nreturn (\nfactor.z * (\n1.0 +\nnonZeroSize *\n2.0 * factor.w / (\nsize + (1.0 - nonZeroSize)\n)\n)\n);\n}"])))),e.vertex.code.add(Object(l.a)(i||(i=Object(f.a)(["float screenSizePerspectiveViewAngleDependentFactor(float absCosAngle) {\nreturn absCosAngle * absCosAngle * absCosAngle;\n}"])))),e.vertex.code.add(Object(l.a)(a||(a=Object(f.a)(["vec4 screenSizePerspectiveScaleFactor(float absCosAngle, float distanceToCamera, vec4 params) {\nreturn vec4(\nmin(params.x / (distanceToCamera - params.y), 1.0),\nscreenSizePerspectiveViewAngleDependentFactor(absCosAngle),\nparams.z,\nparams.w\n);\n}"])))),e.vertex.code.add(Object(l.a)(o||(o=Object(f.a)(["float applyScreenSizePerspectiveScaleFactorFloat(float size, vec4 factor) {\nreturn max(mix(size * factor.x, size, factor.y), screenSizePerspectiveMinSize(size, factor));\n}"])))),e.vertex.code.add(Object(l.a)(c||(c=Object(f.a)(["float screenSizePerspectiveScaleFloat(float size, float absCosAngle, float distanceToCamera, vec4 params) {\nreturn applyScreenSizePerspectiveScaleFactorFloat(\nsize,\nscreenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params)\n);\n}"])))),e.vertex.code.add(Object(l.a)(s||(s=Object(f.a)(["vec2 applyScreenSizePerspectiveScaleFactorVec2(vec2 size, vec4 factor) {\nreturn mix(size * clamp(factor.x, screenSizePerspectiveMinSize(size.y, factor) / size.y, 1.0), size, factor.y);\n}"])))),e.vertex.code.add(Object(l.a)(u||(u=Object(f.a)(["vec2 screenSizePerspectiveScaleVec2(vec2 size, float absCosAngle, float distanceToCamera, vec4 params) {\nreturn applyScreenSizePerspectiveScaleFactorVec2(size, screenSizePerspectiveScaleFactor(absCosAngle, distanceToCamera, params));\n}"]))))}function v(e,t){if(t.screenSizePerspective){Object(d.a)(t.screenSizePerspective,e,"screenSizePerspective");var n=t.screenSizePerspectiveAlignment||t.screenSizePerspective;Object(d.a)(n,e,"screenSizePerspectiveAlignment")}}},753:function(e,t,n){"use strict";n.d(t,"a",(function(){return Z}));var r,i=n(4),a=n.n(i),o=n(9),c=n(2),s=n(3),u=n(5),f=n(6),l=n(215),d=n(18),h=n(67),v=n(65),p=n(7),b=n(21),m=n(162),g=n(24),O=n(812),j=n(458),x=n(10),y=n(23),_=n(62);function w(){if(Object(p.j)(r)){var e=function(e){return Object(_.a)("esri/libs/basisu/".concat(e))};r=Promise.all([n.e(104),n.e(120)]).then(n.bind(null,1107)).then((function(e){return e.b})).then((function(t){return(0,t.default)({locateFile:e}).then((function(e){return e.initializeBasis(),delete e.then,e}))}))}return r}var T=n(546),M=n(720),S=null,k=null;function P(){return A.apply(this,arguments)}function A(){return(A=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Object(p.j)(k),!e.t0){e.next=6;break}return k=w(),e.next=5,k;case 5:S=e.sent;case 6:return e.abrupt("return",k);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,n,r,i){var a=Object(M.b)(t?37496:37492),o=i&&e>1?(Math.pow(4,e)-1)/(3*Math.pow(4,e-1)):1;return Math.ceil(n*r*a*o)}function F(e){return e.getNumImages()>=1&&!e.isUASTC()}function z(e){return e.getFaces()>=1&&e.isETC1S()}function D(){return(D=Object(o.a)(a.a.mark((function e(t,n,r){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Object(p.j)(S),!e.t0){e.next=5;break}return e.next=4,P();case 4:S=e.sent;case 5:if(F(i=new S.BasisFile(new Uint8Array(r)))){e.next=8;break}return e.abrupt("return",null);case 8:return i.startTranscoding(),o=E(t,n,i.getNumLevels(0),i.getHasAlpha(),i.getImageWidth(0,0),i.getImageHeight(0,0),(function(e,t){return i.getImageTranscodedSizeInBytes(0,e,t)}),(function(e,t,n){return i.transcodeImage(n,0,e,t,0,0)})),e.abrupt("return",(i.close(),i.delete(),o));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(){return(C=Object(o.a)(a.a.mark((function e(t,n,r){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Object(p.j)(S),!e.t0){e.next=5;break}return e.next=4,P();case 4:S=e.sent;case 5:if(z(i=new S.KTX2File(new Uint8Array(r)))){e.next=8;break}return e.abrupt("return",null);case 8:return i.startTranscoding(),o=E(t,n,i.getLevels(),i.getHasAlpha(),i.getWidth(),i.getHeight(),(function(e,t){return i.getImageTranscodedSizeInBytes(e,0,0,t)}),(function(e,t,n){return i.transcodeImage(n,e,0,0,t,0,-1,-1)})),e.abrupt("return",(i.close(),i.delete(),o));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e,t,n,r,i,a,o,c){for(var s=e.capabilities,u=s.compressedTextureETC,f=s.compressedTextureS3TC,l=u?r?[1,37496]:[0,37492]:f?r?[3,33779]:[2,33776]:[13,6408],d=Object(y.a)(l,2),h=d[0],v=d[1],p=t.hasMipmap?n:Math.min(1,n),b=[],m=0;m<p;m++)b.push(new Uint8Array(o(m,h))),c(m,h,b[m]);var g=b.length>1,O=g?9987:9729,j=Object(x.a)(Object(x.a)({},t),{},{samplingMode:O,hasMipmap:g,internalFormat:v,width:i,height:a});return new T.a(e,j,{type:"compressed",levels:b})}var L=n(745),N=n(11).a.getLogger("esri.views.3d.webgl-engine.lib.DDSUtil"),U=542327876,R=131072;function V(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var H=V("DXT1"),B=V("DXT3"),q=V("DXT5");function G(e,t,n){var r=function(e,t){var n=new Int32Array(e,0,31);if(n[0]!==U)return N.error("Invalid magic number in DDS header"),null;if(!(4&n[20]))return N.error("Unsupported format, must contain a FourCC code"),null;var r,i,a=n[21];switch(a){case H:r=8,i=33776;break;case B:r=16,i=33778;break;case q:r=16,i=33779;break;default:return N.error("Unsupported FourCC code:",function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}(a)),null}var o=1,c=n[4],s=n[3];0==(3&c)&&0==(3&s)||(N.warn("Rounding up compressed texture size to nearest multiple of 4."),c=c+3&-4,s=s+3&-4);var u,f,l=c,d=s;n[2]&R&&!1!==t&&(o=Math.max(1,n[7])),1===o||Object(v.i)(c)&&Object(v.i)(s)||(N.warn("Ignoring mipmaps of non power of two sized compressed texture."),o=1);for(var h=n[1]+4,p=[],b=0;b<o;++b)f=(c+3>>2)*(s+3>>2)*r,u=new Uint8Array(e,h,f),p.push(u),h+=f,c=Math.max(1,c>>1),s=Math.max(1,s>>1);return{textureData:{type:"compressed",levels:p},internalFormat:i,width:l,height:d}}(n,t.hasMipmap),i=r.textureData,a=r.internalFormat,o=r.width,c=r.height;return t.samplingMode=i.levels.length>1?9987:9729,t.hasMipmap=i.levels.length>1,t.internalFormat=a,t.width=o,t.height=c,new T.a(e,t,i)}var W=n(892),X=n(567),K=n(552),Y=n(622),Z=function(e){Object(u.a)(n,e);var t=Object(f.a)(n);function n(e,r){var i;return Object(c.a)(this,n),(i=t.call(this)).data=e,i.type=4,i.glTexture=null,i.powerOfTwoStretchInfo=null,i.loadingPromise=null,i.loadingController=null,i.events=new h.a,i.params=r||{},i.params.mipmap=!1!==i.params.mipmap,i.params.noUnpackFlip=i.params.noUnpackFlip||!1,i.params.preMultiplyAlpha=i.params.preMultiplyAlpha||!1,i.params.wrap=i.params.wrap||{s:10497,t:10497},i.params.powerOfTwoResizeMode=i.params.powerOfTwoResizeMode||1,i.estimatedTexMemRequired=n.estimateTexMemRequired(i.data,i.params),i.startPreload(),i}return Object(s.a)(n,[{key:"startPreload",value:function(){var e=this.data;Object(p.j)(e)||(e instanceof HTMLVideoElement?this.startPreloadVideoElement(e):e instanceof HTMLImageElement&&this.startPreloadImageElement(e))}},{key:"startPreloadVideoElement",value:function(e){Object(g.t)(e.src)||"auto"===e.preload&&e.crossOrigin||(e.preload="auto",e.crossOrigin="anonymous",e.src=e.src)}},{key:"startPreloadImageElement",value:function(e){Object(g.u)(e.src)||Object(g.t)(e.src)||e.crossOrigin||(e.crossOrigin="anonymous",e.src=e.src)}},{key:"dispose",value:function(){this.data=void 0}},{key:"width",get:function(){return this.params.width}},{key:"height",get:function(){return this.params.height}},{key:"createDescriptor",value:function(e){var t;return{target:3553,pixelFormat:6408,dataType:5121,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?9987:9729,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:null!=(t=this.params.maxAnisotropy)?t:this.params.mipmap?e.parameters.maxMaxAnisotropy:1}}},{key:"load",value:function(e,t){if(Object(p.k)(this.glTexture))return this.glTexture;if(Object(p.k)(this.loadingPromise))return this.loadingPromise;var r=this.data;return Object(p.j)(r)?(this.glTexture=new T.a(e,this.createDescriptor(e),null),this.glTexture):"string"==typeof r?this.loadFromURL(e,t,r):r instanceof Image?this.loadFromImageElement(e,t,r):r instanceof HTMLVideoElement?this.loadFromVideoElement(e,t,r):r instanceof ImageData||r instanceof HTMLCanvasElement?this.loadFromImage(e,r,t):(Object(m.c)(r)||Object(m.k)(r))&&this.params.encoding===n.DDS_ENCODING?this.loadFromDDSData(e,r):(Object(m.c)(r)||Object(m.k)(r))&&this.params.encoding===n.KTX2_ENCODING?this.loadFromKTX2(e,r):(Object(m.c)(r)||Object(m.k)(r))&&this.params.encoding===n.BASIS_ENCODING?this.loadFromBasis(e,r):Object(m.k)(r)?this.loadFromPixelData(e,r):Object(m.c)(r)?this.loadFromPixelData(e,new Uint8Array(r)):null}},{key:"requiresFrameUpdates",get:function(){return this.data instanceof HTMLVideoElement}},{key:"frameUpdate",value:function(e,t,n){if(!(this.data instanceof HTMLVideoElement)||Object(p.j)(this.glTexture))return n;if(this.data.readyState<2||n===this.data.currentTime)return n;if(Object(p.k)(this.powerOfTwoStretchInfo)){var r=this.powerOfTwoStretchInfo,i=r.framebuffer,a=r.vao,o=r.sourceTexture;o.setData(this.data),this.drawStretchedTexture(e,t,i,a,o,this.glTexture)}else{var c=this.data,s=c.width,u=c.height,f=this.glTexture.descriptor,l=f.width,d=f.height;s!==l||u!==d?this.glTexture.updateData(0,0,0,Math.min(s,l),Math.min(u,d),this.data):this.glTexture.setData(this.data)}return this.glTexture.descriptor.hasMipmap&&this.glTexture.generateMipmap(),this.data.currentTime}},{key:"loadFromDDSData",value:function(e,t){return this.glTexture=G(e,this.createDescriptor(e),t),this.glTexture}},{key:"loadFromKTX2",value:function(e,t){var n=this;return this.loadAsync((function(){return function(e,t,n){return C.apply(this,arguments)}(e,n.createDescriptor(e),t).then((function(e){return n.glTexture=e,e}))}))}},{key:"loadFromBasis",value:function(e,t){var n=this;return this.loadAsync((function(){return function(e,t,n){return D.apply(this,arguments)}(e,n.createDescriptor(e),t).then((function(e){return n.glTexture=e,e}))}))}},{key:"loadFromPixelData",value:function(e,t){Object(X.a)(this.params.width>0&&this.params.height>0);var n=this.createDescriptor(e);return n.pixelFormat=1===this.params.components?6409:3===this.params.components?6407:6408,n.width=this.params.width,n.height=this.params.height,this.glTexture=new T.a(e,n,t),this.glTexture}},{key:"loadAsync",value:function(e){var t=this,n=Object(b.d)();this.loadingController=n;var r=e(n.signal);this.loadingPromise=r;var i=function(){t.loadingController===n&&(t.loadingController=null),t.loadingPromise===r&&(t.loadingPromise=null)};return r.then(i,i),r}},{key:"loadFromURL",value:function(e,t,n){var r=this;return this.loadAsync(function(){var i=Object(o.a)(a.a.mark((function i(o){var c;return a.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(O.a)(n,{signal:o});case 2:return c=i.sent,i.abrupt("return",r.loadFromImage(e,c,t));case 4:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())}},{key:"loadFromImageElement",value:function(e,t,n){var r=this;return n.complete?this.loadFromImage(e,n,t):this.loadAsync(function(){var i=Object(o.a)(a.a.mark((function i(o){var c;return a.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(j.a)(n,n.src,!1,o);case 2:return c=i.sent,i.abrupt("return",r.loadFromImage(e,c,t));case 4:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())}},{key:"loadFromVideoElement",value:function(e,t,n){return n.readyState>=2?this.loadFromImage(e,n,t):this.loadFromVideoElementAsync(e,t,n)}},{key:"loadFromVideoElementAsync",value:function(e,t,n){var r=this;return this.loadAsync((function(i){return new Promise((function(a,o){var c=function(){n.removeEventListener("loadeddata",s),n.removeEventListener("error",u),Object(p.k)(f)&&f.remove()},s=function(){n.readyState>=2&&(c(),a(r.loadFromImage(e,n,t)))},u=function(e){c(),o(e||new d.a("Failed to load video"))};n.addEventListener("loadeddata",s),n.addEventListener("error",u);var f=Object(b.q)(i,(function(){return u(Object(b.e)())}))}))}))}},{key:"loadFromImage",value:function(e,t,r){var i=n.getDataDimensions(t);this.params.width=i.width,this.params.height=i.height;var a=this.createDescriptor(e);return a.pixelFormat=3===this.params.components?6407:6408,!this.requiresPowerOfTwo(e,a)||Object(v.i)(i.width)&&Object(v.i)(i.height)?(a.width=i.width,a.height=i.height,this.glTexture=new T.a(e,a,t),this.glTexture):(this.glTexture=this.makePowerOfTwoTexture(e,t,i,a,r),this.glTexture)}},{key:"requiresPowerOfTwo",value:function(e,t){var n=33071,r="number"==typeof t.wrapMode?t.wrapMode===n:t.wrapMode.s===n&&t.wrapMode.t===n;return!Object(Y.a)(e.gl)&&(t.hasMipmap||!r)}},{key:"makePowerOfTwoTexture",value:function(e,t,n,r,i){var a,o=n.width,c=n.height,s=Object(v.l)(o),u=Object(v.l)(c);switch(r.width=s,r.height=u,this.params.powerOfTwoResizeMode){case 2:r.textureCoordinateScaleFactor=[o/s,c/u],(a=new T.a(e,r)).updateData(0,0,0,o,c,t);break;case 1:case null:case void 0:a=this.stretchToPowerOfTwo(e,t,r,i);break;default:Object(l.a)(this.params.powerOfTwoResizeMode)}return r.hasMipmap&&a.generateMipmap(),a}},{key:"stretchToPowerOfTwo",value:function(e,t,n,r){var i=new T.a(e,n),a=new K.a(e,{colorTarget:0,depthStencilTarget:0},i),o=new T.a(e,{target:3553,pixelFormat:n.pixelFormat,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!!n.flipped,maxAnisotropy:8,preMultiplyAlpha:n.preMultiplyAlpha},t),c=Object(W.b)(e);return this.drawStretchedTexture(e,r,a,c,o,i),this.requiresFrameUpdates?this.powerOfTwoStretchInfo={vao:c,sourceTexture:o,framebuffer:a}:(c.dispose(!0),o.dispose(),a.detachColorTexture(),e.bindFramebuffer(null),a.dispose()),i}},{key:"drawStretchedTexture",value:function(e,t,n,r,i,a){e.bindFramebuffer(n);var o=e.getViewport();e.setViewport(0,0,a.descriptor.width,a.descriptor.height);var c=t.program;e.useProgram(c),c.setUniform4f("color",1,1,1,1),c.bindTexture(i,"tex"),e.bindVAO(r),e.setPipelineState(t.pipeline),e.drawArrays(5,0,Object(M.f)(r,"geometry")),e.bindFramebuffer(null),e.setViewport(o.x,o.y,o.width,o.height)}},{key:"unload",value:function(){if(Object(p.k)(this.powerOfTwoStretchInfo)){var e=this.powerOfTwoStretchInfo,t=e.framebuffer,n=e.vao,r=e.sourceTexture;n.dispose(!0),r.dispose(),t.dispose(),this.glTexture=null,this.powerOfTwoStretchInfo=null}if(Object(p.k)(this.glTexture)&&(this.glTexture.dispose(),this.glTexture=null),Object(p.k)(this.loadingController)){var i=this.loadingController;this.loadingController=null,this.loadingPromise=null,i.abort()}this.events.emit("unloaded")}}],[{key:"getDataDimensions",value:function(e){return e instanceof HTMLVideoElement?{width:e.videoWidth,height:e.videoHeight}:e}},{key:"estimateTexMemRequired",value:function(e,t){if(Object(p.j)(e))return 0;if(Object(m.c)(e)||Object(m.k)(e))return t.encoding===n.KTX2_ENCODING?function(e,t){if(Object(p.j)(S))return e.byteLength;var n=new S.KTX2File(new Uint8Array(e)),r=z(n)?I(n.getLevels(),n.getHasAlpha(),n.getWidth(),n.getHeight(),t):0;return n.close(),n.delete(),r}(e,t.mipmap):t.encoding===n.BASIS_ENCODING?function(e,t){if(Object(p.j)(S))return e.byteLength;var n=new S.BasisFile(new Uint8Array(e)),r=F(n)?I(n.getNumLevels(0),n.getHasAlpha(),n.getImageWidth(0,0),n.getImageHeight(0,0),t):0;return n.close(),n.delete(),r}(e,t.mipmap):e.byteLength;var r=e instanceof Image||e instanceof ImageData||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement?n.getDataDimensions(e):t,i=r.width,a=r.height;return(t.mipmap?4/3:1)*i*a*(t.components||4)||0}}]),n}(L.a);Z.DDS_ENCODING="image/vnd-ms.dds",Z.KTX2_ENCODING="image/ktx2",Z.BASIS_ENCODING="image/x.basis"},779:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o}));n(12);function r(e){switch(e){case"u8":case"i8":return 1;case"u16":case"i16":return 2;case"u32":case"i32":case"f32":return 4;case"f64":return 8;default:return}}function i(e){switch(e){case"u8":case"u16":case"u32":return!1;case"i8":case"i16":case"i32":case"f32":case"f64":return!0;default:return}}function a(e){switch(e){case"u8":case"u16":case"u32":case"i8":case"i16":case"i32":return!0;case"f32":case"f64":return!1;default:return}}function o(e){switch(e){case"u8":return 255;case"u16":return 65535;case"u32":return 4294967295;case"i8":return 127;case"i16":return 32767;case"i32":return 2147483647;case"f32":return 3402823e32;case"f64":return 179769e303;default:return}}},791:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r,i,a=n(542),o=n(538);function c(e){e.vertex.code.add(Object(o.a)(r||(r=Object(a.a)(["const float PI = 3.141592653589793;"])))),e.fragment.code.add(Object(o.a)(i||(i=Object(a.a)(["const float PI = 3.141592653589793;\nconst float LIGHT_NORMALIZATION = 1.0 / PI;\nconst float INV_PI = 0.3183098861837907;\nconst float HALF_PI = 1.570796326794897;"]))))}},812:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4),i=n.n(r),a=n(10),o=n(9),c=n(54);function s(e,t){return u.apply(this,arguments)}function u(){return u=Object(o.a)(i.a.mark((function e(t,n){var r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.default)(t,Object(a.a)({responseType:"image"},n));case 2:return r=e.sent,o=r.data,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}},817:function(e,t,n){"use strict";function r(e,t,n){for(var r=0;r<n;++r)t[2*r]=e[r],t[2*r+1]=e[r]-t[2*r]}function i(e,t,n,i){for(var c=0;c<i;++c)a[0]=e[c],r(a,o,1),t[c]=o[0],n[c]=o[1]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));var a=new Float64Array(1),o=new Float32Array(2)},821:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(3),a=n(5),o=n(6),c=n(7),s=function(e){Object(a.a)(n,e);var t=Object(o.a)(n);function n(e){var i;return Object(r.a)(this,n),(i=t.call(this,e))._textureIDs=new Set,i._textureRepository=e.textureRep,i._textureId=e.textureId,i._initTransparent=!!e.initTextureTransparent,i._texture=i._acquire(i._textureId),i._textureNormal=i._acquire(e.normalTextureId),i._textureEmissive=i._acquire(e.emissiveTextureId),i._textureOcclusion=i._acquire(e.occlusionTextureId),i._textureMetallicRoughness=i._acquire(e.metallicRoughnessTextureId),i}return Object(i.a)(n,[{key:"dispose",value:function(){var e=this;this._textureIDs.forEach((function(t){return e._textureRepository.release(t)})),this._textureIDs.clear()}},{key:"updateTexture",value:function(e){e!==this._textureId&&(this._release(this._textureId),this._textureId=e,this._texture=this._acquire(this._textureId))}},{key:"bindTextures",value:function(e){Object(c.k)(this._texture)&&e.bindTexture(this._texture.glTexture,"tex"),Object(c.k)(this._textureNormal)&&e.bindTexture(this._textureNormal.glTexture,"normalTexture"),Object(c.k)(this._textureEmissive)&&e.bindTexture(this._textureEmissive.glTexture,"texEmission"),Object(c.k)(this._textureOcclusion)&&e.bindTexture(this._textureOcclusion.glTexture,"texOcclusion"),Object(c.k)(this._textureMetallicRoughness)&&e.bindTexture(this._textureMetallicRoughness.glTexture,"texMetallicRoughness")}},{key:"bindTextureScale",value:function(e){var t=Object(c.k)(this._texture)&&this._texture.glTexture;t&&t.descriptor.textureCoordinateScaleFactor?e.setUniform2fv("textureCoordinateScaleFactor",t.descriptor.textureCoordinateScaleFactor):e.setUniform2f("textureCoordinateScaleFactor",1,1)}},{key:"_acquire",value:function(e){if(!Object(c.j)(e))return this._textureIDs.add(e),this._textureRepository.acquire(e,this._initTransparent)}},{key:"_release",value:function(e){Object(c.j)(e)||(this._textureIDs.delete(e),this._textureRepository.release(e))}}]),n}(n(681).a)},829:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return _}));var r=n(2),i=n(3),a=n(7),o=n(235),c=n(563),s=n(100),u=n(547),f=n(668),l=n(611),d=n(58),h=n(713),v=n(79),p=n(558),b=n(678),m=function(){function e(){Object(r.a)(this,e),this._transform=Object(u.d)(),this._transformInverse=new g({value:this._transform},s.c,u.d),this._transformInverseTranspose=new g(this._transformInverse,s.b,u.d),this._transformTranspose=new g({value:this._transform},s.b,u.d),this._transformInverseRotation=new g({value:this._transform},o.j,c.b)}return Object(i.a)(e,[{key:"invalidateLazyTransforms",value:function(){this._transformInverse.invalidate(),this._transformInverseTranspose.invalidate(),this._transformTranspose.invalidate(),this._transformInverseRotation.invalidate()}},{key:"transform",get:function(){return this._transform}},{key:"inverse",get:function(){return this._transformInverse.value}},{key:"inverseTranspose",get:function(){return this._transformInverseTranspose.value}},{key:"inverseRotation",get:function(){return this._transformInverseRotation.value}},{key:"transpose",get:function(){return this._transformTranspose.value}},{key:"setTransformMatrix",value:function(e){Object(s.f)(this._transform,e)}},{key:"multiplyTransform",value:function(e){Object(s.n)(this._transform,this._transform,e)}},{key:"set",value:function(e){Object(s.f)(this._transform,e),this.invalidateLazyTransforms()}},{key:"setAndInvalidateLazyTransforms",value:function(e,t){this.setTransformMatrix(e),this.multiplyTransform(t),this.invalidateLazyTransforms()}}]),e}(),g=function(){function e(t,n,i){Object(r.a)(this,e),this.original=t,this.update=n,this.dirty=!0,this.transform=i()}return Object(i.a)(e,[{key:"invalidate",value:function(){this.dirty=!0}},{key:"value",get:function(){return this.dirty&&(this.update(this.transform,this.original.value),this.dirty=!1),this.transform}}]),e}(),O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(r.a)(this,e),this.offset=t,this.tmpVertex=Object(v.e)()}return Object(i.a)(e,[{key:"applyToVertex",value:function(e,t,n){var r=e+this.localOrigin[0],i=t+this.localOrigin[1],a=n+this.localOrigin[2],o=this.offset/Math.sqrt(r*r+i*i+a*a);return this.tmpVertex[0]=e+r*o,this.tmpVertex[1]=t+i*o,this.tmpVertex[2]=n+a*o,this.tmpVertex}},{key:"applyToAabb",value:function(e){var t=e[0]+this.localOrigin[0],n=e[1]+this.localOrigin[1],r=e[2]+this.localOrigin[2],i=e[3]+this.localOrigin[0],a=e[4]+this.localOrigin[1],o=e[5]+this.localOrigin[2],c=this.offset/Math.sqrt(t*t+n*n+r*r);e[0]+=t*c,e[1]+=n*c,e[2]+=r*c;var s=this.offset/Math.sqrt(i*i+a*a+o*o);return e[3]+=i*s,e[4]+=a*s,e[5]+=o*s,e}}]),e}(),j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(r.a)(this,e),this.offset=t,this.componentLocalOriginLength=0,this.tmpVertex=Object(v.e)(),this.mbs=Object(p.e)(),this.obb={center:Object(v.e)(),halfSize:Object(h.b)(),quaternion:null}}return Object(i.a)(e,[{key:"localOrigin",set:function(e){this.componentLocalOriginLength=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2])}},{key:"applyToVertex",value:function(e,t,n){var r=e,i=t,a=n+this.componentLocalOriginLength,o=this.offset/Math.sqrt(r*r+i*i+a*a);return this.tmpVertex[0]=e+r*o,this.tmpVertex[1]=t+i*o,this.tmpVertex[2]=n+a*o,this.tmpVertex}},{key:"applyToAabb",value:function(e){var t=e[0],n=e[1],r=e[2]+this.componentLocalOriginLength,i=e[3],a=e[4],o=e[5]+this.componentLocalOriginLength,c=this.offset/Math.sqrt(t*t+n*n+r*r);e[0]+=t*c,e[1]+=n*c,e[2]+=r*c;var s=this.offset/Math.sqrt(i*i+a*a+o*o);return e[3]+=i*s,e[4]+=a*s,e[5]+=o*s,e}},{key:"applyToMbs",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),n=this.offset/t;return this.mbs[0]=e[0]+e[0]*n,this.mbs[1]=e[1]+e[1]*n,this.mbs[2]=e[2]+e[2]*n,this.mbs[3]=e[3]+e[3]*this.offset/t,this.mbs}},{key:"applyToObb",value:function(e){var t=e.center,n=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);this.obb.center[0]=t[0]+t[0]*n,this.obb.center[1]=t[1]+t[1]*n,this.obb.center[2]=t[2]+t[2]*n,Object(d.u)(this.obb.halfSize,e.halfSize,e.quaternion),Object(d.f)(this.obb.halfSize,this.obb.halfSize,e.center);var r=this.offset/Math.sqrt(this.obb.halfSize[0]*this.obb.halfSize[0]+this.obb.halfSize[1]*this.obb.halfSize[1]+this.obb.halfSize[2]*this.obb.halfSize[2]);return this.obb.halfSize[0]+=this.obb.halfSize[0]*r,this.obb.halfSize[1]+=this.obb.halfSize[1]*r,this.obb.halfSize[2]+=this.obb.halfSize[2]*r,Object(d.j)(this.obb.halfSize,this.obb.halfSize,e.center),Object(f.a)(T,e.quaternion),Object(d.u)(this.obb.halfSize,this.obb.halfSize,T),this.obb.halfSize[0]*=this.obb.halfSize[0]<0?-1:1,this.obb.halfSize[1]*=this.obb.halfSize[1]<0?-1:1,this.obb.halfSize[2]*=this.obb.halfSize[2]<0?-1:1,this.obb.quaternion=e.quaternion,this.obb}}]),e}(),x=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Object(r.a)(this,e),this.offset=t,this.sphere=Object(b.b)(),this.tmpVertex=Object(v.e)()}return Object(i.a)(e,[{key:"applyToVertex",value:function(e,t,n){var r=this.objectTransform.transform,i=r[0]*e+r[4]*t+r[8]*n+r[12],a=r[1]*e+r[5]*t+r[9]*n+r[13],o=r[2]*e+r[6]*t+r[10]*n+r[14],c=this.offset/Math.sqrt(i*i+a*a+o*o);i+=i*c,a+=a*c,o+=o*c;var s=this.objectTransform.inverse;return this.tmpVertex[0]=s[0]*i+s[4]*a+s[8]*o+s[12],this.tmpVertex[1]=s[1]*i+s[5]*a+s[9]*o+s[13],this.tmpVertex[2]=s[2]*i+s[6]*a+s[10]*o+s[14],this.tmpVertex}},{key:"applyToMinMax",value:function(e,t){var n=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*n,e[1]+=e[1]*n,e[2]+=e[2]*n;var r=this.offset/Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]+=t[0]*r,t[1]+=t[1]*r,t[2]+=t[2]*r}},{key:"applyToAabb",value:function(e){var t=this.offset/Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]+=e[0]*t,e[1]+=e[1]*t,e[2]+=e[2]*t;var n=this.offset/Math.sqrt(e[3]*e[3]+e[4]*e[4]+e[5]*e[5]);return e[3]+=e[3]*n,e[4]+=e[4]*n,e[5]+=e[5]*n,e}},{key:"applyToBoundingSphere",value:function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),n=this.offset/t;return this.sphere[0]=e[0]+e[0]*n,this.sphere[1]=e[1]+e[1]*n,this.sphere[2]=e[2]+e[2]*n,this.sphere[3]=e[3]+e[3]*this.offset/t,this.sphere}}]),e}(),y=new x;function _(e){return Object(a.k)(e)?(y.offset=e,y):null}new j;new O;var w="terrain",T=Object(l.b)()},866:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return f}));var r=n(13),i=n(2),a=n(3),o=n(5),c=n(6),s=function(e){var t=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.apply(this,arguments))._isDisposed=!1,e}return Object(a.a)(n,[{key:"dispose",value:function(){var e,t=Object(r.a)(null!=(n=this._managedDisposables)?n:[]);try{for(t.s();!(e=t.n()).done;){var n,i=e.value,a=this[i];this[i]=null,a&&"function"==typeof a.dispose&&a.dispose()}}catch(o){t.e(o)}finally{t.f()}this._isDisposed=!0}},{key:"isDisposed",get:function(){return this._isDisposed}}]),n}(e);return t},u=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return n}(s(function(){return function e(){Object(i.a)(this,e)}}()));function f(){return function(e,t){var n,r;e.hasOwnProperty("_managedDisposables")||(e._managedDisposables=null!=(n=null==(r=e._managedDisposables)?void 0:r.slice())?n:[]),e._managedDisposables.unshift(t)}}},892:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return u}));var r=n(619),i=[{name:"position",count:2,type:5126,offset:0,stride:8,normalized:!1}],a=[{name:"position",count:2,type:5126,offset:0,stride:16,normalized:!1},{name:"uv0",count:2,type:5126,offset:8,stride:16,normalized:!1}],o=n(550),c=n(546),s=n(551);function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.a,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,f=null;return f=t===a?new Float32Array([c,c,0,0,u,c,1,0,c,u,0,1,u,u,1,1]):new Float32Array([c,c,u,c,c,u,u,u]),new s.a(e,n,{geometry:t},{geometry:o.a.createVertex(e,35044,f)})}function f(e){return new c.a(e,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,width:1,height:1},new Uint8Array([255,255,255,255]))}},923:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));n(2),n(3);var r=n(65);function i(e,t,n){var r=n.parameters,i=n.paddingPixelsOverride;return f.scale=Math.min(r.divisor/(t-r.offset),1),f.factor=function(e){return Math.abs(e*e*e)}(e),f.minPixelSize=r.minPixelSize,f.paddingPixels=i,f}function a(e,t){return 0===e?t.minPixelSize:t.minPixelSize*(1+2*t.paddingPixels/e)}function o(e,t){return Math.max(Object(r.j)(e*t.scale,e,t.factor),a(e,t))}function c(e,t,n,r){r.scale=function(e,t,n){var r=i(e,t,n);return r.minPixelSize=0,r.paddingPixels=0,o(1,r)}(e,t,n),r.factor=0,r.minPixelSize=n.parameters.minPixelSize,r.paddingPixels=n.paddingPixelsOverride}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0],r=Math.min(Math.max(t.scale,a(e[1],t)/e[1]),1);return n[0]=e[0]*r,n[1]=e[1]*r,n}function u(e,t,n,r){return o(e,i(t,n,r))}Object(r.f)(10),Object(r.f)(12),Object(r.f)(70),Object(r.f)(40);var f={scale:0,factor:0,minPixelSize:0,paddingPixels:0}}}]);
//# sourceMappingURL=7.2cb41d43.chunk.js.map