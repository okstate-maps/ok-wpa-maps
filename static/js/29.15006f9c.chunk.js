(this["webpackJsonpok-wpa-maps"]=this["webpackJsonpok-wpa-maps"]||[]).push([[29,107,167],{1136:function(e,t,n){"use strict";n.r(t),n.d(t,"DrawGraphicTool2D",(function(){return E}));var r=n(23),a=n(2),i=n(3),o=n(5),s=n(6),c=n(0),u=(n(76),n(80)),l=n(124),h=n(7),d=n(1),p=(n(12),n(15),n(11),n(8)),f=n(979),v=(n(56),n(221)),y=n(127),b=new v.a({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[3.75,3.75],lineDashEnding:"HalfPattern",controlPointEnding:"NoConstraint"}],enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:1.6,color:[255,255,255,255]},{type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",miterLimit:10,width:2,color:[0,0,0,255]}]}}}),m=new y.default({style:"circle",size:6,color:[127,127,127,1],outline:{color:[50,50,50],width:1}}),g=new y.default({style:"circle",size:6,color:[255,127,0,1],outline:{color:[50,50,50],width:1}}),O=n(955),_=n(956),j=n(920),x=n(47),k=n(196),E=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e))._visualElementGraphics={outline:null,regularVertices:null,activeVertex:null},r.activeFillSymbol=null,r.type="draw-2d",r._visualElementSymbols={outline:Object(h.t)(e.activeLineSymbol,b),regularVertices:Object(h.t)(e.regularVerticesSymbol,m),activeVertex:Object(h.t)(e.activeVertexSymbol,g),fill:Object(h.s)(e.activeFillSymbol)},r}return Object(i.a)(n,[{key:"initializeGraphic",value:function(e){return Object(h.k)(this._visualElementSymbols.fill)&&(e.symbol=this._visualElementSymbols.fill),null}},{key:"makeDrawOperation",value:function(){var e=this.view;return new _.a({view:e,manipulators:this.manipulators,geometryType:Object(O.b)(this.geometryType),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new j.b(e),hasM:!1,snappingManager:this.snappingManager,snappingVisualizer:new f.a(this.internalGraphicsLayer)})}},{key:"onActiveVertexChanged",value:function(e){var t=this;if("point"===this.geometryType)return null;var n=Object(r.a)(e,2),a=n[0],i=n[1],o=new x.a({x:a,y:i,spatialReference:this.drawOperation.spatialReference});return Object(h.k)(this._visualElementGraphics.activeVertex)?(this._visualElementGraphics.activeVertex.geometry=o,null):(this._visualElementGraphics.activeVertex=new u.a({geometry:o,symbol:this._visualElementSymbols.activeVertex,attributes:{displayOrder:2}}),this.internalGraphicsLayer.add(this._visualElementGraphics.activeVertex),this.internalGraphicsLayer.graphics.sort(T),Object(l.c)((function(){Object(h.k)(t._visualElementGraphics.activeVertex)&&(t.internalGraphicsLayer.remove(t._visualElementGraphics.activeVertex),t._visualElementGraphics.activeVertex=Object(h.e)(t._visualElementGraphics.activeVertex))})))}},{key:"onOutlineChanged",value:function(e){var t=this,n=e.clone();if("polyline"===n.type){var r=n.paths[n.paths.length-1];r.splice(0,r.length-2)}return Object(h.k)(this._visualElementGraphics.outline)?(this._visualElementGraphics.outline.geometry=n,null):(this._visualElementGraphics.outline=new u.a({geometry:n,symbol:this._visualElementSymbols.outline,attributes:{displayOrder:0}}),this.internalGraphicsLayer.add(this._visualElementGraphics.outline),this.internalGraphicsLayer.graphics.sort(T),Object(l.c)((function(){Object(h.k)(t._visualElementGraphics.outline)&&(t.internalGraphicsLayer.remove(t._visualElementGraphics.outline),t._visualElementGraphics.outline=Object(h.e)(t._visualElementGraphics.outline))})))}},{key:"onRegularVerticesChanged",value:function(e){var t=this,n=new k.a({points:e,spatialReference:this.drawOperation.spatialReference});return Object(h.k)(this._visualElementGraphics.regularVertices)?(this._visualElementGraphics.regularVertices.geometry=n,null):(this._visualElementGraphics.regularVertices=new u.a({geometry:n,symbol:this._visualElementSymbols.regularVertices,attributes:{displayOrder:1}}),this.internalGraphicsLayer.add(this._visualElementGraphics.regularVertices),this.internalGraphicsLayer.graphics.sort(T),Object(l.c)((function(){Object(h.k)(t._visualElementGraphics.regularVertices)&&(t.internalGraphicsLayer.remove(t._visualElementGraphics.regularVertices),t._visualElementGraphics.regularVertices=Object(h.e)(t._visualElementGraphics.regularVertices))})))}}]),n}(O.a);function T(e,t){var n,r,a,i;return(null!=(n=null==(r=e.attributes)?void 0:r.displayOrder)?n:-1/0)-(null!=(a=null==(i=t.attributes)?void 0:i.displayOrder)?a:-1/0)}Object(c.a)([Object(d.b)()],E.prototype,"activeFillSymbol",void 0),Object(c.a)([Object(d.b)({readOnly:!0})],E.prototype,"type",void 0),Object(c.a)([Object(d.b)({constructOnly:!0,nonNullable:!0})],E.prototype,"view",void 0),E=Object(c.a)([Object(p.a)("esri.views.2d.interactive.draw.DrawGraphicTool2D")],E)},565:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return x})),n.d(t,"f",(function(){return k})),n.d(t,"g",(function(){return E}));var r=n(23),a=n(7),i=n(73);var o=function(e,t,n){return[t,n]},s=function(e,t,n){return[t,n,e[2]]},c=function(e,t,n){return[t,n,e[2],e[3]]};function u(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function l(e,t){var n=e.scale,r=e.translate;return Math.round((t-r[0])/n[0])}function h(e,t){var n=e.scale,r=e.translate;return Math.round((r[1]-t)/n[1])}function d(e,t,n){for(var r,a,i,o,s=[],c=0;c<n.length;c++){var u=n[c];c>0?(i=l(e,u[0]),o=h(e,u[1]),i===r&&o===a||(s.push(t(u,i-r,o-a)),r=i,a=o)):(r=l(e,u[0]),a=h(e,u[1]),s.push(t(u,r,a)))}return s.length>0?s:null}function p(e,t){var n=e.scale,r=e.translate;return t*n[0]+r[0]}function f(e,t){var n=e.scale;return e.translate[1]-t*n[1]}function v(e,t,n){var a=new Array(n.length);if(!n.length)return a;var i=Object(r.a)(e.scale,2),o=i[0],s=i[1],c=p(e,n[0][0]),u=f(e,n[0][1]);a[0]=t(n[0],c,u);for(var l=1;l<n.length;l++){var h=n[l];c+=h[0]*o,u-=h[1]*s,a[l]=t(h,c,u)}return a}function y(e,t,n){for(var r=new Array(n.length),a=0;a<n.length;a++)r[a]=v(e,t,n[a]);return r}function b(e,t,n,r,a){return t.points=function(e,t,n,r){return d(e,n?r?c:s:r?s:o,t)}(e,n.points,r,a),t}function m(e,t,n,r,a){return t.x=l(e,n.x),t.y=h(e,n.y),t!==n&&(r&&(t.z=n.z),a&&(t.m=n.m)),t}function g(e,t,n,r,a){var i=function(e,t,n,r){for(var a=[],i=n?r?c:s:r?s:o,u=0;u<t.length;u++){var l=d(e,i,t[u]);l&&l.length>=3&&a.push(l)}return a.length?a:null}(e,n.rings,r,a);return i?(t.rings=i,t):null}function O(e,t,n,r,a){var i=function(e,t,n,r){for(var a=[],i=n?r?c:s:r?s:o,u=0;u<t.length;u++){var l=d(e,i,t[u]);l&&l.length>=2&&a.push(l)}return a.length?a:null}(e,n.paths,r,a);return i?(t.paths=i,t):null}function _(e,t){return e&&t?Object(i.f)(t)?m(e,{},t,!1,!1):Object(i.h)(t)?O(e,{},t,!1,!1):Object(i.g)(t)?g(e,{},t,!1,!1):Object(i.e)(t)?b(e,{},t,!1,!1):Object(i.d)(t)?function(e,t,n,r,a){return t.xmin=l(e,n.xmin),t.ymin=h(e,n.ymin),t.xmax=l(e,n.xmax),t.ymax=h(e,n.ymax),t!==n&&(r&&(t.zmin=n.zmin,t.zmax=n.zmax),a&&(t.mmin=n.mmin,t.mmax=n.mmax)),t}(e,{},t,!1,!1):null:null}function j(e,t,n,r,i){return Object(a.k)(n)&&(t.points=function(e,t,n,r){return v(e,n?r?c:s:r?s:o,t)}(e,n.points,r,i)),t}function x(e,t,n,r,i){return Object(a.j)(n)||(t.x=p(e,n.x),t.y=f(e,n.y),t!==n&&(r&&(t.z=n.z),i&&(t.m=n.m))),t}function k(e,t,n,r,i){return Object(a.k)(n)&&(t.rings=function(e,t,n,r){return y(e,n?r?c:s:r?s:o,t)}(e,n.rings,r,i)),t}function E(e,t,n,r,i){return Object(a.k)(n)&&(t.paths=function(e,t,n,r){return y(e,n?r?c:s:r?s:o,t)}(e,n.paths,r,i)),t}},611:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return d}));var r=n(13),a=n(2),i=(n(711),n(12),n(7)),o=(n(162),n(236),n(39),n(304)),s=n(139),c=(n(565),n(197),n(214),n(669),function e(t,n,r){Object(a.a)(this,e),this.uid=t,this.geometry=n,this.attributes=r,this.visible=!0,this.objectId=null,this.centroid=null});function u(e){return Object(i.k)(e.geometry)}var l=function e(){Object(a.a)(this,e),this.exceededTransferLimit=!1,this.features=[],this.fields=[],this.hasM=!1,this.hasZ=!1,this.geometryType=null,this.objectIdFieldName=null,this.globalIdFieldName=null,this.geometryProperties=null,this.geohashFieldName=null,this.spatialReference=null,this.transform=null};function h(e,t,n,r){return{x:e,y:t,z:n,hasZ:null!=n,hasM:!1,spatialReference:r,type:"point"}}function d(e){if(Object(i.j)(e))return 0;switch(e.type){case"point":return 1;case"polyline":var t,n=0,a=Object(r.a)(e.paths);try{for(a.s();!(t=a.n()).done;){n+=t.value.length}}catch(l){a.e(l)}finally{a.f()}return n;case"polygon":var o,s=0,c=Object(r.a)(e.rings);try{for(c.s();!(o=c.n()).done;){s+=o.value.length}}catch(l){c.e(l)}finally{c.f()}return s;case"multipoint":return e.points.length;case"extent":return 2;case"mesh":var u=e.vertexAttributes&&e.vertexAttributes.position;return u?u.length/3:0;default:return}}function p(e,t){switch(Object(o.h)(t),"mesh"===e.type&&(e=e.extent),e.type){case"point":t[0]=t[3]=e.x,t[1]=t[4]=e.y,e.hasZ&&(t[2]=t[5]=e.z);break;case"polyline":for(var n=0;n<e.paths.length;n++)Object(o.l)(t,e.paths[n],e.hasZ);break;case"polygon":for(var r=0;r<e.rings.length;r++)Object(o.l)(t,e.rings[r],e.hasZ);break;case"multipoint":Object(o.l)(t,e.points,e.hasZ);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[3]=e.xmax,t[4]=e.ymax,null!=e.zmin&&(t[2]=e.zmin),null!=e.zmax&&(t[5]=e.zmax)}}function f(e,t){switch(Object(s.m)(t),"mesh"===e.type&&(e=e.extent),e.type){case"point":t[0]=t[2]=e.x,t[1]=t[3]=e.y;break;case"polyline":for(var n=0;n<e.paths.length;n++)Object(s.p)(t,e.paths[n]);break;case"polygon":for(var r=0;r<e.rings.length;r++)Object(s.p)(t,e.rings[r]);break;case"multipoint":Object(s.p)(t,e.points);break;case"extent":t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax}}function v(e,t){return null!=e.objectId?e.objectId:e.attributes&&t?e.attributes[t]:null}Object(o.f)(),Object(s.l)()},652:function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return x})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return k})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return O})),n.d(t,"j",(function(){return _}));var r=n(2),a=n(3),i=n(10),o=n(13),s=(n(124),n(19)),c=n(65),u=n(7),l=n(35),h=n(79),d=n(383),p=n(760);function f(e,t){return e.events.on("drag",function(e,t){var n=null,r=null;return function(a){if("cancel"!==a.action){var i={action:a.action,screenStart:a.start,screenEnd:a.screenPoint};"start"===a.action&&Object(u.j)(n)&&(n=new E,r=new E,t(e,n,r,a.pointerType,i)),Object(u.k)(n)&&n.execute(i),"end"===a.action&&Object(u.k)(n)&&(n=null,r=null)}else Object(u.k)(r)&&(r.execute({action:"cancel"}),n=null,r=null)}}(e,t))}function v(e,t){var n=[e.x,e.y,e.z],r=t,a=[Math.cos(r),Math.sin(r)],i=Math.sqrt(a[0]*a[0]+a[1]*a[1]);if(0===i)return null;a[0]/=i,a[1]/=i;var o=function(e){var t=(e.x-n[0])*a[0]+(e.y-n[1])*a[1];e.x=n[0]+t*a[0],e.y=n[1]+t*a[1]};return function(e){return o(e.mapStart),o(e.mapEnd),e}}function y(e,t){var n=null;return function(r){if("start"===r.action&&(n=function(e,t,n){var r=e.geometry;if(Object(u.j)(r))return null;if("mesh"===r.type)return function(e,t,n,r){if(Object(u.k)(t.transform))return function(e,t,n,r){var a=b(n.getOriginPoint(t.spatialReference),r),i=t.spatialReference;return Object(u.j)(a)?null:{move:function(t,r,o){var s=Object(p.d)(a.clone(),t,r,o);if(s.spatialReference.equals(i))n.origin=Object(h.g)(s.x,s.y,s.z);else{var c=Object(d.j)(s,i);Object(u.k)(c)&&(n.origin=Object(h.g)(c.x,c.y,c.z))}e.notifyGeometryChanged()}}}(e,t,t.transform,n);if(!t.spatialReference.equals(n))return null;var a=0,i=0,o=0;return{move:function(n,s,c){var u=n-a,l=s-i,h=c-o;if(u||l||h){var d=t.origin.clone().offset(u,l,h);t.centerAt(d,{geographic:1===r}),e.notifyGeometryChanged(),a=n,i=s,o=c}}}}(e,r,t,n);var a=b(r,t),i=r.spatialReference;return Object(u.j)(a)?null:{move:function(t,n,r){var o=Object(p.d)(a.clone(),t,n,r);o.spatialReference.equals(i)?e.geometry=o:e.geometry=Object(d.j)(o,i)}}}(e,r.mapStart.spatialReference,t)),Object(u.j)(n))return null;var a=r.mapEnd.x-r.mapStart.x,o=r.mapEnd.y-r.mapStart.y,s=r.mapEnd.z-r.mapStart.z;return n.move(a,o,s),Object(i.a)(Object(i.a)({},r),{},{translationX:a,translationY:o,translationZ:s})}}function b(e,t){return Object(u.j)(e)?null:e.spatialReference.equals(t)?e.clone():Object(d.j)(e,t)}function m(e,t){var n=e.map((function(e){return Object(u.s)(y(e,t))})).filter((function(e){return Object(u.k)(e)}));return function(e){var t=e.mapEnd.x-e.mapStart.x,r=e.mapEnd.y-e.mapStart.y,a=e.mapEnd.z-e.mapStart.z;return n.forEach((function(t){return t(e)})),Object(i.a)(Object(i.a)({},e),{},{translationX:t,translationY:r,translationZ:a})}}function g(e,t){var n,r=new Map,a=Object(o.a)(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;r.set(i,Object(s.a)(e[i]))}}catch(c){a.e(c)}finally{a.f()}return function(t){return r.forEach((function(t,n){e[n]=t})),t}}function O(e){return Object(u.k)(e.geometry)&&"mesh"===e.geometry.type?function(e,t){var n=Object(u.k)(t.transform)?t.transform.clone():null,r=t.vertexAttributes.clonePositional();return function(a){return t.transform=n,t.vertexAttributes=r,e.notifyGeometryChanged(),a}}(e,e.geometry):g(e,["geometry"])}function _(e){var t=e.map((function(e){return Object(u.s)(O(e))})).filter((function(e){return Object(u.k)(e)}));return function(e){return t.forEach((function(t){return t(e)})),e}}function j(){var e=0,t=0,n=0;return function(r){"start"===r.action&&(e=r.mapStart.x,t=r.mapStart.y,n=r.mapStart.z);var a=r.mapEnd.x-e,o=r.mapEnd.y-t,s=r.mapEnd.z-n;return e=r.mapEnd.x,t=r.mapEnd.y,n=r.mapEnd.z,Object(i.a)(Object(i.a)({},r),{},{mapDeltaX:a,mapDeltaY:o,mapDeltaZ:s,mapDeltaSpatialReference:r.mapStart.spatialReference})}}function x(){var e=0,t=0;return function(n){"start"===n.action&&(e=n.screenStart.x,t=n.screenStart.y);var r=n.screenEnd.x-e,a=n.screenEnd.y-t;return e=n.screenEnd.x,t=n.screenEnd.y,Object(i.a)(Object(i.a)({},n),{},{screenDeltaX:r,screenDeltaY:a})}}function k(e,t){var n=null,r=0,a=0;return function(i){if("start"===i.action&&((n=e.toScreen(t)).x<0||n.x>e.width||n.y<0||n.y>e.height?n=null:(r=i.screenStart.x-n.x,a=i.screenStart.y-n.y)),null==n)return null;var o=Object(c.d)(i.screenEnd.x-r,0,e.width),s=Object(c.d)(i.screenEnd.y-a,0,e.height),u=Object(l.e)(o,s);return i.screenStart=n,i.screenEnd=u,i}}var E=function(){function e(){Object(r.a)(this,e),this.execute=function(){}}return Object(a.a)(e,[{key:"next",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return Object(u.k)(t)&&(this.execute=function(e){var r=t(e);Object(u.k)(r)&&n.execute(r)}),n}}]),e}()},667:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return M})),n.d(t,"e",(function(){return y})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return R})),n.d(t,"h",(function(){return u}));var r=n(562),a=n(610),i=n(79),o=n(46),s=n(58),c=n(406);function u(e,t,n){n*=.5;var r=Math.sin(n);return e[0]=r*t[0],e[1]=r*t[1],e[2]=r*t[2],e[3]=Math.cos(n),e}function l(e,t){var n=2*Math.acos(t[3]),r=Math.sin(n/2);return r>o.a?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),n}function h(e,t,n){var r=t[0],a=t[1],i=t[2],o=t[3],s=n[0],c=n[1],u=n[2],l=n[3];return e[0]=r*l+o*s+a*u-i*c,e[1]=a*l+o*c+i*s-r*u,e[2]=i*l+o*u+r*c-a*s,e[3]=o*l-r*s-a*c-i*u,e}function d(e,t,n,r){var a,i,s,c,u,l=t[0],h=t[1],d=t[2],p=t[3],f=n[0],v=n[1],y=n[2],b=n[3];return(i=l*f+h*v+d*y+p*b)<0&&(i=-i,f=-f,v=-v,y=-y,b=-b),1-i>o.a?(a=Math.acos(i),s=Math.sin(a),c=Math.sin((1-r)*a)/s,u=Math.sin(r*a)/s):(c=1-r,u=r),e[0]=c*l+u*f,e[1]=c*h+u*v,e[2]=c*d+u*y,e[3]=c*p+u*b,e}function p(e,t){var n=t[0],r=t[1],a=t[2],i=t[3],o=n*n+r*r+a*a+i*i,s=o?1/o:0;return e[0]=-n*s,e[1]=-r*s,e[2]=-a*s,e[3]=i*s,e}function f(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function v(e,t){var n,r=t[0]+t[4]+t[8];if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var a=0;t[4]>t[0]&&(a=1),t[8]>t[3*a+a]&&(a=2);var i=(a+1)%3,o=(a+2)%3;n=Math.sqrt(t[3*a+a]-t[3*i+i]-t[3*o+o]+1),e[a]=.5*n,n=.5/n,e[3]=(t[3*i+o]-t[3*o+i])*n,e[i]=(t[3*i+a]+t[3*a+i])*n,e[o]=(t[3*o+a]+t[3*a+o])*n}return e}function y(e,t,n,r){var a=.5*Math.PI/180;t*=a,n*=a,r*=a;var i=Math.sin(t),o=Math.cos(t),s=Math.sin(n),c=Math.cos(n),u=Math.sin(r),l=Math.cos(r);return e[0]=i*c*l-o*s*u,e[1]=o*s*l+i*c*u,e[2]=o*c*u-i*s*l,e[3]=o*c*l+i*s*u,e}var b=c.c,m=c.l,g=c.a,O=h,_=c.b,j=c.d,x=c.j,k=c.e,E=k,T=c.f,w=T,S=c.k,M=c.g,I=c.h;function R(e,t,n){var r=Object(s.h)(t,n);return r<-.999999?(Object(s.g)(A,V,t),Object(s.y)(A)<1e-6&&Object(s.g)(A,G,t),Object(s.r)(A,A),u(e,A,Math.PI),e):r>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(Object(s.g)(A,t,n),e[0]=A[0],e[1]=A[1],e[2]=A[2],e[3]=1+r,S(e,e))}var A=Object(i.e)(),V=Object(i.g)(1,0,0),G=Object(i.g)(0,1,0);var C=Object(a.b)(),P=Object(a.b)();var L=Object(r.b)();Object.freeze({__proto__:null,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},setAxisAngle:u,getAxisAngle:l,multiply:h,rotateX:function(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c+o*s,e[1]=a*c+i*s,e[2]=i*c-a*s,e[3]=o*c-r*s,e},rotateY:function(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c-i*s,e[1]=a*c+o*s,e[2]=i*c+r*s,e[3]=o*c-a*s,e},rotateZ:function(e,t,n){n*=.5;var r=t[0],a=t[1],i=t[2],o=t[3],s=Math.sin(n),c=Math.cos(n);return e[0]=r*c+a*s,e[1]=a*c-r*s,e[2]=i*c+o*s,e[3]=o*c-i*s,e},calculateW:function(e,t){var n=t[0],r=t[1],a=t[2];return e[0]=n,e[1]=r,e[2]=a,e[3]=Math.sqrt(Math.abs(1-n*n-r*r-a*a)),e},slerp:d,random:function(e){var t=Object(o.b)(),n=Object(o.b)(),r=Object(o.b)(),a=Math.sqrt(1-t),i=Math.sqrt(t);return e[0]=a*Math.sin(2*Math.PI*n),e[1]=a*Math.cos(2*Math.PI*n),e[2]=i*Math.sin(2*Math.PI*r),e[3]=i*Math.cos(2*Math.PI*r),e},invert:p,conjugate:f,fromMat3:v,fromEuler:y,str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},copy:b,set:m,add:g,mul:O,scale:_,dot:j,lerp:x,length:k,len:E,squaredLength:T,sqrLen:w,normalize:S,exactEquals:M,equals:I,rotationTo:R,sqlerp:function(e,t,n,r,a,i){return d(C,t,a,i),d(P,n,r,i),d(e,C,P,2*i*(1-i)),e},setAxes:function(e,t,n,r){var a=L;return a[0]=n[0],a[3]=n[1],a[6]=n[2],a[1]=r[0],a[4]=r[1],a[7]=r[2],a[2]=-t[0],a[5]=-t[1],a[8]=-t[2],S(e,v(e,a))}})},669:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));n(12),n(7);function r(e,t){return!!a(e.spatialReference,t.spatialReference)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.m===t.m}function a(e,t){return e===t||e&&t&&e.equals(t)}},679:function(e,t,n){"use strict";n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return V}));var r,a,i=n(2),o=n(3),s=n(14),c=n(5),u=n(6),l=n(0),h=n(29),d=n(11),p=n(7),f=n(386),v=n(212),y=n(21),b=n(142),m=n(25),g=n(1),O=(n(12),n(15),n(8)),_=n(755),j=n(761),x=d.a.getLogger("esri.views.support.Scheduler");(a=r||(r={})).RESOURCE_CONTROLLER="schedule",a.SLIDE="slide",a.STREAM_DATA_LOADER="stream loader",a.ELEVATION_QUERY="elevation query",a.TERRAIN_SURFACE="terrain",a.SURFACE_GEOMETRY_UPDATES="surface geometry updates",a.GRAPHICS_CORE="Graphics3D",a.I3S_CONTROLLER="I3S",a.POINT_CLOUD_LAYER="point cloud",a.FEATURE_TILE_FETCHER="feature fetcher",a.OVERLAY="overlay",a.STAGE="stage",a.GRAPHICS_DECONFLICTOR="graphics deconflictor",a.FILTER_VISIBILITY="Graphics3D filter visibility",a.SCALE_VISIBILITY="Graphics3D scale visibility",a.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",a.POINT_OF_INTEREST_FREQUENT="POI frequent",a.POINT_OF_INTEREST_INFREQUENT="POI infrequent",a.LABELER="labeler",a.FEATURE_QUERY_ENGINE="feature query",a.FEATURE_TILE_TREE="feature tile tree",a.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",a.ELEVATION_ALIGNMENT="elevation alignment",a.TEXT_TEXTURE_ATLAS="text texture atlas",a.TEXTURE_UNLOAD="texture unload",a.LINE_OF_SIGHT_TOOL="line of sight tool",a.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",a.ELEVATION_PROFILE="elevation profile",a.SNAPPING="snapping",a.SHADOW_ACCUMULATOR="shadow accumulator",a[a.TEST_PRIO=1]="TEST_PRIO";var k=new Map([[r.RESOURCE_CONTROLLER,0],[r.SLIDE,0],[r.STREAM_DATA_LOADER,0],[r.ELEVATION_QUERY,0],[r.TERRAIN_SURFACE,1],[r.SURFACE_GEOMETRY_UPDATES,1],[r.GRAPHICS_CORE,2],[r.I3S_CONTROLLER,2],[r.POINT_CLOUD_LAYER,2],[r.FEATURE_TILE_FETCHER,2],[r.OVERLAY,4],[r.STAGE,4],[r.GRAPHICS_DECONFLICTOR,4],[r.FILTER_VISIBILITY,4],[r.SCALE_VISIBILITY,4],[r.FRUSTUM_VISIBILITY,4],[r.POINT_OF_INTEREST_FREQUENT,6],[r.POINT_OF_INTEREST_INFREQUENT,30],[r.LABELER,8],[r.FEATURE_QUERY_ENGINE,8],[r.FEATURE_TILE_TREE,16],[r.FEATURE_TILE_TREE_ACTIVE,0],[r.ELEVATION_ALIGNMENT,12],[r.TEXT_TEXTURE_ATLAS,12],[r.TEXTURE_UNLOAD,12],[r.LINE_OF_SIGHT_TOOL,16],[r.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[r.SNAPPING,0],[r.SHADOW_ACCUMULATOR,30]]);function E(e){return k.has(e)?k.get(e):"number"==typeof e?e:1}var T,w,S=Object(b.a)(6.5),M=Object(b.a)(1),I=Object(b.a)(30),R=Object(b.a)(1e3/30),A=Object(b.a)(100);!function(e){var t=function(e){Object(c.a)(l,e);var t=Object(u.a)(l);function l(e){var n,o;Object(i.a)(this,l),(n=t.call(this,e)).updating=!0,n.performanceInfo={total:new f.a("total"),tasks:new Map},n._frameTaskTimes=new Map,n._budget=null,n._state=1,n._tasks=new v.a,n._runQueue=new v.a,n._load=0,n._idleStateCallbacks=new v.a,n._idleUpdatesStartFired=!1,n._maxReschedule=P,n._forceTask=!1,n._debug=!1,n._debugHandle=Object(m.a)(j.a,"SCHEDULER_LOG_SLOW_TASKS",(function(e){return n._debug=e})),n._budget=new a(e.nowFunc);for(var c=0,u=Object.keys(r);c<u.length;c++){var h=u[c];n.performanceInfo.tasks.set(r[h],new f.a(r[h]))}var d=Object(s.a)(n);return n._test={get state(){return Object(p.j)(o)?d._state:o},set state(e){o=e},FRAME_SAFETY_BUDGET:S,INTERACTING_BUDGET:R,IDLE_BUDGET:A,get budget(){return d._budget.budget},usedBudget:0,updateTask:function(e){return n._updateTask(e)},getState:function(e){return n._getState(e)},getRuntime:function(e){return n._getRuntime(e)},resetRuntimes:function(){return n._resetRuntimes()},getRunning:function(){return n._getRunning()}},n}return Object(o.a)(l,[{key:"destroy",value:function(){this._debugHandle&&this._debugHandle.remove()}},{key:"registerTask",value:function(e,t){var r=E(e),a=new n(this,e,t,r);return this._tasks.push(a),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new f.a(e)),a}},{key:"registerIdleStateCallbacks",value:function(e,t){var n=this,r={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(r),2===this.state&&this._idleUpdatesStartFired&&r.idleBegin();var a=this;return{remove:function(){return n._removeIdleStateCallbacks(r)},set idleBegin(e){a._idleUpdatesStartFired&&(r.idleEnd(),2===a._state&&e()),r.idleBegin=e},set idleEnd(e){r.idleEnd=e}}}},{key:"now",get:function(){return this.nowFunc()}},{key:"load",get:function(){return this._load}},{key:"state",get:function(){return Object(p.j)(this._test.state)?this._state:this._test.state},set:function(e){this._state!==e&&(this._state=e,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((function(e){return e.idleEnd()}))))}},{key:"updateBudget",value:function(e){this._test.usedBudget=0;var t=S,n=e.frameDuration,r=M;switch(this.state){case 2:t=Object(b.a)(0),n=Object(b.a)(Math.max(A,e.frameDuration)),r=I;break;case 1:n=Object(b.a)(Math.max(R,e.frameDuration))}return n=Object(b.a)(n-e.elapsedFrameTime-t),2!==this.state&&n<M&&!this._forceTask?(this._forceTask=!0,!1):(n=Object(b.a)(Math.max(n,r)),this._budget.reset(n,this.state),this._maxReschedule=P,this._updateLoad(),this._schedule())}},{key:"frame",value:function(){switch(this._forceTask=!1,this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((function(e){return e.idleBegin()}))),this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}},{key:"stopFrame",value:function(){this._budget.reset(Object(b.a)(0),this._state),this._budget.madeProgress()}},{key:"_removeIdleStateCallbacks",value:function(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}},{key:"removeTask",value:function(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e)}},{key:"_updateTask",value:function(e){this._tasks.forAll((function(t){t.name===e&&t.setPriority(e)}))}},{key:"_getState",value:function(e){if(this._runQueue.some((function(t){return t.name===e})))return w.SCHEDULED;var t=w.IDLE;return this._tasks.forAll((function(n){n.name===e&&n.needsUpdate&&(n.schedulePriority<=1?t=w.READY:t!==w.READY&&(t=w.WAITING))})),t}},{key:"_getRuntime",value:function(e){var t=0;return this._tasks.forAll((function(n){n.name===e&&(t+=n.runtime)})),t}},{key:"_resetRuntimes",value:function(){this._tasks.forAll((function(e){return e.runtime=0}))}},{key:"_getRunning",value:function(){var e=new Map;if(this._tasks.forAll((function(t){t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;var t="";return e.forEach((function(e,n){t+=e>1?" ".concat(e,"x ").concat(n):" ".concat(n)})),t}},{key:"_runIdle",value:function(){this._run()}},{key:"_runInteracting",value:function(){this._run()}},{key:"_runAnimating",value:function(){this._run()}},{key:"_updateLoad",value:function(){var e=this._tasks.reduce((function(e,t){return t.needsUpdate?++e:e}),0);this._load=.9*this._load+e*(1-.9)}},{key:"_schedule",value:function(){var e=this;if(this._maxReschedule<=0)return!1;var t=function(){var t=!1,n=0;if(e._tasks.forAll((function(r){r.needsUpdate&&0!==r.schedulePriority&&0!==r.basePriority&&(t=!0,n=Math.max(n,r.basePriority),1===r.schedulePriority?(r.schedulePriority=0,e._runQueue.push(r)):--r.schedulePriority)})),!t)return{v:(e.updating=!1,!1)};e._maxReschedule===P&&(e._maxReschedule=n),--e._maxReschedule};for(this._runQueue.filterInPlace((function(e){return!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1)})),this._tasks.forAll((function(t){0===t.basePriority&&t.needsUpdate&&!e._runQueue.some((function(e){return e===t}))&&e._runQueue.unshift(t)}));0===this._runQueue.length;){var n=t();if("object"===typeof n)return n.v}return this.updating=!0,!0}},{key:"_run",value:function(){var e=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){var t=this._budget.now(),n=this._runQueue.pop();this._budget.resetProgress();try{n.task.runTask(this._budget)}catch(a){x.error('Exception in task "'.concat(n.name,'"'),a)}n.schedulePriority=n.basePriority;var r=this._budget.now()-t;if(n.runtime+=r,this._frameTaskTimes.set(n.priority,this._frameTaskTimes.get(n.priority)+r),this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",n.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this._recordFrameTaskTimes(this._budget.now()-e)}},{key:"_startFrameTaskTimes",value:function(){for(var e=0,t=Object.keys(r);e<t.length;e++){var n=t[e];this._frameTaskTimes.set(r[n],0)}}},{key:"_recordFrameTaskTimes",value:function(e){var t=this;this._frameTaskTimes.forEach((function(e,n){return t.performanceInfo.tasks.get(n).record(e)})),this.performanceInfo.total.record(e)}},{key:"test",get:function(){return this._test}}]),l}(h.a);Object(l.a)([Object(g.b)()],t.prototype,"updating",void 0),Object(l.a)([Object(g.b)()],t.prototype,"nowFunc",void 0),t=Object(l.a)([Object(O.a)("esri.views.support.Scheduler")],t),e.Scheduler=t;var n=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e,r,a,o){var s;return Object(i.a)(this,n),(s=t.call(this,{}))._scheduler=e,s.name=r,s._basePriority=o,s.runtime=0,s._queue=new _.a,s.updating=!1,s.schedulePriority=s._basePriority,s.task=Object(p.k)(a)?a:{running:!1,runTask:function(e){return s.processQueue(e)}},s}return Object(o.a)(n,[{key:"normalizeCtorArgs",value:function(){return{}}},{key:"remove",value:function(){this.processQueue(V),this._scheduler.removeTask(this),this.schedule=C.schedule,this.reschedule=C.reschedule}},{key:"basePriority",get:function(){return this._basePriority}},{key:"setPriority",value:function(e){this.name=e;var t=E(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}},{key:"priority",get:function(){return this.name},set:function(e){this.setPriority(e)}},{key:"needsUpdate",get:function(){return this.updating||this.task.running}},{key:"schedule",value:function(e,t,n){return this.updating=!0,this._queue.push(e,t,n)}},{key:"reschedule",value:function(e,t,n){return this.updating=!0,this._queue.unshift(e,t,n)}},{key:"processQueue",value:function(e){for(;!e.done&&this._queue.process();)e.madeProgress();this.updating=this._queue.length>0}}]),n}(h.a);Object(l.a)([Object(g.b)()],n.prototype,"updating",void 0),n=Object(l.a)([Object(O.a)("esri.views.support.SchedulerTask")],n);var a=function(){function e(t){Object(i.a)(this,e),this.now=t,this._begin=0,this._budget=0,this._state=2,this._didWork=!1,this._enabled=!0}return Object(o.a)(e,[{key:"run",value:function(e){return!this.done&&(!0===e()&&(this._didWork=!0),!0)}},{key:"done",get:function(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}},{key:"budget",get:function(){return this._budget}},{key:"madeProgress",value:function(){this._didWork=!0}},{key:"state",get:function(){return this._state}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"reset",value:function(e,t){this._begin=this.now(),this._budget=e,this._state=t,this._didWork=!1}},{key:"remaining",get:function(){return Math.max(this._budget-this.elapsed,0)}},{key:"elapsed",get:function(){return this.now()-this._begin}},{key:"resetProgress",value:function(){this._didWork=!1}},{key:"hasProgressed",get:function(){return this._didWork}}]),e}();e.Budget=a}(T||(T={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(w||(w={}));var V=function(){var e=new T.Budget((function(){return performance.now()}));return e.enabled=!1,e}(),G=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,[{key:"remove",value:function(){}},{key:"processQueue",value:function(){}},{key:"schedule",value:function(e,t,n){try{if(Object(y.n)(t)){var r=Object(y.e)();return n?Promise.resolve(n(r)):Promise.reject(r)}return Object(y.x)(e())}catch(a){return Promise.reject(a)}}},{key:"reschedule",value:function(e,t,n){return this.schedule(e,t,n)}}]),e}(),C=new G,P=Number.MAX_SAFE_INTEGER},711:function(e,t,n){"use strict";function r(e){return 32+e.length}function a(e){if(!e)return 0;var t=32;for(var n in e)if(e.hasOwnProperty(n)){var a=e[n];switch(typeof a){case"string":t+=r(a);break;case"number":t+=16;break;case"boolean":t+=4}}return t}function i(e,t){return 32+e.length*t}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}))},755:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(13),a=n(2),i=n(3),o=n(21),s=function(){function e(){Object(a.a)(this,e),this._tasks=new Array}return Object(i.a)(e,[{key:"length",get:function(){return this._tasks.length}},{key:"push",value:function(e,t,n){var r=this;return new Promise((function(a,i){return r._tasks.push(new c(a,i,e,t,n))}))}},{key:"unshift",value:function(e,t,n){var r=this;return new Promise((function(a,i){return r._tasks.unshift(new c(a,i,e,t,n))}))}},{key:"process",value:function(){if(0===this._tasks.length)return!1;var e=this._tasks.shift();try{var t=Object(o.n)(e.signal);if(t&&!e.abortCallback)e.reject(Object(o.e)());else{var n=t?e.abortCallback(Object(o.e)()):e.callback();Object(o.o)(n)?n.then(e.resolve,e.reject):e.resolve(n)}}catch(c){e.reject(c)}return!0}},{key:"cancelAll",value:function(){var e,t=Object(o.e)(),n=Object(r.a)(this._tasks);try{for(n.s();!(e=n.n()).done;){var a=e.value;if(a.abortCallback){var i=a.abortCallback(t);a.resolve(i)}else a.reject(t)}}catch(s){n.e(s)}finally{n.f()}this._tasks.length=0}}]),e}(),c=function e(t,n,r,i,o){Object(a.a)(this,e),this.resolve=t,this.reject=n,this.callback=r,this.signal=i,this.abortCallback=o}},760:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return l}));var r=n(23),a=n(65),i=n(139),o=n(303),s=n(177);function c(e,t,n,r){if(null==r||e.hasZ||(r=void 0),"point"===e.type)return e.x+=t,e.y+=n,e.hasZ&&null!=r&&(e.z+=r),e;if("multipoint"===e.type){for(var a=e.points,i=0;i<a.length;i++)a[i]=p(a[i],t,n,r);return e}if("extent"===e.type)return e.xmin+=t,e.xmax+=t,e.ymin+=n,e.ymax+=n,null!=r&&(e.zmin+=r,e.zmax+=r),e;for(var o=Object(s.b)(e),c="polyline"===e.type?e.paths:e.rings,u=0;u<o.length;u++)for(var l=o[u],h=0;h<l.length;h++)l[h]=p(l[h],t,n,r);return"paths"in e?e.paths=c:e.rings=c,e}function u(e,t,n,r,a){var i=e.clone(),o=r.resolution;if("point"===i.type){if(a)c(i,t*o,-n*o);else{var u=r.state.transform,l=r.state.inverseTransform,h=u[0]*i.x+u[2]*i.y+u[4],d=u[1]*i.x+u[3]*i.y+u[5];i.x=l[0]*(h+t)+l[2]*(d+n)+l[4],i.y=l[1]*(h+t)+l[3]*(d+n)+l[5]}return i}if("multipoint"===i.type){if(a)c(i,t*o,-n*o);else for(var p=i.points,v=r.state.transform,y=r.state.inverseTransform,b=0;b<p.length;b++){var m=p[b],g=v[0]*m[0]+v[2]*m[1]+v[4],O=v[1]*m[0]+v[3]*m[1]+v[5],_=y[0]*(g+t)+y[2]*(O+n)+y[4],j=y[1]*(g+t)+y[3]*(O+n)+y[5];p[b]=f(m,_,j,void 0)}return i}if("extent"===i.type){if(a)c(i,t*o,-n*o);else{var x=r.state.transform,k=r.state.inverseTransform,E=x[0]*i.xmin+x[2]*i.ymin+x[4],T=x[1]*i.xmin+x[3]*i.ymin+x[5],w=x[0]*i.xmax+x[2]*i.ymax+x[4],S=x[1]*i.xmax+x[3]*i.ymax+x[5];i.xmin=k[0]*(E+t)+k[2]*(T+n)+k[4],i.ymin=k[1]*(E+t)+k[3]*(T+n)+k[5],i.xmax=k[0]*(w+t)+k[2]*(S+n)+k[4],i.ymax=k[1]*(w+t)+k[3]*(S+n)+k[5]}return i}if(a)c(i,t*o,-n*o);else{for(var M=Object(s.b)(i),I="polyline"===i.type?i.paths:i.rings,R=r.state.transform,A=r.state.inverseTransform,V=0;V<M.length;V++)for(var G=M[V],C=0;C<G.length;C++){var P=G[C],L=R[0]*P[0]+R[2]*P[1]+R[4],F=R[1]*P[0]+R[3]*P[1]+R[5],D=A[0]*(L+t)+A[2]*(F+n)+A[4],U=A[1]*(L+t)+A[3]*(F+n)+A[5];G[C]=f(P,D,U,void 0)}"paths"in i?i.paths=I:i.rings=I}return i}function l(e,t,n,a){if("point"===e.type){var c=e.x,u=e.y,l=a?a[0]:c,h=a?a[1]:u,d=e.clone(),p=(c-l)*t+l,v=(u-h)*n+h;return d.x=p,d.y=v,d}if("multipoint"===e.type){for(var y=Object(s.b)(e),b=Object(i.l)(),m=Object(o.d)(b,[y]),g=Object(r.a)(m,4),O=g[0],_=g[1],j=g[2],x=g[3],k=a?a[0]:(O+j)/2,E=a?a[1]:(x+_)/2,T=e.clone(),w=T.points,S=0;S<w.length;S++){var M=w[S],I=Object(r.a)(M,2),R=(I[0]-k)*t+k,A=(I[1]-E)*n+E;w[S]=f(M,R,A,void 0)}return T}if("extent"===e.type){var V=e.xmin,G=e.xmax,C=e.ymin,P=e.ymax,L=a?a[0]:(V+G)/2,F=a?a[1]:(P+C)/2,D=e.clone();if(D.xmin=(V-L)*t+L,D.ymax=(P-F)*n+F,D.xmax=(G-L)*t+L,D.ymin=(C-F)*n+F,D.xmin>D.xmax){var U=D.xmin,z=D.xmax;D.xmin=z,D.xmax=U}if(D.ymin>D.ymax){var N=D.ymin,H=D.ymax;D.ymin=H,D.ymax=N}return D}for(var Z=Object(s.b)(e),W=Object(i.l)(),q=Object(o.d)(W,Z),B=Object(r.a)(q,4),Y=B[0],Q=B[1],X=B[2],J=B[3],K=a?a[0]:(Y+X)/2,$=a?a[1]:(J+Q)/2,ee=e.clone(),te="polyline"===ee.type?ee.paths:ee.rings,ne=0;ne<Z.length;ne++)for(var re=Z[ne],ae=0;ae<re.length;ae++){var ie=re[ae],oe=Object(r.a)(ie,2),se=(oe[0]-K)*t+K,ce=(oe[1]-$)*n+$;te[ne][ae]=f(ie,se,ce,void 0)}return"paths"in ee?ee.paths=te:ee.rings=te,ee}function h(e,t,n,r,a,i){var o=Math.sqrt((n-e)*(n-e)+(r-t)*(r-t));return Math.sqrt((a-e)*(a-e)+(i-t)*(i-t))/o}function d(e,t,n){var r=Math.atan2(t.y-n.y,t.x-n.x)-Math.atan2(e.y-n.y,e.x-n.x),i=Math.atan2(Math.sin(r),Math.cos(r));return Object(a.n)(i)}function p(e,t,n,r){return f(e,e[0]+t,e[1]+n,null!=e[2]&&null!=r?e[2]+r:void 0)}function f(e,t,n,r){var a=[t,n];return e.length>2&&a.push(null!=r?r:e[2]),e.length>3&&a.push(e[3]),a}},761:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(2),a=n(5),i=n(6),o=n(0),s=n(29),c=n(1),u=(n(12),n(15),n(11),n(8)),l=function(e){Object(a.a)(n,e);var t=Object(i.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.apply(this,arguments)).SCHEDULER_LOG_SLOW_TASKS=!1,e.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1,e}return n}(s.a);Object(o.a)([Object(c.b)()],l.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),Object(o.a)([Object(c.b)()],l.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0);var h=new(l=Object(o.a)([Object(u.a)("esri.views.support.DebugFlags")],l))},770:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(2),a=n(3),i=n(5),o=n(6),s=n(0),c=n(29),u=n(11),l=n(7),h=n(21),d=n(1),p=(n(12),n(15),n(8)),f=n(338),v=n(13),y=n(31),b=function(){function e(){Object(r.a)(this,e),this._isToolEditable=!0,this._manipulators=new y.a,this._nextManipulatorId=0,this._resourceContexts={manipulator3D:{}},this._attached=!1}return Object(a.a)(e,[{key:"isToolEditable",set:function(e){this._isToolEditable=e}},{key:"length",get:function(){return this._manipulators.length}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.addMany([e],t)[0]}},{key:"addMany",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map((function(e){var r=t._nextManipulatorId++,a={id:r,manipulator:e,visibilityPredicate:n,attached:!1};return t._manipulators.add(a),t._attached&&t._updateManipulatorAttachment(a),r}))}},{key:"remove",value:function(e){if("number"==typeof e){for(var t=e,n=0;n<this._manipulators.length;n++)if(this._manipulators.getItemAt(n).id===t){var r=this._manipulators.splice(n,1)[0];return this._detachManipulator(r),r.id}return null}for(var a=e,i=0;i<this._manipulators.length;i++)if(this._manipulators.getItemAt(i).manipulator===a){var o=this._manipulators.splice(i,1)[0];return this._detachManipulator(o),o.id}return null}},{key:"removeAll",value:function(){var e=this;this._manipulators.forEach((function(t){e._detachManipulator(t)})),this._manipulators.removeAll()}},{key:"attach",value:function(){var e=this;this._manipulators.forEach((function(t){e._updateManipulatorAttachment(t)})),this._attached=!0}},{key:"detach",value:function(){var e=this;this._manipulators.forEach((function(t){e._detachManipulator(t)})),this._attached=!1}},{key:"destroy",value:function(){this._manipulators.forEach((function(e){var t=e.manipulator;t.destroy&&t.destroy()})),this._manipulators.destroy(),this._resourceContexts=null}},{key:"on",value:function(e,t){return this._manipulators.on(e,(function(e){t(e)}))}},{key:"forEach",value:function(e){var t,n=Object(v.a)(this._manipulators.items);try{for(n.s();!(t=n.n()).done;){e(t.value)}}catch(r){n.e(r)}finally{n.f()}}},{key:"some",value:function(e){return this._manipulators.items.some(e)}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){return e.push(t.manipulator)})),e}},{key:"intersect",value:function(e,t){var n=null,r=Number.MAX_VALUE;return this._manipulators.forEach((function(a){var i=a.id,o=a.manipulator;if(a.attached&&o.interactive){var s=o.intersectionDistance(e,t);Object(l.k)(s)&&s<r&&(r=s,n={id:i,manipulator:o})}})),n}},{key:"findById",value:function(e){if(Object(l.j)(e))return null;var t,n=Object(v.a)(this._manipulators.items);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e===r.id)return r.manipulator}}catch(a){n.e(a)}finally{n.f()}return null}},{key:"_updateManipulatorAttachment",value:function(e){this._isManipulatorItemVisible(e)?this._attachManipulator(e):this._detachManipulator(e)}},{key:"_attachManipulator",value:function(e){e.attached||(e.manipulator.attach&&e.manipulator.attach(this._resourceContexts),e.attached=!0)}},{key:"_detachManipulator",value:function(e){if(e.attached){var t=e.manipulator;t.grabbing=!1,t.dragging=!1,t.hovering=!1,t.selected=!1,t.detach&&t.detach(this._resourceContexts),e.attached=!1}}},{key:"_isManipulatorItemVisible",value:function(e){return 2===e.visibilityPredicate||(this._isToolEditable?0===e.visibilityPredicate:1===e.visibilityPredicate)}}]),e}(),m=u.a.getLogger("esri.views.interactive.InteractiveToolBase"),g=function(e){Object(i.a)(n,e);var t=Object(o.a)(n);function n(e){var a;return Object(r.a)(this,n),(a=t.call(this,e)).toolState="pending",a.completed=!1,a.manipulators=new b,a.updating=!1,a.automaticManipulatorSelection=!0,a._editableFlags=new Map([[1,!0],[0,!0]]),a._creationStartedResolver=Object(h.g)(),a._creationFinishedResolver=Object(h.g)(),a}return Object(a.a)(n,[{key:"active",get:function(){return null!=this.view&&this.view.activeTool===this}},{key:"visible",set:function(e){this._set("visible",e),e||this.active&&(this.view.activeTool=null),this.attached&&(e?this._show():this._hide())}},{key:"editable",get:function(){return this.getEditableFlag(0)},set:function(e){this.setEditableFlag(0,e)}},{key:"attached",get:function(){return this._get("attached")}},{key:"created",get:function(){return"created"===this.toolState}},{key:"cursor",get:function(){return null}},{key:"attach",value:function(){this.attached?m.warn("Tool is already attached. Ignoring attach request."):(this.manipulators.attach(),this.onAttach(),this.visible&&this.onShow(),this._set("attached",!0))}},{key:"detach",value:function(){this.attached?(this.visible&&this.onHide(),this.onDetach(),this.manipulators.detach(),this._set("attached",!1)):m.error("Tool isn't currently attached. Ignoring detach request.")}},{key:"activate",value:function(){Object(l.j)(this.view)?m.error("Can't activate tool if view is not defined."):this.active?m.warn("Tool is already active, ignoring activation request."):(Object(f.b)(this.view)&&this.view.focus(),this.onActivate())}},{key:"deactivate",value:function(){this.active?this.onDeactivate():m.warn("Tool is not active, ignoring deactivation request.")}},{key:"handleInputEvent",value:function(e){this.attached?this.onInputEvent(e):m.warn("handleInputEvent() called on detached tool")}},{key:"handleInputEventAfter",value:function(e){this.attached?this.onInputEventAfter(e):m.warn("handleInputEventAfter() called on detached tool")}},{key:"destroy",value:function(){this.manipulators.destroy(),this._set("view",null),this._set("completed",!1)}},{key:"setEditableFlag",value:function(e,t){this._editableFlags.set(e,t),this.manipulators.isToolEditable=this.internallyEditable,this._updateManipulatorAttachment(),0===e&&this.notifyChange("editable"),this.onEditableChange()}},{key:"getEditableFlag",value:function(e){return this._editableFlags.get(e)}},{key:"whenCreationStarted",value:function(){return this._creationStartedResolver.promise}},{key:"when",value:function(){return this._creationFinishedResolver.promise}},{key:"rejectCreation",value:function(e){"pending"!==this.toolState&&"creating"!==this.toolState||this._creationStartedResolver.resolve(this),this._creationFinishedResolver.reject(e)}},{key:"onActivate",value:function(){}},{key:"onDeactivate",value:function(){}},{key:"onAttach",value:function(){}},{key:"onDetach",value:function(){}},{key:"onShow",value:function(){}},{key:"onHide",value:function(){}},{key:"onEditableChange",value:function(){}},{key:"onInputEvent",value:function(e){}},{key:"onInputEventAfter",value:function(e){}},{key:"internallyEditable",get:function(){return this.getEditableFlag(0)&&this.getEditableFlag(1)}},{key:"startToolCreation",value:function(){if("pending"===this.toolState)return this._creationStartedResolver.resolve(this),void(this.toolState="creating");throw new Error("Unexpected tool state ".concat(this.toolState))}},{key:"finishToolCreation",value:function(){switch(this.toolState){case"pending":this.startToolCreation();case"creating":this.created||this._creationFinishedResolver.resolve(this),this.toolState="created";break;case"created":break;default:throw new Error("Unexpected tool state ".concat(this.toolState))}}},{key:"complete",value:function(){this.finishToolCreation(),this._set("completed",!0)}},{key:"_show",value:function(){this._updateManipulatorAttachment(),this.onShow()}},{key:"_hide",value:function(){this._updateManipulatorAttachment(),this.onHide()}},{key:"_updateManipulatorAttachment",value:function(){this.attached&&this.visible?this.manipulators.attach():this.manipulators.detach()}}]),n}(c.a);Object(s.a)([Object(d.b)()],g.prototype,"toolState",void 0),Object(s.a)([Object(d.b)({constructOnly:!0})],g.prototype,"view",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],g.prototype,"active",null),Object(s.a)([Object(d.b)({value:!0})],g.prototype,"visible",null),Object(s.a)([Object(d.b)({value:!0})],g.prototype,"editable",null),Object(s.a)([Object(d.b)({value:!1,readOnly:!0})],g.prototype,"attached",null),Object(s.a)([Object(d.b)({readOnly:!0})],g.prototype,"created",null),Object(s.a)([Object(d.b)({readOnly:!0})],g.prototype,"completed",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],g.prototype,"manipulators",void 0),Object(s.a)([Object(d.b)({readOnly:!0})],g.prototype,"updating",void 0),Object(s.a)([Object(d.b)()],g.prototype,"cursor",null),Object(s.a)([Object(d.b)()],g.prototype,"automaticManipulatorSelection",void 0),g=Object(s.a)([Object(p.a)("esri.views.interactive.InteractiveToolBase")],g)},786:function(e,t,n){"use strict";n.r(t),n.d(t,"hydratedAdapter",(function(){return c}));var r=n(48),a=n(196),i=n(47),o=n(90),s=n(101),c={convertToGEGeometry:function(e,t){if(null==t)return null;var n="cache"in t?t.cache._geVersion:void 0;return null==n&&(n=e.convertJSONToGeometry(t),"cache"in t&&(t.cache._geVersion=n)),n},exportPoint:function(e,t,n){var r=e.hasZ(t),a=e.hasM(t),o=new i.a({x:e.getPointX(t),y:e.getPointY(t),spatialReference:n});return r&&(o.z=e.getPointZ(t)),a&&(o.m=e.getPointM(t)),o.cache._geVersion=t,o},exportPolygon:function(e,t,n){var r=new o.a({rings:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:n});return r.cache._geVersion=t,r},exportPolyline:function(e,t,n){var r=new s.a({paths:e.exportPaths(t),hasZ:e.hasZ(t),hasM:e.hasM(t),spatialReference:n});return r.cache._geVersion=t,r},exportMultipoint:function(e,t,n){var r=new a.a({hasZ:e.hasZ(t),hasM:e.hasM(t),points:e.exportPoints(t),spatialReference:n});return r.cache._geVersion=t,r},exportExtent:function(e,t,n){var a=e.hasZ(t),i=e.hasM(t),o=new r.a({xmin:e.getXMin(t),ymin:e.getYMin(t),xmax:e.getXMax(t),ymax:e.getYMax(t),spatialReference:n});if(a){var s=e.getZExtent(t);o.zmin=s.vmin,o.zmax=s.vmax}if(i){var c=e.getMExtent(t);o.mmin=c.vmin,o.mmax=c.vmax}return o.cache._geVersion=t,o}}},787:function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(4),a=n.n(r),i=n(9),o=n(10),s=n(2),c=n(3),u=n(7),l=n(21),h=n(669),d=n(652),p=n(724),f=n(679),v=function(){function e(){Object(s.a)(this,e),this.next=new d.a}return Object(c.a)(e,[{key:"createSnapDragEventPipelineStep",value:function(e){var t=this,n=e.predicate,r=void 0===n?function(){return!0}:n,s=e.cancel,c=e.snappingManager,v=e.snappingContext,y=e.updatingHandles;if(Object(u.j)(c))return function(e){return e};var b=null,m=null,g=function(){b=Object(u.a)(b),c.doneSnapping(),Object(u.k)(m)&&m.frameTask.remove(),m=null};return s.next((function(e){return g(),e})),this.next=new d.a,function(e){if(!r(e))return e;if(b=Object(u.a)(b),"start"===e.action){var n="3d"===c.view.type?c.view.resourceController.scheduler.registerTask(f.b.SNAPPING):f.a;m={context:new p.a({editGeometryOperations:v.editGeometryOperations,elevationInfo:v.elevationInfo,pointer:v.pointer,vertexHandle:Object(u.k)(e.info)?e.info.handle:null,excludeFeature:v.excludeFeature,visualizer:v.visualizer}),originalPos:Object(u.k)(e.snapOrigin)?v.coordinateHelper.vectorToDehydratedPoint(e.snapOrigin):e.mapStart,frameTask:n}}if(Object(u.k)(m)){var s=m.context.coordinateHelper.vectorToDehydratedPoint(m.context.coordinateHelper.arrayToVector([m.originalPos.x,m.originalPos.y,m.originalPos.z]));s.x+=e.mapEnd.x-e.mapStart.x,s.y+=e.mapEnd.y-e.mapStart.y;var d=e.mapStart.x-m.originalPos.x,O=e.mapStart.y-m.originalPos.y,_=Object(o.a)(Object(o.a)({},e),{},{action:"udpate"}),j=m.context,x=c.update(s,m.context);if(e.mapEnd.x=x.x+d,e.mapEnd.y=x.y+O,"end"!==e.action){var k=m.frameTask;b=Object(l.h)(function(){var e=Object(i.a)(a.a.mark((function e(n){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.schedule((function(){return c.snap(s,j,n)}),n);case 2:if(!(r=e.sent).valid){e.next=8;break}return e.next=6,k.schedule((function(){return r.apply()}),n);case 6:i=e.sent,Object(h.a)(i,x)||(_.mapEnd.x=i.x+d,_.mapEnd.y=i.y+O,t.next.execute(_));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y.addPromise(b.promise)}}return"end"===e.action&&g(),e}}}]),e}()},858:function(e,t,n){"use strict";n.r(t),n.d(t,"buffer",(function(){return w})),n.d(t,"clip",(function(){return s})),n.d(t,"contains",(function(){return u})),n.d(t,"convexHull",(function(){return _})),n.d(t,"crosses",(function(){return l})),n.d(t,"cut",(function(){return c})),n.d(t,"densify",(function(){return L})),n.d(t,"difference",(function(){return j})),n.d(t,"disjoint",(function(){return y})),n.d(t,"distance",(function(){return h})),n.d(t,"equals",(function(){return d})),n.d(t,"extendedSpatialReferenceInfo",(function(){return o})),n.d(t,"flipHorizontal",(function(){return G})),n.d(t,"flipVertical",(function(){return C})),n.d(t,"generalize",(function(){return P})),n.d(t,"geodesicArea",(function(){return z})),n.d(t,"geodesicBuffer",(function(){return S})),n.d(t,"geodesicDensify",(function(){return F})),n.d(t,"geodesicLength",(function(){return N})),n.d(t,"intersect",(function(){return k})),n.d(t,"intersects",(function(){return p})),n.d(t,"isSimple",(function(){return g})),n.d(t,"nearestCoordinate",(function(){return M})),n.d(t,"nearestVertex",(function(){return I})),n.d(t,"nearestVertices",(function(){return R})),n.d(t,"offset",(function(){return T})),n.d(t,"overlaps",(function(){return b})),n.d(t,"planarArea",(function(){return D})),n.d(t,"planarLength",(function(){return U})),n.d(t,"relate",(function(){return m})),n.d(t,"rotate",(function(){return V})),n.d(t,"simplify",(function(){return O})),n.d(t,"symmetricDifference",(function(){return x})),n.d(t,"touches",(function(){return f})),n.d(t,"union",(function(){return E})),n.d(t,"within",(function(){return v}));var r=n(776),a=n(786);function i(e){return Array.isArray(e)?e[0].spatialReference:e&&e.spatialReference}function o(e){return r.G.extendedSpatialReferenceInfo(e)}function s(e,t){return r.G.clip(a.hydratedAdapter,i(e),e,t)}function c(e,t){return r.G.cut(a.hydratedAdapter,i(e),e,t)}function u(e,t){return r.G.contains(a.hydratedAdapter,i(e),e,t)}function l(e,t){return r.G.crosses(a.hydratedAdapter,i(e),e,t)}function h(e,t,n){return r.G.distance(a.hydratedAdapter,i(e),e,t,n)}function d(e,t){return r.G.equals(a.hydratedAdapter,i(e),e,t)}function p(e,t){return r.G.intersects(a.hydratedAdapter,i(e),e,t)}function f(e,t){return r.G.touches(a.hydratedAdapter,i(e),e,t)}function v(e,t){return r.G.within(a.hydratedAdapter,i(e),e,t)}function y(e,t){return r.G.disjoint(a.hydratedAdapter,i(e),e,t)}function b(e,t){return r.G.overlaps(a.hydratedAdapter,i(e),e,t)}function m(e,t,n){return r.G.relate(a.hydratedAdapter,i(e),e,t,n)}function g(e){return r.G.isSimple(a.hydratedAdapter,i(e),e)}function O(e){return r.G.simplify(a.hydratedAdapter,i(e),e)}function _(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r.G.convexHull(a.hydratedAdapter,i(e),e,t)}function j(e,t){return r.G.difference(a.hydratedAdapter,i(e),e,t)}function x(e,t){return r.G.symmetricDifference(a.hydratedAdapter,i(e),e,t)}function k(e,t){return r.G.intersect(a.hydratedAdapter,i(e),e,t)}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return r.G.union(a.hydratedAdapter,i(e),e,t)}function T(e,t,n,o,s,c){return r.G.offset(a.hydratedAdapter,i(e),e,t,n,o,s,c)}function w(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r.G.buffer(a.hydratedAdapter,i(e),e,t,n,o)}function S(e,t,n,o,s,c){return r.G.geodesicBuffer(a.hydratedAdapter,i(e),e,t,n,o,s,c)}function M(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return r.G.nearestCoordinate(a.hydratedAdapter,i(e),e,t,n)}function I(e,t){return r.G.nearestVertex(a.hydratedAdapter,i(e),e,t)}function R(e,t,n,o){return r.G.nearestVertices(a.hydratedAdapter,i(e),e,t,n,o)}function A(e){return"xmin"in e?"center"in e?e.center:null:"x"in e?e:"extent"in e?e.extent.center:null}function V(e,t,n){var a;if(null==e)throw new Error("Illegal Argument Exception");var i=e.spatialReference;if(null==(n=null!=(a=n)?a:A(e)))throw new Error("Illegal Argument Exception");var o=e.constructor.fromJSON(r.G.rotate(e,t,n));return o.spatialReference=i,o}function G(e,t){var n;if(null==e)throw new Error("Illegal Argument Exception");var a=e.spatialReference;if(null==(t=null!=(n=t)?n:A(e)))throw new Error("Illegal Argument Exception");var i=e.constructor.fromJSON(r.G.flipHorizontal(e,t));return i.spatialReference=a,i}function C(e,t){var n;if(null==e)throw new Error("Illegal Argument Exception");var a=e.spatialReference;if(null==(t=null!=(n=t)?n:A(e)))throw new Error("Illegal Argument Exception");var i=e.constructor.fromJSON(r.G.flipVertical(e,t));return i.spatialReference=a,i}function P(e,t,n,o){return r.G.generalize(a.hydratedAdapter,i(e),e,t,n,o)}function L(e,t,n){return r.G.densify(a.hydratedAdapter,i(e),e,t,n)}function F(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return r.G.geodesicDensify(a.hydratedAdapter,i(e),e,t,n,o)}function D(e,t){return r.G.planarArea(a.hydratedAdapter,i(e),e,t)}function U(e,t){return r.G.planarLength(a.hydratedAdapter,i(e),e,t)}function z(e,t,n){return r.G.geodesicArea(a.hydratedAdapter,i(e),e,t,n)}function N(e,t,n){return r.G.geodesicLength(a.hydratedAdapter,i(e),e,t,n)}},920:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return l}));var r=n(2),a=n(3),i=n(7),o=n(35),s=n(611),c=n(140),u=function(){function e(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Object(r.a)(this,e),this.elevationInfo=t,this.defaultZ=n,this.view=a,this.excludeGraphics=i}return Object(a.a)(e,[{key:"screenToMap",value:function(e){if(Object(i.k)(this.defaultZ))return this.view.sceneIntersectionHelper.intersectElevationFromScreen(Object(o.f)(e.x,e.y),this.elevationInfo,this.defaultZ,this.excludeGraphics);var t=this.view.sceneIntersectionHelper.intersectElevationFromScreen(Object(o.f)(e.x,e.y),this.elevationInfo,0,this.excludeGraphics);return Object(i.k)(t)&&(t.z=void 0),t}},{key:"mapToScreen",value:function(e){var t=Object(s.g)(e.x,e.y,Object(c.a)(this.view,e,this.elevationInfo),e.spatialReference);return this.view.toScreen(t)}}]),e}(),l=function(){function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Object(r.a)(this,e),this.view=t,this.elevationInfo=n,this.exclude=a}return Object(a.a)(e,[{key:"screenToMap",value:function(e){var t=this.view.toMap(e,{exclude:this.exclude});return Object(i.k)(t)&&(t.z=Object(c.g)(t,this.view,this.elevationInfo)),t}},{key:"mapToScreen",value:function(e){var t=e;return Object(i.k)(this.elevationInfo)&&(t=Object(s.g)(e.x,e.y,Object(c.a)(this.view,e,this.elevationInfo),e.spatialReference)),this.view.toScreen(t)}}]),e}(),h=function e(t){Object(r.a)(this,e),this.view=t,this.screenToMap=function(e){return t.toMap(e)},this.mapToScreen=function(e){return t.toScreen(e)}}},955:function(e,t,n){"use strict";n.d(t,"a",(function(){return Q})),n.d(t,"b",(function(){return K}));var r=n(10),a=n(2),i=n(3),o=n(5),s=n(6),c=n(0),u=n(80),l=(n(12),n(67)),h=n(63),d=n(124),p=n(7),f=n(1),v=(n(15),n(11),n(8)),y=n(325),b=(n(76),n(102)),m=n(19),g=n(51),O=n(451),_=n(858),j=n(177),x=n(42),k=n(103),E=n(205),T=n(667),w=n(610),S=n(58),M=n(79),I=n(47);function R(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(p.k)(n)?[e,t,n]:[e,t]}function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(p.k)(n)?{x:e,y:t,z:n}:{x:e,y:t}}var V=function(){function e(t){Object(a.a)(this,e),this.spatialReference=t}return Object(i.a)(e,[{key:"mapToLocalMultiple",value:function(e){var t=this;return Object(p.g)(e.map((function(e){return t.mapToLocal(e)})))}},{key:"doUnnormalization",get:function(){return!1}}]),e}(),G=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(e,r){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(a.a)(this,n),(i=t.call(this,r)).defaultZ=o,i.transform=Object(E.b)(),i.transformInv=Object(E.b)(),i.transform=Object(E.a)(e),Object(k.a)(i.transformInv,i.transform),i}return Object(i.a)(n,[{key:"makeMapPoint",value:function(e,t){return R(e,t,this.defaultZ)}},{key:"mapToLocal",value:function(e){return A(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}},{key:"localToMap",value:function(e){return R(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this.defaultZ)}}]),n}(V),C=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(e,r){var i;Object(a.a)(this,n),(i=t.call(this,e.spatialReference)).view=e,i.defaultZ=null,i.pWS=Object(M.e)(),i.tangentFrameUpWS=Object(M.e)(),i.tangentFrameRightWS=Object(M.e)(),i.tangentFrameForwardWS=Object(M.e)(),i.localFrameRightWS=Object(M.e)(),i.localFrameUpWS=Object(M.e)(),i.worldToLocalTransform=Object(w.b)(),i.localToWorldTransform=Object(w.b)(),i.scale=1,i.scale=e.resolution,i.referenceMapPoint=r,i.defaultZ=r.hasZ?r.z:null;var o=e.state.camera.viewRight;i.view.renderCoordsHelper.toRenderCoords(i.referenceMapPoint,i.pWS),i.view.renderCoordsHelper.worldBasisAtPosition(i.pWS,0,i.tangentFrameRightWS),i.view.renderCoordsHelper.worldBasisAtPosition(i.pWS,1,i.tangentFrameUpWS),i.view.renderCoordsHelper.worldBasisAtPosition(i.pWS,2,i.tangentFrameForwardWS);var s=Object(M.e)();return Object(S.e)(s,i.tangentFrameForwardWS,Object(S.h)(o,i.tangentFrameForwardWS)),Object(S.j)(i.localFrameRightWS,o,s),Object(S.r)(i.localFrameRightWS,i.localFrameRightWS),Object(S.g)(i.localFrameUpWS,i.tangentFrameForwardWS,i.localFrameRightWS),Object(T.g)(i.worldToLocalTransform,i.localFrameRightWS,i.tangentFrameRightWS),Object(T.c)(i.localToWorldTransform,i.worldToLocalTransform),i}return Object(i.a)(n,[{key:"doUnnormalization",get:function(){return"global"===this.view.viewingMode}},{key:"makeMapPoint",value:function(e,t){return R(e,t,this.defaultZ)}},{key:"mapToLocal",value:function(e){var t=Object(M.e)();this.view.renderCoordsHelper.toRenderCoords(new I.a({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),Object(S.u)(t,t,this.worldToLocalTransform);var n=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return Object(p.k)(n)?A(n.x/this.scale,n.y/this.scale):null}},{key:"localToMap",value:function(e){var t=Object(M.e)();this.view.renderCoordsHelper.toRenderCoords(new I.a({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),Object(S.u)(t,t,this.localToWorldTransform);var n=this.view.renderCoordsHelper.fromRenderCoords(t,this.view.spatialReference);return Object(p.k)(n)?R(n.x,n.y,this.defaultZ):null}}]),n}(V);function P(e,t){if("2d"===e.type)return new G(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if("3d"===e.type){var n=t.length>2?new I.a({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new I.a({x:t[0],y:t[1],spatialReference:e.spatialReference});return new C(e,n)}return null}var L=n(196),F=n(101),D=n(90);function U(e,t){var n=new I.a({x:e[0],y:e[1],spatialReference:t});return e.length>2&&(n.z=e[2]),n}function z(e,t){return new L.a({points:e,spatialReference:t})}function N(e,t,n){var r=new F.a({paths:e,spatialReference:t});return n&&Object(j.i)(r),r}function H(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=Object(m.a)(e);a.forEach((function(e){var t=e[0],n=e[e.length-1];Object(b.c)(t,n)&&1!==e.length||e.push(e[0])}));var i=new D.a({rings:a,spatialReference:t});return i.rings.forEach((function(e){Object(j.g)(e,!1,!1)||e.reverse()})),n&&Object(j.i)(i),r&&i.isSelfIntersecting&&Object(x.l)(t)&&(i=Object(_.simplify)(i)),i}function Z(e,t,n){var r=t.mapToLocalMultiple(e),a=[],i={x:r[0].x,y:r[0].y},o=r[1].x,s=r[1].y,c=Math.round(o-i.x),u=Math.round(s-i.y),l=Math.max(Math.abs(c),Math.abs(u));if(n){var h={x:i.x+l,y:i.y+l},d={x:i.x-l,y:i.y-l};a.push(A(h.x,d.y),A(d.x,d.y),A(d.x,h.y),A(h.x,h.y))}else{var f={x:c>0?i.x+l:i.x-l,y:u>0?i.y+l:i.y-l};a.push(A(i.x,i.y),A(f.x,i.y),A(f.x,f.y),A(i.x,f.y))}return H([Object(p.g)(a.map((function(e){return t.localToMap(e)})))],t.spatialReference,t.doUnnormalization,!0)}function W(e,t,n){var r=t.mapToLocalMultiple(e);if(1===r.length){var a=48,i=r[0];r=[A(i.x-a,i.y+a),A(i.x+a,i.y-a),A(i.x+a,i.y-a),A(i.x-a,i.y+a)]}var o=[],s={x:r[0].x,y:r[0].y},c={x:r[1].x,y:r[1].y};if(n){var u=Math.round(c.x-s.x),l=Math.round(c.y-s.y);o.push(A(s.x-u,s.y-l),A(c.x,s.y-l),A(c.x,c.y),A(s.x-u,c.y))}else o.push(A(s.x,s.y),A(c.x,s.y),A(c.x,c.y),A(s.x,c.y));return H([Object(p.g)(o.map((function(e){return t.localToMap(e)})))],t.spatialReference,t.doUnnormalization,!0)}function q(e,t,n,r){var a=t.mapToLocalMultiple(e),i=null,o=null;if(n)i=a[0],o=a[1];else{var s=a[0],c=a[1],u=Math.round(c.x-s.x),l=Math.round(c.y-s.y),h=Math.max(Math.abs(u),Math.abs(l));i=A(u>0?s.x+h/2:s.x-h/2,l>0?s.y+h/2:s.y-h/2),o=A(Math.abs(u)>Math.abs(l)?i.x-h/2:i.x,Math.abs(u)>Math.abs(l)?i.y:i.y-h/2)}var d=t.localToMap(i),f=t.localToMap(o);if(Object(p.j)(d)||Object(p.j)(f))return null;t.doUnnormalization&&Object(j.j)([[d,f]],t.spatialReference);var v=U(d,t.spatialReference),y=U(f,t.spatialReference),b=Object(g.d)(t.spatialReference),m=0;if(Object(x.l)(t.spatialReference))m=b*Object(_.distance)(v,y,null);else{var k=i.x-o.x,E=i.y-o.y;m=b*Math.sqrt(k*k+E*E)*(r||1)}var T=new O.a({center:v,radius:m,radiusUnit:"meters",spatialReference:t.spatialReference});return H(T.rings,T.spatialReference,!1)}function B(e,t,n){for(var r=t.mapToLocalMultiple(e),a=r[0],i=r[1],o=Math.round(i.x-a.x),s=Math.round(i.y-a.y),c=A(n?a.x:a.x+o/2,n?a.y:a.y+s/2),u=n?o:o/2,l=n?s:s/2,h=[],d=2*Math.PI/60,f=0;f<60;f++){var v=Math.cos(f*d),y=Math.sin(f*d),b=A(u*v+c.x,l*y+c.y);h.push(b)}return h.push(h[0]),H([Object(p.g)(h.map((function(e){return t.localToMap(e)})))],t.spatialReference,t.doUnnormalization,!1)}var Y=n(770),Q=function(e){Object(o.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(a.a)(this,n),(r=t.call(this,e))._graphic=null,r.defaultZ=0,r.geometryType=null,r.hasZ=!0,r.mode=null,r.snappingManager=null,r.snapToScene=!1,r}return Object(i.a)(n,[{key:"initialize",value:function(){var e=this;this.internalGraphicsLayer=new y.a({listMode:"hide",internal:!0}),this.view.map.layers.add(this.internalGraphicsLayer),this.drawOperation=this.makeDrawOperation(),this.handles.add([this.drawOperation.on("vertex-add",(function(t){return e.onVertexAdd(t)})),this.drawOperation.on("vertex-remove",(function(t){return e.onVertexRemove(t)})),this.drawOperation.on("vertex-update",(function(t){return e.onVertexUpdate(t)})),this.drawOperation.on("cursor-update",(function(t){return e.onCursorUpdate(t)})),this.drawOperation.on("complete",(function(t){return e.onComplete(t)}))]),this.complete()}},{key:"destroy",value:function(){this.drawOperation=Object(p.e)(this.drawOperation),this._destroyAllVisualisations(),this.view.map.remove(this.internalGraphicsLayer),this.internalGraphicsLayer=Object(p.e)(this.internalGraphicsLayer),this._set("view",null)}},{key:"canRedo",get:function(){return this.drawOperation.canRedo}},{key:"canUndo",get:function(){return this.drawOperation.canUndo}},{key:"centered",set:function(e){this._set("centered",e),this._updateGraphic()}},{key:"enabled",set:function(e){this.drawOperation.interactive=e,this._set("enabled",e)}},{key:"forceUniformSize",set:function(e){this._set("forceUniformSize",e),this._updateGraphic()}},{key:"graphic",get:function(){return this._graphic}},{key:"graphicSymbol",set:function(e){this._set("graphicSymbol",e),Object(p.k)(this._graphic)&&(this._graphic.symbol=e)}},{key:"updating",get:function(){var e,t;return null!=(e=null==(t=this.drawOperation)?void 0:t.updating)&&e}},{key:"completeCreateOperation",value:function(){this.drawOperation.complete()}},{key:"onInputEvent",value:function(e){this.drawOperation.onInputEvent(e)}},{key:"redo",value:function(){this.drawOperation.redo()}},{key:"reset",value:function(){}},{key:"undo",value:function(){this.drawOperation.undo()}},{key:"_createGraphic",value:function(e){var t=this;this._graphic=new u.a({geometry:e,symbol:this.graphicSymbol}),this.internalGraphicsLayer.add(this._graphic),this.handles.add(this.initializeGraphic(this._graphic)),this.notifyChange("graphic"),this.handles.add(Object(d.c)((function(){Object(p.k)(t._graphic)&&(t.internalGraphicsLayer.remove(t._graphic),t._graphic=Object(p.e)(t._graphic))})),X)}},{key:"_destroyAllVisualisations",value:function(){this.handles.remove(J.outline),this.handles.remove(J.regularVertices),this.handles.remove(J.activeVertex),this.handles.remove(X)}},{key:"_getCreateOperationGeometry",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{operationComplete:!1};if(null==this.drawOperation||0===this.drawOperation.numVertices)return null;var t=this.drawOperation.stagedVertex,n=this.drawOperation.committedVertices,r=n.slice();Object(p.k)(t)&&r.push(this.drawOperation.coordinateHelper.pointToArray(t));var a=Object(p.k)(t)?this.drawOperation.coordinateHelper.pointToArray(t):n.splice(-1)[0],i={regularVertices:null,activeVertex:null,full:null,outline:null},o=r.length,s=this.drawOperation.spatialReference,c="3d"===this.view.type&&"global"===this.view.viewingMode;switch(this.geometryType){case"point":i.regularVertices=n,i.activeVertex=a,i.full=this.drawOperation.coordinateHelper.arrayToPoint(r[0]);break;case"multipoint":i.regularVertices=n,i.activeVertex=a,o>0&&(i.full=z(r,s));break;case"polyline":i.regularVertices=n,i.activeVertex=a,o>0&&(i.full=N([r],s,c));break;case"polygon":i.regularVertices=n,i.activeVertex=a,o>0&&(i.full=H([r],s,c,!0));break;case"circle":if(o>0){var u=P(this.view,r[0]);if(1===o&&e.operationComplete){var l=r[0],h=u.makeMapPoint(l[0]+$*this.view.resolution,l[1]);i.full=q([l,h],u,!0)}else 2===o&&(i.full=this.forceUniformSize?q(r,u,this.centered):B(r,u,this.centered))}break;case"rectangle":if(o>0){var d=P(this.view,r[0]);if(1===o&&e.operationComplete){var f=r[0],v=d.makeMapPoint(f[0]+$*this.view.resolution,f[1]);i.full=Z([f,v],d,!0)}else 2===o&&(i.full=this.forceUniformSize?Z(r,d,this.centered):W(r,d,this.centered))}break;default:return null}switch(this.geometryType){case"point":case"multipoint":break;case"polyline":case"polygon":o>1&&(i.outline=N([r],s,c));break;case"circle":case"rectangle":Object(p.k)(i.full)&&"polygon"===i.full.type&&(i.outline=H(i.full.rings,s,c))}return i}},{key:"initializeGraphic",value:function(e){return null}},{key:"onComplete",value:function(e){this._updateGraphic();var t=null;if(this.drawOperation.isCompleted){var n=this._getCreateOperationGeometry({operationComplete:!0});Object(p.k)(n)&&(t=new u.a(Object(r.a)({geometry:n.full,symbol:this.graphicSymbol,sourceLayer:this.internalGraphicsLayer},this.graphicProperties)))}this.emit("complete",Object(r.a)({graphic:t},e))}},{key:"onCursorUpdate",value:function(e){this._updateGraphic(),this.emit("cursor-update",e)}},{key:"onDeactivate",value:function(){this.drawOperation.isCompleted||this.drawOperation.cancel()}},{key:"onVertexAdd",value:function(e){this._updateGraphic(),this.emit("vertex-add",e)}},{key:"onVertexRemove",value:function(e){this._updateGraphic(),this.emit("vertex-remove",e)}},{key:"onVertexUpdate",value:function(e){this._updateGraphic(),this.emit("vertex-update",e)}},{key:"_updateGraphic",value:function(){var e=this._getCreateOperationGeometry();Object(p.j)(e)?this._destroyAllVisualisations():(Object(p.k)(e.outline)?this.handles.add(this.onOutlineChanged(e.outline),J.outline):this.handles.remove(J.outline),Object(p.k)(e.regularVertices)?this.handles.add(this.onRegularVerticesChanged(e.regularVertices),J.regularVertices):this.handles.remove(J.regularVertices),Object(p.k)(e.activeVertex)?this.handles.add(this.onActiveVertexChanged(e.activeVertex),J.activeVertex):this.handles.remove(J.activeVertex),Object(p.k)(e.full)?Object(p.j)(this._graphic)?this._createGraphic(e.full):this._graphic.geometry=e.full:this.handles.remove(X))}}]),n}(Object(h.b)(l.a.EventedMixin(Y.a)));Object(c.a)([Object(f.b)({value:!0})],Q.prototype,"centered",null),Object(c.a)([Object(f.b)({nonNullable:!0})],Q.prototype,"defaultZ",void 0),Object(c.a)([Object(f.b)()],Q.prototype,"drawOperation",void 0),Object(c.a)([Object(f.b)({value:!0})],Q.prototype,"enabled",null),Object(c.a)([Object(f.b)({value:!0})],Q.prototype,"forceUniformSize",null),Object(c.a)([Object(f.b)({constructOnly:!0})],Q.prototype,"geometryType",void 0),Object(c.a)([Object(f.b)()],Q.prototype,"graphic",null),Object(c.a)([Object(f.b)({constructOnly:!0})],Q.prototype,"graphicProperties",void 0),Object(c.a)([Object(f.b)()],Q.prototype,"graphicSymbol",null),Object(c.a)([Object(f.b)({constructOnly:!0})],Q.prototype,"hasZ",void 0),Object(c.a)([Object(f.b)({constructOnly:!0})],Q.prototype,"mode",void 0),Object(c.a)([Object(f.b)()],Q.prototype,"snappingManager",void 0),Object(c.a)([Object(f.b)()],Q.prototype,"snapToScene",void 0),Object(c.a)([Object(f.b)({readOnly:!0})],Q.prototype,"type",void 0),Object(c.a)([Object(f.b)({readOnly:!0})],Q.prototype,"updating",null),Object(c.a)([Object(f.b)({constructOnly:!0,nonNullable:!0})],Q.prototype,"view",void 0),Q=Object(c.a)([Object(v.a)("esri.views.draw.DrawGraphicTool")],Q);var X="create-operation-graphic",J={outline:"outline-visual",regularVertices:"regular-vertices-visual",activeVertex:"active-vertex-visual"};function K(e){switch(e){case"point":case"polyline":case"polygon":case"multipoint":return e;case"circle":case"rectangle":return"segment";default:return null}}var $=48},956:function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var r=n(4),a=n.n(r),i=n(9),o=n(10),s=n(2),c=n(3),u=n(5),l=n(6),h=n(0),d=n(67),p=n(63),f=n(19),v=n(7),y=n(21),b=n(35),m=n(1),g=(n(15),n(12),n(11),n(8)),O=n(669),_=function(){function e(t){var n=t.grabbableForEvent;Object(s.a)(this,e),this.events=new d.a,this.interactive=!0,this.selectable=!1,this.cursor=null,this.grabbable=!0,this.grabbableForEvent=n}return Object(c.a)(e,[{key:"intersectionDistance",value:function(e,t){return 0}},{key:"attach",value:function(){}},{key:"detach",value:function(){}}]),e}(),j="click",x=n(814),k=n(652),E=n(688),T=n(751),w=n(724),S=n(787),M=n(679),I=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e))._createOperationCompleted=!1,r._pointerDownStates=new Set,r._snappingPipeline=new S.a,r._snappingTask=null,r._stagedVertex=null,r.snapToSceneEnabled=null,Object(v.j)(e.elevationInfo)&&(r.elevationInfo={mode:e.hasZ?"absolute-height":"on-the-ground",offset:0}),r}return Object(c.a)(n,[{key:"initialize",value:function(){var e,t,n=this;this.coordinateHelper=Object(x.a)(this.hasZ,this.hasM,this.view.spatialReference);var r="3d"===this.view.type?null==(e=this.view)||null==(t=e.resourceController)?void 0:t.scheduler:null;this._frameTask=r?r.registerTask(M.b.SNAPPING):M.a;var a="viewingMode"in this.view.state?this.view.state.viewingMode:2,i="segment"===this.geometryType||"multipoint"===this.geometryType?"polyline":this.geometryType;this._editGeometryOperations=new T.a(new E.c(i,this.coordinateHelper,a)),this._activeComponent=new E.a(this.spatialReference,a),this._editGeometryOperations.data.components.push(this._activeComponent),this.handles.add(this._editGeometryOperations.on(["vertex-add","vertex-update","vertex-remove"],(function(e){var t=e.vertices.map((function(e){return{componentIndex:0,vertexIndex:e.index,coordinates:n.coordinateHelper.vectorToArray(e.pos)}})),r=t.map((function(e){return e.coordinates}));switch(e.type){case"vertex-add":n.emit(e.type,Object(o.a)(Object(o.a)({},e),{},{added:r,vertices:t}));break;case"vertex-update":n.emit(e.type,Object(o.a)(Object(o.a)({},e),{},{updated:r,vertices:t}));break;case"vertex-remove":n.emit(e.type,Object(o.a)(Object(o.a)({},e),{},{removed:r,vertices:t}))}}))),this._manipulator=new _({grabbableForEvent:function(e){return"click"!==n.drawingMode||"touch"===e.pointerType&&n._snappingEnabled&&1===n._pointerDownStates.size}}),this.manipulators.add(this._manipulator),this._manipulator.grabbable="point"!==this.geometryType,this.handles.add([this._createManipulatorDragPipeline(this._manipulator),this._manipulator.events.on("immediate-click",(function(e){return n._onImmediateClick(e)})),this._manipulator.events.on("immediate-double-click",(function(e){return n._onImmediateDoubleClick(e)}))])}},{key:"destroy",value:function(){this._editGeometryOperations=Object(v.e)(this._editGeometryOperations),this._frameTask=Object(v.r)(this._frameTask)}},{key:"_snappingEnabled",get:function(){return Object(v.k)(this.snappingManager)&&this.snappingManager.options.effectiveEnabled}},{key:"canRedo",get:function(){return this._editGeometryOperations.canRedo}},{key:"canUndo",get:function(){return this._editGeometryOperations.canUndo}},{key:"committedVertices",get:function(){var e=this;return this._activeComponent.vertices.map((function(t){return e.coordinateHelper.vectorToArray(t.pos)}))}},{key:"drawingMode",set:function(e){this._set("drawingMode",null!=e?e:j)}},{key:"hasStagedVertex",get:function(){return Object(v.k)(this._stagedVertex)}},{key:"interactive",get:function(){return this._manipulator.interactive},set:function(e){this._manipulator.interactive=e}},{key:"isCompleted",get:function(){return this._createOperationCompleted}},{key:"numCommittedVertices",get:function(){return this._activeComponent.vertices.length}},{key:"numVertices",get:function(){return Object(v.k)(this._stagedVertex)?this._activeComponent.vertices.length+1:this._activeComponent.vertices.length}},{key:"spatialReference",get:function(){return this.view.spatialReference}},{key:"stagedVertex",get:function(){return this._stagedVertex},set:function(e){if(Object(v.j)(e))this.discardStagedVertex();else if(!Object(v.k)(this._stagedVertex)||!Object(O.a)(this._stagedVertex,e)){if(Object(v.j)(this._stagedVertex))this._stagedVertex=Object(f.a)(e);else{if(Object(O.a)(this._stagedVertex,e))return;this._stagedVertex.x=e.x,this._stagedVertex.y=e.y,this._stagedVertex.z=e.z,this._stagedVertex.m=e.m,this._stagedVertex.hasZ=e.hasZ,this._stagedVertex.hasM=e.hasM,this._stagedVertex.spatialReference=e.spatialReference}this.emit("cursor-update",{updated:null,vertices:[{componentIndex:0,vertexIndex:this._activeComponent.vertices.length,coordinates:this.coordinateHelper.pointToArray(e)}],operation:"apply",type:"vertex-update"})}}},{key:"updating",get:function(){return this.updatingHandles.updating}},{key:"vertices",get:function(){var e=this.committedVertices;return Object(v.k)(this._stagedVertex)&&e.push(this.coordinateHelper.pointToArray(this._stagedVertex)),e}},{key:"cancel",value:function(){this.complete({aborted:!0})}},{key:"commitStagedVertex",value:function(){if(this._snappingTask=Object(v.a)(this._snappingTask),Object(v.k)(this._stagedVertex)){var e=this._stagedVertex;this._stagedVertex=null,this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(e))}}},{key:"complete",value:function(e){var t=e&&e.aborted||!1;Object(v.a)(this._snappingTask),Object(v.k)(this.snappingManager)&&this.snappingManager.doneSnapping(),"segment"===this.geometryType||"point"===this.geometryType?this.commitStagedVertex():this.discardStagedVertex();var n="multipoint"===this.geometryType&&0===this.numVertices||"polyline"===this.geometryType&&this.numVertices<2||"polygon"===this.geometryType&&this.numVertices<3;this._createOperationCompleted=!n,(this.isCompleted||t)&&this.emit("complete",{vertices:this.vertices.map((function(e,t){return{componentIndex:0,vertexIndex:t,coordinates:e}})),aborted:t,type:"complete"})}},{key:"discardStagedVertex",value:function(){this._stagedVertex=null}},{key:"onInputEvent",value:function(e){switch(e.type){case"pointer-down":this._pointerDownStates.add(e.pointerId);break;case"pointer-up":this._pointerDownStates.delete(e.pointerId)}switch(e.type){case"pointer-move":return this._onPointerMove(e);case"hold":return this._onHold(e)}}},{key:"redo",value:function(){this._editGeometryOperations.redo()}},{key:"undo",value:function(){Object(v.k)(this.snappingManager)&&this.snappingManager.doneSnapping(),this._editGeometryOperations.undo()}},{key:"_closeOnClickVertexIndex",value:function(e){var t=this._activeComponent;if("polygon"===this.geometryType&&t.vertices.length>2){if(this._vertexWithinPointerDistance(t.vertices[0].pos,e))return 0;if(this._vertexWithinPointerDistance(t.vertices[t.vertices.length-1].pos,e))return t.vertices.length-1}return null}},{key:"_createManipulatorDragPipeline",value:function(e){switch(this.drawingMode){case"click":return this._createManipulatorDragPipelineClick(e);case"freehand":return this._createManipulatorDragPipelineFreehand(e);case"hybrid":return this._createManipulatorDragPipelineHybrid(e)}}},{key:"_createManipulatorDragPipelineClick",value:function(e){var t=this;return Object(k.e)(e,(function(e,n,r,a){var i="touch"===a&&t._snappingEnabled;!t.isCompleted&&i&&(n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&(t.stagedVertex=e.mapStart,("segment"===t.geometryType||i&&0===t.numVertices)&&t.commitStagedVertex()),e})).next(t._snappingPipeline.createSnapDragEventPipelineStep({predicate:function(){return i},cancel:r,snappingManager:t.snappingManager,snappingContext:new w.a({editGeometryOperations:t._editGeometryOperations,elevationInfo:t.elevationInfo,pointer:a,visualizer:t.snappingVisualizer}),updatingHandles:t.updatingHandles}),t._snappingPipeline.next).next((function(e){return i&&(t.stagedVertex=e.mapEnd,"end"===e.action&&t.commitStagedVertex()),e})).next((function(e){return"end"===e.action&&("segment"!==t.geometryType&&"point"!==t.geometryType||t.complete()),e})),r.next((function(){i&&Object(v.k)(t.snappingManager)&&t.snappingManager.doneSnapping()})))}))}},{key:"_createManipulatorDragPipelineFreehand",value:function(e){var t=this;return Object(k.e)(e,(function(e,n){t.isCompleted||n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&(Object(v.j)(t.stagedVertex)&&(t.stagedVertex=e.mapStart),"segment"===t.geometryType&&t.commitStagedVertex()),e})).next((function(e){switch(e.action){case"start":case"update":t.stagedVertex=e.mapEnd,"polygon"!==t.geometryType&&"polyline"!==t.geometryType||t.commitStagedVertex();break;case"end":t.complete()}return e}))}))}},{key:"_createManipulatorDragPipelineHybrid",value:function(e){var t=this;return Object(k.e)(e,(function(e,n){t.isCompleted||n.next(t._screenToMapDragEventStep()).next((function(e){return"start"===e.action&&(Object(v.j)(t.stagedVertex)&&(t.stagedVertex=e.mapStart),t.commitStagedVertex()),e})).next((function(e){switch(e.action){case"start":case"update":t.stagedVertex=e.mapEnd,"polygon"!==t.geometryType&&"polyline"!==t.geometryType||t.commitStagedVertex();break;case"end":"segment"!==t.geometryType&&"point"!==t.geometryType||t.complete()}return e}))}))}},{key:"_getDrawSurface",value:function(){if(Object(v.j)(this.elevationDrawSurface))return this.drawSurface;if(!this.coordinateHelper.hasZ)return this.elevationDrawSurface.defaultZ=null,this.elevationDrawSurface;var e=this.defaultZ,t=!1;Object(v.k)(this.elevationInfo)&&"absolute-height"===this.elevationInfo.mode&&(t=!0),Object(v.k)(this.snapToSceneEnabled)&&(t=this.snapToSceneEnabled),Object(v.k)(this.elevationInfo)&&"on-the-ground"===this.elevationInfo.mode&&(t=!1);var n=this._activeComponent.vertices.length;return("segment"===this.geometryType||"polygon"===this.geometryType)&&n>0&&(e=this.coordinateHelper.getZ(this._activeComponent.vertices[0].pos),t=!1),t?this.drawSurface:(this.elevationDrawSurface.defaultZ=e,this.elevationDrawSurface)}},{key:"_mapToScreen",value:function(e){return this._getDrawSurface().mapToScreen(e)}},{key:"_onHold",value:function(e){Object(v.a)(this._snappingTask),"click"===this.drawingMode&&"touch"===e.pointerType&&this._snappingEnabled&&(this.stagedVertex=e.mapPoint),e.stopPropagation()}},{key:"_onImmediateClick",value:function(e){if(!this._manipulator.dragging){var t=this._activeComponent,n=this._closeOnClickVertexIndex(e.screenPoint);if(Object(v.k)(n))return e.stopPropagation(),this.discardStagedVertex(),void this.complete();var r=this._screenToMap(e.screenPoint);if(Object(v.k)(r))switch(this.drawingMode){case"freehand":"point"===this.geometryType&&(this.hasStagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(r)),this.complete());break;case"click":case"hybrid":this._snappingTask=Object(v.a)(this._snappingTask),this.hasStagedVertex?this.commitStagedVertex():this._editGeometryOperations.appendVertex(this.coordinateHelper.pointToVector(r)),("point"===this.geometryType||"segment"===this.geometryType&&2===t.vertices.length||"segment"===this.geometryType&&"hybrid"===this.drawingMode&&1===t.vertices.length)&&this.complete()}e.stopPropagation()}}},{key:"_onImmediateDoubleClick",value:function(e){this._manipulator.dragging||"point"===this.geometryType||(this.complete(),e.stopPropagation())}},{key:"_onPointerMove",value:function(e){var t=this;if(Object(v.a)(this._snappingTask),!(this._manipulator.dragging||this._pointerDownStates.has(e.pointerId)||this._manipulator.grabbing)&&this._manipulator.interactive){var n=Object(b.e)(e.x,e.y),r=this._closeOnClickVertexIndex(n);if(Object(v.k)(r)){this.discardStagedVertex();var o={componentIndex:0,vertexIndex:r,coordinates:this.coordinateHelper.vectorToArray(this._activeComponent.vertices[r].pos)};this.emit("cursor-update",{updated:null,vertices:[o],operation:"apply",type:"vertex-update"})}else{var s=this._screenToMap(n);if(this._manipulator.cursor=Object(v.k)(s)?"crosshair":null,Object(v.k)(s))if(Object(v.k)(this.snappingManager)){var c=this.snappingManager,u=new w.a({editGeometryOperations:this._editGeometryOperations,elevationInfo:this.elevationInfo,pointer:e.pointerType,visualizer:this.snappingVisualizer});this.stagedVertex=c.update(s,u),this._snappingTask=Object(y.h)(function(){var e=Object(i.a)(a.a.mark((function e(n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._frameTask.schedule((function(){return c.snap(s,u,n)}),n);case 2:if(r=e.sent,e.t0=r.valid,!e.t0){e.next=7;break}return e.next=7,t._frameTask.schedule((function(){t.stagedVertex=r.apply()}),n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.updatingHandles.addPromise(this._snappingTask.promise)}else this.stagedVertex=s}e.stopPropagation()}}},{key:"_screenToMap",value:function(e){return this._getDrawSurface().screenToMap(e)}},{key:"_screenToMapDragEventStep",value:function(){var e=this,t=null;return function(n){if("start"===n.action&&(t=e._screenToMap(n.screenStart)),Object(v.j)(t))return null;var r=e._screenToMap(n.screenEnd);return Object(v.k)(r)?Object(o.a)(Object(o.a)({},n),{},{mapStart:t,mapEnd:r}):null}}},{key:"_vertexWithinPointerDistance",value:function(e,t){var n=this._mapToScreen(this.coordinateHelper.vectorToDehydratedPoint(e));return!!Object(v.k)(n)&&function(e,t,n){var r=e.x-t.x,a=e.y-t.y;return r*r+a*a<=n}(n,t,25)}}]),n}(d.a.EventedMixin(p.a));Object(h.a)([Object(m.b)()],I.prototype,"defaultZ",void 0),Object(h.a)([Object(m.b)({value:j})],I.prototype,"drawingMode",null),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"elevationDrawSurface",void 0),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"elevationInfo",void 0),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"geometryType",void 0),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"hasM",void 0),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"hasZ",void 0),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"manipulators",void 0),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"drawSurface",void 0),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"snappingManager",void 0),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"snappingVisualizer",void 0),Object(h.a)([Object(m.b)()],I.prototype,"snapToSceneEnabled",void 0),Object(h.a)([Object(m.b)({readOnly:!0})],I.prototype,"updating",null),Object(h.a)([Object(m.b)({constructOnly:!0})],I.prototype,"view",void 0),I=Object(h.a)([Object(g.a)("esri.views.draw.DrawOperation")],I)}}]);
//# sourceMappingURL=29.15006f9c.chunk.js.map