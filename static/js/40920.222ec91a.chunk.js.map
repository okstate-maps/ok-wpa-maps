{"version":3,"file":"static/js/40920.222ec91a.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/networks/support/UtilityNetworkLookupHelper.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import o from\"../../core/Error.js\";import{LoadableMixin as t}from\"../../core/Loadable.js\";import{getOrCreateMapValue as s}from\"../../core/MapUtils.js\";import{EsriPromise as r}from\"../../core/Promise.js\";import{throwIfAborted as u}from\"../../core/promiseUtils.js\";import a from\"../../core/ReactiveMap.js\";import{property as n}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as i}from\"../../core/accessorSupport/decorators/subclass.js\";import{isSubtypeSublayer as p}from\"../../layers/support/layerUtils.js\";let l=class extends(t(r)){constructor(e){super(e),this.layerIdToSourceIdLookup=new a,this.sourceIdToLayerIdLookup=new a,this.sourceIdToNetworkInfo=new a,this._rulesBySourceId=new Map,this._terminalConfigurationsBySourceId=new Map}async load(e){return this.addResolvingPromise(this._load(e)),this}agatFromRule(e,o){let t;switch(o){case\"to\":t={networkSource:e.toNetworkSource??null,assetGroup:e.toAssetGroup??null,assetType:e.toAssetType??null};break;case\"from\":t={networkSource:e.fromNetworkSource??null,assetGroup:e.fromAssetGroup??null,assetType:e.fromAssetType??null};break;case\"via\":t={networkSource:e.viaNetworkSource??null,assetGroup:e.viaAssetGroup??null,assetType:e.viaAssetType??null}}return null===t.networkSource?null:t}agatToFullDefinition({assetGroup:e,assetType:o,networkSourceId:t}){if(null===t||null===e||null===o)return null;const s={networkSource:null,assetGroup:null,assetType:null},r=this.sourceIdToNetworkInfo.get(t);if(!r)return null;s.networkSource=r;const u=r.assetGroupLookup.get(e);return u?(s.assetGroup=u,s.assetType=u.assetTypeLookup.get(o)??null,null===s.assetType?null:s):null}findAgat(e,t){const s=p(t)?t.parent:t;if(!s)throw new o(\"utility-network:missing-layer\",\"Unable to find asset group/asset type for layer. The given layer is a `SubtypeSublayer` with no parent.\");if(this.utilityNetwork.featureServiceUrl!==s.url)return null;const r=this.getNetworkSourceIdForLayer(s);if(null===r)return null;const u=s.fieldsIndex.get(\"assettype\")?.name??\"\";if(\"\"===u)return null;const a=s.fieldsIndex.get(\"assetgroup\")?.name??\"\";if(\"\"===a)return null;const n=e.attributes[u],i=e.attributes[a];return null==n||null==i?null:{assetGroup:i,assetType:n,networkSourceId:r}}findAgatFullDefinition(e,o){const t=this.findAgat(e,o);return t?this.agatToFullDefinition(t):null}findRules({networkSourceId:e,assetGroup:o,assetType:t}){const s=[];if(null===e||null===o)return s;const r=this._rulesBySourceId.get(e)?.get(o);if(!r)return s;for(const u of r.generalRules)s.push(u);if(null!=t){const e=r.typeSpecificRules.get(t);if(e)for(const o of e)s.push(o)}return s}getNetworkSourceIdForLayer(e){const o=p(e)?e.parent:e;return o&&this.utilityNetwork.featureServiceUrl===o.url?this.layerIdToSourceIdLookup.get(o.layerId)??null:null}ruleMatchesAgat(e,o,t){switch(t){case\"to\":return!(e.toNetworkSource?.sourceId!==o.networkSourceId||e.toAssetGroup&&e.toAssetGroup.assetGroupCode!==o.assetGroup||e.toAssetType&&e.toAssetType.assetTypeCode!==o.assetType);case\"from\":return!(e.fromNetworkSource?.sourceId!==o.networkSourceId||e.fromAssetGroup&&e.fromAssetGroup.assetGroupCode!==o.assetGroup||e.fromAssetType&&e.fromAssetType.assetTypeCode!==o.assetType);case\"via\":return!(e.viaNetworkSource?.sourceId!==o.networkSourceId||e.viaAssetGroup&&e.viaAssetGroup.assetGroupCode!==o.assetGroup||e.viaAssetType&&e.viaAssetType.assetTypeCode!==o.assetType)}}ruleMatchesFullDefinitionAgat(e,o,t){switch(t){case\"to\":return!(e.toNetworkSource?.sourceId!==o.networkSource?.sourceId||e.toAssetGroup&&e.toAssetGroup.assetGroupCode!==o.assetGroup?.assetGroupCode||e.toAssetType&&e.toAssetType.assetTypeCode!==o.assetType?.assetTypeCode);case\"from\":return!(e.fromNetworkSource?.sourceId!==o.networkSource?.sourceId||e.fromAssetGroup&&e.fromAssetGroup.assetGroupCode!==o.assetGroup?.assetGroupCode||e.fromAssetType&&e.fromAssetType.assetTypeCode!==o.assetType?.assetTypeCode);case\"via\":return!(e.viaNetworkSource?.sourceId!==o.networkSource?.sourceId||e.viaAssetGroup&&e.viaAssetGroup.assetGroupCode!==o.assetGroup?.assetGroupCode||e.viaAssetType&&e.viaAssetType.assetTypeCode!==o.assetType?.assetTypeCode)}}terminalConfiguration(e,o,t){const s=this._terminalConfigurationsBySourceId.get(e);if(!s)return null;const r=s.get(o);if(!r)return null;const u=r.get(t);return u||null}async _load(e){await this.utilityNetwork.load(),u(e);const{dataElement:t}=this.utilityNetwork;if(!t)throw new o(\"utility-network:no-data-element\",\"No data element found on utility network\");for(const o of t.domainNetworks)for(const e of[...o.edgeSources??[],...o.junctionSources??[]]){this.layerIdToSourceIdLookup.set(e.layerId,e.sourceId),this.sourceIdToLayerIdLookup.set(e.sourceId,e.layerId);const o=(e.assetGroups??[]).map(e=>{const o=new a;for(const t of e.assetTypes??[])o.set(t.assetTypeCode,t);return{...e,assetTypeLookup:o}}),t=new a;for(const e of o)t.set(e.assetGroupCode,e);const s={...e,assetGroupLookup:t,assetGroups:o};this.sourceIdToNetworkInfo.set(s.sourceId,s)}const s=await this.utilityNetwork.getRulesTable();u(e);for(const o of s?.rules??[])switch(o.ruleType){case 3:case 2:case 4:case 1:this._registerRule(o.fromNetworkSource.sourceId,o.fromAssetGroup.assetGroupCode,o.fromAssetType.assetTypeCode,o),this._registerRule(o.toNetworkSource.sourceId,o.toAssetGroup.assetGroupCode,o.toAssetType.assetTypeCode,o);break;case 5:this._registerRule(o.fromNetworkSource.sourceId,o.fromAssetGroup.assetGroupCode,o.fromAssetType.assetTypeCode,o),this._registerRule(o.toNetworkSource.sourceId,o.toAssetGroup.assetGroupCode,o.toAssetType.assetTypeCode,o),this._registerRule(o.viaNetworkSource.sourceId,o.viaAssetGroup.assetGroupCode,o.viaAssetType.assetTypeCode,o)}this._makeTerminalConfigurationLookups(t)}_makeTerminalConfigurationLookups(e){const o={};for(const t of e.terminalConfigurations??[])o[t.terminalConfigurationId]=t;for(const t of e.domainNetworks??[])for(const e of t.junctionSources)if(\"esriUNFCUTJunctionObject\"===e.utilityNetworkFeatureClassUsageType||\"esriUNFCUTDevice\"===e.utilityNetworkFeatureClassUsageType)for(const t of e.assetGroups??[])for(const r of t.assetTypes??[])if(null!=r.terminalConfigurationId&&r.terminalConfigurationId>=0){const u=o[r.terminalConfigurationId];if(u){const o=s(this._terminalConfigurationsBySourceId,e.sourceId,()=>new Map);s(o,t.assetGroupCode,()=>new Map).set(r.assetTypeCode,u)}}}_registerRule(e,o,t,r){const u=s(this._rulesBySourceId,e,()=>new Map),a=s(u,o,()=>({generalRules:[],typeSpecificRules:new Map}));if(-1!==t){return void s(a.typeSpecificRules,t,()=>[]).push(r)}a.generalRules.push(r)}};e([n()],l.prototype,\"layerIdToSourceIdLookup\",void 0),e([n()],l.prototype,\"sourceIdToLayerIdLookup\",void 0),e([n()],l.prototype,\"sourceIdToNetworkInfo\",void 0),e([n()],l.prototype,\"utilityNetwork\",void 0),l=e([i(\"esri.networks.support.UtilityNetworkLookupHelper\")],l);export{l as UtilityNetworkLookupHelper};\n"],"names":["l","t","r","constructor","e","super","this","layerIdToSourceIdLookup","a","sourceIdToLayerIdLookup","sourceIdToNetworkInfo","_rulesBySourceId","Map","_terminalConfigurationsBySourceId","load","addResolvingPromise","_load","agatFromRule","o","_e$toNetworkSource","_e$toAssetGroup","_e$toAssetType","_e$fromNetworkSource","_e$fromAssetGroup","_e$fromAssetType","_e$viaNetworkSource","_e$viaAssetGroup","_e$viaAssetType","networkSource","toNetworkSource","assetGroup","toAssetGroup","assetType","toAssetType","fromNetworkSource","fromAssetGroup","fromAssetType","viaNetworkSource","viaAssetGroup","viaAssetType","agatToFullDefinition","_ref","_u$assetTypeLookup$ge","networkSourceId","s","get","u","assetGroupLookup","assetTypeLookup","findAgat","_s$fieldsIndex$get$na","_s$fieldsIndex$get","_s$fieldsIndex$get$na2","_s$fieldsIndex$get2","p","parent","utilityNetwork","featureServiceUrl","url","getNetworkSourceIdForLayer","fieldsIndex","name","n","attributes","i","findAgatFullDefinition","findRules","_ref2","_this$_rulesBySourceI","generalRules","push","typeSpecificRules","_this$layerIdToSource","layerId","ruleMatchesAgat","_e$toNetworkSource2","_e$fromNetworkSource2","_e$viaNetworkSource2","sourceId","assetGroupCode","assetTypeCode","ruleMatchesFullDefinitionAgat","_e$toNetworkSource3","_o$networkSource","_o$assetGroup","_o$assetType","_e$fromNetworkSource3","_o$networkSource2","_o$assetGroup2","_o$assetType2","_e$viaNetworkSource3","_o$networkSource3","_o$assetGroup3","_o$assetType3","terminalConfiguration","dataElement","domainNetworks","_o$edgeSources","edgeSources","_o$junctionSources","junctionSources","_e$assetGroups","set","assetGroups","map","_e$assetTypes","assetTypes","_objectSpread","getRulesTable","_s$rules","rules","ruleType","_registerRule","_makeTerminalConfigurationLookups","_e$terminalConfigurat","terminalConfigurations","terminalConfigurationId","_e$domainNetworks","utilityNetworkFeatureClassUsageType","_e$assetGroups2","_t$assetTypes","prototype"],"sourceRoot":""}