"use strict";(self.webpackChunkok_wpa_maps=self.webpackChunkok_wpa_maps||[]).push([[13862],{13862:(e,t,o)=>{o.d(t,{default:()=>J});var i=o(89379),l=o(6326),n=(o(11265),o(18690)),s=o(54901),r=o(76460),a=o(30726),d=o(50346),c=o(68134),p=o(46053),u=(o(81806),o(87990)),h=o(73265),v=o(25329),g=o(26611),m=o(67052);o(47249);const _=1,y={s:32,m:48,l:64},C={horizontal:{s:16,m:16,l:24},vertical:{s:16,m:24,l:40}},b={splitButton:{horizontal:"chevron-down",vertical:"ellipsis"},overflow:"ellipsis"};function f(e,t){var o,i;return e.vnodeSelector===t?[e]:null!==(o=null===(i=e.children)||void 0===i?void 0:i.flatMap(e=>f(e,t)))&&void 0!==o?o:[]}const M=e=>{const t=e;let o=class extends t{constructor(){super(...arguments),this.priority=0,this.scale="m",this.slot=void 0,this.lastActiveKey=null,this.layout="horizontal"}destroy(){var e;null!==(e=this.measurementManager)&&void 0!==e&&e.managedElements.remove(this),this.measurementManager=null}set measurementManager(e){const t=this._get("measurementManager");e!==t&&(t&&t.managedElements.remove(this),this._set("measurementManager",e),null===e||void 0===e||e.managedElements.add(this))}set budgetedLength(e){this.budgetedLength!==e&&(this._set("budgetedLength",e),this.scheduleRender())}get actionChildren(){var e,t;return null!==(e=null===(t=this.children)||void 0===t?void 0:t.flatMap(e=>f(e,"calcite-action")))&&void 0!==e?e:[]}get activeChildElement(){var e;const t=this.actionChildren.find(e=>{var t;return!0===(null===(t=e.properties)||void 0===t?void 0:t.active)});return t?(this._set("lastActiveKey",null===(e=t.properties)||void 0===e?void 0:e.key),t):this.lastActiveKey?this.actionChildren.find(e=>{var t;return(null===(t=e.properties)||void 0===t?void 0:t.key)===this.lastActiveKey}):void 0}_handleClick(e){(null===e||void 0===e?void 0:e.dataset)&&"dataset"in e&&e.dataset.actionKey&&(this.lastActiveKey=e.dataset.actionKey)}};return(0,l.Cg)([(0,p.MZ)()],o.prototype,"priority",void 0),(0,l.Cg)([(0,p.MZ)()],o.prototype,"measurementManager",null),(0,l.Cg)([(0,p.MZ)()],o.prototype,"budgetedLength",null),(0,l.Cg)([(0,p.MZ)()],o.prototype,"actionChildren",null),(0,l.Cg)([(0,p.MZ)()],o.prototype,"activeChildElement",null),(0,l.Cg)([(0,p.MZ)()],o.prototype,"scale",void 0),(0,l.Cg)([(0,p.MZ)()],o.prototype,"slot",void 0),(0,l.Cg)([(0,p.MZ)()],o.prototype,"lastActiveKey",void 0),(0,l.Cg)([(0,p.MZ)()],o.prototype,"layout",void 0),o=(0,l.Cg)([(0,u.$)("esri.widgets.Sketch.support.ResponsiveToolbar.ToolbarGroupBase")],o),o};var w=o(15187),T=o(54761);const O=Symbol("on-resize-handle-key");let k=class extends(M(v.A)){constructor(e){super(e),this._measuredWidth=0,this._measuredHeight=0,this._measuredElement=null}destroy(){this._measuredElement=null}get lengthOptions(){return["horizontal"===this.layout?this._measuredWidth:this._measuredHeight]}render(){return(0,T.K)("div",{afterCreate:e=>{this._measuredElement=e.firstElementChild,this.addHandles((0,w.EV)(this._measuredElement,()=>{var e,t,o,i;this._measuredWidth=null!==(e=null===(t=this._measuredElement)||void 0===t?void 0:t.clientWidth)&&void 0!==e?e:0,this._measuredHeight=null!==(o=null===(i=this._measuredElement)||void 0===i?void 0:i.clientHeight)&&void 0!==o?o:0}),O)},afterRemoved:()=>this.removeHandles(O)},this.children)}};(0,l.Cg)([(0,p.MZ)()],k.prototype,"_measuredWidth",void 0),(0,l.Cg)([(0,p.MZ)()],k.prototype,"_measuredHeight",void 0),(0,l.Cg)([(0,p.MZ)()],k.prototype,"lengthOptions",null),(0,l.Cg)([(0,p.MZ)()],k.prototype,"_measuredElement",void 0),k=(0,l.Cg)([(0,u.$)("esri.widgets.Sketch.support.ResponsiveToolbar.MeasuredContentGroup")],k);var Z,S=o(94126),A=o(63582);let P=(Z=class extends(M(v.A)){constructor(e){super(e),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return(0,S.W)({action:()=>Promise.all([o.e(55304),o.e(9474),o.e(85375),o.e(90596)]).then(o.bind(o,85375)),"action-group":()=>Promise.all([o.e(55304),o.e(9474),o.e(91654),o.e(85375),o.e(62428),o.e(51866),o.e(97577)]).then(o.bind(o,97577)),"action-menu":()=>Promise.all([o.e(55304),o.e(9474),o.e(91654),o.e(85375),o.e(62428),o.e(51866),o.e(3671)]).then(o.bind(o,3671))})}get minimumLength(){const{actionChildren:e,scale:t}=this;return e.length?this.allowCollapse?_+y[t]*Math.min(e.length,2):_+y[t]*e.length:0}get lengthOptions(){const{actionChildren:e,scale:t,minimumLength:o,allowCollapse:i,priority:l}=this,n=[o];if(e.length<=2||!i||l<1)return n;for(let s=1;s<e.length-1;s++)n.push(o+y[t]*s);return n}render(){if(!this.actionChildren.length)return(0,T.K)(T.w,null,void 0);const{budgetedLength:e,actionChildren:t,activeChildElement:o,layout:i,slot:l,scale:n}=this,s=Math.floor(e/y[n]),r=[],a=[];if(s>=t.length)r.push(...t);else{const e=null!==o&&void 0!==o?o:r.at(0);if(r.push(...t.slice(0,s-1)),a.push(...t.slice(s-1)),e&&a.includes(e)){const[t]=a.splice(a.indexOf(e),1),o=r.pop();r.push(t),o&&a.unshift(o)}}return(0,T.K)("calcite-action-group",{key:"overflow-button-group",layout:i,onclick:e=>this._handleClick(e.target),slot:l},r.map(e=>this._renderManagedAction(e)),a.length>0?(0,T.K)("calcite-action-menu",{key:"split-button-dropdown",label:this.messagesCommon.more,overlayPositioning:"fixed"},(0,T.K)("calcite-action",{icon:b.overflow,key:"split-button-dropdown-trigger",scale:n,slot:"trigger",text:this.messagesCommon.more}),a.map(e=>this._renderManagedAction(e))):void 0)}_renderManagedAction(e){var t,o,l;return(0,T.K)("calcite-action",(0,i.A)((0,i.A)({},null===e||void 0===e?void 0:e.properties),{},{"data-action-key":null===e||void 0===e||null===(t=e.properties)||void 0===t?void 0:t.key,text:null!==(o=null===e||void 0===e||null===(l=e.properties)||void 0===l?void 0:l.text)&&void 0!==o?o:""}))}},Z.vnodeSelector="calcite-action-group",Z);(0,l.Cg)([(0,p.MZ)()],P.prototype,"allowCollapse",void 0),(0,l.Cg)([(0,p.MZ)()],P.prototype,"minimumLength",null),(0,l.Cg)([(0,p.MZ)(),(0,A.G)("esri/t9n/common")],P.prototype,"messagesCommon",void 0),(0,l.Cg)([(0,p.MZ)()],P.prototype,"lengthOptions",null),P=(0,l.Cg)([(0,u.$)("esri.widgets.Sketch.support.ResponsiveToolbar.OverflowGroup")],P);var E=o(91967),K=o(19276);let R=class extends E.A{constructor(){super(...arguments),this.measuredElement=null,this.managedElements=new K.A,this.availableLength=0,this.layout="horizontal",this._resizeObserver=new ResizeObserver(()=>{this._measure()})}get _sortedElements(){return[...this.managedElements].sort((e,t)=>t.priority-e.priority)}connect(e){this._resizeObserver.disconnect(),this.measuredElement=e,this._resizeObserver.observe(e),this._measure()}allocate(){const e=new Map,{availableLength:t,_sortedElements:o}=this;let i=0;for(const l of o){const t=l.lengthOptions[0];e.set(l,t),i+=t}for(const l of o)for(;i<t;){const o=e.get(l);if(!o)break;const n=l.lengthOptions.find(e=>e>o);if(!n)break;const s=i-o+n;if(s>t)break;e.set(l,n),i=s}for(const[l,n]of e)l.budgetedLength=n}_measure(){var e,t;const o=this.measuredElement;this.availableLength=o?"horizontal"===this.layout?null!==(e=o.clientWidth)&&void 0!==e?e:0:null!==(t=o.clientHeight)&&void 0!==t?t:0:0,this.allocate()}destroy(){this._resizeObserver.disconnect()}};var x;(0,l.Cg)([(0,p.MZ)()],R.prototype,"measuredElement",void 0),(0,l.Cg)([(0,p.MZ)()],R.prototype,"managedElements",void 0),(0,l.Cg)([(0,p.MZ)()],R.prototype,"_sortedElements",null),(0,l.Cg)([(0,p.MZ)()],R.prototype,"availableLength",void 0),(0,l.Cg)([(0,p.MZ)()],R.prototype,"layout",void 0),R=(0,l.Cg)([(0,u.$)("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbarManager")],R);const B={splitButtonBase:"esri-split-button".concat("--split-part")};let z=(x=class extends(M(v.A)){constructor(e){super(e),this.allowCollapse=!0,this.messagesCommon=null}loadDependencies(){return(0,S.W)({action:()=>Promise.all([o.e(55304),o.e(9474),o.e(85375),o.e(90596)]).then(o.bind(o,85375)),"action-group":()=>Promise.all([o.e(55304),o.e(9474),o.e(91654),o.e(85375),o.e(62428),o.e(51866),o.e(97577)]).then(o.bind(o,97577)),"action-menu":()=>Promise.all([o.e(55304),o.e(9474),o.e(91654),o.e(85375),o.e(62428),o.e(51866),o.e(3671)]).then(o.bind(o,3671))})}get minimumLength(){const e=this.actionChildren;return e.length?1===e.length?y[this.scale]+_:this.allowCollapse?y[this.scale]+C[this.layout][this.scale]+_:y[this.scale]*e.length+_:0}get lengthOptions(){const{actionChildren:e,minimumLength:t,layout:o,scale:i,priority:l,allowCollapse:n}=this;if(e.length<2||l<0||!n)return[t];const s=_+y[i]*e.length;return[_+y[i]+C[o][i],s]}render(){if(!this.actionChildren.length)return(0,T.K)(T.w,null,void 0);const{actionChildren:e,minimumLength:t,budgetedLength:o,layout:i,slot:l,allowCollapse:n}=this,s=!n||e.length<2||o>t;return(0,T.K)("calcite-action-group",{key:"split-button-group",layout:i,onclick:e=>this._handleClick(e.target),slot:l},s?this._renderUnSplit():this._renderSplit())}_renderSplit(){const{activeChildElement:e,layout:t,actionChildren:o,scale:i,messagesCommon:l}=this,n=null!==e&&void 0!==e?e:o.at(0);if(!n)return;const s=o.filter(e=>e!==n);return[this._renderManagedAction(n),(0,T.K)("calcite-action-menu",{key:"split-button-dropdown",label:l.more,overlayPositioning:"fixed",placement:"horizontal"===t?"bottom-end":"right-end"},(0,T.K)("calcite-action",{class:"".concat(B.splitButtonBase,"--").concat(t,"--").concat(this.scale),compact:"horizontal"===t,icon:b.splitButton[t],key:"split-button-dropdown-trigger",scale:i,slot:"trigger",text:l.more}),null===s||void 0===s?void 0:s.map(e=>this._renderManagedAction(e)))]}_renderUnSplit(){return this.actionChildren.map(e=>this._renderManagedAction(e))}_renderManagedAction(e){var t,o,l;return(0,T.K)("calcite-action",(0,i.A)((0,i.A)({},null===e||void 0===e?void 0:e.properties),{},{"data-action-key":null===e||void 0===e||null===(t=e.properties)||void 0===t?void 0:t.key,text:null!==(o=null===e||void 0===e||null===(l=e.properties)||void 0===l?void 0:l.text)&&void 0!==o?o:""}))}},x.vnodeSelector="calcite-action-group",x);(0,l.Cg)([(0,p.MZ)()],z.prototype,"minimumLength",null),(0,l.Cg)([(0,p.MZ)()],z.prototype,"allowCollapse",void 0),(0,l.Cg)([(0,p.MZ)()],z.prototype,"lengthOptions",null),(0,l.Cg)([(0,p.MZ)(),(0,A.G)("esri/t9n/common")],z.prototype,"messagesCommon",void 0),z=(0,l.Cg)([(0,u.$)("esri.widgets.Sketch.support.ResponsiveToolbar.SplitButton")],z);const G="esri-responsive-toolbar",I={rulerBase:"".concat(G,"__ruler"),rulerBarHorizontal:"".concat(G,"__ruler--bar"),rulerBarVertical:"".concat(G,"__ruler--bar--vertical"),rulerPadVertical:"".concat(G,"__ruler--pad--vertical"),rulerPadHorizontal:"".concat(G,"__ruler--pad--horizontal"),bar:"".concat(G,"__bar"),barHorizontal:"".concat(G,"__bar--horizontal"),barVertical:"".concat(G,"__bar--vertical"),pad:"".concat(G,"__pad"),padVertical:"".concat(G,"__pad--vertical"),padHorizontal:"".concat(G,"__pad--horizontal")};let L=class extends v.A{constructor(e){super(e),this.scale="m",this.barStyle="floating",this._measurementManager=new R,this._managedWidgets=new Map}loadDependencies(){return(0,S.W)({"action-bar":()=>Promise.all([o.e(55304),o.e(9474),o.e(91654),o.e(85375),o.e(62428),o.e(51866),o.e(44204)]).then(o.bind(o,44204))})}destroy(){this._measurementManager=(0,a.pR)(this._measurementManager),this._managedWidgets.forEach(e=>e.destroy()),this._managedWidgets.clear()}set layout(e){const t=this._get("layout");this._set("layout",e),this._measurementManager&&(this._measurementManager.layout=e),t!==e&&this.scheduleRender()}get _barClasses(){const e="docked"===this.barStyle,t="vertical"===this.layout;return{[I.barHorizontal]:e&&!t,[I.barVertical]:e&&t,[I.bar]:e,[I.padHorizontal]:!e&&!t,[I.padVertical]:!e&&t,[I.pad]:!e}}render(){const{layout:e,scale:t,barStyle:o}=this,l={layout:e,scale:t,expandDisabled:!0,key:"measured-toolbar"},n="docked"===o?"vertical"===e?I.rulerBarVertical:I.rulerBarHorizontal:"horizontal"===e?I.rulerPadHorizontal:I.rulerPadVertical;return(0,T.K)("div",null,(0,T.K)("div",{afterCreate:e=>{var t;null===(t=this._measurementManager)||void 0===t||t.connect(e)},class:this.classes(I.rulerBase,n)}),(0,T.K)("calcite-action-bar",(0,i.A)((0,i.A)({},l),{},{classes:this._barClasses,floating:"docked"!==o,overflowActionsDisabled:!0}),this._renderChildren()))}_renderChildren(){var e;if(!this.children)return;const t=this.children.filter(e=>{var t;return void 0!==(null===(t=e.properties)||void 0===t?void 0:t.key)&&"group-kind"in e.properties}),o=new Set,l=t.map(e=>{var t,l,n,s;const r=e.properties,a=r.key;o.add(a);const d="docked"===this.barStyle&&null!==(t=r.slot)&&void 0!==t?t:void 0,c=null!==(l=r.priority)&&void 0!==l?l:0,p=null!==(n=r["group-kind"])&&void 0!==n?n:"overflow-group",u=null===(s=r["allow-collapse"])||void 0===s||s,h=this._managedWidgets.get(a);if(h)return h.children=e.children,h.priority=c,"allowCollapse"in h&&(h.allowCollapse=u),h.slot=d,h.layout=this.layout,h.scale=this.scale,h.measurementManager=this._measurementManager,h;const v={scale:this.scale,priority:c,measurementManager:this._measurementManager,children:e.children,slot:d,layout:this.layout};switch(p){case"split-button":{const e=new z((0,i.A)((0,i.A)({},v),{},{allowCollapse:u}));return this._managedWidgets.set(a,e),e}case"overflow-group":{const e=new P((0,i.A)((0,i.A)({},v),{},{allowCollapse:u}));return this._managedWidgets.set(a,e),e}case"measured-content":{const e=new k((0,i.A)({},v));return this._managedWidgets.set(a,e),e}}}).filter(n.Ru);return Array.from(this._managedWidgets.keys()).filter(e=>!o.has(e)).forEach(e=>{var t;null!==(t=this._managedWidgets.get(e))&&void 0!==t&&t.destroy(),this._managedWidgets.delete(e)}),null!==(e=this._measurementManager)&&void 0!==e&&e.allocate(),l.map(e=>e.render())}};(0,l.Cg)([(0,p.MZ)()],L.prototype,"scale",void 0),(0,l.Cg)([(0,p.MZ)({value:"horizontal"})],L.prototype,"layout",null),(0,l.Cg)([(0,p.MZ)()],L.prototype,"barStyle",void 0),(0,l.Cg)([(0,p.MZ)()],L.prototype,"_measurementManager",void 0),(0,l.Cg)([(0,p.MZ)()],L.prototype,"_managedWidgets",void 0),(0,l.Cg)([(0,p.MZ)()],L.prototype,"_barClasses",null),L=(0,l.Cg)([(0,u.$)("esri.widgets.Sketch.support.ResponsiveToolbar.ResponsiveToolbar")],L);var H=o(52849),W=o(49947),V=o(26598),D=o(12254),U=o(29065),F=o(97875),$=o(39348);const N="esri-sketch",j={base:N,vertical:"".concat(N,"--vertical"),docked:"".concat(N,"-bar"),floating:"".concat(N,"-pad"),chipHorizontal:"".concat(N,"__selection-count-chip--horizontal"),chipVertical:"".concat(N,"__selection-count-chip--vertical"),chipVerticalSmall:"".concat(N,"__selection-count-chip--vertical--s"),popoverWrapper:"".concat(N,"__popover-wrapper")},Q={point:"pin",polyline:"line",polygon:"polygon",rectangle:"rectangle",circle:"circle",multipoint:"pins",mesh:"i3d-building",freehandPolygon:"freehand-area",freehandPolyline:"freehand",text:"add-text"};let q=class extends v.A{constructor(e,t){var o;super(e,t),this._activeCustomToolOptions=null,this._selectionToolbar=null,this._viewModelHandlesGroup=null,this.availableCreateTools=["point","polyline","polygon","rectangle","circle"],this.customToolOptions=null,this.customActions=null,this.toolbarKind="floating",this.contextualToolLocation="separate",this.groupCollapsePriorities=null,this.groupAllowCollapseOptions=null,this.messages=null,this.messagesCommon=null,this.visibleElements=new m.AP,this._defaultViewModel=null,this._calcitePopoverReferenceElement=null,this._relativeLocation="top",this._popoverOpen=!1,this._activateCreateTool=this._activateCreateTool.bind(this),this.viewModel=(null===e||void 0===e?void 0:e.viewModel)||(this._defaultViewModel=new g.A({creationMode:null!==(o=null===e||void 0===e?void 0:e.creationMode)&&void 0!==o?o:"continuous"}))}initialize(){const{layer:e,view:t}=this,o="2d"===(null===t||void 0===t?void 0:t.type),i=new H.A({persistSelection:!1,visibleElements:new U.A({chip:!1,lassoTool:o,operationTypeControls:!1,pan:!1,pointTool:!1,rectangleTool:o}),view:t,sources:e?[e]:null,scale:this.scale});this.addHandles([(0,c.wB)(()=>this.viewModel,e=>{this._viewModelHandlesGroup=(0,a.xt)(this._viewModelHandlesGroup),e&&(this._viewModelHandlesGroup=(0,s.vE)([e.on("create",()=>this.scheduleRender()),e.on("update",()=>this.scheduleRender()),e.on("delete",e=>this.emit("delete",e)),e.on("undo",()=>this.scheduleRender()),e.on("redo",()=>this.scheduleRender()),(0,c.wB)(()=>e.layer,e=>{this._selectionToolbar&&(this._selectionToolbar.sources=e?[e]:null)}),(0,c.wB)(()=>e.view,e=>{this._selectionToolbar&&(this._selectionToolbar.view=e)}),(0,c.wB)(()=>e.state,()=>this.notifyChange("state"))]))},c.pc),(0,c.z7)(()=>i.activeOperation,()=>this.viewModel.cancel()),i.on("complete",e=>this._onSelectionOperationComplete(e)),(0,c.wB)(()=>{const{view:e,visibleElements:{selectionTools:t}}=this;return{lassoTool:"3d"!==(null===e||void 0===e?void 0:e.type)&&!(null===t||void 0===t||!t["lasso-selection"]),rectangleTool:"3d"!==(null===e||void 0===e?void 0:e.type)&&!(null===t||void 0===t||!t["rectangle-selection"])}},e=>{Object.assign(i.visibleElements,e)},c.pc)]),this._selectionToolbar=i}loadDependencies(){return(0,S.W)({action:()=>Promise.all([o.e(55304),o.e(9474),o.e(85375),o.e(90596)]).then(o.bind(o,85375)),chip:()=>Promise.all([o.e(55304),o.e(9474),o.e(10239)]).then(o.bind(o,10239)),popover:()=>Promise.all([o.e(55304),o.e(9474),o.e(91654),o.e(85375),o.e(62428),o.e(51866)]).then(o.bind(o,51866))})}destroy(){var e;null!==(e=this._selectionToolbar)&&void 0!==e&&e.destroy(),this._viewModelHandlesGroup=(0,a.xt)(this._viewModelHandlesGroup)}get activeTool(){var e;const t=null===(e=this._selectionToolbar)||void 0===e?void 0:e.activeOperation;if(t)switch(t.toolName){case"lasso":return"lasso-selection";case"rectangle":return"rectangle-selection";case"default":return"custom-selection"}const o=this._effectiveAvailableCreateTools,{activeTool:i,activeCreateToolDrawMode:l}=this.viewModel;return"polygon"===i&&"freehand"===l&&null!==o&&void 0!==o&&o.includes("freehandPolygon")?"freehandPolygon":"polyline"===i&&"freehand"===l&&null!==o&&void 0!==o&&o.includes("freehandPolyline")?"freehandPolyline":this.viewModel.activeTool}get activeTooltip(){return this.viewModel.activeTooltip}get createGraphic(){return this.viewModel.createGraphic}get creationMode(){return this.viewModel.creationMode}set creationMode(e){this.viewModel.creationMode=e}get defaultCreateOptions(){return this.viewModel.defaultCreateOptions}set defaultCreateOptions(e){this.viewModel.defaultCreateOptions=e}get defaultUpdateOptions(){return this.viewModel.defaultUpdateOptions}set defaultUpdateOptions(e){this.viewModel.defaultUpdateOptions=e}get icon(){return"pencil"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e,t;return null!==(e=null===(t=this.messages)||void 0===t?void 0:t.widgetLabel)&&void 0!==e?e:""}set label(e){this._overrideIfSome("label",e)}get labelOptions(){return this.viewModel.labelOptions}set labelOptions(e){this.viewModel.labelOptions=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}set layout(e){this._set("layout",e),this._selectionToolbar&&(this._selectionToolbar.layout=e)}set scale(e){this._set("scale",e),this._selectionToolbar&&(this._selectionToolbar.scale=e)}get snappingOptions(){return this.viewModel.snappingOptions}set snappingOptions(e){this.viewModel.snappingOptions=e}get state(){var e;return null!==(e=this._selectionToolbar)&&void 0!==e&&e.activeOperation?"active":this.viewModel.state}get tooltipOptions(){return this.viewModel.tooltipOptions}set tooltipOptions(e){this.viewModel.tooltipOptions=e}get updateGraphics(){return this.viewModel.updateGraphics}get valueOptions(){return this.viewModel.valueOptions}set valueOptions(e){this.viewModel.valueOptions=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set viewModel(e){const t=this._get("viewModel");e!==t&&(t&&t===this._defaultViewModel&&(0,a.pR)(t),this._set("viewModel",e))}get _effectiveAvailableCreateTools(){const{availableCreateTools:e,view:t,visibleElements:o}=this,i=null===e||void 0===e?void 0:e.filter(e=>{var t;return!(null===(t=o.createTools)||void 0===t||!t[e])});return"3d"===(null===t||void 0===t?void 0:t.type)?null===i||void 0===i?void 0:i.filter(e=>"multipoint"!==e):i}create(e,t,o){var i;const l=null!==(i=null===o||void 0===o?void 0:o.createOptions)&&void 0!==i?i:t;return this._activeCustomToolOptions=o,(0,d.QZ)(this.viewModel.create(e,l))}update(e,t){return(0,d.QZ)(this.viewModel.update(e,t))}complete(){this.viewModel.complete()}cancel(){var e;null!==(e=this._selectionToolbar)&&void 0!==e&&e.cancel(),this.viewModel.cancel(),this._activeCustomToolOptions=null}undo(){var e;this.viewModel.undo(),null===(e=this.view)||void 0===e||e.focus()}redo(){var e;this.viewModel.redo(),null===(e=this.view)||void 0===e||e.focus()}delete(){this.viewModel.delete()}duplicate(){return this.viewModel.duplicate()}dismissFloatingElements(){this._popoverOpen=!1}render(){var e,t,o,i,l,n;const{toolbarKind:s,layout:r,scale:a}=this,d=null===(e=this.customActions)||void 0===e?void 0:e.filter(e=>"selection-toolbar"===e.position);return(0,T.K)("div",null,(0,T.K)("div",{classes:{[j.base]:!0,[j.floating]:"floating"===s,[j.docked]:"docked"===s,[j.vertical]:"vertical"===r}},(0,T.K)(L,{barStyle:s,layout:r,scale:a},this._renderSelectionSetItemGroupInline(),(0,T.K)("div",{"allow-collapse":null===(t=null===(o=this.groupAllowCollapseOptions)||void 0===o?void 0:o.get("selectionTools"))||void 0===t||t,"group-kind":"split-button",key:"selection-split-button",priority:null!==(i=null===(l=this.groupCollapsePriorities)||void 0===l?void 0:l.get("selectionTools"))&&void 0!==i?i:0},this._renderDefaultSelectionButton(),null===(n=this._selectionToolbar)||void 0===n?void 0:n.render(),null===d||void 0===d?void 0:d.map(e=>this._renderToolbarItem(e))),this._renderCreateToolActionGroup(),this._renderUndoRedoMenuItemGroup(),this._renderSettingsMenuItemGroup()),this._renderSelectionSetToolbar(),this._renderSettingsMenuPopover()))}_renderSettingsMenuPopover(){const{messagesCommon:e,snappingOptions:t,view:o,viewModel:i,visibleElements:l}=this;if(!this._calcitePopoverReferenceElement)return;const n={directionModePicker:l.directionModePicker,labelsToggle:l.labelsToggle,tooltipsToggle:l.tooltipsToggle},s="horizontal"===this.layout?"top"===this._relativeLocation?"bottom-end":"top-end":"right-end";return(0,T.K)("calcite-popover",{closable:!0,heading:e.settings,label:e.settings,open:this._popoverOpen,overlayPositioning:"fixed",placement:s,referenceElement:this._calcitePopoverReferenceElement,scale:this.scale,onCalcitePopoverBeforeClose:()=>this._popoverOpen=!1,onCalcitePopoverBeforeOpen:e=>this._remeasurePopoverSizes(e.currentTarget),onCalcitePopoverClose:()=>this._refocusOnView()},(0,T.K)("div",{class:j.popoverWrapper},Object.values(n).includes(!0)?(0,T.K)(W.A,{sketchOptions:i.sketchOptions,viewType:null===o||void 0===o?void 0:o.type,visibleElements:new F.A(n)}):void 0,l.snappingControls&&o&&t?(0,T.K)(V.A,{snappingManager:this.viewModel.snappingManager,snappingOptions:t,view:o,visibleElements:l.snappingControlsElements}):void 0))}_renderSelectionSetToolbar(){if("separate"!==this.contextualToolLocation)return;const e=this._renderSelectionSetItemGroup();return null!==e&&void 0!==e&&e.length?(0,T.K)(L,{barStyle:this.toolbarKind,layout:this.layout,scale:this.scale},e):void 0}_renderSelectionSetItemGroupInline(){return"separate"===this.contextualToolLocation?[]:this._renderSelectionSetItemGroup()}_renderUndoRedoMenuItemGroup(){var e,t,o,i;return(0,T.K)("div",{"allow-collapse":null===(e=null===(t=this.groupAllowCollapseOptions)||void 0===t?void 0:t.get("undoRedo"))||void 0===e||e,"group-kind":"split-button",key:"undo-redo-menu",priority:null!==(o=null===(i=this.groupCollapsePriorities)||void 0===i?void 0:i.get("undoRedo"))&&void 0!==o?o:10,slot:"actions-end"},this._renderUndoButton(),this._renderRedoButton())}_renderSettingsMenuItemGroup(){var e,t,o,i,l;const s=[],r=[];null===(e=this.customActions)||void 0===e||e.forEach(e=>{"settings-before"===e.position?r.push(e):"settings-after"===e.position&&s.push(e)});const a=[...r.map(e=>this._renderToolbarItem(e)),this._renderSettingsMenuButton(),...s.map(e=>this._renderToolbarItem(e))].filter(n.Ru);if(a.length)return(0,T.K)("div",{"allow-collapse":null!==(t=null===(o=this.groupAllowCollapseOptions)||void 0===o?void 0:o.get("settings"))&&void 0!==t&&t,"group-kind":"overflow-group",key:"settings-menu",priority:null!==(i=null===(l=this.groupCollapsePriorities)||void 0===l?void 0:l.get("settings"))&&void 0!==i?i:1e3,slot:"actions-end"},a)}_renderSelectionSetItemGroup(){var e,t,o,i,l,n;if(!this.updateGraphics.length)return[];const s="inline-end"===this.contextualToolLocation?"actions-end":void 0,r=null===(e=this.customActions)||void 0===e?void 0:e.filter(e=>"before-selection-set"===e.position),a=null===(t=this.customActions)||void 0===t?void 0:t.filter(e=>"after-selection-set"===e.position),d=null!==(o=null===(i=this.groupCollapsePriorities)||void 0===i?void 0:i.get("selectionSet"))&&void 0!==o?o:100;return[(0,T.K)("div",{"group-kind":"measured-content",key:"selection-count-chip-group",priority:d,slot:s},this._renderFeatureCountChip()),(0,T.K)("div",{"allow-collapse":null!==(l=null===(n=this.groupAllowCollapseOptions)||void 0===n?void 0:n.get("selectionSet"))&&void 0!==l&&l,"group-kind":"overflow-group",key:"selection-set-tool-group",priority:d,slot:s},null===r||void 0===r?void 0:r.map(e=>this._renderToolbarItem(e)),this._renderDuplicateButton(),this._renderDeleteButton(),null===a||void 0===a?void 0:a.map(e=>this._renderToolbarItem(e)))]}_renderDefaultSelectionButton(){if(!this.viewModel.updateOnGraphicClick)return[];const{messages:e,state:t}=this;return this._renderToolbarItem({id:"pointer-select",text:e.selectFeature,icon:"cursor",onclick:this._activateDefaultSelectTool,active:"ready"===t})}_renderCreateToolActionGroup(){var e,t,o,i,l,n,s,r;const a=null!==(e=null===(t=this._effectiveAvailableCreateTools)||void 0===t?void 0:t.flatMap(e=>this._renderBuiltInCreateToolItem(e)))&&void 0!==e?e:[],d=null!==(o=null===(i=this.customToolOptions)||void 0===i?void 0:i.flatMap(e=>this._renderCustomToolItem(e)))&&void 0!==o?o:[];return(0,T.K)("div",{"allow-collapse":null===(l=null===(n=this.groupAllowCollapseOptions)||void 0===n?void 0:n.get("createTools"))||void 0===l||l,"group-kind":"overflow-group",key:"create-tools-group",priority:null!==(s=null===(r=this.groupCollapsePriorities)||void 0===r?void 0:r.get("createTools"))&&void 0!==s?s:100},a,d)}_renderBuiltInCreateToolItem(e){return this._renderToolbarItem({id:"".concat(e,"-button"),text:this.messages.draw[e],icon:Q[e],onclick:()=>this._activateCreateTool(e),active:this.activeTool===e&&!this._activeCustomToolOptions})}_renderCustomToolItem(e){var t;const{toolKey:o}=e;return this._renderToolbarItem({id:"custom-".concat(e.toolKey),text:e.label,icon:e.icon,onclick:()=>this._activateCreateTool(e.toolName,null,e),active:(null===(t=this._activeCustomToolOptions)||void 0===t?void 0:t.toolKey)===o})}_renderUndoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"undo-button",text:this.messages.undo,icon:"undo",disabled:!this.viewModel.canUndo(),onclick:this.undo,flipRTL:!0}):[]}_renderRedoButton(){return this.visibleElements.undoRedoMenu?this._renderToolbarItem({id:"redo-button",text:this.messages.redo,icon:"redo",disabled:!this.viewModel.canRedo(),onclick:this.redo,flipRTL:!0}):[]}_renderSettingsMenuButton(){return this.visibleElements.settingsMenu?this._renderToolbarItem({id:"settings-menu-action",text:this.messagesCommon.settings,icon:"gear",active:this._popoverOpen,onclick:()=>this._popoverOpen=!this._popoverOpen,afterCreate:e=>this._calcitePopoverReferenceElement=e,afterUpdate:e=>this._calcitePopoverReferenceElement=e,afterRemoved:()=>this._calcitePopoverReferenceElement=null}):[]}_renderFeatureCountChip(){if(!this.visibleElements.selectionCountLabel)return[];const{layout:e,messages:t,scale:o,id:i,updateGraphics:{length:l}}=this,n=(0,$.V)(t.selectedCount,{count:l}),s="s"===o?99:999,r=l>s?(0,$.V)(t.selectedCountTruncated,{truncated:s}):l,a="s"===o&&"vertical"===e,d="".concat(i,a?"-selection-chip-small":"-selection-chip");return[a?(0,T.K)("span",{classes:{[j.chipVertical]:!0,[j.chipVerticalSmall]:"s"===this.scale},id:d,tabIndex:0,title:n},r):(0,T.K)("calcite-chip",{appearance:"outline",class:"horizontal"===e?j.chipHorizontal:j.chipVertical,id:d,kind:"brand",label:n,scale:"l"===o?"m":"s",tabIndex:0,title:"vertical"===e?n:void 0},"vertical"===e?r:n)]}_renderDuplicateButton(){if(!this.visibleElements.duplicateButton)return[];const{messages:e}=this;return this._renderToolbarItem({id:"duplicate",text:this.updateGraphics.length>1?e.duplicateFeatures:e.duplicateFeature,icon:"copy",onclick:this._onDuplicateSelect})}_renderDeleteButton(){if(!this.visibleElements.deleteButton)return[];const{messages:e}=this,t=this.updateGraphics.length>1?e.deleteFeatures:e.deleteFeature;return this._renderToolbarItem({id:"delete",text:t,icon:"trash",onclick:this.delete})}_renderToolbarItem(e){let{id:t,text:o,icon:i,disabled:l,onclick:n,active:s,flipRTL:r,afterCreate:a,afterUpdate:d,afterRemoved:c}=e;const p="".concat(this.id,"-").concat(t);return[(0,T.K)("calcite-action",{active:s,afterCreate:a,afterRemoved:c,afterUpdate:d,bind:this,"data-testid":t,disabled:l||"disabled"===this.state,icon:i,iconFlipRtl:null!==r&&void 0!==r&&r,id:p,key:t,onclick:n,scale:this.scale,text:o,title:o})]}_remeasurePopoverSizes(e){try{var t,o,i;const l=e.parentElement,n=null===this||void 0===this||null===(t=this.view)||void 0===t||null===(t=t.container)||void 0===t?void 0:t.getBoundingClientRect(),s=null===l||void 0===l?void 0:l.style;if(!(l&&n&&s&&null!==(o=this.view)&&void 0!==o&&null!==(o=o.container)&&void 0!==o&&o.contains(l)))return;const r=this._calcitePopoverReferenceElement;if(!r)return;const{bottom:a,top:d}=r.getBoundingClientRect();if("horizontal"===this.layout){const e=a<n.height/2;e!==("top"===this._relativeLocation)&&(this._relativeLocation=e?"top":"bottom"),e?(null!==s&&void 0!==s&&s.setProperty("--sketch-view-height-offset",a-n.top+"px"),null===s||void 0===s||s.setProperty("--sketch-view-margin-offset","30px")):(null!==s&&void 0!==s&&s.setProperty("--sketch-view-height-offset",n.bottom-d+"px"),null===s||void 0===s||s.setProperty("--sketch-view-margin-offset","15px"))}else"vertical"===this.layout&&(s.setProperty("--sketch-view-height-offset","15px"),s.setProperty("--sketch-view-margin-offset","15px"));const c=null===(i=e.shadowRoot)||void 0===i||null===(i=i.querySelector("div.header"))||void 0===i?void 0:i.getBoundingClientRect().height;s.setProperty("--sketch-popover-header-offset","".concat(c,"px"))}catch(l){r.A.getLogger(this.declaredClass).warnOnce("Sketch failed to lay out settings menu.",l)}}_activateCreateTool(e,t,o){var i;const l=this._activeCustomToolOptions;if(o||l){if((null===o||void 0===o?void 0:o.toolKey)===(null===l||void 0===l?void 0:l.toolKey))return void this.cancel()}else if(this.activeTool===e)return void this.cancel();null!==(i=this._selectionToolbar)&&void 0!==i&&i.cancel(),this.create(e,t,o)}_onDuplicateSelect(){const e=this.duplicate(),t=this.viewModel.activeTool;"transform"!==t&&"reshape"!==t||this.update(e,{tool:t})}_onSelectionOperationComplete(e){const{viewModel:{defaultUpdateOptions:t}}=this,{selection:o}=e;if(!e.aborted&&o.length){const e=t.tool,l=o.length>1&&"reshape"===e?"transform":e;this.update(o,(0,i.A)((0,i.A)({},t),{},{tool:l}))}this.notifyChange("state")}_activateDefaultSelectTool(){var e;this.cancel(),null===(e=this.view)||void 0===e||e.focus()}_refocusOnView(){var e;this.activeTool&&(null===(e=this.view)||void 0===e||e.focus())}};(0,l.Cg)([(0,p.MZ)()],q.prototype,"_activeCustomToolOptions",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"activeTool",null),(0,l.Cg)([(0,p.MZ)({readOnly:!0})],q.prototype,"activeTooltip",null),(0,l.Cg)([(0,p.MZ)({cast:e=>{if(null===e||void 0===e||!e.length)return null;const t=new Set(["point","polyline","polygon","rectangle","circle","multipoint","freehandPolyline","freehandPolygon","mesh","text"]);return e.filter(e=>t.has(e))}})],q.prototype,"availableCreateTools",void 0),(0,l.Cg)([(0,p.MZ)({readOnly:!0})],q.prototype,"createGraphic",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"creationMode",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"customToolOptions",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"customActions",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"defaultCreateOptions",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"defaultUpdateOptions",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"icon",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"label",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"labelOptions",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"layer",null),(0,l.Cg)([(0,p.MZ)({type:["horizontal","vertical"],value:"horizontal"})],q.prototype,"layout",null),(0,l.Cg)([(0,p.MZ)({value:"m"})],q.prototype,"scale",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"toolbarKind",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"contextualToolLocation",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"groupCollapsePriorities",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"groupAllowCollapseOptions",void 0),(0,l.Cg)([(0,p.MZ)(),(0,A.G)("esri/widgets/Sketch/t9n/Sketch")],q.prototype,"messages",void 0),(0,l.Cg)([(0,p.MZ)(),(0,A.G)("esri/t9n/common")],q.prototype,"messagesCommon",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"snappingOptions",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"state",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"tooltipOptions",null),(0,l.Cg)([(0,p.MZ)({readOnly:!0})],q.prototype,"updateGraphics",null),(0,l.Cg)([(0,p.MZ)({type:h.A,nonNullable:!0})],q.prototype,"valueOptions",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"view",null),(0,l.Cg)([(0,p.MZ)({type:g.A}),(0,D.U)(["create","update","undo","redo"])],q.prototype,"viewModel",null),(0,l.Cg)([(0,p.MZ)({type:m.AP,nonNullable:!0})],q.prototype,"visibleElements",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"_effectiveAvailableCreateTools",null),(0,l.Cg)([(0,p.MZ)()],q.prototype,"_defaultViewModel",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"_calcitePopoverReferenceElement",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"_relativeLocation",void 0),(0,l.Cg)([(0,p.MZ)()],q.prototype,"_popoverOpen",void 0),q=(0,l.Cg)([(0,u.$)("esri.widgets.Sketch")],q);const J=q}}]);
//# sourceMappingURL=13862.5f69a478.chunk.js.map