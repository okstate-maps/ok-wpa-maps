"use strict";(self.webpackChunkok_wpa_maps=self.webpackChunkok_wpa_maps||[]).push([[22851],{22851(e,t,i){i.r(t),i.d(t,{default:()=>D});var r=i(6326),l=(i(11265),i(68134)),o=i(88685),s=i(46053),n=(i(81806),i(76460),i(47249),i(87990)),a=i(31933),d=i(1723),u=i(25329),c=i(82141),p=i(94126),h=i(89379),g=i(21403),v=(i(15187),i(63582)),m=i(54761),y=i(91967),C=i(18690),_=i(19276),f=i(23406),b=i(53430);const M={date:[],dateOnly:[],id:["is","isNot","startsWith","endsWith","contains","doesNotContain"],number:["is","isNot","startsWith","endsWith","contains","doesNotContain","isBlank","isNotBlank"],timeOnly:[],timestampOffset:[],string:["is","isNot","startsWith","endsWith","contains","doesNotContain","isBlank","isNotBlank","isEmpty","isNotEmpty"]};let w=class extends y.A{constructor(e){super(e),this.fieldName=null,this.layer=null,this.operator="is",this.operators=M,this.value=null}initialize(){this.addHandles((0,l.wB)(()=>this.layer,async e=>{e&&!e.loaded&&await e.load()},l.Vh))}get domain(){const{fieldName:e,layer:t}=this;if(e&&t)return t.getFieldDomain(e)}get field(){const{fieldName:e,layer:t}=this;if(e&&t)return t.fieldsIndex.get(e)}get fields(){var e,t;return(null!==(e=null===(t=this.layer)||void 0===t?void 0:t.fields)&&void 0!==e?e:[]).filter(e=>!!((0,b.yM)(e)||(0,b.WA)(e)||(0,b.te)(e)||(0,b.Xz)(e)))}get fieldLabel(){const{field:e}=this;return e&&(e.alias||e.name)||""}get isObjectIDField(){const{field:e}=this;return!!e&&(0,b.te)(e)}get isGlobalIDField(){const{field:e}=this;return!!e&&(0,b.Xz)(e)}get isIntegerField(){return(0,b.R3)(this.field)}get isNumericField(){return(0,b.WA)(this.field)}get isStringField(){return(0,b.yM)(this.field)}get isTimeOnlyField(){return(0,b.OH)(this.field)}get normalizedFieldName(){var e;return(0,b.rS)(null===(e=this.field)||void 0===e?void 0:e.name)}get state(){const{layer:e}=this;return e?e.loaded?"ready":"loading":"disabled"}get valueAsString(){const{value:e}=this;return null==e||""===e?"":"".concat(e)}get normalizedValue(){const{value:e,isNumericField:t,isObjectIDField:i}=this;return null==e||""===e?"":t||i?"".concat(e):"'".concat(e,"'")}get whereClause(){const{normalizedFieldName:e,operator:t,normalizedValue:i}=this;return e&&t?"isBlank"===t?"".concat(e," IS NULL"):"isNotBlank"===t?"".concat(e," IS NOT NULL"):"isEmpty"===t?"".concat(e," = ''"):"isNotEmpty"===t?"".concat(e," <> ''"):""===i?null:"is"===t?"".concat(e," = ").concat(i):"isNot"===t?"".concat(e," <> ").concat(i):"startsWith"===t?"".concat(e," LIKE ").concat(i,"%"):"endsWith"===t?"".concat(e," LIKE %").concat(i):"contains"===t?"".concat(e," LIKE %").concat(i,"%"):"doesNotContain"===t?"".concat(e," NOT LIKE %").concat(i,"%"):null:null}};(0,r.Cg)([(0,s.MZ)()],w.prototype,"domain",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"field",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"fields",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"fieldLabel",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"fieldName",void 0),(0,r.Cg)([(0,s.MZ)()],w.prototype,"isObjectIDField",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"isIntegerField",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"isNumericField",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"isStringField",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"isTimeOnlyField",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"layer",void 0),(0,r.Cg)([(0,s.MZ)()],w.prototype,"normalizedFieldName",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"operator",void 0),(0,r.Cg)([(0,s.MZ)()],w.prototype,"operators",void 0),(0,r.Cg)([(0,s.MZ)()],w.prototype,"state",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"value",void 0),(0,r.Cg)([(0,s.MZ)()],w.prototype,"valueAsString",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"normalizedValue",null),(0,r.Cg)([(0,s.MZ)()],w.prototype,"whereClause",null),w=(0,r.Cg)([(0,n.$)("esri.widgets.support.FilterCondition.FilterConditionViewModel")],w);const F={},Z="esri-filter-condition",O={base:Z,valueInputContainer:"".concat(Z,"__value-input-container")};let I=class extends u.A{constructor(e,t){super(e,t),this.messages=null,this.messagesCommon=null,this.viewModel=new w,this.visibleElements=(0,h.A)({},F)}loadDependencies(){return(0,p.W)({input:()=>Promise.all([i.e(55304),i.e(9474),i.e(36175),i.e(38841)]).then(i.bind(i,38841)),option:()=>i.e(46422).then(i.bind(i,46422)),select:()=>Promise.all([i.e(55304),i.e(9474),i.e(2253)]).then(i.bind(i,2253))})}get _defaultFieldName(){const{fields:e,fieldName:t}=this;return t||(null!==e&&void 0!==e&&e.length?e[0].name:void 0)}get _valueInputType(){const{viewModel:e}=this;return e.isNumericField||e.isObjectIDField?"number":"text"}get _visibleOperators(){const{field:e,operators:t,viewModel:i}=this;return e?i.isStringField||i.isGlobalIDField?t.string:i.isNumericField?t.number:i.isObjectIDField?t.id:[]:[]}get _isValueInputHidden(){const{operator:e}=this;return!!e&&["isBlank","isNotBlank","isEmpty","isNotEmpty"].includes(e)}get domain(){return this.viewModel.domain}get field(){return this.viewModel.field}get fields(){return this.viewModel.fields}get fieldLabel(){return this.viewModel.fieldLabel}get fieldName(){return this.viewModel.fieldName}set fieldName(e){this.viewModel.fieldName=e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get normalizedFieldName(){return this.viewModel.normalizedFieldName}get operator(){return this.viewModel.operator}set operator(e){this.viewModel.operator=e}get operators(){return this.viewModel.operators}set operators(e){this.viewModel.operators=e}get state(){return this.viewModel.state}get value(){return this.viewModel.value}set value(e){this.viewModel.value=e}get valueAsString(){return this.viewModel.valueAsString}castVisibleElements(e){return(0,h.A)((0,h.A)({},F),e)}get whereClause(){return this.viewModel.whereClause}render(){return(0,m.K)("div",{class:O.base},this._renderFieldSelection(),this._renderOperatorSelection(),this._renderValueInput())}_renderFieldSelection(){const{layer:e,normalizedFieldName:t}=this;return(0,m.K)("div",null,(0,m.K)("calcite-select",{afterCreate:()=>{this.fieldName||(this.fieldName=this._defaultFieldName)},bind:this,label:this.messages.chooseField,width:"full",onCalciteSelectChange:e=>{let{currentTarget:t}=e;this.value=null,this.fieldName=t.value}},this.fields.map(i=>{const r=(0,f._)(i,e);return this._renderOption(i.name,r,t)})))}_renderOperatorSelection(){const{_visibleOperators:e,messages:t,operator:i}=this;if(e.length)return(0,m.K)("div",null,(0,m.K)("calcite-select",{afterUpdate:e=>{const t=e.value;this._visibleOperators.includes(t)||(this.operator=this._visibleOperators[0])},bind:this,label:t.operator,required:!0,width:"full",onCalciteSelectChange:e=>{this.operator=e.currentTarget.value}},e.map(e=>this._renderOption(e,t.operators[e],i))))}_renderOption(e,t,i){return(0,m.K)("calcite-option",{key:e,label:null!==t&&void 0!==t?t:e,selected:e===i,value:e})}_renderValueInput(){const{valueAsString:e,domain:t,messages:i,operator:r}=this;if(!this._isValueInputHidden){if("coded-value"===(null===t||void 0===t?void 0:t.type)&&t.codedValues.length&&("is"===r||"isNot"===r)){const r=t.codedValues[0].code;return(0,m.K)("div",{key:"value-select"},(0,m.K)("calcite-select",{afterCreate:()=>this._afterSelectCreateOrUpdate(r),afterUpdate:()=>this._afterSelectCreateOrUpdate(r),bind:this,label:i.value,required:!0,width:"full",onCalciteSelectChange:e=>{let{currentTarget:t}=e;this._onValueChange(t.value)}},t.codedValues.map(t=>{let{code:i,name:r}=t;return this._renderOption("".concat(i),r,e)})))}return(0,m.K)("div",{class:O.valueInputContainer,key:"value-input"},(0,m.K)("calcite-input",{label:i.value,type:this._valueInputType,value:e,onCalciteInputInput:e=>{let{currentTarget:t}=e;this._onValueChange(t.value)}}))}}_afterSelectCreateOrUpdate(e){null==this.value&&(this.value=e)}_onValueChange(e){const{viewModel:t}=this;e&&""!==e?t.isStringField||t.isGlobalIDField?this.value=e.toString():(t.isNumericField||t.isObjectIDField)&&(this.value=parseFloat(e)):this.value=null}};(0,r.Cg)([(0,s.MZ)()],I.prototype,"_defaultFieldName",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"_valueInputType",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"_visibleOperators",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"_isValueInputHidden",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"domain",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"field",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"fields",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"fieldLabel",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"fieldName",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"layer",null),(0,r.Cg)([(0,s.MZ)(),(0,v.G)("esri/widgets/support/FilterCondition/t9n/FilterCondition")],I.prototype,"messages",void 0),(0,r.Cg)([(0,s.MZ)(),(0,v.G)("esri/t9n/common")],I.prototype,"messagesCommon",void 0),(0,r.Cg)([(0,s.MZ)()],I.prototype,"normalizedFieldName",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"operator",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"operators",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"state",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"value",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"valueAsString",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"viewModel",void 0),(0,r.Cg)([(0,s.MZ)()],I.prototype,"visibleElements",void 0),(0,r.Cg)([(0,g.w)("visibleElements")],I.prototype,"castVisibleElements",null),(0,r.Cg)([(0,s.MZ)()],I.prototype,"whereClause",null),I=(0,r.Cg)([(0,n.$)("esri.widgets.support.FilterCondition")],I);let S=class extends y.A{constructor(e){super(e),this.conditionOperator="AND",this.conditionWidgets=new _.A,this.layer=null,this.operators=M}initialize(){this.addHandles([(0,l.wB)(()=>this.layer,async e=>{e&&!e.loaded&&await e.load()},l.Vh)])}get count(){return this.conditionWidgets.length}get state(){const{layer:e}=this;return e?e.loaded?"ready":"loading":"disabled"}get whereClause(){const{conditionOperator:e,whereClauses:t}=this;let i="";return t.forEach((t,r)=>{i+=r>0?" ".concat(e," (").concat(t,")"):"(".concat(t,")")}),i}get whereClauses(){return this.conditionWidgets.toArray().map(e=>e.whereClause).filter(C.Ru)}addCondition(e,t){const{layer:i,operators:r}=this;i&&this.conditionWidgets.add(new I((0,h.A)((0,h.A)({},e),{},{layer:i,operators:r})),t)}duplicateCondition(e){const t=this.conditionWidgets.at(e);if(!t)return;const{fieldName:i,operator:r,value:l}=t;this.addCondition({fieldName:i,operator:r,value:l})}reset(){this.conditionWidgets.removeAll()}removeCondition(e){null==e?this.conditionWidgets.pop():this.conditionWidgets.splice(e,1)}};(0,r.Cg)([(0,s.MZ)()],S.prototype,"conditionOperator",void 0),(0,r.Cg)([(0,s.MZ)()],S.prototype,"conditionWidgets",void 0),(0,r.Cg)([(0,s.MZ)()],S.prototype,"count",null),(0,r.Cg)([(0,s.MZ)()],S.prototype,"layer",void 0),(0,r.Cg)([(0,s.MZ)()],S.prototype,"operators",void 0),(0,r.Cg)([(0,s.MZ)()],S.prototype,"state",null),(0,r.Cg)([(0,s.MZ)()],S.prototype,"whereClause",null),(0,r.Cg)([(0,s.MZ)()],S.prototype,"whereClauses",null),S=(0,r.Cg)([(0,n.$)("esri.widgets.support.FilterBuilder.FilterBuilderViewModel")],S);const N={fab:!0,menu:!0},L="esri-filter-builder",T={base:L,conditionContainer:"".concat(L,"__condition-container"),operatorSelect:"".concat(L,"__operator-select")};let K=class extends u.A{constructor(e,t){super(e,t),this.messages=null,this.messagesCommon=null,this.viewModel=new S,this.visibleElements=(0,h.A)({},N)}loadDependencies(){return(0,p.W)({action:()=>Promise.all([i.e(55304),i.e(9474),i.e(85375),i.e(90596)]).then(i.bind(i,85375)),"action-menu":()=>Promise.all([i.e(55304),i.e(9474),i.e(91654),i.e(85375),i.e(62428),i.e(51866),i.e(3671)]).then(i.bind(i,3671)),block:()=>Promise.all([i.e(55304),i.e(9474),i.e(91654),i.e(85375),i.e(62428),i.e(51866),i.e(14841),i.e(75502)]).then(i.bind(i,75502)),fab:()=>Promise.all([i.e(55304),i.e(9474),i.e(43285),i.e(95019)]).then(i.bind(i,58862)),option:()=>i.e(46422).then(i.bind(i,46422)),select:()=>Promise.all([i.e(55304),i.e(9474),i.e(2253)]).then(i.bind(i,2253))})}get conditionOperator(){return this.viewModel.conditionOperator}set conditionOperator(e){this.viewModel.conditionOperator=e}get count(){return this.viewModel.count}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get operators(){return this.viewModel.operators}set operators(e){this.viewModel.operators=e}get state(){return this.viewModel.state}castVisibleElements(e){return(0,h.A)((0,h.A)({},N),e)}get whereClause(){return this.viewModel.whereClause}get whereClauses(){return this.viewModel.whereClauses}render(){return(0,m.K)("div",{class:T.base},this._renderOperatorSelect(),this._renderConditions(),this._renderFAB())}reset(){this.viewModel.reset()}_renderOperatorSelect(){if(this.count<2)return;const{conditionOperator:e,messages:t}=this,i="AND"===e;return(0,m.K)("div",{class:T.operatorSelect},(0,m.K)("calcite-select",{label:t.condition,width:"full",onCalciteSelectChange:e=>{let{currentTarget:t}=e;this.conditionOperator=t.value}},(0,m.K)("calcite-option",{label:t.allAreTrue,selected:i,value:"AND"}),(0,m.K)("calcite-option",{label:t.anyAreTrue,selected:!i,value:"OR"})))}_renderConditions(){return this.viewModel.conditionWidgets.toArray().map((e,t)=>this._renderConditionContainer(e,t))}_renderConditionContainer(e,t){return(0,m.K)("calcite-block",{class:T.conditionContainer,expanded:!0,heading:this.messages.condition},e.render(),this._renderConditionrMenu(t))}_renderFAB(){if(!this.visibleElements.fab)return;const e="loading"===this.state;return(0,m.K)("calcite-fab",{appearance:"outline-fill",disabled:e,icon:"plus",kind:"neutral",loading:e,onclick:()=>this.viewModel.addCondition(),text:this.messages.addNew,textEnabled:!0})}_renderConditionrMenu(e){if(!this.visibleElements.menu)return;const{messages:t}=this;return(0,m.K)("calcite-action-menu",{label:t.moreOptions,overlayPositioning:"fixed",placement:"bottom-end",slot:"control"},(0,m.K)("calcite-action",{onclick:()=>this.viewModel.removeCondition(e),text:t.delete,textEnabled:!0}),(0,m.K)("calcite-action",{onclick:()=>this.viewModel.duplicateCondition(e),text:t.duplicate,textEnabled:!0}))}};(0,r.Cg)([(0,s.MZ)()],K.prototype,"conditionOperator",null),(0,r.Cg)([(0,s.MZ)()],K.prototype,"count",null),(0,r.Cg)([(0,s.MZ)()],K.prototype,"layer",null),(0,r.Cg)([(0,s.MZ)(),(0,v.G)("esri/widgets/support/FilterBuilder/t9n/FilterBuilder")],K.prototype,"messages",void 0),(0,r.Cg)([(0,s.MZ)(),(0,v.G)("esri/t9n/common")],K.prototype,"messagesCommon",void 0),(0,r.Cg)([(0,s.MZ)()],K.prototype,"operators",null),(0,r.Cg)([(0,s.MZ)()],K.prototype,"state",null),(0,r.Cg)([(0,s.MZ)()],K.prototype,"viewModel",void 0),(0,r.Cg)([(0,s.MZ)()],K.prototype,"visibleElements",void 0),(0,r.Cg)([(0,g.w)("visibleElements")],K.prototype,"castVisibleElements",null),(0,r.Cg)([(0,s.MZ)()],K.prototype,"whereClause",null),(0,r.Cg)([(0,s.MZ)()],K.prototype,"whereClauses",null),K=(0,r.Cg)([(0,n.$)("esri.widgets.support.FilterBuilder")],K);var A=i(98108),k=i(87540),B=i(52849),V=i(29065),E=i(39348);const W="esri-feature-form-utility-network-association-layers",x={base:W,header:"".concat(W,"__header"),headingContent:"".concat(W,"__heading-content"),featureObserver:"".concat(W,"__feature-observer"),filterContainer:"".concat(W,"__filter-container"),filterOptionsContainer:"".concat(W,"__filter-options-container"),filterOptionsHeader:"".concat(W,"__filter-options-header"),listContainer:"".concat(W,"__list-container"),spatialSelectContainer:"".concat(W,"__spatial-select-container"),spatialSelectToolbar:"".concat(W,"__spatial-select-toolbar"),stickySpinnerContainer:"".concat(W,"__sticky-loading-container"),loadingContainer:"".concat(W,"__loading-container")};let P=class extends u.A{constructor(e,t){super(e,t),this.headingLevel=5,this.messagesCommon=null,this.messagesEditor=null,this.messagesFeature=null,this.messagesFeatureForm=null,this.messagesFilterBuilder=null,this.viewModel=new c.A,this.view=null,this._filterBuilder=new K,this._featureFilterText="",this._layerFilterText="",this._observer=new IntersectionObserver(e=>{let[t]=e;(null===t||void 0===t?void 0:t.isIntersecting)&&this._increaseFeaturePage()},{root:window.document}),this._observerNode=null,this._selectionToolbar=new B.A({returnFeatureTitleFields:!0,layerViewPreferenceEnabled:!1,persistSelection:!1,visibleElements:new V.A({chip:!1,operationTypeControls:!1,pan:!1})}),this._onSelectionComplete=async e=>{const{highlightHelper:t}=this.viewModel;await this.viewModel.onSelectionComplete(e),null!==t&&void 0!==t&&t.removeAll(),this._featureSpatialGraphics.length>0&&(null===t||void 0===t||t.add(this._featureSpatialGraphics))}}initialize(){this._setupSelectionToolbar(),this.addHandles([(0,l.wB)(()=>this.viewModel,()=>this.reset()),(0,l.wB)(()=>[this.viewModel.state,this._observerNode],()=>this._onObserverChange()),(0,l.wB)(()=>this.selectedLayer,e=>{this._filterBuilder.layer=e,e||(this.filterOptionsVisible=!1,this._featureFilterText="")})])}loadDependencies(){return(0,p.W)({action:()=>Promise.all([i.e(55304),i.e(9474),i.e(85375),i.e(90596)]).then(i.bind(i,85375)),button:()=>Promise.all([i.e(55304),i.e(9474),i.e(43285),i.e(58538)]).then(i.bind(i,43285)),icon:()=>Promise.all([i.e(55304),i.e(16702)]).then(i.bind(i,16702)),input:()=>Promise.all([i.e(55304),i.e(9474),i.e(36175),i.e(38841)]).then(i.bind(i,38841)),list:()=>Promise.all([i.e(55304),i.e(9474),i.e(36175),i.e(38841),i.e(75802)]).then(i.bind(i,75802)),"list-item":()=>Promise.all([i.e(55304),i.e(9474),i.e(91654),i.e(85375),i.e(14841),i.e(25412)]).then(i.bind(i,70205)),loader:()=>i.e(35688).then(i.bind(i,35688))})}destroy(){this._filterBuilder.destroy(),this._selectionToolbar.destroy()}get filterOptionsVisible(){return this.viewModel.filterOptionsVisible}set filterOptionsVisible(e){this.viewModel.filterOptionsVisible=e}get isSelecting(){return"active"===this._selectionToolbar.state}get selectedLayer(){return this.viewModel.selectedLayer}set selectedLayer(e){this.viewModel.selectedLayer=e}get selectedFeature(){return this.viewModel.selectedFeature}set selectedFeature(e){this.viewModel.selectedFeature=e}get filterWhereClause(){return this.viewModel.filterWhereClause}set filterWhereClause(e){this.viewModel.filterWhereClause=e,e||this._filterBuilder.reset()}get _featureSpatialGraphics(){return this.viewModel.featureSpatialItems.toArray().map(e=>e.feature)}get _filteredFeatureItems(){const{_featureFilterText:e}=this,{featureItems:t,featureSpatialItems:i}=this.viewModel;return(i.length?i:t).map(e=>({label:e.label,graphic:e.feature,layer:e.feature.sourceLayer})).filter(t=>{var i,r;return null!==(i=null===(r=t.label)||void 0===r?void 0:r.toLowerCase().includes(e))&&void 0!==i&&i})}get _filteredFeatureItemsPage(){const{featurePage:e,featuresPerPage:t}=this.viewModel,i=e*t;return this._filteredFeatureItems.toArray().slice(0,i)}render(){return(0,m.K)("div",{class:this.classes(x.base,A.D.widget)},this._renderContent())}applyFilterOptions(){const{selectedLayer:e}=this;this.filterOptionsVisible=!1,e&&(this.filterWhereClause=this._filterBuilder.whereClause)}cancelSelection(){this._selectionToolbar.cancel()}reset(){this.filterWhereClause=null,this._featureFilterText="",this._layerFilterText="",this.filterOptionsVisible=!1,this._filterBuilder.reset()}startSelection(e){this._selectionToolbar.activateTool(e)}_setupSelectionToolbar(){this.addHandles([(0,l.wB)(()=>this.view,e=>{this.viewModel.reset(),this._selectionToolbar.view="2d"===(null===e||void 0===e?void 0:e.type)?e:null},l.Vh),(0,l.wB)(()=>{var e,t;return[this.viewModel,this.viewModel.layerItems.length,null===(e=this.viewModel.map)||void 0===e?void 0:e.allLayers.map(e=>e.visible),null===(t=this.viewModel.map)||void 0===t||null===(t=t.allLayers)||void 0===t?void 0:t.filter(e=>(0,a.F2)(e)).toArray().flatMap(e=>e.sublayers.toArray()).map(e=>e.visible)]},()=>this._updateToolbarSources()),(0,l.on)(()=>this._selectionToolbar,"before-activate",e=>this.emit("before-selection",e)),(0,l.on)(()=>this._selectionToolbar,"complete",this._onSelectionComplete)])}_updateToolbarSources(){const e=this.viewModel.layerItems.toArray().filter(e=>{const{parent:t}=e;return!(t&&((0,a.jZ)(t)||(0,a.F2)(t))&&!t.visible)&&e.visible});this._selectionToolbar.sources=e}_onObserverChange(){this._observerNode&&this._observer.unobserve(this._observerNode);const{state:e}=this.viewModel;this._observerNode&&"ready"===e&&this._observer.observe(this._observerNode)}_increaseFeaturePage(){const{featureCount:e,featurePage:t,featureSpatialItems:i,state:r}=this.viewModel;e||i.length||1===t?"ready"===r&&this.viewModel.featurePage++:this.viewModel.featurePage=1}_renderContent(){const{state:e,filterOptionsVisible:t}=this.viewModel;return"loading"===e?this._renderLoading():t?this._renderFilterOptions():[this._renderSelectionToolbar(),this._renderListContent()]}_renderListContent(){var e;return null!==(e=this._selectionToolbar.activeOperation)&&void 0!==e&&e.processingFinalSelection?this._renderLoading():this.selectedLayer||this.viewModel.featureSpatialItems.length?this._renderFeatures():this._renderLayers()}_renderSelectionToolbar(){var e;const{messagesCommon:t,_selectionToolbar:i}=this,{featureSpatialItems:r,selectedLayer:l}=this.viewModel;if(l||null===(e=i.sources)||void 0===e||!e.length)return null;const o=(0,m.K)("div",{class:x.spatialSelectToolbar},i.render()),s=(0,m.K)("calcite-button",{appearance:"transparent",disabled:!r.length,label:t.clear,onclick:()=>this.viewModel.reset()},t.clear);return(0,m.K)("div",{class:x.spatialSelectContainer,key:"spatial-select-toolbar"},o,s)}_renderStickyLoading(){return"querying"===this.viewModel.state?(0,m.K)("div",{class:x.stickySpinnerContainer,key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoading(){return(0,m.K)("div",{class:x.loadingContainer,key:"loading-container"},this._renderLoadingIcon())}_renderLoadingIcon(){return(0,m.K)("calcite-loader",{inline:!0,label:this.messagesCommon.loading})}_renderFilterOptions(){return(0,m.K)("div",{class:x.filterOptionsContainer},(0,m.K)("div",{class:x.filterOptionsHeader},(0,m.K)("span",null,this.messagesFilterBuilder.widgetLabel),(0,m.K)("calcite-button",{appearance:"transparent",onclick:()=>this._filterBuilder.reset()},this.messagesCommon.clear)),this._filterBuilder.render())}_renderLayers(){const e=this.messagesFeatureForm.associations,t=e.availableLayers,i=e.filterLayers;return(0,m.K)("div",null,this._renderHeader({heading:t,placeholder:i,renderFilterOptions:!1,renderTotal:!1}),(0,m.K)("div",{class:x.listContainer},(0,m.K)("calcite-list",{label:e.associatedFeatures},this._renderLayerItems(),this._renderStickyLoading())))}_renderLayerItems(){const{_layerFilterText:e,viewModel:t,messagesCommon:i}=this,{layerItems:r,tableItems:l}=t;return r.concat(l).map(e=>{var t;return{label:null!==(t=e.title)&&void 0!==t?t:i.untitled,layer:e}}).filter(t=>{var i,r;return null!==(i=null===(r=t.label)||void 0===r?void 0:r.toLowerCase().includes(e))&&void 0!==i&&i}).toArray().map(e=>this._renderLayerItem(e))}_renderLayerItem(e){const{label:t,layer:i}=e;return(0,m.K)("calcite-list-item",{key:"layer-item-".concat(i.id),label:(0,o._e)(t),onCalciteListItemSelect:()=>{this.selectedLayer=i,this._filterBuilder.reset()}},(0,m.K)("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderFeatures(){const{selectedLayer:e,viewModel:t}=this,i=t.featureSpatialItems.length>0,r=this.messagesFeatureForm.associations,l=i?void 0:(null===e||void 0===e?void 0:e.title)||this.messagesCommon.untitled,o=r.filterFeatures;return(0,m.K)("div",null,this._renderHeader({heading:l,placeholder:o,renderFilterOptions:!i,renderTotal:!0}),(0,m.K)("div",{class:x.listContainer},(0,m.K)("calcite-list",{label:r.associatedFeatures},this._renderFeatureItems(),this._renderStickyLoading(),this._renderFeatureObserver())))}_renderFeatureItems(){return this._filteredFeatureItemsPage.map(e=>this._renderFeatureItem(e))}_renderFeatureItem(e){const{viewModel:t}=this,{highlightHelper:i}=t,{label:r,graphic:l}=e,s=t.featureSpatialItems.length>0?()=>null===i||void 0===i?void 0:i.update(l,d.Tv):void 0,n=t.featureSpatialItems.length>0?()=>null===i||void 0===i?void 0:i.update(l,d.n4):void 0;return(0,m.K)("calcite-list-item",{key:"feature-item-".concat(l.uid),label:(0,o._e)(r),onmouseenter:s,onmouseleave:n,onCalciteListItemSelect:()=>{this.selectedFeature={feature:l,label:r}}},(0,m.K)("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"}))}_onObserverCreate(e){this._observerNode=e}_renderFeatureObserver(){return(0,m.K)("div",{afterCreate:this._onObserverCreate,bind:this,class:x.featureObserver,key:"feature-observer"})}_renderHeader(e){return(0,m.K)("div",{class:x.header,key:"filter"},this._renderHeading(e.heading),this._renderFilter(e.placeholder,e.renderFilterOptions),e.renderTotal?this._renderTotal():null)}_renderHeading(e){return e?(0,m.K)(k.D,{key:"title",level:this.headingLevel},(0,m.K)("div",{class:x.headingContent},(0,m.K)("calcite-icon",{icon:"layer"}),e)):null}_renderFilter(e,t){const i=!this.selectedLayer&&!this.viewModel.featureSpatialItems.length,r=i?this._layerFilterText:this._featureFilterText;return(0,m.K)("div",{class:x.filterContainer,key:"filter"},(0,m.K)("calcite-input",{icon:"search",placeholder:e,type:"search",value:r,onCalciteInputInput:e=>{i?this._layerFilterText=e.currentTarget.value.trim().toLowerCase():this._featureFilterText=e.currentTarget.value.trim().toLowerCase()}},t?this._renderFilterOptionsAction():null))}_renderFilterOptionsAction(){const e=this.messagesFeatureForm.associations.filterOptions;return(0,m.K)("calcite-action",{appearance:"transparent",icon:"sliders",indicator:!!this._filterBuilder.whereClause,onclick:()=>{this.viewModel.filterOptionsVisible=!this.viewModel.filterOptionsVisible},scale:"s",slot:"action",text:e,title:e})}_renderTotal(){const{messagesFeature:e,viewModel:t}=this,{featureCount:i,featureSpatialItems:r}=t,l=(0,E.V)(e.numberRecords,{number:r.length?r.length:i});return(0,m.K)("div",{key:"total"},l)}};(0,r.Cg)([(0,s.MZ)()],P.prototype,"filterOptionsVisible",null),(0,r.Cg)([(0,s.MZ)()],P.prototype,"headingLevel",void 0),(0,r.Cg)([(0,s.MZ)()],P.prototype,"isSelecting",null),(0,r.Cg)([(0,s.MZ)(),(0,v.G)("esri/t9n/common")],P.prototype,"messagesCommon",void 0),(0,r.Cg)([(0,s.MZ)(),(0,v.G)("esri/widgets/Editor/t9n/Editor")],P.prototype,"messagesEditor",void 0),(0,r.Cg)([(0,s.MZ)(),(0,v.G)("esri/widgets/Feature/t9n/Feature")],P.prototype,"messagesFeature",void 0),(0,r.Cg)([(0,s.MZ)(),(0,v.G)("esri/widgets/FeatureForm/t9n/FeatureForm")],P.prototype,"messagesFeatureForm",void 0),(0,r.Cg)([(0,s.MZ)(),(0,v.G)("esri/widgets/support/FilterBuilder/t9n/FilterBuilder")],P.prototype,"messagesFilterBuilder",void 0),(0,r.Cg)([(0,s.MZ)()],P.prototype,"selectedLayer",null),(0,r.Cg)([(0,s.MZ)({type:c.A})],P.prototype,"viewModel",void 0),(0,r.Cg)([(0,s.MZ)()],P.prototype,"selectedFeature",null),(0,r.Cg)([(0,s.MZ)()],P.prototype,"filterWhereClause",null),(0,r.Cg)([(0,s.MZ)()],P.prototype,"view",void 0),(0,r.Cg)([(0,s.MZ)()],P.prototype,"_filterBuilder",void 0),(0,r.Cg)([(0,s.MZ)()],P.prototype,"_featureFilterText",void 0),(0,r.Cg)([(0,s.MZ)()],P.prototype,"_layerFilterText",void 0),(0,r.Cg)([(0,s.MZ)()],P.prototype,"_observer",void 0),(0,r.Cg)([(0,s.MZ)()],P.prototype,"_featureSpatialGraphics",null),(0,r.Cg)([(0,s.MZ)()],P.prototype,"_filteredFeatureItems",null),(0,r.Cg)([(0,s.MZ)()],P.prototype,"_filteredFeatureItemsPage",null),(0,r.Cg)([(0,s.MZ)()],P.prototype,"_observerNode",void 0),P=(0,r.Cg)([(0,n.$)("esri.widgets.FeatureForm.FeatureFormUtilityNetworkAssociations.UtilityNetworkAssociationItemList")],P);const D=P}}]);
//# sourceMappingURL=22851.c2a5569c.chunk.js.map