"use strict";(self.webpackChunkok_wpa_maps=self.webpackChunkok_wpa_maps||[]).push([[95796],{66486(t,e,i){i.d(e,{A:()=>d});var s,l=i(6326),n=i(50076),o=i(42553),r=i(53084),a=i(76460),h=i(46053),u=i(21403),c=i(87990),p=i(8141),f=i(52297);let d=s=class extends o.o{static createEmptyBand(t,e){return new(s.getPixelArrayConstructor(t))(e)}static combineBandMasks(t){if(t.length<2)return t[0];const e=t[0].length,i=new Uint8Array(e).fill(255);for(let s=0;s<t.length;s++){const l=t[s];for(let t=0;t<e;t++)l[t]||(i[t]=0)}return i}static getPixelArrayConstructor(t){let e;switch(t){case"u1":case"u2":case"u4":case"u8":e=Uint8Array;break;case"u16":e=Uint16Array;break;case"u32":e=Uint32Array;break;case"s8":e=Int8Array;break;case"s16":e=Int16Array;break;case"s32":e=Int32Array;break;case"f32":case"c64":case"c128":case"unknown":e=Float32Array;break;case"f64":e=Float64Array}return e}constructor(t){super(t),this.width=null,this.height=null,this.pixelType="f32",this.validPixelCount=null,this.mask=null,this.maskIsAlpha=!1,this.premultiplyAlpha=!1,this.statistics=null,this.depthCount=1}castPixelType(t){if(!t)return"f32";let e=t.toLowerCase();return["u1","u2","u4"].includes(e)?e="u8":["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].includes(e)||(e="f32"),e}getPlaneCount(){var t;return null===(t=this.pixels)||void 0===t?void 0:t.length}addData(t){var e;if(!t.pixels||t.pixels.length!==this.width*this.height)throw new n.A("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(t.pixels),this.statistics.push(null!==(e=t.statistics)&&void 0!==e?e:new p.z)}getAsRGBA(){const t=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(t);break;default:this._fillFrom8Bit(t)}return new Uint8ClampedArray(t)}getAsRGBAFloat(){const t=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(t),t}updateStatistics(){if(!this.pixels)return;this.statistics=this.pixels.map(t=>function(t,e){let i=1/0,s=-1/0;const l=t.length;let n,o=0;if(null!=e)for(n=0;n<l;n++)e[n]&&(o=t[n],i=o<i?o:i,s=o>s?o:s);else for(n=0;n<l;n++)o=t[n],i=o<i?o:i,s=o>s?o:s;return new p.z(i,s)}(t,this.mask));const t=this.mask;let e=0;if(null!=t)for(let i=0;i<t.length;i++)t[i]&&e++;else e=this.width*this.height;this.validPixelCount=e}clamp(t){if(!t||"f64"===t||"f32"===t||!this.pixels)return;const[e,i]=(0,f.hP)(t),l=this.pixels,n=this.width*this.height,o=l.length;let r,a,h;const u=[];for(let c=0;c<o;c++){h=s.createEmptyBand(t,n),r=l[c];for(let t=0;t<n;t++)a=r[t],h[t]=a>i?i:a<e?e:a;u.push(h)}this.pixels=u,this.pixelType=t}extractBands(t){var e;const{pixels:i,statistics:l}=this;if(null==t||0===t.length||!i||0===i.length)return this;const n=i.length,o=t.some(t=>t>=i.length),r=n===t.length&&!t.some((t,e)=>t!==e);if(o||r)return this;const a=(null===(e=this.bandMasks)||void 0===e?void 0:e.length)===n?t.map(t=>this.bandMasks[t]):void 0;let{mask:h,validPixelCount:u}=this;const{width:c,height:p}=this;return null!==a&&void 0!==a&&a.length&&(h=s.combineBandMasks(a),u=h.filter(t=>!!t).length),new s({pixelType:this.pixelType,width:c,height:p,mask:h,bandMasks:a,validPixelCount:u,maskIsAlpha:this.maskIsAlpha,pixels:t.map(t=>i[t]),statistics:l&&t.map(t=>l[t])})}clone(){const t=new s({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount,premultiplyAlpha:this.premultiplyAlpha,depthCount:this.depthCount});let e;null!=this.mask&&(t.mask=new Uint8Array(this.mask)),this.noDataValues&&(t.noDataValues=[...this.noDataValues]),this.bandMasks&&(t.bandMasks=this.bandMasks.map(t=>new Uint8Array(t)));const i=s.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){t.pixels=[];const s=!!this.pixels[0].slice;for(e=0;e<this.pixels.length;e++)t.pixels[e]=s?this.pixels[e].slice():new i(this.pixels[e])}if(this.statistics)for(t.statistics=[],e=0;e<this.statistics.length;e++)t.statistics[e]=(0,r.o8)(this.statistics[e]);return t}getTransferableObject(){const{pixels:t,bandMasks:e,mask:i}=this;this.pixels=[],this.bandMasks=void 0,this.mask=void 0;const s=this.toJSON();this.pixels=t,this.bandMasks=e,this.mask=i,s.pixels=t?[...t]:t,s.bandMasks=e?[...e]:e,s.mask=i;const l=[];return[...null!==t&&void 0!==t?t:[],i,...null!==e&&void 0!==e?e:[]].filter(t=>null!=t&&ArrayBuffer.isView(t)).forEach(t=>{t&&!l.includes(t.buffer)&&l.push(t.buffer)}),{pixelBlock:s,transferList:l}}_fillFrom8Bit(t){const{mask:e,maskIsAlpha:i,premultiplyAlpha:s,pixels:l}=this;if(!t||null===l||void 0===l||!l.length)return void a.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");let n,o,r,h;n=o=r=l[0],l.length>=3?(o=l[1],r=l[2]):2===l.length&&(o=l[1]);const u=new Uint32Array(t),c=this.width*this.height;if(n.length===c)if(null!=e&&e.length===c)if(i)for(h=0;h<c;h++){const t=e[h];if(t){const e=t/255;u[h]=s?t<<24|r[h]*e<<16|o[h]*e<<8|n[h]*e:t<<24|r[h]<<16|o[h]<<8|n[h]}}else for(h=0;h<c;h++)e[h]&&(u[h]=255<<24|r[h]<<16|o[h]<<8|n[h]);else for(h=0;h<c;h++)u[h]=255<<24|r[h]<<16|o[h]<<8|n[h];else a.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}_fillFromNon8Bit(t){const{pixels:e,mask:i,statistics:s}=this;if(!t||null===e||void 0===e||!e.length)return void a.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");const l=this.pixelType;let n=1,o=0,r=1;if(s&&s.length>0){for(const t of s)if(null!=t.minValue&&(o=Math.min(o,t.minValue)),null!=t.maxValue&&null!=t.minValue){const e=t.maxValue-t.minValue;r=Math.max(r,e)}n=255/r}else{let t=255;"s8"===l?(o=-128,t=127):"u16"===l?t=65535:"s16"===l?(o=-32768,t=32767):"u32"===l?t=4294967295:"s32"===l?(o=-2147483648,t=2147483647):"f32"===l?(o=-34e38,t=34e38):"f64"===l&&(o=-Number.MAX_VALUE,t=Number.MAX_VALUE),n=255/(t-o)}const h=new Uint32Array(t),u=this.width*this.height;let c,p,f,d,g;if(c=p=f=e[0],c.length!==u)return a.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(e.length>=2)if(p=e[1],e.length>=3&&(f=e[2]),null!=i&&i.length===u)for(d=0;d<u;d++)i[d]&&(h[d]=255<<24|(f[d]-o)*n<<16|(p[d]-o)*n<<8|(c[d]-o)*n);else for(d=0;d<u;d++)h[d]=255<<24|(f[d]-o)*n<<16|(p[d]-o)*n<<8|(c[d]-o)*n;else if(null!=i&&i.length===u)for(d=0;d<u;d++)g=(c[d]-o)*n,i[d]&&(h[d]=255<<24|g<<16|g<<8|g);else for(d=0;d<u;d++)g=(c[d]-o)*n,h[d]=255<<24|g<<16|g<<8|g}_fillFrom32Bit(t){const{pixels:e,mask:i}=this;if(!t||null===e||void 0===e||!e.length)return a.A.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let s,l,n,o;s=l=n=e[0],e.length>=3?(l=e[1],n=e[2]):2===e.length&&(l=e[1]);const r=this.width*this.height;if(s.length!==r)return a.A.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let h=0;if(null!=i&&i.length===r)for(o=0;o<r;o++)t[h++]=s[o],t[h++]=l[o],t[h++]=n[o],t[h++]=1&i[o];else for(o=0;o<r;o++)t[h++]=s[o],t[h++]=l[o],t[h++]=n[o],t[h++]=1}};(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"width",void 0),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"height",void 0),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"pixelType",void 0),(0,l.Cg)([(0,u.w)("pixelType")],d.prototype,"castPixelType",null),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"validPixelCount",void 0),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"mask",void 0),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"maskIsAlpha",void 0),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"pixels",void 0),(0,l.Cg)([(0,h.MZ)()],d.prototype,"premultiplyAlpha",void 0),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"statistics",void 0),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"depthCount",void 0),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"noDataValues",void 0),(0,l.Cg)([(0,h.MZ)({json:{write:!0}})],d.prototype,"bandMasks",void 0),d=s=(0,l.Cg)([(0,c.$)("esri.layers.support.PixelBlock")],d)},8141(t,e,i){i.d(e,{z:()=>s});class s{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.minValue=t,this.maxValue=e,this.noDataValue=i}}},52297(t,e,i){i.d(e,{$p:()=>u,Sp:()=>c,X1:()=>r,hP:()=>l,xN:()=>o,yM:()=>h,zw:()=>a});const s={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function l(t){var e;return null!==(e=s[t])&&void 0!==e?e:[-34028234663852886e22,34028234663852886e22]}const n={u1:1,u2:1,u4:1,u8:1,s8:1,u16:2,s16:2,u32:4,s32:4,f32:4,f64:8,unknown:4,c64:16,c128:32};function o(t){return function(t){return n[t]}(t.pixelType)*t.bandCount}function r(t,e){return null==t||null==e?"s32":t<0?t>=-128&&e<128?"s8":t>=-32768&&e<32768?"s16":"s32":e<256?"u8":e<65536?"u16":"u32"}function a(t){var e;return null!==(e=(null===t||void 0===t?void 0:t.startsWith("s"))||(null===t||void 0===t?void 0:t.startsWith("u")))&&void 0!==e&&e}function h(t,e,i,s){let[n,o]=l(i);const r=a(i);return r&&(n-=1e-5,o+=1e-5),r?i.startsWith("u")?function(t,e,i,s){const[l,n]=s;for(let o=0;o<e.length;o++)if(e[o]){const s=t[o];s<l||s>n?e[o]=0:i[o]=s+.5|0}}(t,e,s,[n,o]):function(t,e,i,s){const[l,n]=s;for(let o=0;o<e.length;o++)if(e[o]){const s=t[o];s<l||s>n?e[o]=0:i[o]=s+(s>0?.5:-.5)|0}}(t,e,s,[n,o]):function(t,e,i,s){const[l,n]=s;for(let o=0;o<e.length;o++)if(e[o]){const s=t[o];s<l||s>n?e[o]=0:i[o]=s}}(t,e,s,[n,o])}function u(t,e){for(let i=0;i<e.length;i++)e[i]&&isNaN(t[i])&&(e[i]=0,t[i]=0)}function c(t,e,i){var s,n;if(t.depthCount&&t.depthCount>1)return;const{pixels:o,statistics:r,pixelType:a}=t,h=o[0].length,u=null!==(s=t.bandMasks)&&void 0!==s?s:[],c=null!==(n=t.mask)&&void 0!==n?n:new Uint8Array(h).fill(255),p="f32"===a||"f64"===a,f=l(a);let d=!1;for(let l=0;l<o.length;l++){var g,m,v,A;const t="number"==typeof e?e:e[l];if(null==t)continue;const s=null!==(g=null===r||void 0===r||null===(m=r[l])||void 0===m?void 0:m.minValue)&&void 0!==g?g:f[0],n=null!==(v=null===r||void 0===r||null===(A=r[l])||void 0===A?void 0:A.maxValue)&&void 0!==v?v:f[1];if(s>t+Number.EPSILON||n<t-Number.EPSILON)continue;const h=u[l]||c.slice(),x=o[l],k=null===i||void 0===i?void 0:i.customFloatTolerance;if(p&&0!==k){let e=k;e||(e=Math.abs(t)>=9999999e31?2e-7*Math.abs(t):"f32"===a?2**-23:Number.EPSILON);for(let i=0;i<x.length;i++)h[i]&&Math.abs(x[i]-t)<e&&(x[i]=0,h[i]=0,c[i]=0,d=!0)}else for(let e=0;e<x.length;e++)h[e]&&x[e]===t&&(x[e]=0,h[e]=0,c[e]=0,d=!0);u[l]=h}if(d){const e=t.bandMasks||t.pixels.length>1?u:null;null!==i&&void 0!==i&&i.matchAllNoData?t.mask=e&&e.length>1?function(t){if(t.length<2)return t[0];const e=t[0].length,i=new Uint8Array(e).fill(0);for(let s=0;s<t.length;s++){const l=t[s];for(let t=0;t<e;t++)l[t]&&(i[t]=255)}return i}(e):c:(t.bandMasks=e,t.mask=c)}d&&"updateStatistics"in t&&t.updateStatistics()}},95796(t,e,i){i.r(e),i.d(e,{convertPixelBlockToImageData:()=>o,getFacesWithVertexAttributes:()=>n,recomputePositions:()=>r});var s=i(15941),l=i(66486);function n(t){let{distance:e,yaw:i,horizontalFieldOfView:l,pitch:n,verticalFieldOfView:o,origin:r=[0,0,0],positionLength:a=25}=t;const h=a-1,u=a*a,c=new Float32Array(2*u),p=new Float64Array(3*u),f=new Float32Array(3*u).fill(0),d=new Uint32Array(h**2*6);for(let g=0,m=0;g<u;g++){const t=Math.floor(g/a),u=g%a,v=1-u/h,A=t/h,x=2*g,k=3*g;c[x]=v,c[x+1]=A;const y=n+o/2-A*o,w=(0,s.kU)(i-l/2+v*l),b=(0,s.kU)(y),M=Math.sin(b),C=Math.cos(b),B=[M*Math.sin(w),Math.cos(w)*M,-C];p[k]=r[0]+e*B[0],p[k+1]=r[1]+e*B[1],p[k+2]=r[2]+e*B[2],f[k]=-B[0],f[k+1]=-B[1],f[k+2]=-B[2],t!==h&&u!==h&&(d[m++]=g,d[m++]=g+a,d[m++]=g+a+1,d[m++]=g,d[m++]=g+a+1,d[m++]=g+1)}return{result:{position:p,uv:c,normal:f,faces:d},transferList:[p.buffer,c.buffer,f.buffer,null===d||void 0===d?void 0:d.buffer]}}function o(t){const e=l.A.fromJSON(t);e.premultiplyAlpha=!0;const i=e.getAsRGBA(),s=e.width,n=e.height,o=new ImageData(i,s,n);return{result:o,transferList:[o.data.buffer]}}function r(t){let{oldDistance:e,newDistance:i,position:s,origin:l=[0,0,0]}=t;const n=s.length/3;for(let o=0;o<n;o+=3){const t=3*o;s[t]=l[0]+(s[t]-l[0])*(i/e),s[t+1]=l[1]+(s[t+1]-l[1])*(i/e),s[t+2]=l[2]+(s[t+2]-l[2])*(i/e)}return{result:s,transferList:[s.buffer]}}}}]);
//# sourceMappingURL=95796.b071050c.chunk.js.map