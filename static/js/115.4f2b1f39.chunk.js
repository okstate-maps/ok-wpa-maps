(this["webpackJsonpok-wpa-maps"]=this["webpackJsonpok-wpa-maps"]||[]).push([[115],{1123:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return Et}));var a=r(4),n=r.n(a),i=r(9),s=r(10),o=r(2),u=r(3),l=r(5),c=r(6),p=r(0),b=r(36),f=r(1),y=(r(12),r(15)),d=(r(11),r(8)),m=r(26),h=r(13),v=r(74),O=r(59),g=r(54),j=r(18),x=r(7),w=r(35),S=r(24),k=r(90),P=r(237),D=r(29),I=r(48),M=r(39),G=function(e){Object(l.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).outSpatialReference=null,e.processExtent=null,e.processSpatialReference=null,e.returnFeatureCollection=!1,e.returnM=!1,e.returnZ=!1,e}return r}(D.a);Object(p.a)([Object(f.b)({type:M.a})],G.prototype,"outSpatialReference",void 0),Object(p.a)([Object(f.b)({type:I.a})],G.prototype,"processExtent",void 0),Object(p.a)([Object(f.b)({type:M.a})],G.prototype,"processSpatialReference",void 0),Object(p.a)([Object(f.b)({nonNullable:!0})],G.prototype,"returnFeatureCollection",void 0),Object(p.a)([Object(f.b)({nonNullable:!0})],G.prototype,"returnM",void 0),Object(p.a)([Object(f.b)({nonNullable:!0})],G.prototype,"returnZ",void 0),(G=Object(p.a)([Object(d.a)("esri/rest/geoprocessor/GPOptions")],G)).from=Object(y.m)(G);var L=G,T=r(307),V=r(214),J=r(20),N=function(e){Object(l.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).extent=null,e.height=null,e.href=null,e.opacity=1,e.rotation=0,e.scale=null,e.visible=!0,e.width=null,e}return r}(J.a);Object(p.a)([Object(f.b)({type:I.a})],N.prototype,"extent",void 0),Object(p.a)([Object(f.b)()],N.prototype,"height",void 0),Object(p.a)([Object(f.b)()],N.prototype,"href",void 0),Object(p.a)([Object(f.b)()],N.prototype,"opacity",void 0),Object(p.a)([Object(f.b)()],N.prototype,"rotation",void 0),Object(p.a)([Object(f.b)()],N.prototype,"scale",void 0),Object(p.a)([Object(f.b)()],N.prototype,"visible",void 0),Object(p.a)([Object(f.b)()],N.prototype,"width",void 0);var R=N=Object(p.a)([Object(d.a)("esri.layer.support.MapImage")],N),F=r(91),E=function(e){Object(l.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).itemId=null,a.url=null,a}return r}(J.a);Object(p.a)([Object(f.b)({type:String,json:{read:{source:"itemID"},write:{target:"itemID"}}})],E.prototype,"itemId",void 0),Object(p.a)([Object(f.b)({type:String,json:{write:!0}})],E.prototype,"url",void 0);var A=E=Object(p.a)([Object(d.a)("esri.rest.support.DataFile")],E),C=r(126),U=new b.a({esriMeters:"meters",esriFeet:"feet",esriKilometers:"kilometers",esriMiles:"miles",esriNauticalMiles:"nautical-miles",esriYards:"yards"},{ignoreUnknown:!1}),_=function(e){Object(l.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).distance=0,a.units=null,a}return r}(J.a);Object(p.a)([Object(f.b)({json:{write:!0}})],_.prototype,"distance",void 0),Object(p.a)([Object(f.b)({json:{read:U.read,write:U.write}})],_.prototype,"units",void 0);var q=_=Object(p.a)([Object(d.a)("esri/rest/support/LinearUnit")],_),z=new b.a({GPBoolean:"boolean",GPDataFile:"data-file",GPDate:"date",GPDouble:"double",GPFeatureRecordSetLayer:"feature-record-set-layer",GPField:"field",GPLinearUnit:"linear-unit",GPLong:"long",GPRasterData:"raster-data",GPRasterDataLayer:"raster-data-layer",GPRecordSet:"record-set",GPString:"string","GPMultiValue:GPBoolean":"multi-value","GPMultiValue:GPDataFile":"multi-value","GPMultiValue:GPDate":"multi-value","GPMultiValue:GPDouble":"multi-value","GPMultiValue:GPFeatureRecordSetLayer":"multi-value","GPMultiValue:GPField":"multi-value","GPMultiValue:GPLinearUnit":"multi-value","GPMultiValue:GPLong":"multi-value","GPMultiValue:GPRasterData":"multi-value","GPMultiValue:GPRasterDataLayer":"multi-value","GPMultiValue:GPRecordSet":"multi-value","GPMultiValue:GPString":"multi-value"}),B=function(e){Object(l.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).dataType=null,a.value=null,a}return r}(J.a);Object(p.a)([Object(f.b)({json:{read:z.read,write:z.write}})],B.prototype,"dataType",void 0),Object(p.a)([Object(f.b)()],B.prototype,"value",void 0);var K=B=Object(p.a)([Object(d.a)("esri.rest.support.ParameterValue")],B),W=function(e){Object(l.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).format=null,a.itemId=null,a.url=null,a}return r}(J.a);Object(p.a)([Object(f.b)()],W.prototype,"format",void 0),Object(p.a)([Object(f.b)({json:{read:{source:"itemID"},write:{target:"itemID"}}})],W.prototype,"itemId",void 0),Object(p.a)([Object(f.b)()],W.prototype,"url",void 0);var Z=W=Object(p.a)([Object(d.a)("esri/rest/support/RasterData")],W);function Q(e,t,r,a,n){return Y.apply(this,arguments)}function Y(){return(Y=Object(i.a)(n.a.mark((function e(t,r,a,i,o){var u,l,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u={},l={},c=[],e.abrupt("return",(H(i,c,u),Object(T.a)(c).then((function(e){var n=a.outSpatialReference,c=a.processExtent,p=a.processSpatialReference,b=a.returnFeatureCollection,f=a.returnM,y=a.returnZ,d=Object(F.c)(t).path;for(var m in u){var h=u[m];l[m]=e.slice(h[0],h[1])}var v=n?n.wkid||n:null,O=p?p.wkid||p:null,j="execute"===r?{returnFeatureCollection:b||void 0,returnM:f||void 0,returnZ:y||void 0}:null,x=X(Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},c?{context:{extent:c,outSR:v,processSR:O}}:{"env:outSR":v,"env:processSR":O}),i),j),{},{f:"json"}),null,l),w=Object(s.a)(Object(s.a)({},o),{},{query:x});return Object(g.default)("".concat(d,"/").concat(r),w)}))));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,t,r){for(var a in e){var n=e[a];if(n&&"object"==typeof n&&n instanceof C.default){var i=n.features;r[a]=[t.length,t.length+i.length],i.forEach((function(e){t.push(e.geometry)}))}}}function $(e){var t=e.dataType,r=K.fromJSON(e);switch(t){case"GPBoolean":case"GPDouble":case"GPLong":case"GPString":case"GPMultiValue:GPBoolean":case"GPMultiValue:GPDouble":case"GPMultiValue:GPLong":case"GPMultiValue:GPString":return r;case"GPDate":r.value=new Date(r.value);break;case"GPDataFile":r.value=A.fromJSON(r.value);break;case"GPLinearUnit":r.value=q.fromJSON(r.value);break;case"GPFeatureRecordSetLayer":case"GPRecordSet":var a=e.value.url;r.value=a?A.fromJSON(r.value):C.default.fromJSON(r.value);break;case"GPRasterData":case"GPRasterDataLayer":var n=e.value.mapImage;r.value=n?R.fromJSON(n):Z.fromJSON(r.value);break;case"GPField":r.value=V.a.fromJSON(r.value);break;case"GPMultiValue:GPDate":var i=r.value;r.value=i.map((function(e){return new Date(e)}));break;case"GPMultiValue:GPDataFile":r.value=r.value.map((function(e){return A.fromJSON(e)}));break;case"GPMultiValue:GPLinearUnit":r.value=r.value.map((function(e){return q.fromJSON(e)}));break;case"GPMultiValue:GPFeatureRecordSetLayer":case"GPMultiValue:GPRecordSet":r.value=r.value.map((function(e){return C.default.fromJSON(e)}));break;case"GPMultiValue:GPRasterData":case"GPMultiValue:GPRasterDataLayer":r.value=r.value.map((function(e){return e?R.fromJSON(e):Z.fromJSON(r.value)}));break;case"GPMultiValue:GPField":r.value=r.value.map((function(e){return V.a.fromJSON(e)}))}return r}function X(e,t,r){for(var a in e){var n=e[a];Array.isArray(n)?e[a]=JSON.stringify(n.map((function(e){return X({item:e},!0).item}))):n instanceof Date&&(e[a]=n.getTime())}return Object(F.b)(e,t,r)}var ee=r(845);function te(e,t,r,a){return re.apply(this,arguments)}function re(){return(re=Object(i.a)(n.a.mark((function e(t,r,a,i){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(a=L.from(a||{}),Q(t,"execute",a,r,i).then((function(e){var t=e.data.results||[],r=e.data.messages||[];return{results:t.map($),messages:r.map((function(e){return ee.a.fromJSON(e)}))}}))));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ae,ne=r(21),ie=new b.a({esriJobCancelled:"job-cancelled",esriJobCancelling:"job-cancelling",esriJobDeleted:"job-deleted",esriJobDeleting:"job-deleting",esriJobTimedOut:"job-timed-out",esriJobExecuting:"job-executing",esriJobFailed:"job-failed",esriJobNew:"job-new",esriJobSubmitted:"job-submitted",esriJobSucceeded:"job-succeeded",esriJobWaiting:"job-waiting"}),se=ae=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).jobId=null,r.jobStatus=null,r.messages=null,r.requestOptions=null,r.sourceUrl=null,r._timer=null,r}return Object(u.a)(a,[{key:"cancelJob",value:function(e){var t=this,r=this.jobId,a=this.sourceUrl,n=Object(F.c)(a).path,i=Object(s.a)(Object(s.a)(Object(s.a)({},this.requestOptions),e),{},{query:{f:"json"}});return this._clearTimer(),Object(g.default)("".concat(n,"/jobs/").concat(r,"/cancel"),i).then((function(e){var r=ae.fromJSON(e.data);return t.messages=r.messages,t.jobStatus=r.jobStatus,t}))}},{key:"destroy",value:function(){clearInterval(this._timer)}},{key:"checkJobStatus",value:function(e){var t=this,r=Object(F.c)(this.sourceUrl).path,a=Object(s.a)(Object(s.a)(Object(s.a)({},this.requestOptions),e),{},{query:{f:"json"}}),n="".concat(r,"/jobs/").concat(this.jobId);return Object(g.default)(n,a).then((function(e){var r=e.data,a=ae.fromJSON(r);return t.messages=a.messages,t.jobStatus=a.jobStatus,t}))}},{key:"fetchResultData",value:function(e,t,r){var a=t=L.from(t||{}),n=a.returnFeatureCollection,i=a.returnM,o=a.returnZ,u=a.outSpatialReference,l=Object(F.c)(this.sourceUrl).path,c=X({returnFeatureCollection:n,returnM:i,returnZ:o,outSR:u,returnType:"data",f:"json"},null),p=Object(s.a)(Object(s.a)(Object(s.a)({},this.requestOptions),r),{},{query:c}),b="".concat(l,"/jobs/").concat(this.jobId,"/results/").concat(e);return Object(g.default)(b,p).then((function(e){return $(e.data)}))}},{key:"fetchResultImage",value:function(e,t,r){var a=Object(F.c)(this.sourceUrl).path,n=X(Object(s.a)(Object(s.a)({},t.toJSON()),{},{f:"json"})),i=Object(s.a)(Object(s.a)(Object(s.a)({},this.requestOptions),r),{},{query:n}),o="".concat(a,"/jobs/").concat(this.jobId,"/results/").concat(e);return Object(g.default)(o,i).then((function(e){return $(e.data)}))}},{key:"fetchResultMapImageLayer",value:function(){var e=Object(i.a)(n.a.mark((function e(){var t,a,i,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(F.c)(this.sourceUrl),a=t.path,i=a.indexOf("/GPServer/"),s="".concat(a.substring(0,i),"/MapServer/jobs/").concat(this.jobId),e.next=4,r.e(41).then(r.bind(null,986));case 4:return e.t0=e.sent.default,e.t1={url:s},e.abrupt("return",new e.t0(e.t1));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"waitForJobCompletion",value:function(){var e=Object(i.a)(n.a.mark((function e(){var t,r,a,i,s,o=this,u=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},r=t.interval,a=void 0===r?1e3:r,i=t.signal,s=t.statusCallback,e.abrupt("return",new Promise((function(e,t){Object(ne.q)(i,(function(){o._clearTimer(),t(Object(ne.e)())})),o._clearTimer();var r=setInterval((function(){o._timer||t(Object(ne.e)()),o.checkJobStatus(o.requestOptions).then((function(r){var a=r.jobStatus;switch(o.jobStatus=a,a){case"job-succeeded":o._clearTimer(),e(o);break;case"job-submitted":case"job-executing":case"job-waiting":case"job-new":s&&s(o);break;case"job-cancelled":case"job-cancelling":case"job-deleted":case"job-deleting":case"job-timed-out":case"job-failed":o._clearTimer(),t(o)}}))}),a);o._timer=r})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_clearTimer",value:function(){this._timer&&(clearInterval(this._timer),this._timer=null)}}]),a}(J.a);Object(p.a)([Object(f.b)()],se.prototype,"jobId",void 0),Object(p.a)([Object(f.b)({json:{read:ie.read}})],se.prototype,"jobStatus",void 0),Object(p.a)([Object(f.b)({type:[ee.a]})],se.prototype,"messages",void 0),Object(p.a)([Object(f.b)()],se.prototype,"requestOptions",void 0),Object(p.a)([Object(f.b)({json:{write:!0}})],se.prototype,"sourceUrl",void 0);var oe=se=ae=Object(p.a)([Object(d.a)("esri.rest.support.JobInfo")],se);function ue(e,t,r,a){return le.apply(this,arguments)}function le(){return(le=Object(i.a)(n.a.mark((function e(t,r,a,i){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(a=L.from(a||{}),Q(t,"submitJob",a,r,i).then((function(e){var r=oe.fromJSON(e.data);return r.sourceUrl=t,r}))));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ce=new b.a({PDF:"pdf",PNG32:"png32",PNG8:"png8",JPG:"jpg",GIF:"gif",EPS:"eps",SVG:"svg",SVGZ:"svgz"}),pe=(ce.fromJSON.bind(ce),ce.toJSON.bind(ce)),be=new b.a({MAP_ONLY:"map-only","A3 Landscape":"a3-landscape","A3 Portrait":"a3-portrait","A4 Landscape":"a4-landscape","A4 Portrait":"a4-portrait","Letter ANSI A Landscape":"letter-ansi-a-landscape","Letter ANSI A Portrait":"letter-ansi-a-portrait","Tabloid ANSI B Landscape":"tabloid-ansi-b-landscape","Tabloid ANSI B Portrait":"tabloid-ansi-b-portrait"}),fe=(be.fromJSON.bind(be),be.toJSON.bind(be)),ye="simple-marker",de="simple-line";function me(e,t){var r=t.graphic,a=t.renderer,n=t.symbol,i=n.type;if("text"!==i&&"shield-label-symbol"!==i&&"visualVariables"in a&&a.visualVariables){var s=a.getVisualVariablesForType("size"),o=a.getVisualVariablesForType("color"),u=a.getVisualVariablesForType("opacity"),l=a.getVisualVariablesForType("rotation"),c=s[0],p=o[0],b=u[0],f=l[0];if(c){var y=i===ye?n.style:null,d=Object(P.getSize)(c,r,{shape:y});null!=d&&(i===ye?e.size=Object(w.h)(d):"picture-marker"===i?(e.width=Object(w.h)(d),e.height=Object(w.h)(d)):i===de?e.width=Object(w.h)(d):e.outline&&(e.outline.width=Object(w.h)(d)))}if(p){var m=Object(P.getColor)(p,r);(m&&i===ye||i===de||"simple-fill"===i)&&(e.color=m?m.toJSON():void 0)}if(b){var h=Object(P.getOpacity)(b,r);null!=h&&e.color&&(e.color[3]=Math.round(255*h))}f&&(e.angle=-Object(P.getRotationAngle)(a,r))}}function he(e){var t,r,a,n,i,s,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,u=e.canvas.width,l=e.canvas.height,c=e.getImageData(0,0,u,l).data;e:for(r=l;r--;)for(t=u;t--;)if(c[4*(u*r+t)+3]>o){s=r;break e}if(!s)return null;e:for(t=u;t--;)for(r=s+1;r--;)if(c[4*(u*r+t)+3]>o){i=t;break e}e:for(t=0;t<=i;++t)for(r=s+1;r--;)if(c[4*(u*r+t)+3]>o){a=t;break e}e:for(r=0;r<=s;++r)for(t=a;t<=i;++t)if(c[4*(u*r+t)+3]>o){n=r;break e}return{x:a,y:n,width:i-a,height:s-n}}function ve(e,t){var r=e.allLayerViews.items;if(t===e.scale)return r.filter((function(e){return!e.suspended}));var a,n=new Array,i=Object(h.a)(r);try{for(i.s();!(a=i.n()).done;){var s=a.value;ke(s.parent)&&!n.includes(s.parent)||!s.visible||t&&"isVisibleAtScale"in s&&!s.isVisibleAtScale(t)||n.push(s)}}catch(o){i.e(o)}finally{i.f()}return n}function Oe(e){return e&&"bing-maps"===e.type}function ge(e){return e&&"csv"===e.type}function je(e){return e&&"feature"===e.type}function xe(e){return e&&"geojson"===e.type}function we(e){return e&&"graphics"===e.type}function Se(e){return e&&"group"===e.type}function ke(e){return e&&"esri.views.2d.layers.GroupLayerView2D"===e.declaredClass}function Pe(e){return e&&"imagery"===e.type}function De(e){return e&&"kml"===e.type}function Ie(e){return e&&"map-image"===e.type}function Me(e){return e&&"map-notes"===e.type}function Ge(e){return e&&"open-street-map"===e.type}function Le(e){return e&&"stream"===e.type}function Te(e){return e&&"tile"===e.type}function Ve(e){return e&&"vector-tile"===e.type}function Je(e){return e&&"web-tile"===e.type}function Ne(e){return e&&"wms"===e.type}function Re(e){return e&&"wmts"===e.type}var Fe=function(e){Object(l.a)(r,e);var t=Object(c.a)(r);function r(e){var a;return Object(o.a)(this,r),(a=t.call(this,e)).attributionVisible=!0,a.exportOptions={width:800,height:1100,dpi:96},a.forceFeatureAttributes=!1,a.format="png32",a.label=null,a.layout="map-only",a.layoutOptions=null,a.outScale=0,a.scalePreserved=!0,a.showLabels=!0,a}return r}(D.a);Object(p.a)([Object(f.b)()],Fe.prototype,"attributionVisible",void 0),Object(p.a)([Object(f.b)()],Fe.prototype,"exportOptions",void 0),Object(p.a)([Object(f.b)()],Fe.prototype,"forceFeatureAttributes",void 0),Object(p.a)([Object(f.b)()],Fe.prototype,"format",void 0),Object(p.a)([Object(f.b)()],Fe.prototype,"label",void 0),Object(p.a)([Object(f.b)()],Fe.prototype,"layout",void 0),Object(p.a)([Object(f.b)()],Fe.prototype,"layoutOptions",void 0),Object(p.a)([Object(f.b)()],Fe.prototype,"outScale",void 0),Object(p.a)([Object(f.b)()],Fe.prototype,"scalePreserved",void 0),Object(p.a)([Object(f.b)()],Fe.prototype,"showLabels",void 0);var Ee=Fe=Object(p.a)([Object(d.a)("esri.rest.support.PrintTemplate")],Fe),Ae=r(456),Ce=r(427),Ue={Feet:"ft",Kilometers:"km",Meters:"m",Miles:"mi"},_e=new b.a({esriFeet:"Feet",esriKilometers:"Kilometers",esriMeters:"Meters",esriMiles:"Miles"}),qe=new b.a({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),ze=new Map;function Be(){return(Be=Object(i.a)(n.a.mark((function e(t,r,a){var i,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Ye(t),s=ze.get(i),e.abrupt("return",Promise.resolve().then((function(){return s?{data:s.gpMetadata}:(s={gpServerUrl:i,is11xService:!1,legendLayerNameMap:[],legendLayers:[]},Object(g.default)(i,{query:{f:"json"}}))})).then((function(e){return s.gpMetadata=e.data,s.cimVersion=s.gpMetadata.cimVersion,s.is11xService=!!s.cimVersion,ze.set(i,s),Ke(r,s)})).then((function(e){var n,i=Vt(s),o=function(e){return"sync"===i?e.results&&e.results[0]&&e.results[0].value:n.fetchResultData("Output_File",null,a).then((function(e){return e.value}))};return"async"===i?ue(t,e,null,a).then((function(e){return n=e,e.waitForJobCompletion({interval:r.updateDelay}).then(o)})):te(t,e,null,a).then(o)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ke(e,t){return We.apply(this,arguments)}function We(){return(We=Object(i.a)(n.a.mark((function e(t,r){var a,i,s,o,u,l,c,p,b,f,y,d,m,h,v,O,g;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||{is11xService:!1,legendLayerNameMap:[],legendLayers:[]},null==(a=t.template||new Ee).showLabels&&(a.showLabels=!0),i=a.exportOptions,o=fe(a.layout),i&&(s={dpi:i.dpi},("map_only"===o.toLowerCase()||""===o)&&(u=i.width,l=i.height,s.outputSize=[u,l])),(c=a.layoutOptions)&&("Miles"===c.scalebarUnit||"Kilometers"===c.scalebarUnit?(b="Kilometers",f="Miles"):"Meters"!==c.scalebarUnit&&"Feet"!==c.scalebarUnit||(b="Meters",f="Feet"),p={titleText:c.titleText,authorText:c.authorText,copyrightText:c.copyrightText,customTextElements:c.customTextElements,scaleBarOptions:{metricUnit:_e.toJSON(b),metricLabel:Ue[b],nonMetricUnit:_e.toJSON(f),nonMetricLabel:Ue[f]}}),y=null,c&&c.legendLayers&&(y=c.legendLayers.map((function(e){r.legendLayerNameMap[e.layerId]=e.title;var t={id:e.layerId};return e.subLayerIds&&(t.subLayerIds=e.subLayerIds),t}))),e.next=12,Ze(t,a,r);case 12:return(d=e.sent).operationalLayers&&(m=new RegExp("[\\u4E00-\\u9FFF\\u0E00-\\u0E7F\\u0900-\\u097F\\u3040-\\u309F\\u30A0-\\u30FF\\u31F0-\\u31FF]"),h=/[\u0600-\u06FF]/,v=function(e){var t=e.text,r=e.font,a=r&&r.family&&r.family.toLowerCase();t&&r&&("arial"===a||"arial unicode ms"===a)&&(r.family=m.test(t)?"Arial Unicode MS":"Arial","normal"!==r.style&&h.test(t)&&(r.family="Arial Unicode MS"))},O=function(){throw new j.a("print-task:cim-symbol-unsupported","CIMSymbol is not supported by a print service published from ArcMap")},d.operationalLayers.forEach((function(e){var t,a,n;null!=(t=e.featureCollection)&&t.layers?e.featureCollection.layers.forEach((function(e){var t,a,n,i;if(null!=(t=e.layerDefinition)&&null!=(a=t.drawingInfo)&&null!=(n=a.renderer)&&n.symbol){var s=e.layerDefinition.drawingInfo.renderer;"esriTS"===s.symbol.type?v(s.symbol):"CIMSymbolReference"!==s.symbol.type||r.is11xService||O()}null!=(i=e.featureSet)&&i.features&&e.featureSet.features.forEach((function(e){e.symbol&&("esriTS"===e.symbol.type?v(e.symbol):"CIMSymbolReference"!==e.symbol.type||r.is11xService||O())}))})):!r.is11xService&&null!=(a=e.layerDefinition)&&null!=(n=a.drawingInfo)&&n.renderer&&JSON.stringify(e.layerDefinition.drawingInfo.renderer).includes('"type":"CIMSymbolReference"')&&O()}))),t.outSpatialReference&&(d.mapOptions.spatialReference=t.outSpatialReference.toJSON()),Object.assign(d,{exportOptions:s,layoutOptions:p||{}}),Object.assign(d.layoutOptions,{legendOptions:{operationalLayers:null!=y?y:r.legendLayers.slice()}}),r.legendLayers.length=0,ze.set(r.gpServerUrl,r),g={Web_Map_as_JSON:JSON.stringify(d),Format:pe(a.format),Layout_Template:o},e.abrupt("return",(t.extraParameters&&Object.assign(g,t.extraParameters),g));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(e,t,r){return Qe.apply(this,arguments)}function Qe(){return(Qe=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o,u,l,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.view,s=i.spatialReference,e.next=4,He(i,r,a);case 4:return e.t0=e.sent,o={operationalLayers:e.t0},u=a.ssExtent||t.extent||i.extent,s&&s.isWrappable&&(u=u.clone()._normalize(!0),s=u.spatialReference),o.mapOptions={extent:u&&u.toJSON(),spatialReference:s&&s.toJSON(),showAttribution:r.attributionVisible},a.ssExtent=null,i.background&&(o.background=i.background.toJSON()),i.rotation&&(o.mapOptions.rotation=-i.rotation),r.scalePreserved&&(o.mapOptions.scale=r.outScale||i.scale),i.timeExtent&&(l=Object(x.k)(i.timeExtent.start)?i.timeExtent.start.getTime():null,c=Object(x.k)(i.timeExtent.end)?i.timeExtent.end.getTime():null,o.mapOptions.time=[l,c]),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(e){var t=e,r=t.lastIndexOf("/GPServer/");return r>0&&(t=t.slice(0,r+9)),t}function He(e,t,r){return $e.apply(this,arguments)}function $e(){return($e=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o,u,l,c,p,b,f,y;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=[],s={layerView:null,printTemplate:r,view:t},o=0,r.scalePreserved&&(o=r.outScale||t.scale),u=ve(t,o),l=Object(h.a)(u),e.prev=5,l.s();case 7:if((c=l.n()).done){e.next=116;break}if(p=c.value,(b=p.layer).loaded&&!Se(b)){e.next=12;break}return e.abrupt("continue",114);case 12:if(f=void 0,s.layerView=p,!Oe(b)){e.next=18;break}e.t0=Xe(b),e.next=112;break;case 18:if(!ge(b)){e.next=24;break}return e.next=21,et(b,s,a);case 21:e.t1=e.sent,e.next=111;break;case 24:if(!je(b)){e.next=30;break}return e.next=27,nt(b,s,a);case 27:e.t2=e.sent,e.next=110;break;case 30:if(!xe(b)){e.next=36;break}return e.next=33,st(b,s,a);case 33:e.t3=e.sent,e.next=109;break;case 36:if(!we(b)){e.next=42;break}return e.next=39,ut(b,s,a);case 39:e.t4=e.sent,e.next=108;break;case 42:if(!Pe(b)){e.next=46;break}e.t5=ct(b,a),e.next=107;break;case 46:if(!De(b)){e.next=52;break}return e.next=49,pt(b,s,a);case 49:e.t6=e.sent,e.next=106;break;case 52:if(!Ie(b)){e.next=56;break}e.t7=ft(b,s,a),e.next=105;break;case 56:if(!Me(b)){e.next=62;break}return e.next=59,yt(s,a);case 59:e.t8=e.sent,e.next=104;break;case 62:if(!Ge(b)){e.next=66;break}e.t9={type:"OpenStreetMap"},e.next=103;break;case 66:if(!Le(b)){e.next=72;break}return e.next=69,vt(b,s,a);case 69:e.t10=e.sent,e.next=102;break;case 72:if(!Te(b)){e.next=76;break}e.t11=gt(b),e.next=101;break;case 76:if(!Ve(b)){e.next=82;break}return e.next=79,jt(b,s,a);case 79:e.t12=e.sent,e.next=100;break;case 82:if(!Je(b)){e.next=86;break}e.t13=wt(b),e.next=99;break;case 86:if(!Ne(b)){e.next=90;break}e.t14=St(b),e.next=98;break;case 90:if(!Re(b)){e.next=94;break}e.t15=kt(b),e.next=97;break;case 94:return e.next=96,mt(b,s,a);case 96:e.t15=e.sent;case 97:e.t14=e.t15;case 98:e.t13=e.t14;case 99:e.t12=e.t13;case 100:e.t11=e.t12;case 101:e.t10=e.t11;case 102:e.t9=e.t10;case 103:e.t8=e.t9;case 104:e.t7=e.t8;case 105:e.t6=e.t7;case 106:e.t5=e.t6;case 107:e.t4=e.t5;case 108:e.t3=e.t4;case 109:e.t2=e.t3;case 110:e.t1=e.t2;case 111:e.t0=e.t1;case 112:(f=e.t0)&&(Array.isArray(f)?i.push.apply(i,Object(m.a)(f)):(f.id=b.id,f.title=a.legendLayerNameMap[b.id]||b.title,f.opacity=b.opacity,f.minScale=b.minScale||0,f.maxScale=b.maxScale||0,i.push(f)));case 114:e.next=7;break;case 116:e.next=121;break;case 118:e.prev=118,e.t16=e.catch(5),l.e(e.t16);case 121:return e.prev=121,l.f(),e.finish(121);case 124:if(o&&i.forEach((function(e){e.minScale=0,e.maxScale=0})),!t.graphics||!t.graphics.length){e.next=129;break}return e.next=127,rt(null,t.graphics,r,a);case 127:(y=e.sent)&&i.push(y);case 129:return e.abrupt("return",i);case 130:case"end":return e.stop()}}),e,null,[[5,118,121,124]])})))).apply(this,arguments)}function Xe(e){return{culture:e.culture,key:e.key,type:"BingMaps"+("aerial"===e.style?"Aerial":"hybrid"===e.style?"Hybrid":"Road")}}function et(e,t,r){return tt.apply(this,arguments)}function tt(){return(tt=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.legendLayers&&a.legendLayers.push({id:t.id}),i=r.layerView,s=r.printTemplate,a.is11xService&&!i.filter){e.next=11;break}return e.t0=rt,e.t1=t,e.next=7,Lt(i);case 7:return e.t2=e.sent,e.t3=s,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 11:return e.abrupt("return",(o={type:"CSV"},t.write(o,{origin:"web-map"}),delete o.popupInfo,delete o.layerType,o.showLabels=s.showLabels&&t.labelsVisible,o));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rt(e,t,r,a){return at.apply(this,arguments)}function at(){return(at=Object(i.a)(n.a.mark((function e(t,r,a,i){var s,o,u,l,c,p,b,f,y,d,m,v,O,g,j,x,w,S,P,D,I,M,G,L,T,V,J;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}},u={layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}},l={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}},c={layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}},(p={layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}).layerDefinition.name="textLayer",delete p.layerDefinition.drawingInfo,t&&("esri.layers.FeatureLayer"===t.declaredClass||"esri.layers.StreamLayer"===t.declaredClass?o.layerDefinition.name=u.layerDefinition.name=l.layerDefinition.name=c.layerDefinition.name=i.legendLayerNameMap[t.id]||t.get("arcgisProps.title")||t.title:"esri.layers.GraphicsLayer"===t.declaredClass&&(r=t.graphics.items),t.renderer&&(b=t.renderer.toJSON(),o.layerDefinition.drawingInfo.renderer=b,u.layerDefinition.drawingInfo.renderer=b,l.layerDefinition.drawingInfo.renderer=b,c.layerDefinition.drawingInfo.renderer=b),a.showLabels&&t.labelsVisible&&"function"==typeof t.write&&(d=null==(f=t.write({},{origin:"web-map"}).layerDefinition)||null==(y=f.drawingInfo)?void 0:y.labelingInfo)&&(s=!0,o.layerDefinition.drawingInfo.labelingInfo=d,u.layerDefinition.drawingInfo.labelingInfo=d,l.layerDefinition.drawingInfo.labelingInfo=d,c.layerDefinition.drawingInfo.labelingInfo=d)),null!=t&&t.renderer||s||(delete o.layerDefinition.drawingInfo,delete u.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo,delete c.layerDefinition.drawingInfo),v=null==t?void 0:t.fieldsIndex,O=null==t?void 0:t.renderer,!v){e.next=12;break}if(!O||"function"!=typeof O.collectRequiredFields){e.next=10;break}return g=new Set,e.next=9,O.collectRequiredFields(g,v);case 9:m=Array.from(g);case 10:j=v.fields.map((function(e){return e.toJSON()})),o.layerDefinition.fields=j,u.layerDefinition.fields=j,l.layerDefinition.fields=j,c.layerDefinition.fields=j;case 12:x=r&&r.length,S=0;case 14:if(!(S<x)){e.next=46;break}if(!1!==(P=r[S]||r.getItemAt(S)).visible&&P.geometry){e.next=18;break}return e.abrupt("continue",43);case 18:if((w=P.toJSON()).hasOwnProperty("popupTemplate")&&delete w.popupTemplate,w.geometry&&w.geometry.z&&delete w.geometry.z,!w.symbol||!w.symbol.outline||"esriCLS"!==w.symbol.outline.type||i.is11xService){e.next=20;break}return e.abrupt("continue",43);case 20:if(!i.is11xService&&w.symbol&&w.symbol.outline&&w.symbol.outline.color&&w.symbol.outline.color[3]&&(w.symbol.outline.color[3]=255),D=t&&t.renderer&&("valueExpression"in t.renderer&&t.renderer.valueExpression||"hasVisualVariables"in t.renderer&&t.renderer.hasVisualVariables()),w.symbol||!t||!t.renderer||!D||i.is11xService){e.next=30;break}return I=t.renderer,e.next=26,I.getSymbolAsync(P);case 26:if(M=e.sent){e.next=29;break}return e.abrupt("continue",43);case 29:w.symbol=M.toJSON(),"hasVisualVariables"in I&&I.hasVisualVariables()&&me(w.symbol,{renderer:I,graphic:P,symbol:M});case 30:if(e.t0=w.symbol,!e.t0){e.next=40;break}if(w.symbol.angle||delete w.symbol.angle,!Jt(w.symbol)){e.next=39;break}return e.next=36,Dt(w.symbol,i);case 36:w.symbol=e.sent,e.next=40;break;case 39:w.symbol.text&&delete w.attributes;case 40:if(a&&a.forceFeatureAttributes||!m||!m.length){e.next=42;break}!function(){var e={};m.forEach((function(t){w.attributes&&w.attributes.hasOwnProperty(t)&&(e[t]=w.attributes[t])})),w.attributes=e}();case 42:"polygon"===P.geometry.type?o.featureSet.features.push(w):"polyline"===P.geometry.type?u.featureSet.features.push(w):"point"===P.geometry.type?w.symbol&&w.symbol.text?p.featureSet.features.push(w):l.featureSet.features.push(w):"multipoint"===P.geometry.type?c.featureSet.features.push(w):"extent"===P.geometry.type&&(w.geometry=k.a.fromExtent(P.geometry).toJSON(),o.featureSet.features.push(w));case 43:S++,e.next=14;break;case 46:G=[o,u,c,l,p].filter((function(e){return e.featureSet.features.length>0})),L=Object(h.a)(G),e.prev=48,L.s();case 50:if((T=L.n()).done){e.next=61;break}if(V=T.value,J=V.featureSet.features.every((function(e){return e.symbol})),!J||a&&a.forceFeatureAttributes||V.featureSet.features.forEach((function(e){delete e.attributes})),J&&delete V.layerDefinition.drawingInfo,e.t1=V.layerDefinition.drawingInfo&&V.layerDefinition.drawingInfo.renderer,!e.t1){e.next=59;break}return e.next=59,Mt(V.layerDefinition.drawingInfo.renderer,i);case 59:e.next=50;break;case 61:e.next=66;break;case 63:e.prev=63,e.t2=e.catch(48),L.e(e.t2);case 66:return e.prev=66,L.f(),e.finish(66);case 69:return e.abrupt("return",G.length?{featureCollection:{layers:G},showLabels:s}:null);case 70:case"end":return e.stop()}}),e,null,[[48,63,66,69]])})))).apply(this,arguments)}function nt(e,t,r){return it.apply(this,arguments)}function it(){return(it=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o,u,l,c,p,b,f,y,d,m,h,v,O,g;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.legendLayers&&a.legendLayers.push({id:t.id}),u=t.renderer,!(t.featureReduction||u&&"dot-density"===u.type&&(!a.is11xService||parseFloat(a.cimVersion)<2.6))){e.next=4;break}return e.abrupt("return",mt(t,r,a));case 4:if(l=r.layerView,c=r.printTemplate,p=r.view,b=u&&("valueExpression"in u&&u.valueExpression||"hasVisualVariables"in u&&u.hasVisualVariables()),f="feature-layer"!==(null==(i=t.source)?void 0:i.type)&&"ogc-feature"!==(null==(s=t.source)?void 0:s.type),!(!a.is11xService&&b||t.featureReduction||l.filter||f)&&u&&(!("field"in u)||null==u.field||"string"==typeof u.field&&t.getField(u.field))){e.next=14;break}return e.next=8,Lt(l);case 8:return y=e.sent,e.next=11,rt(t,y,c,a);case 11:o=e.sent,e.next=29;break;case 14:if((o={id:(g=t.write()).id,title:g.title,opacity:g.opacity,minScale:g.minScale,maxScale:g.maxScale,url:g.url,layerType:g.layerType,customParameters:g.customParameters,layerDefinition:g.layerDefinition}).showLabels=c.showLabels&&t.labelsVisible,Pt(o,t),e.t0=null!=(d=o.layerDefinition)&&null!=(m=d.drawingInfo)&&m.renderer,!e.t0){e.next=24;break}return delete o.layerDefinition.minScale,delete o.layerDefinition.maxScale,e.next=23,Mt(o.layerDefinition.drawingInfo.renderer,a);case 23:e.t0="visualVariables"in u&&u.visualVariables&&u.visualVariables[0];case 24:if(!e.t0){e.next=27;break}"size"===(h=u.visualVariables[0]).type&&h.maxSize&&"number"!=typeof h.maxSize&&h.minSize&&"number"!=typeof h.minSize&&(v=Object(P.getSizeRangeAtScale)(h,p.scale),o.layerDefinition.drawingInfo.renderer.visualVariables[0].minSize=v.minSize,o.layerDefinition.drawingInfo.renderer.visualVariables[0].maxSize=v.maxSize);case 27:(O=Object(Ce.b)(l))&&(o.layerDefinition||(o.layerDefinition={}),o.layerDefinition.definitionExpression=o.layerDefinition.definitionExpression?"(".concat(o.layerDefinition.definitionExpression,") AND (").concat(O,")"):O);case 29:return e.abrupt("return",o);case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function st(e,t,r){return ot.apply(this,arguments)}function ot(){return(ot=Object(i.a)(n.a.mark((function e(t,r,a){var i,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.layerView,s=r.printTemplate,a.legendLayers&&a.legendLayers.push({id:t.id}),e.t0=rt,e.t1=t,e.next=6,Lt(i);case 6:return e.t2=e.sent,e.t3=s,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ut(e,t,r){return lt.apply(this,arguments)}function lt(){return(lt=Object(i.a)(n.a.mark((function e(t,r,a){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.printTemplate,e.abrupt("return",rt(t,null,i,a));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ct(e,t){t.legendLayers&&t.legendLayers.push({id:e.id});var r,a={layerType:(r=e.write()).layerType,customParameters:r.customParameters};if(a.bandIds=e.bandIds,a.compressionQuality=e.compressionQuality,a.format=e.format,a.interpolation=e.interpolation,(e.mosaicRule||e.definitionExpression)&&(a.mosaicRule=e.exportImageServiceParameters.mosaicRule.toJSON()),e.renderingRule||e.renderer)if(t.is11xService)e.renderingRule&&(a.renderingRule=e.renderingRule.toJSON()),e.renderer&&(a.layerDefinition=a.layerDefinition||{},a.layerDefinition.drawingInfo=a.layerDefinition.drawingInfo||{},a.layerDefinition.drawingInfo.renderer=e.renderer.toJSON());else{var n=e.exportImageServiceParameters.combineRendererWithRenderingRule();n&&(a.renderingRule=n.toJSON())}return Pt(a,e),a}function pt(e,t,r){return bt.apply(this,arguments)}function bt(){return(bt=Object(i.a)(n.a.mark((function e(t,r,a){var i,o,u,l,c,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.printTemplate,!a.is11xService){e.next=4;break}return o={type:"kml"},e.abrupt("return",(t.write(o,{origin:"web-map"}),delete o.layerType,o.url=Object(S.D)(t.url),o));case 4:return u=[],(l=r.layerView).allVisibleMapImages.forEach((function(e,r){var a={id:"".concat(t.id,"_image").concat(r),type:"image",title:t.id,minScale:t.minScale||0,maxScale:t.maxScale||0,opacity:t.opacity,extent:e.extent};"data:image/png;base64,"===e.href.substr(0,22)?a.imageData=e.href.substr(22):a.url=e.href,u.push(a)})),c=[].concat(Object(m.a)(l.allVisiblePoints.items),Object(m.a)(l.allVisiblePolylines.items),Object(m.a)(l.allVisiblePolygons.items)),e.t0=s.a,e.t1={id:t.id},e.next=11,rt(null,c,i,a);case 11:return e.t2=e.sent,p=(0,e.t0)(e.t1,e.t2),e.abrupt("return",(u.push(p),u));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(e,t,r){var a,n,i=t.view,s={id:e.id,subLayerIds:[]},o=[],u=i.scale;return e.sublayers&&e.sublayers.forEach((function e(t){var r=0===u,a=0===t.minScale||u<=t.minScale,n=0===t.maxScale||u>=t.maxScale;if(t.visible&&(r||a&&n))if(t.sublayers)t.sublayers.forEach(e);else{var i=t.toExportImageJSON(),l={id:t.id,name:t.title,layerDefinition:{drawingInfo:i.drawingInfo,definitionExpression:i.definitionExpression,source:i.source}};o.unshift(l),s.subLayerIds.push(t.id)}})),o.length&&(o=o.map((function(e){return{id:e.id,name:e.name,layerDefinition:e.layerDefinition}})),(a={layerType:(n=e.write()).layerType,customParameters:n.customParameters}).layers=o,a.visibleLayers=e.capabilities.exportMap.supportsDynamicLayers?void 0:s.subLayerIds,Pt(a,e),r.legendLayers.push(s)),a}function yt(e,t){return dt.apply(this,arguments)}function dt(){return(dt=Object(i.a)(n.a.mark((function e(t,r){var a,i,s,o,u,l,c,p,b,f,y,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.layerView,i=t.printTemplate,s=[],o=a.layer,!Object(x.k)(o.featureCollections)){e.next=24;break}u=Object(h.a)(o.featureCollections),e.prev=4,u.s();case 6:if((l=u.n()).done){e.next=14;break}return c=l.value,e.next=10,rt(c,c.source,i,r);case 10:(p=e.sent)&&s.push.apply(s,Object(m.a)(p.featureCollection.layers));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),u.e(e.t0);case 19:return e.prev=19,u.f(),e.finish(19);case 22:e.next=44;break;case 24:if(!Object(x.k)(o.sublayers)){e.next=44;break}b=Object(h.a)(o.sublayers),e.prev=26,b.s();case 28:if((f=b.n()).done){e.next=36;break}return y=f.value,e.next=32,rt(null,y.graphics,i,r);case 32:(d=e.sent)&&s.push.apply(s,Object(m.a)(d.featureCollection.layers));case 34:e.next=28;break;case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(26),b.e(e.t1);case 41:return e.prev=41,b.f(),e.finish(41);case 44:return e.abrupt("return",{featureCollection:{layers:s}});case 45:case"end":return e.stop()}}),e,null,[[4,16,19,22],[26,38,41,44]])})))).apply(this,arguments)}function mt(e,t,r){return ht.apply(this,arguments)}function ht(){return(ht=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o,u,l,c,p,b,f,y,d,m,h;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.printTemplate,s=r.view,o={type:"image"},u={format:"png",ignoreBackground:!0,layers:[t],rotation:0},l=a.ssExtent||s.extent.clone(),c=96,p=!0,b=!0,i.exportOptions&&((f=i.exportOptions).dpi>0&&(c=f.dpi),f.width>0&&(p=f.width%2==s.width%2),f.height>0&&(b=f.height%2==s.height%2)),"map-only"!==i.layout||!i.scalePreserved||i.outScale&&i.outScale!==s.scale||96!==c||p&&b||(u.area={x:0,y:0,width:s.width,height:s.height},p||(u.area.width-=1),b||(u.area.height-=1),a.ssExtent)||(y=s.toMap(Object(w.e)(u.area.width,u.area.height)),l.ymin=y.y,l.xmax=y.x,a.ssExtent=l),o.extent=l.clone()._normalize(!0).toJSON(),e.next=8,s.takeScreenshot(u);case 8:return d=e.sent,m=Object(S.i)(d.dataUrl),h=m.data,e.abrupt("return",(o.imageData=h,o));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vt(e,t,r){return Ot.apply(this,arguments)}function Ot(){return(Ot=Object(i.a)(n.a.mark((function e(t,r,a){var i,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.layerView,s=r.printTemplate,a.legendLayers&&a.legendLayers.push({id:t.id}),e.t0=rt,e.t1=t,e.next=6,Lt(i);case 6:return e.t2=e.sent,e.t3=s,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gt(e){var t,r={layerType:(t=e.write()).layerType,customParameters:t.customParameters};return Pt(r,e),r}function jt(e,t,r){return xt.apply(this,arguments)}function xt(){return(xt=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.is11xService&&t.serviceUrl&&t.styleUrl)){e.next=5;break}if(i=O.b&&O.b.findCredential(t.styleUrl),s=O.b&&O.b.findCredential(t.serviceUrl),(i||s)&&"2.1.0"===a.cimVersion){e.next=5;break}return o={type:"VectorTileLayer"},e.abrupt("return",(o.styleUrl=Object(S.D)(t.styleUrl),i&&(o.token=i.token),s&&s.token!==o.token&&(o.additionalTokens=[{url:t.serviceUrl,token:s.token}]),o));case 5:return e.abrupt("return",mt(t,r,a));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wt(e){var t={type:"WebTiledLayer",urlTemplate:e.urlTemplate.replace(/\${/g,"{"),credits:e.copyright};return e.subDomains&&e.subDomains.length>0&&(t.subDomains=e.subDomains),t}function St(e){var t,r=[];return e.sublayers&&e.sublayers.forEach((function e(t){t.visible&&(t.sublayers?t.sublayers.forEach(e):t.name&&r.unshift(t.name))})),r.length&&(t={type:"wms",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,transparentBackground:e.imageTransparency,visibleLayers:r,url:Object(S.D)(e.url),version:e.version}),t}function kt(e){var t=e.activeLayer;return{type:"wmts",customLayerParameters:e.customLayerParameters,customParameters:e.customParameters,format:t.imageFormat,layer:t.id,style:t.styleId,tileMatrixSet:t.tileMatrixSetId,url:Object(S.D)(e.url)}}function Pt(e,t){if(t.url)if(e.url=Object(S.D)(e.url||t.url),"apiKey"in t&&t.apiKey)e.token=t.apiKey;else if(v.a.apiKey&&Object(Ae.a)(t.url))e.token=v.a.apiKey;else{var r,a;e.token=null==(r=O.b)||null==(a=r.findCredential(t.url))?void 0:a.token}}function Dt(e,t){return It.apply(this,arguments)}function It(){return(It=Object(i.a)(n.a.mark((function e(t,r){var a,i,s,o,u,l,c,p,b,f,y,d,m,h,v;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.canvas||(r.canvas=document.createElement("canvas")),a=1024,r.canvas.width=a,r.canvas.height=a,i=r.canvas.getContext("2d"),!t.path){e.next=20;break}if((l=new Path2D(t.path)).closePath(),i.fillStyle=Array.isArray(t.color)?"rgba(".concat(t.color[0],",").concat(t.color[1],",").concat(t.color[2],",").concat(t.color[3]/255,")"):"rgb(0,0,0)",i.fill(l),c=he(i)){e.next=10;break}return e.abrupt("return",null);case 10:i.clearRect(0,0,a,a),p=Object(w.g)(t.size)/Math.max(c.width,c.height),i.scale(p,p),f=(b=a/p)/2-c.width/2-c.x,y=b/2-c.height/2-c.y,i.translate(f,y),Array.isArray(t.color)&&i.fill(l),null!=(u=t.outline)&&u.width&&Array.isArray(t.outline.color)&&(d=t.outline,i.lineWidth=Object(w.g)(d.width)/p,i.lineJoin="round",i.strokeStyle="rgba(".concat(d.color[0],",").concat(d.color[1],",").concat(d.color[2],",").concat(d.color[3]/255,")"),i.stroke(l),c.width+=i.lineWidth,c.height+=i.lineWidth),c.width*=p,c.height*=p,m=i.getImageData(a/2-c.width/2,a/2-c.height/2,Math.ceil(c.width),Math.ceil(c.height)),s=m.width,o=m.height,i.canvas.width=s,i.canvas.height=o,i.putImageData(m,0,0),e.next=25;break;case 20:return h="image/svg+xml"===t.contentType?"data:image/svg+xml;base64,"+t.imageData:t.url,e.next=23,Object(g.default)(h,{responseType:"image"});case 23:v=e.sent.data,s=Object(w.g)(t.width),o=Object(w.g)(t.height),i.canvas.width=s,i.canvas.height=o,i.drawImage(v,0,0,i.canvas.width,i.canvas.height);case 25:return e.abrupt("return",{type:"esriPMS",imageData:i.canvas.toDataURL("image/png").substr(22),angle:t.angle,contentType:"image/png",height:p(o),width:p(s),xoffset:t.xoffset,yoffset:t.yoffset});case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Mt(e,t){return Gt.apply(this,arguments)}function Gt(){return(Gt=Object(i.a)(n.a.mark((function e(t,r){var a,i,s,o,u;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("simple"!==(a=t.type)||!Jt(t.symbol)){e.next=7;break}return e.next=4,Dt(t.symbol,r);case 4:t.symbol=e.sent,e.next=35;break;case 7:if("uniqueValue"!==a&&"classBreaks"!==a){e.next=35;break}if(e.t0=Jt(t.defaultSymbol),!e.t0){e.next=13;break}return e.next=12,Dt(t.defaultSymbol,r);case 12:t.defaultSymbol=e.sent;case 13:if(!(i=t["uniqueValue"===a?"uniqueValueInfos":"classBreakInfos"])){e.next=35;break}s=Object(h.a)(i),e.prev=16,s.s();case 18:if((o=s.n()).done){e.next=27;break}if(u=o.value,e.t1=Jt(u.symbol),!e.t1){e.next=25;break}return e.next=24,Dt(u.symbol,r);case 24:u.symbol=e.sent;case 25:e.next=18;break;case 27:e.next=32;break;case 29:e.prev=29,e.t2=e.catch(16),s.e(e.t2);case 32:return e.prev=32,s.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,null,[[16,29,32,35]])})))).apply(this,arguments)}function Lt(e){return Tt.apply(this,arguments)}function Tt(){return(Tt=Object(i.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.queryFeatures(t.createQuery()).then((function(e){return e.features})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vt(e){return e.gpMetadata&&e.gpMetadata.executionType?qe.fromJSON(e.gpMetadata.executionType):"sync"}function Jt(e){return e&&(e.path||"image/svg+xml"===e.contentType||e.url&&e.url.endsWith(".svg"))}var Nt=r(423),Rt=new b.a({esriExecutionTypeSynchronous:"sync",esriExecutionTypeAsynchronous:"async"}),Ft=function(e){Object(l.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(o.a)(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n)))._gpMetadata=null,e.updateDelay=1e3,e}return Object(u.a)(r,[{key:"mode",get:function(){return this._gpMetadata&&this._gpMetadata.executionType?Rt.fromJSON(this._gpMetadata.executionType):"sync"}},{key:"execute",value:function(e,t){return e&&(e.updateDelay=this.updateDelay),function(e,t,r){return Be.apply(this,arguments)}(this.url,e,Object(s.a)(Object(s.a)({},this.requestOptions),t))}},{key:"_getGpPrintParams",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Ye(this.url),a=ze.get(r),e.abrupt("return",Ke(t,a));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Nt.a);Object(p.a)([Object(f.b)()],Ft.prototype,"_gpMetadata",void 0),Object(p.a)([Object(f.b)({readOnly:!0})],Ft.prototype,"mode",null),Object(p.a)([Object(f.b)()],Ft.prototype,"updateDelay",void 0);var Et=Ft=Object(p.a)([Object(d.a)("esri.tasks.PrintTask")],Ft)},845:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var a=r(2),n=r(5),i=r(6),s=r(0),o=r(36),u=r(20),l=r(1),c=(r(12),r(15),r(11),r(8)),p=new o.a({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"}),b=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).description=null,n.type=null,n}return r}(u.a);Object(s.a)([Object(l.b)({type:String,json:{write:!0}})],b.prototype,"description",void 0),Object(s.a)([Object(l.b)({type:String,json:{read:p.read,write:p.write}})],b.prototype,"type",void 0);var f=b=Object(s.a)([Object(c.a)("esri.rest.support.GPMessage")],b)}}]);
//# sourceMappingURL=115.4f2b1f39.chunk.js.map