"use strict";(self.webpackChunkok_wpa_maps=self.webpackChunkok_wpa_maps||[]).push([[59145],{10600:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(27106);function o(e){return function(){return new r(e.apply(this,arguments))}}function r(e){var t,n;function o(t,n){try{var s=e[t](n),a=s.value,l=a instanceof i.A;Promise.resolve(l?a.v:a).then(function(n){if(l){var i="return"===t?"return":"next";if(!a.k||n.done)return o(i,n);n=e[i](n).value}r(s.done?"return":"normal",n)},function(e){o("throw",e)})}catch(e){r("throw",e)}}function r(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?o(t.key,t.arg):n=null}this._invoke=function(e,i){return new Promise(function(r,s){var a={key:e,arg:i,resolve:r,reject:s,next:null};n?n=n.next=a:(t=n=a,o(e,i))})},"function"!=typeof e.return&&(this.return=void 0)}r.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},r.prototype.next=function(e){return this._invoke("next",e)},r.prototype.throw=function(e){return this._invoke("throw",e)},r.prototype.return=function(e){return this._invoke("return",e)}},19495:(e,t,n)=>{function i(e){var t,n,i,r=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new o(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function o(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return o=function(e){this.s=e,this.n=e.next},o.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new o(e)}n.d(t,{A:()=>i})},19747:(e,t,n)=>{n.d(t,{c:()=>r});var i=n(31633),o=n(65308);function r(e){var t,n,r,s,a;const l="metric";if(null==e)return l;const u=e.map,c=null!==(t=u&&"portalItem"in u?null===(n=u.portalItem)||void 0===n?void 0:n.portal:null)&&void 0!==t?t:o.A.getDefault();switch(null!==(r=null===(s=c.user)||void 0===s?void 0:s.units)&&void 0!==r?r:c.units){case l:return l;case"english":return"imperial"}return null!==(a=(0,i.jM)(e.spatialReference))&&void 0!==a?a:l}},27106:(e,t,n)=>{function i(e,t){this.v=e,this.k=t}n.d(t,{A:()=>i})},42151:(e,t,n)=>{n.d(t,{E5:()=>h,ZP:()=>f,vz:()=>v});var i=n(18690),o=n(94967),r=n(99809),s=n(60008),a=n(4336),l=n(20664),u=n(9392),c=n(19247);function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=n?[e,t,n]:[e,t]}function h(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null!=n?{x:e,y:t,z:n}:{x:e,y:t}}class d{constructor(e){this.spatialReference=e}mapToLocalMultiple(e){return e.map(e=>this.mapToLocal(e)).filter(i.Ru)}get doUnnormalization(){return!1}}class v extends d{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(t),this._defaultZ=n,this.transform=(0,r.vt)(),this.transformInv=(0,r.vt)(),this.transform=(0,r.o8)(e),(0,o.B8)(this.transformInv,this.transform)}makeMapPoint(e,t){return p(e,t,this._defaultZ)}mapToLocal(e){return h(this.transform[0]*e[0]+this.transform[2]*e[1]+this.transform[4],this.transform[1]*e[0]+this.transform[3]*e[1]+this.transform[5])}localToMap(e){return p(this.transformInv[0]*e.x+this.transformInv[2]*e.y+this.transformInv[4],this.transformInv[1]*e.x+this.transformInv[3]*e.y+this.transformInv[5],this._defaultZ)}}class y extends d{constructor(e,t){super(e.spatialReference),this.view=e,this.defaultZ=null,this.pWS=(0,u.vt)(),this.tangentFrameUpWS=(0,u.vt)(),this.tangentFrameRightWS=(0,u.vt)(),this.tangentFrameForwardWS=(0,u.vt)(),this.localFrameRightWS=(0,u.vt)(),this.localFrameUpWS=(0,u.vt)(),this.worldToLocalTransform=(0,a.vt)(),this.localToWorldTransform=(0,a.vt)(),this.scale=1,this.scale=e.resolution,this.referenceMapPoint=t,this.defaultZ=t.hasZ?t.z:null;const n=e.state.camera.viewRight;this.view.renderCoordsHelper.toRenderCoords(this.referenceMapPoint,this.pWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,0,this.tangentFrameRightWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,1,this.tangentFrameUpWS),this.view.renderCoordsHelper.worldBasisAtPosition(this.pWS,2,this.tangentFrameForwardWS);const i=(0,u.vt)();(0,l.h)(i,this.tangentFrameForwardWS,(0,l.f)(n,this.tangentFrameForwardWS)),(0,l.e)(this.localFrameRightWS,n,i),(0,l.n)(this.localFrameRightWS,this.localFrameRightWS),(0,l.i)(this.localFrameUpWS,this.tangentFrameForwardWS,this.localFrameRightWS),(0,s.Yc)(this.worldToLocalTransform,this.localFrameRightWS,this.tangentFrameRightWS),(0,s.B8)(this.localToWorldTransform,this.worldToLocalTransform)}get doUnnormalization(){return"global"===this.view.viewingMode}makeMapPoint(e,t){return p(e,t,this.defaultZ)}mapToLocal(e){const t=(0,u.vt)();this.view.renderCoordsHelper.toRenderCoords(new c.A({x:e[0],y:e[1],spatialReference:this.spatialReference}),t),(0,l.v)(t,t,this.worldToLocalTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(t,new c.A({spatialReference:this.view.spatialReference}));return null!=n?h(n.x/this.scale,n.y/this.scale):null}localToMap(e){const t=(0,u.vt)();this.view.renderCoordsHelper.toRenderCoords(new c.A({x:e.x*this.scale,y:e.y*this.scale,spatialReference:this.spatialReference}),t),(0,l.v)(t,t,this.localToWorldTransform);const n=this.view.renderCoordsHelper.fromRenderCoords(t,new c.A({spatialReference:this.view.spatialReference}));return null!=n?p(n.x,n.y,this.defaultZ):null}}function f(e,t){if("2d"===e.type)return new v(e.state.transform,e.spatialReference,t.length>2?t[2]:null);if("3d"===e.type){const n=t.length>2?new c.A({x:t[0],y:t[1],z:t[2],spatialReference:e.spatialReference}):new c.A({x:t[0],y:t[1],spatialReference:e.spatialReference});return new y(e,n)}return null}},43927:(e,t,n)=>{n.d(t,{L:()=>l,l:()=>h});var i=n(98773),o=n(19276),r=n(54901),s=n(50346),a=n(68134);function l(e,t,n){var i,r;const s=null!==(i=null===n||void 0===n||null===(r=n.createCollection)||void 0===r?void 0:r.call(n))&&void 0!==i?i:new o.A,l=null!==n&&void 0!==n&&n.recycleItems?new u:null,c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(null===e||void 0===e||!e.length)return;const n=s.splice(t,e.length);l?l.processRemoved(e):n.forEach(p)},h=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(null===e||void 0===e||!e.length)return;const i=[];for(const o of e){const e=null===l||void 0===l?void 0:l.use(o);if(e)i.push(e);else{const e=t(o);null!==l&&void 0!==l&&l.register(o,e),i.push(e)}}s.addMany(i,n)},d=(0,a.on)(e,"after-splice",e=>{let{added:t,start:n,removed:i}=e;c(i,n),h(t,n)},{sync:!0,onListenerRemove:e=>c(e.items),onListenerAdd:e=>h(e.items)});return s.addHandles(d),s}class u{constructor(){this._originalToMapped=new Map,this._removedItemCandidates=new Set,this._garbageCollectionQueued=!1}processRemoved(e){if(null===e||void 0===e||!e.length)return;const{_removedItemCandidates:t}=this;for(const i of e){var n;(null===(n=this._getItem(i))||void 0===n?void 0:n.markRemoved())&&(t.add(i),this._queueGarbageCollection())}}use(e){const t=this._getItem(e);return t&&(t.removed=!1),null===t||void 0===t?void 0:t.item}register(e,t){this._originalToMapped.set(e,new c(t))}_getItem(e){return this._originalToMapped.get(e)}_queueGarbageCollection(){this._garbageCollectionQueued||(this._garbageCollectionQueued=!0,queueMicrotask(()=>this._garbageCollectCandidates()))}_garbageCollectCandidates(){this._garbageCollectionQueued=!1;const{_removedItemCandidates:e}=this,t=Array.from(e);e.clear(),t.forEach(e=>this._garbageCollectIfRemoved(e))}_garbageCollectIfRemoved(e){const{_originalToMapped:t}=this,n=this._getItem(e);(null===n||void 0===n?void 0:n.removed)&&(p(n.item),t.delete(e))}}class c{constructor(e){this.item=e,this.removed=!1}markRemoved(){return this.removed=!0,!0}}function p(e){"object"==typeof e&&e&&("destroy"in e&&"function"==typeof e.destroy?e.destroy():(0,r.wt)(e))}function h(e,t,n){const a=new o.A,u=l(e,e=>(0,i.UT)(async n=>{const i=await t(e,n);if((0,s.G4)(n))throw p(i),(0,s.NK)();return i}),n),c=()=>null,h=async e=>{const t=await e.promise,n=u.indexOf(e);n<0||a.splice(n,1,t)};a.addMany(u.items.map(c));for(const i of u)(0,s.QZ)(h(i));const d=u.on("after-splice",e=>{let{added:t,start:n,deleteCount:i}=e;const o=a.splice(n,i);for(const r of o)p(r);if(null!==t&&void 0!==t&&t.length){a.addMany(t.map(c),n);for(const e of t)(0,s.QZ)(h(e))}});return a.addHandles([(0,r.DQ)(u),d]),a}},48384:(e,t,n)=>{n.d(t,{zV:()=>L,zd:()=>U,eq:()=>A,N6:()=>k,LZ:()=>E,_T:()=>D,GF:()=>T});var i,o=n(18690),r=n(53084),s=n(31633),a=n(20664),l=n(9392),u=n(6326),c=n(46053),p=(n(81806),n(76460),n(47249),n(87990)),h=n(34111),d=n(19247),v=n(65215),y=n(13312),f=n(7137),g=n(45417),m=n(85996);let _=i=class extends v.A{constructor(e){super(e),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){var e;const t=this.center,n=this.numberOfPoints;if(this.hasZ=null!==(e=null===t||void 0===t?void 0:t.hasZ)&&void 0!==e&&e,0!==this.rings.length||!t)return;const i=(0,s.oU)(this.radius,this.radiusUnit,"meters"),o=t.spatialReference;let r,a="geographic";if(o.isWebMercator?a="webMercator":(null!=(o.wkid&&m.A[o.wkid])||(o.wkt2||o.wkt)&&(0,s.x1)(o.wkt2||o.wkt))&&(a="projected"),this.geodesic){let e;switch(a){case"webMercator":e=(0,g.ci)(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":e=t}r=this._createGeodesicCircle(e,i,n),"webMercator"===a&&(r=(0,g.Gh)(r))}else{let e;"webMercator"===a||"projected"===a?e=i/(0,s.Ao)(t.spatialReference):"geographic"===a&&(e=(0,s.vl)(i,"meters",(0,h.tO)(t.spatialReference).radius)),r=this._createPlanarCircle(t,e,n)}this.spatialReference=r.spatialReference,this.addRing(r.rings[0])}clone(){const{center:e,numberOfPoints:t,radius:n,radiusUnit:o,geodesic:r}=this;return new i({center:null===e||void 0===e?void 0:e.clone(),numberOfPoints:t,radius:n,radiusUnit:o,geodesic:r})}_createGeodesicCircle(e,t,n){const i=[],o=[e.x,e.y];for(let s=0;s<360;s+=360/n){var r;const n=this.hasZ?[0,0,null!==(r=e.z)&&void 0!==r?r:0]:[0,0];(0,f.vN)(n,o,s,t,y.A.WGS84),i.push(n)}return i.push(i[0]),new v.A({rings:[i]})}_createPlanarCircle(e,t,n){const i=[],o=2*Math.PI/n;for(let s=0;s<n;++s){var r;const n=o*s,a=[e.x+Math.cos(-n)*t,e.y+Math.sin(-n)*t];this.hasZ&&a.push(null!==(r=e.z)&&void 0!==r?r:0),i.push(a)}return i.push(i[0]),new v.A({spatialReference:e.spatialReference,rings:[i]})}};(0,u.Cg)([(0,c.MZ)({type:d.A})],_.prototype,"center",void 0),(0,u.Cg)([(0,c.MZ)()],_.prototype,"geodesic",void 0),(0,u.Cg)([(0,c.MZ)()],_.prototype,"numberOfPoints",void 0),(0,u.Cg)([(0,c.MZ)()],_.prototype,"radius",void 0),(0,u.Cg)([(0,c.MZ)()],_.prototype,"radiusUnit",void 0),_=i=(0,u.Cg)([(0,p.$)("esri.geometry.Circle")],_);const w=_;var C=n(66388),M=n(23701),x=n(1736),b=n(78496),R=n(5262),S=n(80963),P=n(42151);function Z(e,t){const n=new d.A({x:e[0],y:e[1],spatialReference:t});return e.length>2&&(n.z=e[2]),n}function A(e,t){return new C.A({points:e,spatialReference:t})}function E(e,t,n){const i=new M.A({paths:e,spatialReference:t});return n&&(0,R._7)(i),i}function k(e,t,n){let i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const s=(0,r.o8)(e);s.forEach(e=>{const t=e[0],n=e[e.length-1];(0,o.aI)(t,n)&&1!==e.length||e.push(e[0])});let a=new v.A({rings:s,spatialReference:t});return a.rings.forEach(e=>{(0,R.$3)(e)||e.reverse()}),n&&(0,R._7)(a),i&&!(0,b.i)(a)&&(0,S.fn)(t)&&(a=(0,b.e)(a)||a),a}function T(e,t,n){const i=t.mapToLocalMultiple(e),r=[],s={x:i[0].x,y:i[0].y},a=i[1].x,l=i[1].y,u=Math.round(a-s.x),c=Math.round(l-s.y),p=Math.max(Math.abs(u),Math.abs(c));if(n){const e={x:s.x+p,y:s.y+p},t={x:s.x-p,y:s.y-p};r.push((0,P.E5)(e.x,t.y),(0,P.E5)(t.x,t.y),(0,P.E5)(t.x,e.y),(0,P.E5)(e.x,e.y))}else{const e={x:u>0?s.x+p:s.x-p,y:c>0?s.y+p:s.y-p};r.push((0,P.E5)(s.x,s.y),(0,P.E5)(e.x,s.y),(0,P.E5)(e.x,e.y),(0,P.E5)(s.x,e.y))}return G(k([r.map(e=>t.localToMap(e)).filter(o.Ru)],t.spatialReference,t.doUnnormalization,!0),r,t)}function D(e,t,n){let i=t.mapToLocalMultiple(e);if(1===i.length){const e=48,t=i[0];i=[(0,P.E5)(t.x-e,t.y+e),(0,P.E5)(t.x+e,t.y-e),(0,P.E5)(t.x+e,t.y-e),(0,P.E5)(t.x-e,t.y+e)]}const r=[],s={x:i[0].x,y:i[0].y},a={x:i[1].x,y:i[1].y};if(n){const e=Math.round(a.x-s.x),t=Math.round(a.y-s.y);r.push((0,P.E5)(s.x-e,s.y-t),(0,P.E5)(a.x,s.y-t),(0,P.E5)(a.x,a.y),(0,P.E5)(s.x-e,a.y))}else r.push((0,P.E5)(s.x,s.y),(0,P.E5)(a.x,s.y),(0,P.E5)(a.x,a.y),(0,P.E5)(s.x,a.y));return G(k([r.map(e=>t.localToMap(e)).filter(o.Ru)],t.spatialReference,t.doUnnormalization,!0),r,t)}function G(e,t,n){const i=z(t[3],t[2],n),o=z(t[1],t[2],n),r=z(t[0],t[1],n),s=z(t[0],t[3],n);return{geometry:e,midpoints:null!=i&&null!=o&&null!=r&&null!=s?{top:i,right:o,bottom:r,left:s}:null}}function z(e,t,n){V[0]=e.x,V[1]=e.y,V[2]=0,O[0]=t.x,O[1]=t.y,O[2]=0,(0,a.l)(V,V,O,.5),I.x=V[0],I.y=O[1],I.z=O[2];const i=n.localToMap(I);return null!=i?Z(i,n.spatialReference):null}const I=(0,P.E5)(0,0,0),V=(0,l.vt)(),O=(0,l.vt)();function L(e,t,n,i){const o=t.mapToLocalMultiple(e);let r=null,a=null;if(n)r=o[0],a=o[1];else{const e=o[0],t=o[1],n=Math.round(t.x-e.x),i=Math.round(t.y-e.y),s=Math.max(Math.abs(n),Math.abs(i));r=(0,P.E5)(n>0?e.x+s/2:e.x-s/2,i>0?e.y+s/2:e.y-s/2),a=(0,P.E5)(Math.abs(n)>Math.abs(i)?r.x-s/2:r.x,Math.abs(n)>Math.abs(i)?r.y:r.y-s/2)}const l=t.localToMap(r),u=t.localToMap(a);if(null==l||null==u)return null;t.doUnnormalization&&(0,R.JM)([[l,u]],t.spatialReference);const c=Z(l,t.spatialReference),p=Z(u,t.spatialReference),h=(0,s.GA)(t.spatialReference);let d=0;if((0,S.fn)(t.spatialReference))d=h*(0,x.e)(c,p);else{const e=r.x-a.x,t=r.y-a.y;d=h*Math.sqrt(e*e+t*t)*(i||1)}const v=new w({center:c,radius:d,radiusUnit:"meters",spatialReference:t.spatialReference});return{geometry:k(v.rings,v.spatialReference,!1),center:c,edge:p}}function U(e,t,n){const i=t.mapToLocalMultiple(e),r=i[0],s=i[1],a=Math.round(s.x-r.x),l=Math.round(s.y-r.y),u=(0,P.E5)(n?r.x:r.x+a/2,n?r.y:r.y+l/2),c=n?a:a/2,p=n?l:l/2,h=[],d=2*Math.PI/60;function v(e){const t=Math.cos(e),n=Math.sin(e);return(0,P.E5)(c*t+u.x,p*n+u.y)}for(let o=0;o<60;o++)h.push(v(o*d));h.push(h[0]);const{spatialReference:y,doUnnormalization:f}=t,g=k([h.map(e=>t.localToMap(e)).filter(o.Ru)],y,f,!1),m=t.localToMap(v(Math.PI/2)),_=t.localToMap(v(0)),w=t.localToMap(v(-Math.PI/2)),C=t.localToMap(v(Math.PI));return{geometry:g,midpoints:null!=m&&null!=_&&null!=w&&null!=C?{top:Z(m,y),right:Z(_,y),bottom:Z(w,y),left:Z(C,y)}:null}}},50360:(e,t,n)=>{n.d(t,{Pg:()=>l,fz:()=>u,g7:()=>s,zo:()=>a});var i=n(68707),o=(n(97799),n(63331),n(56175));n(91523);const r=new o.D;function s(e,t,n){return r.execute(e,t,n,null)}function a(e,t,n){const o=r.executeMany(new i.S(e),t,n,null);return Array.from(o)}function l(e,t,n){return r.isSimpleAsFeature(e,t,n,null,null)}function u(){return r.supportsCurves()}},56218:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(27106);function o(e){return new i.A(e,0)}},59145:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_t});var i=n(6326),o=n(50076),r=n(46053),s=(n(81806),n(76460),n(47249),n(87990)),a=n(54099),l=n(54901),u=n(91291);let c=class extends((0,u.g)(a.nJ)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(e){this._userInteractive=e}get updating(){return!1}get visible(){var e,t;return null===(e=(null===(t=this.parent)||void 0===t?void 0:t.visible)&&!this.parent.suspended)||void 0===e||e}set visible(e){this._overrideIfSome("visible",e)}forceInteractive(){return this._interactiveViewModelCount++,(0,l.hA)(()=>this._interactiveViewModelCount--)}};(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],c.prototype,"parent",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],c.prototype,"view",void 0),(0,i.Cg)([(0,r.MZ)({type:Boolean})],c.prototype,"interactive",null),(0,i.Cg)([(0,r.MZ)()],c.prototype,"_userInteractive",void 0),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],c.prototype,"updating",null),(0,i.Cg)([(0,r.MZ)()],c.prototype,"visible",null),(0,i.Cg)([(0,r.MZ)()],c.prototype,"_interactiveViewModelCount",void 0),c=(0,i.Cg)([(0,s.$)("esri.views.analysis.AnalysisView")],c);let p=class extends c{};p=(0,i.Cg)([(0,s.$)("esri.views.2d.analysis.AnalysisView2D")],p);var h=n(91967),d=n(68134);let v=class extends h.A{constructor(e){super(e)}initialize(){this.addHandles(function(e){return(0,l.vE)([(0,d.wB)(()=>{const{analysis:t,sketchGraphic:n,toolState:i,visible:o}=e.analysisViewData,{geometryVisualizationVisible:r}=t.viewOptions;return{geometryVisualizationVisible:r,geometry:t.geometry,sketchGraphic:n,toolState:i,visible:o}},t=>{let{geometryVisualizationVisible:n,sketchGraphic:i,toolState:o,visible:r}=t;if(e.remove(),r)return n&&null!=i&&"reshaping"!==o&&"sketching"!==o?e.show(i):void 0},d.pc)])}({analysisViewData:this.analysisViewData,remove:()=>{},show:()=>{}}))}get updating(){return!1}};(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],v.prototype,"view",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],v.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,r.MZ)()],v.prototype,"updating",null),v=(0,i.Cg)([(0,s.$)("esri.views.2d.analysis.ElevationProfile.ElevationProfileInputVisualization2D")],v);var y=n(39356),f=n(59784),g=n(79468),m=n(63733),_=n(89465),w=n(31633);let C={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:C.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0,signal:null}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:(0,w.oU)(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,profileLinesUpdateThrottleMillis:100,hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function M(){return C}const x={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null};var b=n(48384);let R=class extends h.A{constructor(e){super(e),this._graphic=new y.A,this._layer=new m.A({listMode:"hide",internal:!0}),this._updateGeometryThrottled=(0,g.n)(e=>{var t;if(!e)return void(this._graphic.visible=!1);const n=this._layer,i=null===(t=this.view.map)||void 0===t?void 0:t.layers;i&&(i.includes(n)||i.add(n),i.reorder(n,0)),this._graphic.visible=!0,this._graphic.geometry=function(e,t){var n;null!==(n=e)&&void 0!==n||(e=[]);const i=e.length-1,o=[];let r=[];for(let s=0;s<=i;s++){const{x:t,y:n,z:a}=e[s];null!=a&&r.push([t,n,a]),s!==i&&null!=a||!r.length||(o.push(r),r=[])}return(0,b.LZ)(o,t,!0)}(e.samples,e.spatialReference)},M().profileLinesUpdateThrottleMillis)}initialize(){this._layer.add(this._graphic),this.addHandles([(0,d.z7)(()=>!this.analysisViewData.visible,()=>{this._graphic.visible=!1}),(0,d.wB)(()=>this._colorUpdateParameters,e=>this._updateColor(e),d.pc),(0,d.wB)(()=>this.analysisViewData.analysis.geometry,()=>{this._graphic.visible=!1},d.pc),(0,d.wB)(()=>this._geometryUpdateParameters,e=>this._updateGeometryThrottled(e),d.pc),this._updateGeometryThrottled])}destroy(){var e;null!==(e=this.view.map)&&void 0!==e&&e.remove(this._layer),this._layer.destroy(),this._graphic.destroy()}get updating(){return this._updateGeometryThrottled.hasPendingUpdates()}get _result(){const{analysisViewData:e}=this;return e.visible?e.results.find(e=>{let{available:t,computation:n,rawResult:i}=e;return t&&n.profile.viewOptions.lineVisible&&!0===(null===i||void 0===i?void 0:i.hasZ)}):null}get _geometryUpdateParameters(){const e=this._result;return 1!==(null===e||void 0===e?void 0:e.progress)?null:{samples:e.samples,spatialReference:this.view.spatialReference}}get _colorUpdateParameters(){var e;const t=null===(e=this._result)||void 0===e?void 0:e.computation.profile.color;return t?{color:t.toArray(),contrastColor:(0,f.bJ)(t).toArray()}:null}_updateColor(e){e&&(this._graphic.symbol=new _.A({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",capStyle:"Butt",color:e.color,effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],joinStyle:"Round",width:1.5},{type:"CIMSolidStroke",capStyle:"Butt",color:e.contrastColor,joinStyle:"Round",width:1.5}]}}}))}};(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],R.prototype,"view",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],R.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,r.MZ)()],R.prototype,"updating",null),(0,i.Cg)([(0,r.MZ)()],R.prototype,"_result",null),(0,i.Cg)([(0,r.MZ)()],R.prototype,"_geometryUpdateParameters",null),(0,i.Cg)([(0,r.MZ)()],R.prototype,"_colorUpdateParameters",null),R=(0,i.Cg)([(0,s.$)("esri.views.2d.analysis.ElevationProfile.ElevationProfileLineVisualization2D")],R);var S=n(19276),P=n(69539),Z=n(56611);let A=class extends h.A{constructor(e){super(e),this.position=null,this.color=new P.A("#ffffff"),this.element=function(){const e=document.createElement("div"),{size:t,borderStyle:n,borderColor:i,borderWidth:o,boxShadow:r}=M().hoveredPointsStyle,{style:s}=e;return s.display="block",s.position="absolute",s.top="0",s.left="0",s.contain="strict",s.boxSizing="border-box",s.width="".concat(t,"px"),s.height="".concat(t,"px"),s.marginTop="-".concat(t/2,"px"),s.marginLeft="-".concat(t/2,"px"),s.border="".concat(n," ").concat(o,"px ").concat(i),s.borderRadius="".concat(t,"px"),s.boxShadow=r,e}()}initialize(){var e;this.addHandles([(0,d.wB)(()=>this._screenLocation,e=>{e&&(this.element.style.transform="translate(".concat(e.x,"px, ").concat(e.y,"px)"))},d.pc),(0,d.wB)(()=>this.color.toCss(),e=>{this.element.style.background=e},d.pc)]),null===(e=this.view.surface)||void 0===e||e.appendChild(this.element)}destroy(){this.element.remove()}get _screenLocation(){const{position:e,view:t}=this;"3d"===t.type?(t.commitProperty("size"),t.commitProperty("camera")):t.commitProperty("center");const n=null===t||void 0===t?void 0:t.spatialReference,i=n?(0,Z.projectOrLoad)(e,n).geometry:null;return i&&null!==t&&void 0!==t&&t.ready?t.toScreen(i):null}};(0,i.Cg)([(0,r.MZ)()],A.prototype,"position",void 0),(0,i.Cg)([(0,r.MZ)({type:P.A})],A.prototype,"color",void 0),(0,i.Cg)([(0,r.MZ)()],A.prototype,"view",void 0),(0,i.Cg)([(0,r.MZ)()],A.prototype,"_screenLocation",null),A=(0,i.Cg)([(0,s.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointVisualization")],A);let E=class extends h.A{constructor(e){super(e),this._hoveredPoints=new S.A}initialize(){const{analysisViewData:e}=this,{analysis:t}=e;this.addHandles([(0,d.wB)(()=>{const{hoveredPoints:n,visible:i,updating:o}=e;return i?o?null:n.map((e,n)=>{const i=t.profiles.at(n);return!0===(null===i||void 0===i?void 0:i.viewOptions.hoveredPointVisible)&&null!=e?{hoveredPoint:e,color:i.color}:null}).filter(e=>!!e):[]},e=>this._update(e),d.pc),(0,d.wB)(()=>t.geometry,()=>this._update([]),d.pc)])}destroy(){this._hoveredPoints.drain(e=>e.destroy())}get updating(){return!1}_update(e){if(!e)return;const{view:t,_hoveredPoints:n}=this,i=e.length;for(;n.length>i;){var o;null===(o=n.pop())||void 0===o||o.destroy()}for(;n.length<i;){const e=new A({view:t});n.push(e)}for(let r=0;r<i;++r){const t=e[r],o=n.at(i-1-r);o.position=t.hoveredPoint,o.color=t.color}}};(0,i.Cg)([(0,r.MZ)()],E.prototype,"view",void 0),(0,i.Cg)([(0,r.MZ)()],E.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,r.MZ)()],E.prototype,"_hoveredPoints",void 0),(0,i.Cg)([(0,r.MZ)()],E.prototype,"updating",null),E=(0,i.Cg)([(0,s.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointsVisualization")],E);let k=class extends h.A{constructor(e){super(e)}initialize(){const{view:e,analysisViewData:t}=this;this._hoveredPointsVisualization=new E({view:e,analysisViewData:t}),this._inputVisualization=new v({view:e,analysisViewData:t}),this._lineVisualization=new R({view:e,analysisViewData:t})}destroy(){this._inputVisualization.destroy(),this._hoveredPointsVisualization.destroy(),this._lineVisualization.destroy()}get updating(){return this._hoveredPointsVisualization.updating||this._inputVisualization.updating||this._lineVisualization.updating}};(0,i.Cg)([(0,r.MZ)()],k.prototype,"view",void 0),(0,i.Cg)([(0,r.MZ)()],k.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,r.MZ)()],k.prototype,"updating",null),k=(0,i.Cg)([(0,s.$)("esri.views.2d.analysis.ElevationProfile.ElevationProfileVisualization2D")],k);var T=n(89379),D=n(19495),G=n(18690),z=n(98773);function I(e,t){let n,i=!1;return function(){for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];const a=e.apply(this,r);return i&&void 0!==n&&null!==t&&void 0!==t&&t(n,a)?n:(i=!0,n=a,a)}}var V=n(53084),O=n(53521),L=n(43927),U=n(30726),F=n(50346);class q{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,t){this._store.put(e,t)}}var j=n(12482),H=n(19747),W=n(731);class B extends o.A{constructor(e,t,n){super(e,t,n),this.name="unknown",this.name=e}}class N extends B{constructor(){super("too-complex","The input geometry has too many points.")}}class Q extends B{constructor(){super("invalid-geometry","The input geometry is invalid.")}}class $ extends B{constructor(){super("elevation-query-error","Error querying elevation from provider.")}}class J extends B{constructor(){super("unknown","Unknown error.")}}var K=n(56218),X=n(10600),Y=n(15941),ee=n(66388),te=n(5262),ne=n(80963),ie=n(19555),oe=n(20664),re=n(23701),se=n(13312),ae=n(7137);async function le(e,t,i,o,r,s,a){let l,u,c;const p=e.spatialReference,h=p.isGeographic||p.isWebMercator;let d=0;if(!h){const{execute:t}=await n.e(89227).then(n.bind(n,89227));(0,F.Te)(a),d=t(e,{unit:"meters"}),(0,F.Te)(a)}const v=1/(0,w.GA)(o);if(h){await(0,Z.initializeProjection)([{source:p,dest:o},{source:p,dest:se.A.WGS84}],a);const n=function(e){return(0,ae.TT)(e.spatialReference)?e:(0,Z.project)(e,se.A.WGS84)}(e);l=(0,ae.l1)([n],"meters")[0];const h=ue(l,r);if(Se(e,l,h)>s)throw new N;const d=ce(n,t,i);({densifiedPath:u,distances:c}=function(e,t,n){const{hasZ:i}=e;return me(e,t,n,_e,i?Me:Ce)}(d,h,v)),u=(0,Z.project)(u,o)}else{await(0,Z.initializeProjection)([{source:p,dest:o}],a),l=d;const n=ue(l,r);if(Se(e,l,n)>s)throw new N;const h=ce(e,t,i);({densifiedPath:u,distances:c}=function(e,t,n){const{hasZ:i}=e;return me(e,t,n,we,i?be:xe)}(h,n,v)),(0,F.Te)(a),u=(0,Z.project)(u,o)}return{densifiedPath:u,pathLength:l*v,distances:c}}function ue(e,t){const n=e/t.densificationMaxSamples;return Math.max(t.samplingDistance,n)}function ce(e,t,n){if(null==t)return pe(e);const i=e.spatialReference,o=t.mode,r=(0,j.Ze)(t,i);let s=null;switch(n.type){case"2d":s=function(e,t,n){let{hasZ:i}=e;return"absolute-height"===t?i?e=>{let[t,i,o]=e;return[t,i,o+n]}:e=>{let[t,i]=e;return[t,i,n]}:null}(e,o,r);break;case"3d":s=function(e,t,n,i){let{spatialReference:o,hasZ:r}=e,{elevationProvider:s}=i;const a=(e,t,n,i)=>{var r;return null!==(r=null===s||void 0===s?void 0:s.getElevation(e,t,n,o,i))&&void 0!==r?r:0};switch(t){case"on-the-ground":return e=>{let[t,n]=e;return[t,n,a(t,n,0,"ground")]};case"absolute-height":return r?e=>{let[t,i,o]=e;return[t,i,o+n]}:e=>{let[t,i]=e;return[t,i,n]};case"relative-to-ground":return r?e=>{let[t,i,o]=e;return[t,i,o+a(t,i,o,"ground")+n]}:e=>{let[t,i]=e;return[t,i,a(t,i,0,"ground")+n]};case"relative-to-scene":return r?e=>{let[t,i,o]=e;return[t,i,o+a(t,i,o,"scene")+n]}:e=>{let[t,i]=e;return[t,i,a(t,i,0,"scene")+n]};default:return null}}(e,o,r,n)}return null==s?pe(e):new re.A({hasZ:!0,hasM:!1,spatialReference:i,paths:he(e.paths,s)})}function pe(e){return e.hasZ?new re.A({hasZ:!1,hasM:!1,spatialReference:e.spatialReference,paths:he(e.paths,e=>{let[t,n]=e;return[t,n]})}):e}function he(e,t){const n=e.length,i=new Array(n);for(let o=0;o<n;++o){const n=e[o],r=n.length,s=new Array(n.length);i[o]=s;for(let e=0;e<r;++e)s[e]=t(n[e])}return i}function de(e){return ye(e)&&e.paths.some(e=>e.length>1)}function ve(e){return function(e){return fe(e)&&ye(null===e||void 0===e?void 0:e.geometry)}(e)&&de(e.geometry)}function ye(e){return!fe(e)&&null!=e&&"polyline"===e.type}function fe(e){return null!=e&&"geometry"in e}function ge(e){const t=null===e||void 0===e?void 0:e.layer;return null!=t&&"graphics"===t.type&&t.internal}function me(e,t,n,i,o){const{spatialReference:r,hasZ:s}=e,a={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:r,metersPerSR:(0,w.GA)(r)},l=[],u=[];let c=0;for(let p=0;p<e.paths.length;++p){const r=e.paths[p],s=new Array,h=new Array;let d=0;for(let e=1;e<r.length;++e){const l=r[e-1],u=r[e],p=i(a,l,u);let v;for(v=d;v<p.distance&&!(0,Y.Io)(v,p.distance);v+=t)s.push(o(p,v)),h.push((c+v)*n);d=v-p.distance,c+=p.distance,s.push(u),h.push(c*n)}l[p]=s,u[p]=h}return{densifiedPath:new re.A({spatialReference:r,hasZ:s,paths:l}),distances:u}}function _e(e,t,n){return e.distance=0,(0,ae._3)(e,t,n,e.spatialReference),e.from=t,e.to=n,e}function we(e,t,n){return e.from=t,e.to=n,e.distance=(0,ie.Io)(n,t)*e.metersPerSR,e}function Ce(e,t){let{from:n,azimuth:i,spatialReference:o}=e;return(0,ae.vN)([0,0],n,i,t,o)}function Me(e,t){let{from:n,to:i,azimuth:o,distance:r,spatialReference:s}=e;const a=t/r,l=[0,0,(0,Y.Cc)(n[2],i[2],a)];return(0,ae.vN)(l,n,o,t,s),l}function xe(e,t){let{from:n,to:i,distance:o}=e;return(0,ie.Cc)([0,0],n,i,t/o)}function be(e,t){let{from:n,to:i,distance:o}=e;return(0,oe.l)([0,0,0],n,i,t/o)}function Re(e){return e.paths.reduce((e,t)=>e+t.length,0)}function Se(e,t,n){return Re(e)+Math.floor(t/n)+Math.max(0,e.paths.reduce(e=>1+e,0)-1)}function Pe(e,t){const n=e.length;if(0===n)return null;const i=e[0],o=i.sampledZ;let r=o,s=o,a=0,l=0,u=null,c=null,p=null!=o?o:0,h=0,d=0,v=null!=o?1:0,y=0,f=0;const g=(0,w.GA)(t),m=(0,w.G9)(t),_=M().minSlopeSampleDistance/g,C=2*_,x=new ke,b=new ke,R=()=>{P(),x.copy(b),b.reset()},S=(e,t)=>{R(),e>0&&e-x.start<=C&&(e=x.start+_),b.restart(e,t)},P=()=>{if(x.isHole||b.isHole)return;const e=b.avgElevation-x.avgElevation,t=b.start-x.start,n=e*m,i=t*g,o=(0,w.oU)(Math.atan2(n,i),"radians","degrees");o>0?(h+=o,u=Ae(u,o),y++):o<0&&(d-=o,c=Ae(c,-o),f++)};null!=i.sampledZ&&S(i.distance,i.sampledZ);for(let w=1;w<n;++w){const t=e[w-1],n=e[w],i=n.sampledZ;if(null==i){b.isHole||R();continue}v++,p+=i,r=Ze(r,i),s=Ae(s,i),b.isHole||n.distance-b.start>=_?S(n.distance,i):b.insert(i);const o=t.sampledZ;if(null!=o){const e=i-o;e>0?a+=e:e<0&&(l-=e)}}return R(),0===v?null:{maxDistance:e[n-1].distance,minElevation:r,maxElevation:s,avgElevation:0===v?null:p/v,elevationGain:a,elevationLoss:l,maxPositiveSlope:u,maxNegativeSlope:c,avgPositiveSlope:0===y?null:h/y,avgNegativeSlope:0===f?null:d/f}}function Ze(e,t){return null==t?e:null!=e?Math.min(e,t):t}function Ae(e,t){return null==t?e:null!=e?Math.max(e,t):t}function Ee(e,t){return null!=e&&null!=t?e*t:null}class ke{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return 0===this._sampleCount}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,t){this._start=e,this._sampleCount=1,this._totalElevation=t}insert(e){++this._sampleCount,this._totalElevation+=e}}function Te(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e>=t)return n;if(n.push(e),t-e<2)return n;const i=t-1;n.push(i);const o=De(e+1,i);for(;;){const e=o.next();if(e.done)break;n.push(e.value)}return n}function*De(e,t){if(e>=t)return;const n=e+Math.floor((t-e)/2);yield n;const i=De(e,n),o=De(n+1,t);for(;;){const e=i.next(),t=o.next();if(e.done&&t.done)break;e.done||(yield e.value),t.done||(yield t.value)}}var Ge=n(27243),ze=n(59752);function Ie(){return Ie=(0,X.A)(function*(e,t){var n;const{view:i,geometry:o,elevationInfo:r,providers:s,options:a}=e,l=i.spatialReference;if(!l||null==o||!de(o))throw new Q;const u=s.length;if(0===u)return null;const c=Math.round(a.maxTotalSamples/u);if(Re(o)>c)throw new N;const p=yield(0,K.A)(le(o,r,i,l,a,c,t));(0,F.Te)(t);let h=0;const d=new Array(u),v=new Array(u);for(let g=0;g<u;g++){const n=Fe(p);d[g]=n,h+=n.samples.length;const i=(0,T.A)((0,T.A)({},e),{},{provider:s[g],result:n,densificationResult:p});v[g]=Ve(i,t)[Symbol.iterator]()}if(h>a.maxTotalSamples)throw new N;const y=yield(0,K.A)(Promise.all(v.map(e=>{const t=e.next();return!0===t.done?Promise.resolve(null):t.value})));(0,F.Te)(t);for(let g=0;g<u;g++)d[g]=y[g];yield d,yield(0,K.A)((0,F.Pl)(null!==(n=e.delayAfterPreview)&&void 0!==n?n:M().delayAfterPreviewMillis,null,t.signal)),(0,F.Te)(t);const f=[];try{let e;do{e=!1;for(let t=0;t<u;t++){const n=v[t].next();!1===n.done&&(f.push({resultPromise:n.value,index:t}),e=!0)}}while(e)}finally{v.forEach(e=>{var t;return null===(t=e.return)||void 0===t?void 0:t.call(e)})}for(const{resultPromise:g,index:m}of f)d[m]=yield(0,K.A)(g),(0,F.Te)(t),yield d;for(const g of d)null!=g&&(g.progress=1);yield d}),Ie.apply(this,arguments)}function*Ve(e,t){const{densificationResult:n}=e,i=(0,T.A)((0,T.A)({},e),{},{abortOptions:t,densificationResult:n}),o=Te(0,i.result.samples.length),r=o.slice(0,i.provider.numSamplesForPreview);yield Oe(i,r,!0);const s=(0,G.Ho)(o,i.provider.numSamplesPerChunk);for(const a of s)yield Oe(i,a,!1)}async function Oe(e,t,n){let{densificationResult:i,result:o,provider:r,queue:s,abortOptions:a,cache:l}=e;const{densifiedPath:u,pathLength:c}=i,p=o.spatialReference,{samples:h}=o,d=[];for(let v=0;v<t.length;v++){const e=h[t[v]];d[v]=[...e.coordinate]}try{return await s.push({geometry:new ee.A({spatialReference:p,points:d,hasZ:u.hasZ}),provider:r,indices:t,preview:n,result:o,parameters:(0,T.A)((0,T.A)({},M().defaultQueryOptions()),{},{minDemResolution:n?Math.round(c/r.numSamplesForPreview):Math.round(c/h.length),cache:l})},a),(0,T.A)({},o)}catch(ue){return(0,F.zf)(ue)?null:x}}function Le(e){return new Ge.F({priority:ze.W6.ELEVATION_PROFILE,concurrency:1,scheduler:e,process:async e=>{(0,F.Te)(e.parameters);try{await async function(e){let{geometry:t,provider:n,indices:i,preview:o,result:r,parameters:s}=e;if(0===i.length)return;const a=(await async function(e,t,n){try{return await e.queryElevation(t,n)}catch(o){throw new $}}(n,t,s)).geometry,{hasZ:l,points:u}=a,c=s.noDataValue,{samples:p}=r;for(let h=0;h<i.length;h++){const e=p[i[h]];if(e.isHole)continue;const t=l?u[h][2]:null;null===t||t===c?e.sampledZ=null:(r.hasZ=!0,e.sampledZ=t),e.sampled=!0}(function(e){const t=e.length-1;let n=0;for(let i=1;i<=t;i++)(e[i].sampled||i===t)&&(Ue(e,n,i),n=i)})(p),r.progress=o?0:r.progress+i.length/p.length,r.statistics=Pe(r.samples,r.spatialReference)}(e)}catch(t){(0,F.jH)(t)}}})}function Ue(e,t,n){if(n-t===1)return;const i=e[t],o=i.sampledZ,r=e[n],s=r.sampledZ;if(null==o||null==s){for(let i=t+1;i<n;i++)e[i].sampledZ=null;return}const a=i.distance,l=r.distance-a;for(let u=t+1;u<n;u++){const t=e[u],n=(t.distance-a)/l;t.sampledZ=(0,Y.Cc)(o,s,n)}}function Fe(e){let{densifiedPath:t,distances:n}=e;const i=t.spatialReference,o=(0,ne.Vp)(i),r=t.paths,s=r.length,a=[];let l=null,u=0;for(let c=0;c<s;c++){const e=r[c],t=e.length,i=n[c];for(let n=0;n<t;n++){const t=e[n],r=i[n];o&&(t[0]=(0,te.N6)(t[0],o.valid[0],o.valid[1])),l&&0===n&&qe(a,l,t,u,r),a.push(je(t,r)),l=t,u=r}}return{progress:0,samples:a,hasZ:!1,statistics:null,spatialReference:i}}function qe(e,t,n,i,o){e.push(He(t,i)),e.push(He(n,o))}function je(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!1,isHole:!1}}function He(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!0,isHole:!0}}function We(e){return e>.999999?1:e}let Be=class extends h.A{constructor(e){super(e),this.error=null,this._getStableEffectiveUnits=I(()=>{var e,t;const n=function(e){var t,n,i;let o=null,r=null,s=null;for(const a of e){if(null==a)continue;const{statistics:e,spatialReference:t}=a;if(null==e)continue;const n=(0,w.GA)(t);o=Ae(o,Ee(e.maxDistance,n));const i=(0,w.G9)(t);s=Ze(s,Ee(e.minElevation,i)),r=Ae(r,Ee(e.maxElevation,i))}return{minDistance:0,maxDistance:null!==(t=o)&&void 0!==t?t:0,minElevation:null!==(n=s)&&void 0!==n?n:0,maxElevation:null!==(i=r)&&void 0!==i?i:0}}(this._activeComputations.map(e=>e.result.rawResult)),i=this.analysis.displayUnits,o=(0,H.c)(this.view);return{distance:(0,w.Vs)(n.maxDistance,"meters",null!==(e=i.distance)&&void 0!==e?e:o),elevation:(0,w.jE)(n.maxElevation,"meters",null!==(t=i.elevation)&&void 0!==t?t:o)}},V.gh),this._updateTask=null,this._queue=null,this._currentTileCache=null,this._parametersPerComputation=new Map,this._getStableUpdateParameters=I(()=>{var e;return{stationary:null===(e=this.view.stationary)||void 0===e||e,activeComputations:this._activeComputations,generationParameters:this._generationParameters}},V.gh),this._getStableGenerationParameters=I(()=>{const{view:e,analysis:t}=this;return null!==e&&void 0!==e&&e.ready&&this._queue?{view:e,geometry:t.geometry,geometryIsValid:t.valid,elevationInfo:this.elevationInfo,queue:this._queue,cache:this._tileCache,options:this._options,slicePlane:"3d"===e.type?e.slice.plane:null}:null},V.gh),this._getStableElevationInfo=I(()=>{var e;return null!==(e=this.analysis.elevationInfo)&&void 0!==e?e:Ne},U.CM),this._getStableOptions=I(()=>{var e;const{densificationMaxSamples:t,defaultDemResolution:n,maxTotalSamples:i}=M();let o=null!==(e=this._minDemResolution)&&void 0!==e?e:n;return o=parseFloat(o.toFixed(2)),{samplingDistance:o,densificationMaxSamples:Math.round(t/this._activeComputations.length),maxTotalSamples:i}},V.gh),this._updateThrottled=(0,g.n)(e=>this._update(e),M().updateThrottleMillis)}initialize(){this._computationsCollection=(0,L.L)(()=>this.analysis.profiles,e=>this.computationFactory.create({controller:this,profile:e,onInvalidate:e=>this._invalidateComputation(e)}),{recycleItems:!0}),this.addHandles([this._computationsCollection.on("change",()=>{this._parametersPerComputation.clear(),this._updateThrottled(this._updateParameters)}),(0,d.wB)(()=>this._updateParameters,e=>this._updateThrottled(e),d.pc),this._updateThrottled]);const e="3d"===this.view.type?this.view.resourceController:void 0;this._queue=Le(null===e||void 0===e?void 0:e.scheduler),null===e||void 0===e||e.addUpdatingObject(this)}destroy(){var e;this._abortUpdate(),this._parametersPerComputation.clear(),null!==(e=this._computationsCollection)&&void 0!==e&&e.destroy(),this._queue=(0,U.pR)(this._queue),this._currentTileCache=(0,U.pR)(this._currentTileCache)}get effectiveDisplayUnits(){return this._getStableEffectiveUnits()}get progress(){let e=0,t=0;for(const n of this._activeComputations)e++,t+=n.progress;return We(e>0?t/e:0)}get updating(){var e;const{progress:t}=this,n=!(null===(e=this._queue)||void 0===e||!e.updating),i=this._updateThrottled.hasPendingUpdates(),o=null!=this._updateTask&&!this._updateTask.finished;return n||i||o||t>0&&t<1}get results(){return this._computations.map(e=>e.result)}get statistics(){return function(e){const t=e.filter(G.Ru),n=t.length;if(0===n)return null;const i=t[0];if(1===n)return i;let o=i.maxDistance,r=i.minElevation,s=i.maxElevation,a=i.maxPositiveSlope,l=i.maxNegativeSlope;for(let u=1;u<t.length;++u){const e=t[u];o=Ae(o,e.maxDistance),r=Ze(r,e.minElevation),s=Ae(s,e.maxElevation),a=Ae(a,e.maxPositiveSlope),l=Ae(l,e.maxNegativeSlope)}return{maxDistance:o,minElevation:r,maxElevation:s,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:a,maxNegativeSlope:l,avgPositiveSlope:null,avgNegativeSlope:null}}(this._activeComputations.map(e=>e.result.statistics))}get hoveredPoints(){return this._computations.map(e=>e.hoveredPoint)}onElevationChange(e){const{view:t}=this;return"3d"===(null===t||void 0===t?void 0:t.type)?(0,d.on)(()=>t.elevationProvider,"elevation-change",e,{onListenerAdd:e,onListenerRemove:e}):(0,l.hA)()}get _tileCache(){this._currentTileCache=(0,U.pR)(this._currentTileCache);const e=this.view;if("3d"===(null===e||void 0===e?void 0:e.type)){var t;const n=null===(t=e.basemapTerrain)||void 0===t?void 0:t.elevationQueryCache;if(null!=n)return n}return null==this._currentTileCache&&(this._currentTileCache=new q(new O.q(20971520))),this._currentTileCache}get _computations(){var e,t;return null!==(e=null===(t=this._computationsCollection)||void 0===t?void 0:t.toArray())&&void 0!==e?e:[]}get _activeComputations(){return this._computations.filter(e=>e.profile.enabled&&e.available)}get _minDemResolution(){const e=this._minDemResolutions;return e.length>0?(0,G.jk)(e):null}get _minDemResolutions(){const e=[];for(const{minDemResolution:t}of this._activeComputations)null!=t&&e.push(t);return e}get _updateParameters(){return this._getStableUpdateParameters()}get _generationParameters(){return this._getStableGenerationParameters()}get elevationInfo(){return this._getStableElevationInfo()}get _options(){return this._getStableOptions()}_update(e){let{stationary:t,activeComputations:n,generationParameters:i}=e;this._abortUpdate(),t&&(null!=i?this._updateTask=(0,z.UT)(async e=>{this.error=null;const t=n.filter(e=>!this._isComputationValid(e,i));try{if(!i.geometryIsValid)throw new Q;const n=function(e,t){return Ie.apply(this,arguments)}((0,T.A)((0,T.A)({},i),{},{providers:t}),{signal:e});let c=!1;var o,r=!1,s=!1;try{for(var a,l=(0,D.A)(n);r=!(a=await l.next()).done;r=!1){const n=a.value;(0,F.Te)(e),c||(this._clearInvalidResults(i),c=!0);for(let e=0;e<t.length;e++)t[e].setResult(n[e])}}catch(u){s=!0,o=u}finally{try{r&&null!=l.return&&await l.return()}finally{if(s)throw o}}for(const e of t)this._parametersPerComputation.set(e,i)}catch(c){(0,F.QP)(c),this._abortUpdate(),this.error=c instanceof B?c:new J,t.forEach(e=>{e.clearResult()})}}):this._clearResults())}_abortUpdate(){this._updateTask=(0,U.DC)(this._updateTask)}_isComputationValid(e,t){return this._parametersPerComputation.has(e)&&this._parametersPerComputation.get(e)===t}_invalidateComputation(e){this._parametersPerComputation.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const t of this._computations)this._isComputationValid(t,e)||(t.clearResult(),this._parametersPerComputation.delete(t))}_clearResults(){for(const e of this._computations)e.clearResult(),this._parametersPerComputation.delete(e)}};(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],Be.prototype,"analysis",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],Be.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],Be.prototype,"computationFactory",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],Be.prototype,"view",void 0),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"error",void 0),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],Be.prototype,"effectiveDisplayUnits",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"progress",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"updating",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"results",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"statistics",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"hoveredPoints",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_updateTask",void 0),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_queue",void 0),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_tileCache",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_computationsCollection",void 0),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_computations",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_activeComputations",null),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],Be.prototype,"_minDemResolution",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_minDemResolutions",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_updateParameters",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_generationParameters",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"elevationInfo",null),(0,i.Cg)([(0,r.MZ)()],Be.prototype,"_options",null),Be=(0,i.Cg)([(0,s.$)("esri.views.analysis.ElevationProfile.ElevationProfileController")],Be);const Ne=new W.A((0,T.A)({},j.qt));var Qe=n(69098),$e=n(56002),Je=n(19247);function Ke(e,t,n){return null==e?null:(0,w.oU)(e*t,"meters",n)}function Xe(e,t,n){return null==e?null:(0,w.oU)(e*t,"meters",n)}let Ye=class extends Qe.Pw{constructor(e){super(e),this._getSamplesMemoized=(0,$e.B)((e,t)=>function(e,t){if(null==e||null==t)return null;const{samples:n,spatialReference:i}=e,{distance:o,elevation:r}=t,s=(0,w.GA)(i),a=(0,w.G9)(i),l=n.length,u=new Array(l);for(let c=0;c<l;++c){const e=n[c],t=e.sampledZ,i=e.coordinate;u[c]={x:i[0],y:i[1],z:t,distance:Ke(e.distance,s,o),elevation:Xe(t,a,r)}}return u}(e,t)),this._getStatisticsMemoized=(0,$e.B)((e,t)=>function(e,t){if(null==e||null==t||null==e.statistics||null==e.spatialReference)return null;const{distance:n,elevation:i}=t,{statistics:o,spatialReference:r}=e,s=(0,w.GA)(r),a=(0,w.G9)(r);return{maxDistance:Ke(o.maxDistance,s,n),minElevation:Xe(o.minElevation,a,i),maxElevation:Xe(o.maxElevation,a,i),avgElevation:Xe(o.avgElevation,a,i),elevationGain:Xe(o.elevationGain,a,i),elevationLoss:Xe(o.elevationLoss,a,i),maxPositiveSlope:o.maxPositiveSlope,maxNegativeSlope:o.maxNegativeSlope,avgPositiveSlope:o.avgPositiveSlope,avgNegativeSlope:o.avgNegativeSlope}}(e,t)),this.rawResult=null}get available(){const{computation:e}=this;return e.profile.enabled&&e.available}get profile(){return this.computation.profile}get progress(){return We(null!=this.rawResult&&this.computation.profile.enabled?this.rawResult.progress:0)}get samples(){return this._getSamplesMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get statistics(){return this._getStatisticsMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get hoveredPoint(){if(!this.computation.profile.enabled)return null;const e=this.computation.controller.analysisViewData.hoveredPosition;if(null==e)return null;const{rawResult:t,samples:n}=this;if(null==n||null==t)return null;const i=n.length;if(0===i)return null;const o=function(e,t,n){if(!e||0===e.length)return;const i=e.length-1,o=e[0];if(t<=n(o))return o;const r=e[i];if(t>=n(r))return r;let s=0,a=0,l=i;for(;s<l;){a=s+Math.floor((l-s)/2);const o=e[a],r=n(o);if(r===t)return o;if(t<r){if(a>0){const i=e[a-1],s=n(i);if(t>s)return t-s>=r-t?o:i}l=a}else{if(a<i){const i=e[a+1],s=n(i);if(t<s)return t-r>=s-t?i:o}s=a+1}}return e[a]}(n,e*n[i-1].distance,e=>e.distance);if(null==o)return null;const{x:r,y:s,z:a}=o;return null==a?null:new Je.A({x:r,y:s,z:a,spatialReference:t.spatialReference})}};(0,i.Cg)([(0,r.MZ)()],Ye.prototype,"available",null),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],Ye.prototype,"profile",null),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],Ye.prototype,"progress",null),(0,i.Cg)([(0,r.MZ)()],Ye.prototype,"samples",null),(0,i.Cg)([(0,r.MZ)()],Ye.prototype,"statistics",null),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],Ye.prototype,"computation",void 0),(0,i.Cg)([(0,r.MZ)()],Ye.prototype,"rawResult",void 0),(0,i.Cg)([(0,r.MZ)()],Ye.prototype,"hoveredPoint",null),Ye=(0,i.Cg)([(0,s.$)("esri.views.analysis.ElevationProfile.ElevationProfileResult")],Ye);let et=class extends h.A{constructor(e){super(e),this.result=new Ye({computation:this}),this.numSamplesForPreview=30,this.numSamplesPerChunk=200}initialize(){this.addHandles([(0,d.wB)(()=>{const{geometry:e,elevationInfo:t}=this.controller.analysis;return[e,t]},()=>this.onInvalidate(this),d.OH)])}setResult(e){this.result.rawResult=e}clearResult(){this.setResult(null)}get progress(){return this.result.progress}get hoveredPoint(){return this.result.hoveredPoint}get available(){return!0}get minDemResolution(){return M().defaultDemResolution}};(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],et.prototype,"controller",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],et.prototype,"profile",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],et.prototype,"onInvalidate",void 0),(0,i.Cg)([(0,r.MZ)()],et.prototype,"result",void 0),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],et.prototype,"progress",null),(0,i.Cg)([(0,r.MZ)()],et.prototype,"hoveredPoint",null),(0,i.Cg)([(0,r.MZ)()],et.prototype,"available",null),(0,i.Cg)([(0,r.MZ)()],et.prototype,"numSamplesForPreview",void 0),(0,i.Cg)([(0,r.MZ)()],et.prototype,"numSamplesPerChunk",void 0),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],et.prototype,"minDemResolution",null),et=(0,i.Cg)([(0,s.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineComputation")],et);var tt=n(97153);function nt(e){var t;if(null==e)return null;if((0,tt.Q)(e))return it(e);const n=e.tileInfo;if(null==n)return null;const i=null===(t=n.lods)||void 0===t?void 0:t.at(-1);return null==i?null:i.resolution*(0,w.GA)(n.spatialReference)}function it(e){var t;if(null==e)return null;const n=e.layers.items.map(ot).filter(G.Ru);return null!==(t=(0,G.jk)(n))&&void 0!==t?t:null}function ot(e){return e&&"tileInfo"in e?nt(e):null}let rt=class extends et{constructor(){super(...arguments),this.type="ground",this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getStableQueryElevationDependencies=I(()=>({ground:this._ground,groundLayers:this._getStableGroundLayers()}),V.gh),this._getStableGroundLayers=I(()=>{var e;return null===(e=this._ground)||void 0===e||null===(e=e.layers)||void 0===e?void 0:e.toArray()},V.gh)}get minDemResolution(){return it(this._ground)}get available(){var e;return!0===(null===(e=this._ground)||void 0===e?void 0:e.layers.some(e=>e.visible))}initialize(){this.addHandles([(0,d.wB)(()=>this._queryElevationDependencies,()=>this.onInvalidate(this))])}async queryElevation(e,t){const n=this._queryElevationDependencies;if(null==n)throw new Error("".concat(this.declaredClass,": no dependencies"));const{ground:i}=n;if(null==i)throw new Error("No ground configured in the view");const o=await i.queryElevation(e,t),r=(0,w.G9)(e.spatialReference),s=(0,w.G9)(i.layers.at(0).spatialReference);if(r!==s){const e=o.geometry;e.points=e.points.map(e=>{let[n,i,o]=e;return[n,i,o===t.noDataValue?o:o*s/r]})}return o}get _queryElevationDependencies(){return this._getStableQueryElevationDependencies()}get _ground(){var e;return null===(e=this.controller.view)||void 0===e||null===(e=e.map)||void 0===e?void 0:e.ground}};(0,i.Cg)([(0,r.MZ)()],rt.prototype,"minDemResolution",null),(0,i.Cg)([(0,r.MZ)()],rt.prototype,"available",null),(0,i.Cg)([(0,r.MZ)()],rt.prototype,"_queryElevationDependencies",null),(0,i.Cg)([(0,r.MZ)()],rt.prototype,"_ground",null),rt=(0,i.Cg)([(0,s.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineGroundComputation")],rt);var st=n(62078);let at=class extends et{constructor(){super(...arguments),this.type="input",this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this._getStableElevationDependencies=I(()=>{const{view:e}=this.controller;if(!e)return null;const t=this._getStableElevationInfo();return{view:e,stationary:!this._requiresElevationAlignment||e.stationary,elevationInfo:t,visibleLayerIds:this._getStableLayerIds(),spatialReference:this._getStableSpatialReference()}},V.gh),this._getStableElevationInfo=I(()=>this.controller.elevationInfo,U.CM),this._getStableSpatialReference=I(()=>{var e;return null===(e=this.controller.view)||void 0===e?void 0:e.spatialReference},U.CM),this._getStableLayerIds=I(()=>{const{view:e}=this.controller;return"3d"!==e.type?[]:function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.map)||void 0===n||null===(n=n.allLayers)||void 0===n?void 0:n.toArray().filter(e=>("graphics"!==e.type||!e.internal)&&e.visible).map(e=>e.uid))&&void 0!==t?t:[]}(e)},V.gh)}initialize(){const e=()=>this.onInvalidate(this);this.addHandles([(0,d.wB)(()=>this._queryElevationDependencies,e,d.OH),this.controller.onElevationChange(e)])}async queryElevation(e,t){let{noDataValue:n,signal:i}=t;const o=this._queryElevationDependencies;if(null==o)throw new Error("".concat(this.declaredClass,": no dependencies"));const{view:r,spatialReference:s}=o;if(this._requiresElevationAlignment&&"3d"===r.type&&s){const t=await st.q.fromGeometry(e).project(s,i);if(!t)return{geometry:e,noDataValue:n};const o=r.elevationProvider;return t.coordinates.forEach(e=>{var t;e.z=null!==(t=o.getElevation(e.x,e.y,0,s,"ground"))&&void 0!==t?t:0}),{geometry:t.export(),noDataValue:n}}return{geometry:e,noDataValue:n}}get _requiresElevationAlignment(){var e;return"on-the-ground"===(null===(e=this.controller.elevationInfo)||void 0===e?void 0:e.mode)&&"3d"===this.controller.view.type}get _queryElevationDependencies(){return this._getStableElevationDependencies()}};(0,i.Cg)([(0,r.MZ)()],at.prototype,"_queryElevationDependencies",null),at=(0,i.Cg)([(0,s.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineInputComputation")],at);let lt=class extends et{constructor(){super(...arguments),this.type="query",this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return nt(this.profile.source)}get available(){const{source:e}=this.profile;return!!e&&(null==e.visible||e.visible)&&(null==e.layers||e.layers.some(e=>e.visible))}initialize(){this.addHandles((0,d.wB)(()=>this.profile.source,()=>this.onInvalidate(this),d.OH))}queryElevation(e,t){if(!this.profile.source)throw new Error("No source configured for the elevation profile line");return this.profile.source.queryElevation(e,t)}};(0,i.Cg)([(0,r.MZ)({readOnly:!0})],lt.prototype,"minDemResolution",null),(0,i.Cg)([(0,r.MZ)()],lt.prototype,"available",null),lt=(0,i.Cg)([(0,s.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineQueryComputation")],lt);var ut=n(19451),ct=n(7246),pt=n(75540);class ht{constructor(){this._currentOperationSignal=(0,pt.v)(null)}get currentOperationType(){var e,t;return null!==(e=null===(t=this._currentOperationSignal.value)||void 0===t?void 0:t.type)&&void 0!==e?e:null}destroy(){this.stop()}async start(e,t,n){const i=this._currentOperationSignal.value;null===i||void 0===i||i.stop();const o=new AbortController,r=null===n||void 0===n?void 0:n.signal,s=AbortSignal.any([o.signal,r].filter(G.Ru)),a=(0,F.Tw)();let u=!1;const c=()=>{u||(u=!0,a.reject((0,F.NK)()))},p={type:e,resolve:e=>{u||(u=!0,a.resolve(e))},reject:c,promise:a.promise,stop:()=>o.abort(),handles:[]};this._currentOperationSignal.value=p,p.handles.push((0,F.u7)(r,()=>{o.abort()}),(0,F.u7)(s,()=>{(0,l.a0)(p.handles),u||c()}));try{return i&&(await i.promise.catch(()=>{}),(0,F.Te)(s)),await t(p,s),await a.promise}finally{(0,l.a0)(p.handles),this._currentOperationSignal.value===p&&(this._currentOperationSignal.value=null)}}stop(){var e;null===(e=this._currentOperationSignal.value)||void 0===e||e.stop()}}var dt=n(57308),vt=n(81335),yt=n(26611);let ft=class extends h.A{constructor(e){super(e),this._sketchViewModels=new S.A,this._updatingHandles=new ut.U,this._operationManager=new ht}initialize(){const{view:e}=this;this._graphicsLayer=new m.A({listMode:"hide",internal:!0}),this.addHandles([(0,d.wB)(()=>({map:e.map,internalGraphicsLayer:this._graphicsLayer,state:this.state,geometryVisualizationVisible:this._analysis.viewOptions.geometryVisualizationVisible,visible:this.analysisViewData.visible}),e=>{let{map:t,internalGraphicsLayer:n,state:i,geometryVisualizationVisible:o,visible:r}=e;!function(e,t){t&&(t.removeFromParent(),null===e||void 0===e||e.add(t))}(t,n);const s=this.sketchGraphic;switch(s&&(s.visible=r),i){case"idle":case"reshaping-disabled":s&&!o&&(s.visible=!1),this._operationManager.stop(),this._ensureUpdatedSketchGraphic();break;case"reshaping":(0,F.QZ)(this._startReshape());break;case"awaiting-sketch":this.analysisViewData.interactive=!0}},d.pc),(0,d.wB)(()=>this._analysis.elevationInfo,e=>{this._graphicsLayer.elevationInfo=e},d.pc)])}destroy(){var e;this._operationManager.destroy(),this._sketchViewModels.drain(e=>(0,U.pR)(e));const t=this._graphicsLayer;null!==(e=this.view.map)&&void 0!==e&&e.remove(t),t.destroy()}get sketchGraphic(){return this._get("sketchGraphic")}set sketchGraphic(e){e!==this._get("sketchGraphic")&&(this._set("sketchGraphic",e),this._updateAnalysisFromSketchGraphic())}get state(){const{visible:e,interactive:t}=this.analysisViewData;if(!e)return"idle";switch(this._operationManager.currentOperationType){case"place":return this._sketching?"sketching":"awaiting-sketch";case"pick-feature":return"picking";default:return this._analysis.geometry?t?"reshaping":"reshaping-disabled":"idle"}}get updating(){return this._sketchViewModels.some(e=>e.updating)||this._updatingHandles.updating}get _sketching(){return this._sketchViewModels.some(e=>e.createGraphic===this.sketchGraphic)}get _analysis(){return this.analysisViewData.analysis}get _lineSymbol(){return function(e){if("2d"===e){const e={type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5};return new _.A({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[(0,T.A)((0,T.A)({},e),{},{effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],color:[0,0,0,255]}),(0,T.A)((0,T.A)({},e),{},{color:[255,255,255,255]})]}}})}return new ct.default({color:[0,0,0,0]})}(this.view.type)}place(e){return this._operationManager.start("place",async t=>{const n=this._createSketchViewModel(),i=this._analysis.clone();this._ensureUpdatedSketchGraphic();const o=this.sketchGraphic,r=this._analysis.elevationInfo,s=(0,l.hA)(()=>{this.sketchGraphic===o&&(this._graphicsLayer.elevationInfo=r)}),a=n.on("create",e=>{switch(e.state){case"start":this._graphicsLayer.removeAll(),this.sketchGraphic=e.graphic,this._analysis.elevationInfo=this._graphicsLayer.elevationInfo;break;case"active":this._updateAnalysisFromSketchGraphic();break;case"complete":this.sketchGraphic&&(this._updateAnalysisFromSketchGraphic(),this._addSketchGraphic(this.sketchGraphic)),t.stop();break;case"cancel":t.stop()}});t.handles.push(a,(0,l.hA)(()=>(a.remove(),n.destroy(),this._sketchViewModels.remove(n),this._updateAnalysisFromSketchGraphic(),this._analysis.valid?(0,F.G4)(e)||i.equals(this._analysis)?t.reject():void t.resolve({}):(this._clear(),t.reject()))),s),this._graphicsLayer.elevationInfo=gt,await this._updatingHandles.addPromise((0,F.QZ)(n.create("polyline")))},e)}async pickFeature(e){return this._operationManager.start("pick-feature",async e=>{const{view:t}=this;t.closePopup();let n=null;e.handles.push(t.on("immediate-click",i=>{i.defer(async()=>{var o;null!==(o=n)&&void 0!==o&&o.abort(),n=(0,z.UT)(async n=>{const{results:o}=await t.hitTest(i);(0,F.Te)(n);let r=null;for(const e of o)if("graphic"===e.type&&ve(e.graphic)&&!ge(e.graphic)){r=e.graphic;break}r?(i.preventDefault(),i.stopPropagation(),this.sketchGraphic=null,this._analysis.geometry=r.geometry,this._analysis.elevationInfo=new W.A((0,T.A)({},(0,j.bh)(r))),e.resolve({feature:r}),e.stop()):e.reject()}),await n.promise})},dt.oj.TOOL),t.on("key-down",t=>{(0,vt.$X)(t)&&(e.reject(),e.stop())},dt.oj.TOOL),t.acquireCursor("crosshair","high"),(0,l.hA)(()=>{var t;null!==(t=n)&&void 0!==t&&t.abort(),e.reject()})),t.focus()},e)}_startReshape(){const e=this._createSketchViewModel();return this._sketchViewModels.add(e),this._operationManager.start("reshape",async t=>{const n=()=>{const t=this._ensureUpdatedSketchGraphic();return t?this._updatingHandles.addPromise(e.update(t,{tool:"reshape"})):Promise.resolve()};if(!this._ensureUpdatedSketchGraphic())return;const i=e.on("update",e=>{this._updateAnalysisFromSketchGraphic(),"complete"===e.state&&("reshaping"===this.state?(0,F.QZ)(n()):t.resolve())});t.handles.push(i,(0,l.hA)(()=>{i.remove(),this._sketchViewModels.remove(e),e.destroy(),t.resolve()})),await n()})}_createSketchViewModel(){return new yt.A({layer:this._graphicsLayer,view:this.view,defaultCreateOptions:{mode:"click",hasZ:!0},updateOnGraphicClick:!1,defaultUpdateOptions:{enableMoveAllGraphics:!1,enableRotation:!1,enableScaling:!1,enableZ:!1,highlightOptions:{enabled:!1},multipleSelectionEnabled:!1,reshapeOptions:{shapeOperation:"none"},toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:this._lineSymbol,activeLineSymbol:this._lineSymbol})}_ensureUpdatedSketchGraphic(){var e;const{geometry:t}=this._analysis;if(!t)return this.sketchGraphic=null,this._graphicsLayer.removeAll(),null;const n=null!==(e=this.sketchGraphic)&&void 0!==e?e:this.sketchGraphic=new y.A({symbol:this._lineSymbol,geometry:t});return n.geometry=t,this._addSketchGraphic(n),n}_addSketchGraphic(e){const{graphics:t}=this._graphicsLayer;t.includes(e)||t.add(e),1!==t.length&&t.removeMany(t.filter(t=>t!==e))}_clear(){this.sketchGraphic=null,this._analysis.clear()}_updateAnalysisFromSketchGraphic(){var e;let t=null===(e=this.sketchGraphic)||void 0===e?void 0:e.geometry;ye(t)||(t=null);const n=this._analysis;n.geometry!==t&&(n.geometry=t)}};(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],ft.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0})],ft.prototype,"view",void 0),(0,i.Cg)([(0,r.MZ)()],ft.prototype,"sketchGraphic",null),(0,i.Cg)([(0,r.MZ)({nonNullable:!0})],ft.prototype,"state",null),(0,i.Cg)([(0,r.MZ)()],ft.prototype,"updating",null),(0,i.Cg)([(0,r.MZ)()],ft.prototype,"_sketching",null),(0,i.Cg)([(0,r.MZ)()],ft.prototype,"_analysis",null),(0,i.Cg)([(0,r.MZ)()],ft.prototype,"_lineSymbol",null),ft=(0,i.Cg)([(0,s.$)("esri.views.analysis.ElevationProfile.ElevationProfileTool")],ft);const gt=new W.A({mode:"on-the-ground",offset:0});let mt=class extends p{constructor(e){super(e),this.type="elevation-profile-view-2d",this.analysis=null,this.hoveredPosition=null}initialize(){const{analysis:e,view:t}=this;this._controller=new Be({analysis:e,analysisViewData:this,view:t,computationFactory:{create:e=>{switch(e.profile.type){case"ground":return new rt(e);case"input":return new at(e);case"query":return new lt(e);case"scene":throw new o.A("elevation-profile-analysis-view-2d:unsupported","The scene profile line type is not supported in 2D views.")}}}}),this._visualization=new k({view:t,analysisViewData:this}),this._sketchTool=new ft({view:t,analysisViewData:this})}destroy(){var e,t,n;null!==(e=this._controller)&&void 0!==e&&e.destroy(),null!==(t=this._visualization)&&void 0!==t&&t.destroy(),null===(n=this._sketchTool)||void 0===n||n.destroy()}get effectiveDisplayUnits(){var e,t;return null!==(e=null===(t=this._controller)||void 0===t?void 0:t.effectiveDisplayUnits)&&void 0!==e?e:{distance:"meters",elevation:"meters"}}get error(){var e;return null===(e=this._controller)||void 0===e?void 0:e.error}get hoveredPoints(){var e,t;return null!==(e=null===(t=this._controller)||void 0===t?void 0:t.hoveredPoints)&&void 0!==e?e:[]}get interactive(){return super.interactive}set interactive(e){super.interactive=e}get progress(){var e,t;return null!==(e=null===(t=this._controller)||void 0===t?void 0:t.progress)&&void 0!==e?e:0}get results(){var e,t;return null!==(e=null===(t=this._controller)||void 0===t?void 0:t.results)&&void 0!==e?e:[]}get statistics(){var e;return null===(e=this._controller)||void 0===e?void 0:e.statistics}get updating(){var e,t,n;return!0===(null===(e=this._controller)||void 0===e?void 0:e.updating)||!0===(null===(t=this._visualization)||void 0===t?void 0:t.updating)||!0===(null===(n=this._sketchTool)||void 0===n?void 0:n.updating)}get visible(){return super.visible}set visible(e){super.visible=e}get sketchGraphic(){var e;return null===(e=this._sketchTool)||void 0===e?void 0:e.sketchGraphic}get toolState(){var e,t;return null!==(e=null===(t=this._sketchTool)||void 0===t?void 0:t.state)&&void 0!==e?e:"idle"}place(e){return this._sketchTool.place(e)}pickFeature(e){return this._sketchTool.pickFeature(e)}};(0,i.Cg)([(0,r.MZ)({readOnly:!0})],mt.prototype,"type",void 0),(0,i.Cg)([(0,r.MZ)({constructOnly:!0,nonNullable:!0})],mt.prototype,"analysis",void 0),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],mt.prototype,"effectiveDisplayUnits",null),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],mt.prototype,"error",null),(0,i.Cg)([(0,r.MZ)()],mt.prototype,"hoveredPosition",void 0),(0,i.Cg)([(0,r.MZ)()],mt.prototype,"hoveredPoints",null),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],mt.prototype,"progress",null),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],mt.prototype,"results",null),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],mt.prototype,"statistics",null),(0,i.Cg)([(0,r.MZ)({readOnly:!0})],mt.prototype,"updating",null),(0,i.Cg)([(0,r.MZ)()],mt.prototype,"sketchGraphic",null),(0,i.Cg)([(0,r.MZ)()],mt.prototype,"toolState",null),(0,i.Cg)([(0,r.MZ)()],mt.prototype,"_controller",void 0),(0,i.Cg)([(0,r.MZ)()],mt.prototype,"_visualization",void 0),(0,i.Cg)([(0,r.MZ)()],mt.prototype,"_sketchTool",void 0),mt=(0,i.Cg)([(0,s.$)("esri.views.2d.analysis.ElevationProfileAnalysisView2D")],mt);const _t=mt},62078:(e,t,n)=>{n.d(t,{q:()=>a});var i=n(66388),o=n(19247),r=n(23701),s=n(56611);class a{constructor(e){this.geometry=e,this.spatialReference=e.spatialReference}export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const t=new a(this.geometry);return t.spatialReference=this.spatialReference,t.coordinates=null!==e&&void 0!==e?e:this.coordinates.map(e=>e.clone()),t._exporter=this._exporter,t}async project(e,t){if(this.spatialReference.equals(e))return this.clone();await(0,s.initializeProjection)([{source:this.spatialReference,dest:e}],{signal:t});const n=new i.A({spatialReference:this.spatialReference,points:this.coordinates.map(e=>[e.x,e.y])}),o=(0,s.project)(n,e);if(!o)return null;const r=this.coordinates.map((e,t)=>{const n=e.clone(),i=o.points[t];return n.x=i[0],n.y=i[1],n}),a=this.clone(r);return a.spatialReference=e,a}static fromGeometry(e){const t=new a(e);if(e instanceof a)return t.coordinates=e.coordinates.map(e=>e.clone()),t._exporter=(t,n)=>{const i=e.clone(t);return i.spatialReference=n,i},t;switch(e.type){case"point":{const n=e,{hasZ:i,hasM:r}=n;return t.coordinates=i&&r?[new l(n.x,n.y,n.z,n.m)]:i?[new l(n.x,n.y,n.z)]:r?[new l(n.x,n.y,null,n.m)]:[new l(n.x,n.y)],t._exporter=(t,n)=>e.hasM?new o.A(t[0].x,t[0].y,t[0].z,t[0].m,n):new o.A(t[0].x,t[0].y,t[0].z,n),t}case"multipoint":{const n=e,{hasZ:o,hasM:r}=n;return t.coordinates=o&&r?n.points.map(e=>new l(e[0],e[1],e[2],e[3])):o?n.points.map(e=>new l(e[0],e[1],e[2])):r?n.points.map(e=>new l(e[0],e[1],null,e[2])):n.points.map(e=>new l(e[0],e[1])),t._exporter=(t,n)=>e.hasM?new i.A({points:t.map(e=>{var t,n;return[e.x,e.y,null!==(t=e.z)&&void 0!==t?t:0,null!==(n=e.m)&&void 0!==n?n:0]}),hasZ:!0,hasM:!0,spatialReference:n}):new i.A({points:t.map(e=>{var t;return[e.x,e.y,null!==(t=e.z)&&void 0!==t?t:0]}),spatialReference:n}),t}case"polyline":{const n=e,i=[],o=[],{hasZ:s,hasM:a}=e;let u=0;for(const e of n.paths)if(o.push([u,u+e.length]),u+=e.length,s&&a)for(const t of e)i.push(new l(t[0],t[1],t[2],t[3]));else if(s)for(const t of e)i.push(new l(t[0],t[1],t[2]));else if(a)for(const t of e)i.push(new l(t[0],t[1],null,t[2]));else for(const t of e)i.push(new l(t[0],t[1]));return t.coordinates=i,t._exporter=(t,n)=>{const i=e.hasM?t.map(e=>{var t,n;return[e.x,e.y,null!==(t=e.z)&&void 0!==t?t:0,null!==(n=e.m)&&void 0!==n?n:0]}):t.map(e=>{var t;return[e.x,e.y,null!==(t=e.z)&&void 0!==t?t:0]}),s=o.map(e=>i.slice(e[0],e[1]));return new r.A({paths:s,hasM:e.hasM,hasZ:!0,spatialReference:n})},t}}}}class l{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.x=e,this.y=t,this.z=n,this.m=i,this.tile=o,this.elevationTile=r}clone(){return new l(this.x,this.y,this.z,this.m)}}},78496:(e,t,n)=>{n.d(t,{e:()=>r,i:()=>s,s:()=>l});var i=n(50360),o=n(58067);function r(e){const t=(0,o.getSpatialReference)(e);return(0,o.toGeometry)((0,i.g7)((0,o.fromGeometry)(e),(0,o.fromSpatialReference)(t),!1),t)}function s(e){return(0,i.Pg)((0,o.fromGeometry)(e),(0,o.fromSpatialReference)((0,o.getSpatialReference)(e)),!1)}const a=(0,i.fz)(),l=Object.freeze(Object.defineProperty({__proto__:null,execute:r,executeMany:function(e){const t=e.map(o.fromGeometry),n=(0,o.getSpatialReference)(e);return(0,i.zo)(t,(0,o.fromSpatialReference)(n),!1).map(e=>(0,o.toGeometry)(e,n))},isSimple:s,supportsCurves:a},Symbol.toStringTag,{value:"Module"}))}}]);
//# sourceMappingURL=59145.bc732cd3.chunk.js.map