{"version":3,"file":"static/js/319.1cd0aaee.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/geometry/support/lineSegment.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/sceneLayerSnappingUtils.js","../node_modules/@arcgis/core/views/interactive/snapping/featureSources/sceneLayerSource/SceneLayerSnappingSourceWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{clamp as t}from\"../../core/mathUtils.js\";import{ObjectStack as r}from\"../../core/ObjectStack.js\";import{c as n,f as o,j as i,i as e,g as c,m as s,a as u}from\"../../chunks/vec3.js\";import{g as a,c as g}from\"../../chunks/vec3f64.js\";import{sv3d as f}from\"./vectorStacks.js\";function v(t){return t?{origin:a(t.origin),vector:a(t.vector)}:{origin:g(),vector:g()}}function m(t,r){const n=x.get();return n.origin=t,n.vector=r,n}function p(t,r=v()){return h(t.origin,t.vector,r)}function h(t,r,o=v()){return n(o.origin,t),n(o.vector,r),o}function b(t,r,i=v()){return n(i.origin,t),o(i.vector,r,t),i}function M(r,n){const c=o(f.get(),n,r.origin),s=i(r.vector,c),u=i(r.vector,r.vector),a=t(s/u,0,1),g=o(f.get(),e(f.get(),r.vector,a),c);return i(g,g)}function j(t,r){return Math.sqrt(M(t,r))}function l(t,r,n){return d(t,r,0,1,n)}function A(t,r,n){return c(n,t.origin,e(n,t.vector,r))}function d(r,n,u,a,g){const{vector:v,origin:m}=r,p=o(f.get(),n,m),h=i(v,p)/s(v);return e(g,v,t(h,u,a)),c(g,g,r.origin)}function B(t,r){if(q(t,m(r.origin,r.direction),!1,w)){const{tA:r,pB:n,distance2:o}=w;if(r>=0&&r<=1)return o;if(r<0)return u(t.origin,n);if(r>1)return u(c(f.get(),t.origin,t.vector),n)}return null}function k(t,r,o){return!!q(t,r,!0,w)&&(n(o,w.pA),!0)}function S(t,r){return q(t,r,!0,w)?w.distance2:null}function q(r,n,o,i){const e=1e-6,s=r.origin,a=c(f.get(),s,r.vector),g=n.origin,v=c(f.get(),g,n.vector),m=f.get(),p=f.get();if(m[0]=s[0]-g[0],m[1]=s[1]-g[1],m[2]=s[2]-g[2],p[0]=v[0]-g[0],p[1]=v[1]-g[1],p[2]=v[2]-g[2],Math.abs(p[0])<e&&Math.abs(p[1])<e&&Math.abs(p[2])<e)return!1;const h=f.get();if(h[0]=a[0]-s[0],h[1]=a[1]-s[1],h[2]=a[2]-s[2],Math.abs(h[0])<e&&Math.abs(h[1])<e&&Math.abs(h[2])<e)return!1;const b=m[0]*p[0]+m[1]*p[1]+m[2]*p[2],M=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],j=m[0]*h[0]+m[1]*h[1]+m[2]*h[2],l=p[0]*p[0]+p[1]*p[1]+p[2]*p[2],A=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*l-M*M;if(Math.abs(A)<e)return!1;let d=(b*M-j*l)/A,B=(b+M*d)/l;o&&(d=t(d,0,1),B=t(B,0,1));const k=f.get(),S=f.get();return k[0]=s[0]+d*h[0],k[1]=s[1]+d*h[1],k[2]=s[2]+d*h[2],S[0]=g[0]+B*p[0],S[1]=g[1]+B*p[1],S[2]=g[2]+B*p[2],i.tA=d,i.tB=B,i.pA=k,i.pB=S,i.distance2=u(k,S),!0}const w={tA:0,tB:0,pA:g(),pB:g(),distance2:0},x=new r((()=>v()));export{S as closestLineSegmentDistance2,k as closestLineSegmentPoint,B as closestRayDistance2,p as copy,v as create,j as distance,M as distance2,b as fromPoints,h as fromValues,A as pointAt,l as projectPoint,d as projectPointClamp,m as wrap};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{q as s,o,g as r}from\"../../../../../chunks/vec3.js\";import{c,g as n}from\"../../../../../chunks/sphere.js\";const t=1e3;function e(t,e,a){const m=c(),p=n(m);return s(p,p,t,.5),s(p,p,e,.5),m[3]=o(p,t),r(p,p,a),m}export{e as boundsFromEdge,t as maxCandidateCount};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import{throwIfAborted as t}from\"../../../../../core/promiseUtils.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/arrayUtils.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Error.js\";import{subclass as s}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{g as o,o as n}from\"../../../../../chunks/vec3.js\";import{c as i,g as r}from\"../../../../../chunks/vec3f64.js\";import{create as d,fromPoints as c,projectPoint as a}from\"../../../../../geometry/support/lineSegment.js\";import{g as p,n as u}from\"../../../../../chunks/sphere.js\";import h from\"../../../../3d/webgl-engine/lib/Octree.js\";import{extractComponentsEdgeLocationsLayout as m}from\"../../../../3d/webgl-engine/lib/edgeRendering/edgeProcessing.js\";import{maxCandidateCount as g,boundsFromEdge as l}from\"./sceneLayerSnappingUtils.js\";let _=class{constructor(){this._idToComponent=new Map,this._components=new h((e=>e.bounds)),this._edges=new h((e=>e.bounds)),this._tmpLineSegment=d(),this._tmpP1=i(),this._tmpP2=i(),this._tmpP3=i(),this.remoteClient=null}async fetchCandidates(e,s){await Promise.resolve(),t(s),await this._ensureEdgeLocations(e,s);const o=[];return this._edges.forEachNeighbor((t=>(this._addCandidates(e,t,o),o.length<g)),e.bounds),{result:{candidates:o}}}async _ensureEdgeLocations(e,t){const s=[];if(this._components.forEachNeighbor((e=>{if(null==e.info){const{id:t,uid:o}=e;s.push({id:t,uid:o})}return!0}),e.bounds),!s.length)return;const o={components:s},n=await this.remoteClient.invoke(\"fetchAllEdgeLocations\",o,t??{});for(const i of n.components)this._setFetchEdgeLocations(i)}async add(e){const t=new b(e.id,e.bounds);return this._idToComponent.set(t.id,t),this._components.add([t]),{result:{}}}async remove(e){const t=this._idToComponent.get(e.id);if(t){const e=[];this._edges.forEachNeighbor((s=>(s.component===t&&e.push(s),!0)),t.bounds),this._edges.remove(e),this._components.remove([t]),this._idToComponent.delete(t.id)}return{result:{}}}_setFetchEdgeLocations(e){const t=this._idToComponent.get(e.id);if(null==t||e.uid!==t.uid)return;const s=m.createView(e.locations),o=new Array(s.count),n=i(),r=i();for(let i=0;i<s.count;i++){s.position0.getVec(i,n),s.position1.getVec(i,r);const d=l(n,r,e.origin),c=new j(t,i,d);o[i]=c}this._edges.add(o);const{objectIds:d,origin:c}=e;t.info={locations:s,objectIds:d,origin:c}}_addCandidates(e,t,s){const{info:n}=t.component,{origin:i,objectIds:r}=n,d=n.locations,c=d.position0.getVec(t.index,this._tmpP1),a=d.position1.getVec(t.index,this._tmpP2);o(c,c,i),o(a,a,i);const p=r[d.componentIndex.get(t.index)];this._addEdgeCandidate(e,p,c,a,s),this._addVertexCandidate(e,p,c,s),this._addVertexCandidate(e,p,a,s)}_addEdgeCandidate(e,t,s,o,i){if(!e.returnEdge)return;const d=p(e.bounds),h=c(s,o,this._tmpLineSegment),m=a(h,d,this._tmpP3);u(e.bounds,m)&&i.push({type:\"edge\",objectId:t,target:r(m),distance:n(d,m),start:r(s),end:r(o)})}_addVertexCandidate(e,t,s,o){if(!e.returnVertex)return;const i=p(e.bounds);u(e.bounds,s)&&o.push({type:\"vertex\",objectId:t,target:r(s),distance:n(i,s)})}};_=e([s(\"esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker\")],_);const f=_;class b{constructor(e,t){this.id=e,this.bounds=t,this.info=null,this.uid=++b.uid}}b.uid=0;class j{constructor(e,t,s){this.component=e,this.index=t,this.bounds=s}}export{f as default};\n"],"names":["v","t","origin","a","vector","g","p","r","arguments","length","undefined","h","o","n","b","i","M","c","f","get","s","u","e","l","d","A","m","B","q","x","direction","w","tA","pB","distance2","k","pA","Math","abs","j","S","tB","_","constructor","this","_idToComponent","Map","_components","bounds","_edges","_tmpLineSegment","_tmpP1","_tmpP2","_tmpP3","remoteClient","fetchCandidates","Promise","resolve","_ensureEdgeLocations","forEachNeighbor","_addCandidates","result","candidates","info","id","uid","push","components","invoke","_setFetchEdgeLocations","add","set","remove","component","delete","createView","locations","Array","count","position0","getVec","position1","objectIds","index","componentIndex","_addEdgeCandidate","_addVertexCandidate","returnEdge","type","objectId","target","distance","start","end","returnVertex"],"sourceRoot":""}