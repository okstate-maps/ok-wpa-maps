{"version":3,"file":"static/js/3143.ee06ac14.chunk.js","mappings":"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","sources":["../node_modules/src/.internal/core/render/PointedRectangle.ts","../node_modules/src/.internal/core/render/Tooltip.ts","../node_modules/src/.internal/core/util/ResizeSensor.ts","../node_modules/src/.internal/core/util/InterfaceColors.ts","../node_modules/src/.internal/core/util/NumberFormatter.ts","../node_modules/src/.internal/core/util/Timezone.ts","../node_modules/src/.internal/core/util/DateFormatter.ts","../node_modules/src/.internal/core/util/DurationFormatter.ts","../node_modules/src/locales/en.ts","../node_modules/src/.internal/core/util/Language.ts","../node_modules/src/.internal/core/util/Matrix.ts","../node_modules/svg-arc-to-cubic-bezier/modules/index.js","../node_modules/src/.internal/core/render/backend/CanvasRenderer.ts","../node_modules/src/.internal/core/Root.ts","../node_modules/@arcgis/core/widgets/support/chartUtilsAm5.js"],"sourcesContent":["import { Graphics, IGraphicsSettings, IGraphicsPrivate } from \"./Graphics\";\nimport * as $math from \"../util/Math\";\n\nexport interface IPointedRectangleSettings extends IGraphicsSettings {\n\n\t/**\n\t * A width of the pinter's (stem's) thick end (base) in pixels.\n\t */\n\tpointerBaseWidth?: number;\n\n\t/**\n\t * A length of the pinter (stem) in pixels.\n\t */\n\tpointerLength?: number;\n\n\t/**\n\t * X coordinate the shape is pointing to.\n\t */\n\tpointerX?: number;\n\n\t/**\n\t * Y coordinate the shape is pointing to.\n\t */\n\tpointerY?: number;\n\n\t/**\n\t * Corner radius in pixels.\n\t */\n\tcornerRadius?: number;\n}\n\nexport interface IPointedRectanglePrivate extends IGraphicsPrivate {\n}\n\n/**\n * Draws a rectangle with a pointer.\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/graphics/} for more info\n * @important\n */\nexport class PointedRectangle extends Graphics {\n\n\tdeclare public _settings: IPointedRectangleSettings;\n\tdeclare public _privateSettings: IPointedRectanglePrivate;\n\n\tpublic static className: string = \"PointedRectangle\";\n\tpublic static classNames: Array<string> = Graphics.classNames.concat([PointedRectangle.className]);\n\n\tpublic _beforeChanged() {\n\t\tsuper._beforeChanged();\n\n\t\tif (this.isDirty(\"pointerBaseWidth\") || this.isDirty(\"cornerRadius\") || this.isDirty(\"pointerLength\") || this.isDirty(\"pointerX\") || this.isDirty(\"pointerY\") || this.isDirty(\"width\") || this.isDirty(\"height\")) {\n\t\t\tthis._clear = true;\n\t\t}\n\t}\n\n\tpublic _changed() {\n\t\tsuper._changed();\n\n\t\tif (this._clear) {\n\n\t\t\tthis.markDirtyBounds();\n\n\t\t\tlet w = this.width();\n\t\t\tlet h = this.height();\n\n\t\t\tif (w > 0 && h > 0) {\n\t\t\t\tlet cr = this.get(\"cornerRadius\", 8);\n\t\t\t\tcr = $math.fitToRange(cr, 0, Math.min(w / 2, h / 2));\n\n\t\t\t\tlet x = this.get(\"pointerX\", 0);\n\t\t\t\tlet y = this.get(\"pointerY\", 0);\n\t\t\t\tlet bwh = this.get(\"pointerBaseWidth\", 15) / 2;\n\n\t\t\t\t// corner coordinates\n\t\t\t\t// top left\n\t\t\t\tlet xtl = 0;\n\t\t\t\tlet ytl = 0;\n\t\t\t\t// top right\n\t\t\t\tlet xtr = w;\n\t\t\t\tlet ytr = 0;\n\t\t\t\t// bottom right\n\t\t\t\tlet xbr = w;\n\t\t\t\tlet ybr = h;\n\t\t\t\t// bottom left\n\t\t\t\tlet xbl = 0;\n\t\t\t\tlet ybl = h;\n\n\t\t\t\t// find stem base side: http://$math.stackexchange.com/questions/274712/calculate-on-which-side-of-straign-line-is-dot-located\n\t\t\t\t// d=(xx1)(y2y1)(yy1)(x2x1)\n\t\t\t\tlet d1 = (x - xtl) * (ybr - ytl) - (y - ytl) * (xbr - xtl);\n\t\t\t\tlet d2 = (x - xbl) * (ytr - ybl) - (y - ybl) * (xtr - xbl);\n\n\t\t\t\tconst display = this._display;\n\t\t\t\t// top\n\t\t\t\tdisplay.moveTo(cr, 0);\n\n\t\t\t\tif (d1 > 0 && d2 > 0) {\n\t\t\t\t\tlet stemX = Math.round($math.fitToRange(x, cr + bwh, w - bwh - cr));\n\t\t\t\t\ty = $math.fitToRange(y, -Infinity, 0);\n\n\t\t\t\t\tdisplay.lineTo(stemX - bwh, 0);\n\t\t\t\t\tdisplay.lineTo(x, y);\n\t\t\t\t\tdisplay.lineTo(stemX + bwh, 0);\n\t\t\t\t}\n\n\t\t\t\tdisplay.lineTo(w - cr, 0);\n\t\t\t\tdisplay.arcTo(w, 0, w, cr, cr);\n\n\t\t\t\t// right\n\t\t\t\tif (d1 > 0 && d2 < 0) {\n\t\t\t\t\tlet stemY = Math.round($math.fitToRange(y, cr + bwh, h - bwh - cr));\n\t\t\t\t\tx = $math.fitToRange(x, w, Infinity);\n\t\t\t\t\tdisplay.lineTo(w, cr);\n\t\t\t\t\tdisplay.lineTo(w, Math.max(stemY - bwh, cr));\n\t\t\t\t\tdisplay.lineTo(x, y);\n\t\t\t\t\tdisplay.lineTo(w, stemY + bwh);\n\t\t\t\t}\n\t\t\t\tdisplay.lineTo(w, h - cr);\n\t\t\t\tdisplay.arcTo(w, h, w - cr, h, cr);\n\n\t\t\t\t// bottom\n\t\t\t\tif (d1 < 0 && d2 < 0) {\n\t\t\t\t\tlet stemX = Math.round($math.fitToRange(x, cr + bwh, w - bwh - cr));\n\t\t\t\t\ty = $math.fitToRange(y, h, Infinity);\n\n\t\t\t\t\tdisplay.lineTo(w - cr, h);\n\t\t\t\t\tdisplay.lineTo(stemX + bwh, h);\n\t\t\t\t\tdisplay.lineTo(x, y);\n\t\t\t\t\tdisplay.lineTo(stemX - bwh, h);\n\t\t\t\t}\n\t\t\t\tdisplay.lineTo(cr, h)\n\t\t\t\tdisplay.arcTo(0, h, 0, h - cr, cr);\n\n\n\t\t\t\t// left\n\t\t\t\tif (d1 < 0 && d2 > 0) {\n\t\t\t\t\tlet stemY = Math.round($math.fitToRange(y, cr + bwh, h - cr - bwh));\n\t\t\t\t\tx = $math.fitToRange(x, -Infinity, 0);\n\t\t\t\t\tdisplay.lineTo(0, h - cr);\n\t\t\t\t\tdisplay.lineTo(0, stemY + bwh);\n\t\t\t\t\tdisplay.lineTo(x, y);\n\t\t\t\t\tdisplay.lineTo(0, Math.max(stemY - bwh, cr));\n\t\t\t\t}\n\t\t\t\tdisplay.lineTo(0, cr);\n\t\t\t\tdisplay.arcTo(0, 0, cr, 0, cr);\n\t\t\t\tdisplay.closePath();\n\t\t\t}\n\t\t}\n\t}\n}\n","import type { IBounds } from \"../util/IBounds\";\nimport type { IPoint } from \"../util/IPoint\";\nimport type { Pattern } from \"../render/patterns/Pattern\";\nimport type { Time } from \"../util/Animation\";\nimport type { Sprite } from \"../render/Sprite\";\nimport type { Graphics } from \"../render/Graphics\";\nimport type { IPointerEvent } from \"../render/backend/Renderer\";\nimport type { DataItem, IComponentDataItem } from \"./Component\";\nimport type { Root } from \"../Root\";\nimport type { Template } from \"../util/Template\";\nimport type { Entity } from \"../util/Entity\";\n\nimport { MultiDisposer, IDisposer } from \"../util/Disposer\";\nimport { Label } from \"../render/Label\";\nimport { PointedRectangle } from \"../render/PointedRectangle\";\nimport { Container, IContainerPrivate, IContainerSettings } from \"./Container\";\nimport { Percent } from \"../util/Percent\";\nimport { Color } from \"../util/Color\";\n\nimport * as $math from \"../util/Math\";\nimport * as $array from \"../util/Array\";\nimport * as $utils from \"../util/Utils\";\n\n\nexport interface ITooltipSettings extends IContainerSettings {\n\n\t/**\n\t * Text to use for tooltip's label.\n\t */\n\tlabelText?: string;\n\n\t/**\n\t * HTML content to use for tooltip's label.\n\t *\n\t * @since 5.2.11\n\t */\n\tlabelHTML?: string;\n\n\t/**\n\t * A screen reader content for the label.\n\t *\n\t * Used in conjuction with `readerAnnounce`. If it is set to `true`, and\n\t * `labelAriaLabel` is set, its contents will be read out by a screen reader\n\t * when tooltip is shown or its data item changes.\n\t *\n\t * Otherwise, regular `labelText` (or `text` set directly on tooltip label) will\n\t * be used for scree reader announcement.\n\t *\n\t * @since 5.9.2\n\t */\n\tlabelAriaLabel?: string;\n\n\t/**\n\t * A direction of the tooltip pointer.\n\t *\n\t * https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Orientation\n\t */\n\tpointerOrientation?: \"left\" | \"right\" | \"up\" | \"down\" | \"vertical\" | \"horizontal\";\n\n\t/**\n\t * If set to `true` will use the same `fill` color for its background as\n\t * its `tooltipTarget`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Colors} for more info\n\t * @default true\n\t */\n\tgetFillFromSprite?: boolean;\n\n\t/**\n\t * If set to `true` will use the same `filGradientl` for its background as\n\t * its `tooltipTarget`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Colors} for more info\n\t * @default false\n\t */\n\tgetFillGradientFromSprite?: boolean;\n\n\t/**\n\t * If set to `true` will use the same `fill` color as its `tooltipTarget`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Colors} for more info\n\t * @default false\n\t */\n\tgetLabelFillFromSprite?: boolean;\n\n\t/**\n\t * If set to `true` will use the same `stroke` color as its `tooltipTarget`.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/#Colors} for more info\n\t * @default false\n\t */\n\tgetStrokeFromSprite?: boolean;\n\n\t/**\n\t * Screen bounds to constrain the tooltip within.\n\t */\n\tbounds?: IBounds;\n\n\t/**\n\t * If set to `true` tooltip will adjust its text color for better visibility\n\t * on its background.\n\t *\n\t * @default true\n\t */\n\tautoTextColor?: boolean;\n\n\t/**\n\t * Screen coordinates the tooltip show point to.\n\t */\n\tpointTo?: IPoint;\n\n\t/**\n\t * Duration in milliseconds for tooltip position change, e.g. when tooltip\n\t * is jumping from one target to another.\n\t */\n\tanimationDuration?: number;\n\n\t/**\n\t * Easing function for tooltip animation.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/animations/#Easing_functions} for more info\n\t */\n\tanimationEasing?: (t: Time) => Time;\n\n\t/**\n\t * A target element tooltip is shown fow.\n\t */\n\ttooltipTarget?: Sprite;\n\n\t/**\n\t * If set to `true`, tooltip's target element will considered to be hovered\n\t * when mouse pointer is over tooltip itself.\n\t *\n\t * @since 5.2.14\n\t */\n\tkeepTargetHover?: boolean;\n\n\t/**\n\t * If set to `true` the tooltip contents will be read out by a screen reader\n\t * when displayed or changed.\n\t *\n\t * @default false\n\t * @since 5.9.2\n\t */\n\treaderAnnounce?: boolean;\n\n}\n\nexport interface ITooltipPrivate extends IContainerPrivate {\n}\n\n/**\n * Creates a tooltip.\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/common-elements/tooltips/} for more info\n * @important\n */\nexport class Tooltip extends Container {\n\n\tpublic _fx: number = 0;\n\tpublic _fy: number = 0;\n\n\tdeclare public _settings: ITooltipSettings;\n\tdeclare public _privateSettings: ITooltipPrivate;\n\n\tprotected _label!: Label;\n\tpublic static className: string = \"Tooltip\";\n\tpublic static classNames: Array<string> = Container.classNames.concat([Tooltip.className]);\n\n\tprotected _fillDp: IDisposer | undefined;\n\tprotected _fillGrDp: IDisposer | undefined;\n\tprotected _strokeDp: IDisposer | undefined;\n\tprotected _labelDp: IDisposer | undefined;\n\n\tprotected _w: number = 0;\n\tprotected _h: number = 0;\n\n\tprotected _keepHoverDp: MultiDisposer | undefined;\n\tprotected _htmlContentHovered: boolean = false;\n\n\tconstructor(root: Root, settings: Entity[\"_settings\"], isReal: boolean, templates: Array<Template<Entity>> = []) {\n\t\tsuper(root, settings, isReal, templates);\n\t}\n\n\tprotected _afterNew() {\n\t\tthis._settings.themeTags = $utils.mergeTags(this._settings.themeTags, [\"tooltip\"]);\n\n\t\tsuper._afterNew();\n\n\t\tconst background: Graphics = this._setDefaultFn(\"background\", () => {\n\t\t\treturn PointedRectangle.new(this._root, {});\n\t\t});\n\n\t\tbackground.set(\"themeTags\", [\"tooltip\", \"background\"]);\n\n\t\tthis._label = this.children.push(Label.new(this._root, {}));\n\n\t\tthis._disposers.push(this._label.events.on(\"boundschanged\", () => {\n\t\t\tthis._updateBackground();\n\t\t}))\n\n\t\tthis._disposers.push(this.on(\"bounds\", () => {\n\t\t\tthis._updateBackground();\n\t\t}))\n\n\t\tthis._updateTextColor();\n\n\t\tthis._root.tooltipContainer.children.push(this);\n\t\tthis.hide(0);\n\n\t\tthis._disposers.push(this.label.onPrivate(\"htmlElement\", (htmlElement) => {\n\t\t\tif (htmlElement) {\n\t\t\t\tthis._disposers.push($utils.addEventListener(htmlElement, \"pointerover\", (_ev) => {\n\t\t\t\t\tthis._htmlContentHovered = true;\n\t\t\t\t}));\n\t\t\t\tthis._disposers.push($utils.addEventListener(htmlElement, \"pointerout\", (_ev) => {\n\t\t\t\t\tthis._htmlContentHovered = false;\n\t\t\t\t}));\n\t\t\t}\n\t\t}))\n\n\t\tthis.on(\"visible\", (_ev) => {\n\t\t\tthis._handleReaderAnnouncement();\n\t\t});\n\n\t\tthis.label.events.on(\"dataitemchanged\", (_ev) => {\n\t\t\tthis._handleReaderAnnouncement();\n\t\t});\n\n\t\tthis._root._tooltips.push(this);\n\t}\n\n\tprotected _handleReaderAnnouncement() {\n\t\tif (this.get(\"readerAnnounce\") && this.isVisibleDeep()) {\n\t\t\tthis._root.readerAlert(this.label.getAccessibleText());\n\t\t}\n\t}\n\n\t/**\n\t * A [[Label]] element for the tooltip.\n\t *\n\t * @readonly\n\t * @return Label\n\t */\n\tpublic get label(): Label {\n\t\treturn this._label;\n\t}\n\n\t/**\n\t * Permanently disposes the tooltip.\n\t */\n\tprotected _dispose() {\n\t\tsuper._dispose();\n\t\t$array.remove(this._root._tooltips, this);\n\t}\n\n\tpublic _updateChildren() {\n\t\tsuper._updateChildren();\n\n\t\tif (this.isDirty(\"pointerOrientation\") || this.isPrivateDirty(\"minWidth\") || this.isPrivateDirty(\"minHeight\")) {\n\t\t\tthis.get(\"background\")!._markDirtyKey(\"width\");\n\t\t}\n\n\t\tconst labelText = this.get(\"labelText\");\n\t\tif (labelText != null) {\n\t\t\tthis.label.set(\"text\", this.get(\"labelText\"));\n\t\t}\n\t\tconst labelHTML = this.get(\"labelHTML\");\n\t\tif (labelHTML != null) {\n\t\t\tthis.label.set(\"html\", this.get(\"labelHTML\"));\n\t\t}\n\t\tconst labelAriaLabel = this.get(\"labelAriaLabel\");\n\t\tif (labelAriaLabel != null) {\n\t\t\tthis.label.set(\"ariaLabel\", this.get(\"labelAriaLabel\"));\n\t\t}\n\t}\n\n\tpublic _changed() {\n\t\tsuper._changed();\n\n\t\tif (this.isDirty(\"pointTo\") || this.isDirty(\"pointerOrientation\")) {\n\t\t\t// can't compare to previous, as sometimes pointTo is set twice (when pointer moves, so the position won't be udpated)\n\t\t\tthis._updateBackground();\n\t\t}\n\n\t\tif (this.isDirty(\"tooltipTarget\")) {\n\t\t\tthis.updateBackgroundColor();\n\t\t}\n\n\t\tif (this.isDirty(\"keepTargetHover\")) {\n\t\t\tconst keephover = this.get(\"keepTargetHover\");\n\t\t\tif (keephover) {\n\t\t\t\tconst bg = this.get(\"background\")!;\n\t\t\t\tthis._keepHoverDp = new MultiDisposer([\n\t\t\t\t\tbg.events.on(\"pointerover\", (_ev) => {\n\t\t\t\t\t\tlet target = this.get(\"tooltipTarget\");\n\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\tif (target.parent && target.parent.getPrivate(\"tooltipTarget\") == target) {\n\t\t\t\t\t\t\t\ttarget = target.parent;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttarget.hover();\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\tbg.events.on(\"pointerout\", (_ev) => {\n\t\t\t\t\t\tlet target = this.get(\"tooltipTarget\");\n\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\tif (target.parent && target.parent.getPrivate(\"tooltipTarget\") == target) {\n\t\t\t\t\t\t\t\ttarget = target.parent;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!this._htmlContentHovered) {\n\t\t\t\t\t\t\t\ttarget.unhover();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t]);\n\n\t\t\t\tthis.label.onPrivate(\"htmlElement\", (htmlElement: any) => {\n\t\t\t\t\tif (this._keepHoverDp && htmlElement) {\n\t\t\t\t\t\tthis._keepHoverDp.disposers.push($utils.addEventListener<PointerEvent | MouseEvent>(htmlElement, \"pointerleave\", (ev: IPointerEvent) => {\n\t\t\t\t\t\t\tconst outEvent = this.root._renderer.getEvent(ev);\n\t\t\t\t\t\t\tbg.events.dispatch(\"pointerout\", {\n\t\t\t\t\t\t\t\ttype: \"pointerout\",\n\t\t\t\t\t\t\t\toriginalEvent: outEvent.event,\n\t\t\t\t\t\t\t\tpoint: outEvent.point,\n\t\t\t\t\t\t\t\tsimulated: false,\n\t\t\t\t\t\t\t\ttarget: bg\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this._keepHoverDp) {\n\t\t\t\t\tthis._keepHoverDp.dispose();\n\t\t\t\t\tthis._keepHoverDp = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected _onShow() {\n\t\tsuper._onShow();\n\t\tthis.updateBackgroundColor();\n\t}\n\n\n\tpublic updateBackgroundColor() {\n\t\tlet tooltipTarget = this.get(\"tooltipTarget\");\n\t\tconst background = this.get(\"background\");\n\t\tlet fill: Color | undefined;\n\t\tlet stroke: Color | undefined;\n\n\n\t\tif (tooltipTarget && background) {\n\n\t\t\tfill = tooltipTarget.get(\"fill\" as any);\n\t\t\tstroke = tooltipTarget.get(\"stroke\" as any);\n\n\t\t\tif (fill == null) {\n\t\t\t\tfill = stroke;\n\t\t\t}\n\n\t\t\tif (this.get(\"getFillFromSprite\")) {\n\n\t\t\t\tif (this._fillDp) {\n\t\t\t\t\tthis._fillDp.dispose();\n\t\t\t\t}\n\n\t\t\t\tif (fill != null) {\n\t\t\t\t\tbackground.set(\"fill\", fill);\n\t\t\t\t}\n\n\t\t\t\tthis._fillDp = tooltipTarget.on(\"fill\" as any, (fill) => {\n\t\t\t\t\tif (fill != null) {\n\t\t\t\t\t\tbackground.set(\"fill\", fill);\n\t\t\t\t\t\tthis._updateTextColor(fill);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tthis._disposers.push(this._fillDp);\n\t\t\t}\n\n\t\t\tif (this.get(\"getFillGradientFromSprite\")) {\n\n\t\t\t\tif (this._fillGrDp) {\n\t\t\t\t\tthis._fillGrDp.dispose();\n\t\t\t\t}\n\n\t\t\t\tlet fillGradient = tooltipTarget.get(\"fillGradient\" as any);\n\n\t\t\t\tif (fillGradient != null) {\n\t\t\t\t\tbackground.set(\"fillGradient\", fillGradient);\n\t\t\t\t}\n\n\t\t\t\tthis._fillGrDp = tooltipTarget.on(\"fillGradient\" as any, (fillGradient) => {\n\t\t\t\t\tif (fillGradient != null) {\n\t\t\t\t\t\tbackground.set(\"fillGradient\", fillGradient);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\tthis._disposers.push(this._fillGrDp);\n\t\t\t}\n\n\t\t\tif (this.get(\"getStrokeFromSprite\")) {\n\n\t\t\t\tif (this._strokeDp) {\n\t\t\t\t\tthis._strokeDp.dispose();\n\t\t\t\t}\n\n\t\t\t\tif (fill != null) {\n\t\t\t\t\tbackground.set(\"stroke\", fill);\n\t\t\t\t}\n\n\t\t\t\tthis._strokeDp = tooltipTarget.on(\"fill\" as any, (fill) => {\n\t\t\t\t\tif (fill != null) {\n\t\t\t\t\t\tbackground.set(\"stroke\", fill);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tthis._disposers.push(this._strokeDp);\n\t\t\t}\n\n\t\t\tif (this.get(\"getLabelFillFromSprite\")) {\n\n\t\t\t\tif (this._labelDp) {\n\t\t\t\t\tthis._labelDp.dispose();\n\t\t\t\t}\n\n\t\t\t\tif (fill != null) {\n\t\t\t\t\tthis.label.set(\"fill\", fill);\n\t\t\t\t}\n\n\t\t\t\tthis._labelDp = tooltipTarget.on(\"fill\" as any, (fill) => {\n\t\t\t\t\tif (fill != null) {\n\t\t\t\t\t\tthis.label.set(\"fill\", fill);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tthis._disposers.push(this._labelDp);\n\t\t\t}\n\t\t}\n\n\t\tthis._updateTextColor(fill);\n\t}\n\n\n\tprotected _updateTextColor(fill?: Color | Pattern) {\n\t\tif (this.get(\"autoTextColor\")) {\n\t\t\tif (fill == null) {\n\t\t\t\tfill = this.get(\"background\")!.get(\"fill\") as Color;\n\t\t\t}\n\n\t\t\tif (fill == null) {\n\t\t\t\tfill = this._root.interfaceColors.get(\"background\");\n\t\t\t}\n\n\t\t\tif (fill instanceof Color) {\n\t\t\t\tthis.label.set(\"fill\", Color.alternative(fill, this._root.interfaceColors.get(\"alternativeText\"), this._root.interfaceColors.get(\"text\")));\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _setDataItem(dataItem?: DataItem<IComponentDataItem>): void {\n\t\tsuper._setDataItem(dataItem);\n\t\tthis.label._setDataItem(dataItem);\n\t}\n\n\n\tprotected _updateBackground() {\n\t\tsuper.updateBackground();\n\t\tconst parent = this._root.container;\n\n\t\tif (parent) {\n\n\t\t\tlet cw = 0.5;\n\t\t\tlet ch = 0.5;\n\n\t\t\tlet centerX = this.get(\"centerX\");\n\t\t\tif (centerX instanceof Percent) {\n\t\t\t\tcw = centerX.value;\n\t\t\t}\n\n\t\t\tlet centerY = this.get(\"centerY\");\n\t\t\tif (centerY instanceof Percent) {\n\t\t\t\tch = centerY.value;\n\t\t\t}\n\n\t\t\tlet parentW = parent.width();\n\t\t\tlet parentH = parent.height();\n\n\t\t\tlet tooltipContainer = this.parent;\n\t\t\tlet xx = 0;\n\t\t\tlet yy = 0;\n\t\t\tif (tooltipContainer) {\n\t\t\t\txx = tooltipContainer.x();\n\t\t\t\tyy = tooltipContainer.y();\n\n\t\t\t\tconst layerMargin = tooltipContainer.get(\"layerMargin\");\n\t\t\t\tif (layerMargin) {\n\t\t\t\t\txx += layerMargin.left || 0;\n\t\t\t\t\tyy += layerMargin.top || 0;\n\t\t\t\t\tparentW += (layerMargin.left || 0) + (layerMargin.right || 0);\n\t\t\t\t\tparentH += (layerMargin.top || 0) + (layerMargin.bottom || 0);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst bounds = this.get(\"bounds\", { left: -xx, top: -yy, right: parentW - xx, bottom: parentH - yy });\n\n\t\t\tthis._updateBounds();\n\n\t\t\tlet w = this.width();\n\t\t\tlet h = this.height();\n\n\t\t\t// use old w and h,as when tooltip is hidden, these are 0 and unneeded animation happens\n\t\t\tif (w === 0) {\n\t\t\t\tw = this._w;\n\t\t\t}\n\n\t\t\tif (h === 0) {\n\t\t\t\th = this._h;\n\t\t\t}\n\n\t\t\tlet pointTo = this.get(\"pointTo\", { x: parentW / 2, y: parentH / 2 });\n\t\t\tlet x = pointTo.x;\n\t\t\tlet y = pointTo.y;\n\n\t\t\tlet pointerOrientation = this.get(\"pointerOrientation\");\n\n\t\t\tlet background = this.get(\"background\");\n\t\t\tlet pointerLength = 0;\n\t\t\tlet bgStrokeSizeY = 0;\n\t\t\tlet bgStrokeSizeX = 0;\n\n\t\t\tif (background instanceof PointedRectangle) {\n\t\t\t\tpointerLength = background.get(\"pointerLength\", 0);\n\t\t\t\tbgStrokeSizeY = background.get(\"strokeWidth\", 0) / 2;\n\t\t\t\tbgStrokeSizeX = bgStrokeSizeY;\n\t\t\t\tbackground.set(\"width\", w);\n\t\t\t\tbackground.set(\"height\", h);\n\t\t\t}\n\n\t\t\tlet pointerX = 0;\n\t\t\tlet pointerY = 0;\n\n\t\t\tlet boundsW = bounds.right - bounds.left;\n\t\t\tlet boundsH = bounds.bottom - bounds.top;\n\n\n\t\t\t// horizontal\n\t\t\tif (pointerOrientation == \"horizontal\" || pointerOrientation == \"left\" || pointerOrientation == \"right\") {\n\t\t\t\tbgStrokeSizeY = 0;\n\t\t\t\tif (pointerOrientation == \"horizontal\") {\n\t\t\t\t\tif (x > bounds.left + boundsW / 2) {\n\t\t\t\t\t\tx -= (w * (1 - cw) + pointerLength);\n\t\t\t\t\t\tbgStrokeSizeX *= -1;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tx += (w * cw + pointerLength);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (pointerOrientation == \"left\") {\n\t\t\t\t\tx += (w * (1 - cw) + pointerLength);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tx -= (w * cw + pointerLength);\n\t\t\t\t\tbgStrokeSizeX *= -1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// vertical pointer\n\t\t\telse {\n\t\t\t\tbgStrokeSizeX = 0;\n\t\t\t\tif (pointerOrientation == \"vertical\") {\n\t\t\t\t\tif (y > bounds.top + h / 2 + pointerLength) {\n\t\t\t\t\t\ty -= (h * (1 - ch) + pointerLength);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\ty += (h * ch + pointerLength);\n\t\t\t\t\t\tbgStrokeSizeY *= -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (pointerOrientation == \"down\") {\n\t\t\t\t\ty -= (h * (1 - ch) + pointerLength);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ty += (h * ch + pointerLength);\n\t\t\t\t\tbgStrokeSizeY *= -1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tx = $math.fitToRange(x, bounds.left + w * cw, bounds.left + boundsW - w * (1 - cw)) + bgStrokeSizeX;\n\t\t\ty = $math.fitToRange(y, bounds.top + h * ch, bounds.top + boundsH - h * (1 - ch)) - bgStrokeSizeY;\n\n\t\t\tpointerX = pointTo.x - x + w * cw + bgStrokeSizeX;\n\t\t\tpointerY = pointTo.y - y + h * ch - bgStrokeSizeY;\n\n\t\t\tthis._fx = x;\n\t\t\tthis._fy = y;\n\n\t\t\tconst animationDuration = this.get(\"animationDuration\", 0);\n\n\t\t\tif (animationDuration > 0 && this.get(\"visible\") && this.get(\"opacity\") > 0.1) {\n\t\t\t\tconst animationEasing = this.get(\"animationEasing\");\n\t\t\t\tthis.animate({ key: \"x\", to: x, duration: animationDuration, easing: animationEasing });\n\t\t\t\tthis.animate({ key: \"y\", to: y, duration: animationDuration, easing: animationEasing });\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.set(\"x\", x);\n\t\t\t\tthis.set(\"y\", y);\n\t\t\t}\n\n\t\t\tif (background instanceof PointedRectangle) {\n\t\t\t\tbackground.set(\"pointerX\", pointerX);\n\t\t\t\tbackground.set(\"pointerY\", pointerY);\n\t\t\t}\n\n\t\t\tif (w > 0) {\n\t\t\t\tthis._w = w;\n\t\t\t}\n\t\t\tif (h > 0) {\n\t\t\t\tthis._h = h;\n\t\t\t}\n\t\t}\n\t}\n}\n","/** @ignore *//** */\n\nimport type { IDisposer } from \"./Disposer\";\nimport * as $array from \"./Array\";\nimport * as $utils from \"./Utils\";\n\n/**\n * @ignore\n */\ninterface Sensor {\n\taddTarget(target: Element, callback: () => void): void;\n\tremoveTarget(target: Element): void;\n}\n\n/**\n * @ignore\n */\ndeclare const ResizeObserver: any;\n\n/**\n * @ignore\n */\nclass Native implements Sensor {\n\tprivate _observer: any;\n\tprivate _targets: Array<{ target: Element, callback: () => void }> = [];\n\n\tconstructor() {\n\t\tthis._observer = new ResizeObserver((entries: Array<any>) => {\n\t\t\t$array.each(entries, (entry) => {\n\t\t\t\t$array.each(this._targets, (x) => {\n\t\t\t\t\tif (x.target === entry.target) {\n\t\t\t\t\t\tx.callback();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\taddTarget(target: Element, callback: () => void) {\n\t\tthis._observer.observe(target, { box: \"border-box\" });\n\t\tthis._targets.push({ target, callback });\n\t}\n\n\tremoveTarget(target: Element) {\n\t\tthis._observer.unobserve(target);\n\n\t\t$array.keepIf(this._targets, (x) => {\n\t\t\treturn x.target !== target;\n\t\t});\n\t}\n}\n\n/**\n * @ignore\n */\ninterface ClientBounds {\n\twidth: number,\n\theight: number,\n\tleft: number,\n\tright: number,\n\ttop: number,\n\tbottom: number,\n\tx: number,\n\ty: number\n}\n\n\n/**\n * @ignore\n */\nclass Raf implements Sensor {\n\tpublic static delay: number = 200;\n\n\tprivate _timer: number | null = null;\n\tprivate _targets: Array<{ target: Element, callback: () => void, size: ClientRect | DOMRect | ClientBounds }> = [];\n\n\taddTarget(target: Element, callback: () => void) {\n\t\tif (this._timer === null) {\n\t\t\tlet lastTime: number | null = null;\n\n\t\t\tconst loop = () => {\n\t\t\t\tconst currentTime = Date.now();\n\n\t\t\t\tif (lastTime === null || currentTime > (lastTime + Raf.delay)) {\n\t\t\t\t\tlastTime = currentTime;\n\n\t\t\t\t\t$array.each(this._targets, (x) => {\n\t\t\t\t\t\tlet newSize = x.target.getBoundingClientRect();\n\n\t\t\t\t\t\tif (newSize.width !== x.size.width || newSize.height !== x.size.height) {\n\t\t\t\t\t\t\tx.size = newSize;\n\t\t\t\t\t\t\tx.callback();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (this._targets.length === 0) {\n\t\t\t\t\tthis._timer = null;\n\n\t\t\t\t} else {\n\t\t\t\t\tthis._timer = requestAnimationFrame(loop);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._timer = requestAnimationFrame(loop);\n\t\t}\n\n\t\t// We start off with fake bounds so that sensor always kicks in\n\t\tlet size = { width: 0, height: 0, left: 0, right: 0, top: 0, bottom: 0, x: 0, y: 0 };\n\t\tthis._targets.push({ target, callback, size });\n\t}\n\n\tremoveTarget(target: Element) {\n\t\t$array.keepIf(this._targets, (x) => {\n\t\t\treturn x.target !== target;\n\t\t});\n\n\t\tif (this._targets.length === 0) {\n\t\t\tif (this._timer !== null) {\n\t\t\t\tcancelAnimationFrame(this._timer);\n\t\t\t\tthis._timer = null;\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * @ignore\n */\nlet observer: Sensor | null = null;\n\n/**\n * @ignore\n */\nfunction makeSensor(): Sensor {\n\tif (observer === null) {\n\t\tif (typeof ResizeObserver !== \"undefined\") {\n\t\t\tobserver = new Native();\n\n\t\t} else {\n\t\t\tobserver = new Raf();\n\t\t}\n\t}\n\n\treturn observer;\n}\n\n/**\n * @ignore\n */\nexport class ResizeSensor implements IDisposer {\n\tprivate _sensor: Sensor;\n\tprivate _element: Element;\n\tprivate _listener: IDisposer;\n\tprivate _disposed: boolean = false;\n\n\tconstructor(element: Element, callback: () => void) {\n\t\tthis._sensor = makeSensor();\n\t\tthis._element = element;\n\n\t\t// This is needed because we need to know when the window is zoomed\n\t\tthis._listener = $utils.onZoom(callback);\n\n\t\tthis._sensor.addTarget(element, callback);\n\t}\n\n\tpublic isDisposed() {\n\t\treturn this._disposed;\n\t}\n\n\tpublic dispose() {\n\t\tif (!this._disposed) {\n\t\t\tthis._disposed = true;\n\t\t\tthis._sensor.removeTarget(this._element);\n\t\t\tthis._listener.dispose();\n\t\t}\n\t}\n\n\tpublic get sensor(): Sensor {\n\t\treturn this._sensor;\n\t}\n}\n","import type { Color } from \"./Color\"\n\nimport { Entity, IEntitySettings } from \"./Entity\"\n\n\nexport interface IInterfaceColorsSettings extends IEntitySettings {\n\n\t/**\n\t * Used for generic outlines.\n\t */\n\tstroke?: Color,\n\n\t/**\n\t * Used for generic fills.\n\t */\n\tfill?: Color,\n\n\t/**\n\t * Primary button fill color.\n\t */\n\tprimaryButton?: Color,\n\n\t/**\n\t * Primary button fill color on hover.\n\t */\n\tprimaryButtonHover?: Color,\n\n\t/**\n\t * Primary button fill color when pressing down on it.\n\t */\n\tprimaryButtonDown?: Color,\n\n\t/**\n\t * Primary button fill color when it is set as active.\n\t */\n\tprimaryButtonActive?: Color,\n\n\t/**\n\t * Primary button fill color when it is set as disabled.\n\t */\n\tprimaryButtonDisabled?: Color,\t\n\n\t/**\n\t * Primary button text color when it is set as disabled.\n\t */\n\tprimaryButtonTextDisabled?: Color,\n\n\t/**\n\t * Primary button text color.\n\t */\n\tprimaryButtonText?: Color,\t\n\n\t/**\n\t * Primary button stroke (outline) color.\n\t */\n\tprimaryButtonStroke?: Color,\n\n\t/**\n\t * Secondary button fill color.\n\t */\n\tsecondaryButton?: Color,\n\n\t/**\n\t * Secondary button fill color on hover.\n\t */\n\tsecondaryButtonHover?: Color,\n\n\t/**\n\t * Secondary button fill color when pressing down on it.\n\t */\n\tsecondaryButtonDown?: Color,\n\n\t/**\n\t * Secondary button fill color when it is set as active.\n\t */\n\tsecondaryButtonActive?: Color,\n\n\t/**\n\t * Secondary button text color.\n\t */\n\tsecondaryButtonText?: Color,\n\n\t/**\n\t * Secondary button stroke (outline) color.\n\t */\n\tsecondaryButtonStroke?: Color,\n\n\t/**\n\t * Grid color.\n\t */\n\tgrid?: Color,\n\n\t/**\n\t * Chart background color.\n\t */\n\tbackground?: Color,\n\n\t/**\n\t * Alternative background, for elements that need to contrast with primary\n\t * background.\n\t */\n\talternativeBackground?: Color,\n\n\t/**\n\t * Label text color.\n\t */\n\ttext?: Color,\n\n\t/**\n\t * Alternative text color, used for inverted (dark) backgrounds.\n\t * @type {[type]}\n\t */\n\talternativeText?: Color,\n\n\t/**\n\t * Color for disabled elements.\n\t */\n\tdisabled?: Color,\n\n\t/**\n\t * Color to indicate positive value.\n\t */\n\tpositive?: Color,\n\n\t/**\n\t * Color to indicate negative value.\n\t */\n\tnegative?: Color\n\n}\n\n\n/**\n * Presets for common UI elements.\n */\nexport class InterfaceColors extends Entity {\n\tpublic static className: string = \"InterfaceColors\";\n\tpublic static classNames: Array<string> = Entity.classNames.concat([InterfaceColors.className]);\n\n\tdeclare public _settings: IInterfaceColorsSettings;\n}\n","import type { Language } from \"./Language\";\n\nimport { Entity, IEntitySettings, IEntityPrivate } from \"./Entity\"\nimport { TextFormatter } from \"./TextFormatter\";\n\nimport * as $object from \"./Object\";\nimport * as $utils from \"./Utils\";\nimport * as $type from \"./Type\";\n\n/**\n * @ignore\n */\nexport interface INumberSuffix {\n\tnumber: number;\n\tsuffix: string;\n}\n\nexport interface INumberFormatterSettings extends IEntitySettings {\n\n\t/**\n\t * Number format to be used when formatting numbers.\n\t *\n\t * @default \"#,###.#####\"\n\t */\n\tnumberFormat?: string | Intl.NumberFormatOptions;\n\n\t/**\n\t * A threshold value for negative numbers.\n\t *\n\t * @default 0\n\t */\n\tnegativeBase?: number;\n\n\t/**\n\t * Prefixes and thresholds to group big numbers into, e.g. 1M.\n\t *\n\t * Used in conjunction with `a` modifier of the number format.\n\t */\n\tbigNumberPrefixes?: INumberSuffix[];\n\n\t/**\n\t * Prefixes and thresholds to group small numbers into, e.g. 1m.\n\t *\n\t * Used in conjunction with `a` modifier of the number format.\n\t */\n\tsmallNumberPrefixes?: INumberSuffix[];\n\n\t/**\n\t * All numbers below this value are considered small.\n\t *\n\t * @default 1\n\t */\n\tsmallNumberThreshold?: number;\n\n\t/**\n\t * Prefixes to and thresholds to use when grouping data size numbers, e.g. 1MB.\n\t *\n\t * Used in conjunction with `b` modifier of the number format.\n\t */\n\tbytePrefixes?: INumberSuffix[];\n\n\t/**\n\t * Indicates which fields in data should be considered numeric.\n\t *\n\t * It is used when formatting data placeholder values.\n\t */\n\tnumericFields?: string[];\n\n\t/**\n\t * Locales if you are using date formats in `Intl.NumberFormatOptions` syntax.\n\t *\n\t * @see (@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NumberFormat) about using Intl for number formatting\n\t * @param value Locales\n\t */\n\tintlLocales?: string;\n\n\t/**\n\t * If set to `true` will force the number string to be LTR, even if RTL is\n\t * enabled.\n\t * \n\t * @default false\n\t * @since 5.3.13\n\t */\n\tforceLTR?: boolean;\n\n}\n\nexport interface INumberFormatterPrivate extends IEntityPrivate {\n}\n\n/**\n * Number formatter\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-numbers/} for more info\n * @important\n */\nexport class NumberFormatter extends Entity {\n\tdeclare public _settings: INumberFormatterSettings;\n\tdeclare public _privateSettings: INumberFormatterPrivate;\n\n\tprotected _setDefaults() {\n\t\t// Defaults\n\t\tthis._setDefault(\"negativeBase\", 0);\n\t\tthis._setDefault(\"numberFormat\", \"#,###.#####\");\n\t\tthis._setDefault(\"smallNumberThreshold\", 1.00);\n\n\t\tconst bns = \"_big_number_suffix_\";\n\t\tconst sns = \"_small_number_suffix_\";\n\t\tconst bs = \"_byte_suffix_\";\n\n\t\tthis._setDefault(\"bigNumberPrefixes\", [\n\t\t\t{ \"number\": 1e+3, \"suffix\": this._t(bns + \"3\") },\n\t\t\t{ \"number\": 1e+6, \"suffix\": this._t(bns + \"6\") },\n\t\t\t{ \"number\": 1e+9, \"suffix\": this._t(bns + \"9\") },\n\t\t\t{ \"number\": 1e+12, \"suffix\": this._t(bns + \"12\") },\n\t\t\t{ \"number\": 1e+15, \"suffix\": this._t(bns + \"15\") },\n\t\t\t{ \"number\": 1e+18, \"suffix\": this._t(bns + \"18\") },\n\t\t\t{ \"number\": 1e+21, \"suffix\": this._t(bns + \"21\") },\n\t\t\t{ \"number\": 1e+24, \"suffix\": this._t(bns + \"24\") }\n\t\t]);\n\n\t\tthis._setDefault(\"smallNumberPrefixes\", [\n\t\t\t{ \"number\": 1e-24, \"suffix\": this._t(sns + \"24\") },\n\t\t\t{ \"number\": 1e-21, \"suffix\": this._t(sns + \"21\") },\n\t\t\t{ \"number\": 1e-18, \"suffix\": this._t(sns + \"18\") },\n\t\t\t{ \"number\": 1e-15, \"suffix\": this._t(sns + \"15\") },\n\t\t\t{ \"number\": 1e-12, \"suffix\": this._t(sns + \"12\") },\n\t\t\t{ \"number\": 1e-9, \"suffix\": this._t(sns + \"9\") },\n\t\t\t{ \"number\": 1e-6, \"suffix\": this._t(sns + \"6\") },\n\t\t\t{ \"number\": 1e-3, \"suffix\": this._t(sns + \"3\") }\n\t\t]);\n\n\t\tthis._setDefault(\"bytePrefixes\", [\n\t\t\t{ \"number\": 1, suffix: this._t(bs + \"B\") },\n\t\t\t{ \"number\": 1024, suffix: this._t(bs + \"KB\") },\n\t\t\t{ \"number\": 1048576, suffix: this._t(bs + \"MB\") },\n\t\t\t{ \"number\": 1073741824, suffix: this._t(bs + \"GB\") },\n\t\t\t{ \"number\": 1099511627776, suffix: this._t(bs + \"TB\") },\n\t\t\t{ \"number\": 1125899906842624, suffix: this._t(bs + \"PB\") }\n\t\t]);\n\n\t\tsuper._setDefaults();\n\t}\n\n\tpublic _beforeChanged() {\n\t\tsuper._beforeChanged();\n\t}\n\n\t/**\n\t * Formats the number according to specific format.\n\t *\n\t * @param value   Value to format\n\t * @param format  Format to apply\n\t * @return Formatted number\n\t */\n\tpublic format(value: number | string, format?: string | Intl.NumberFormatOptions, precision?: number): string {\n\n\t\t// no format passed in or \"Number\"\n\t\tif (format == null || ($type.isString(format) && format.toLowerCase() === \"number\")) {\n\t\t\tformat = this.get(\"numberFormat\", \"\");\n\t\t}\n\n\t\t// Init return value\n\t\tlet formatted;\n\n\t\t// Cast to number just in case\n\t\t// TODO: maybe use better casting\n\t\tlet source: number = Number(value);\n\n\t\t// Is it a built-in format or Intl.NumberFormatOptions\n\t\tif ($type.isObject(format)) {\n\t\t\ttry {\n\t\t\t\tif (this.get(\"intlLocales\")) {\n\t\t\t\t\treturn new Intl.NumberFormat(this.get(\"intlLocales\"), <Intl.NumberFormatOptions>format).format(source);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn new Intl.NumberFormat(undefined, <Intl.NumberFormatOptions>format).format(source);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\treturn \"Invalid\";\n\t\t\t}\n\n\t\t}\n\t\telse {\n\n\t\t\t// Clean format\n\t\t\tformat = $utils.cleanFormat(format!);\n\n\t\t\t// Get format info (it will also deal with parser caching)\n\t\t\tlet info = this.parseFormat(format, this._root.language);\n\n\n\t\t\t// format and replace the number\n\t\t\tlet details;\n\t\t\tif (source > this.get(\"negativeBase\")) {\n\t\t\t\tdetails = info.positive;\n\t\t\t}\n\t\t\telse if (source < this.get(\"negativeBase\")) {\n\t\t\t\tdetails = info.negative;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdetails = info.zero;\n\t\t\t}\n\n\t\t\t// Adjust precision\n\t\t\tif (precision != null && !details.mod) {\n\t\t\t\tdetails = $object.copy(details);\n\t\t\t\tdetails.decimals.active = source == 0 ? 0 : precision;\n\t\t\t}\n\n\t\t\t// Format\n\t\t\tformatted = details.template.split($type.PLACEHOLDER).join(this.applyFormat(source, details));\n\n\t\t}\n\n\t\tif (this.get(\"forceLTR\") === true) {\n\t\t\tformatted = \"\" + formatted;\n\t\t}\n\n\t\treturn formatted;\n\t}\n\n\t/**\n\t * Parses supplied format into structured object which can be used to format\n\t * the number.\n\t *\n\t * @param format Format string, i.e. \"#,###.00\"\n\t * @param language Language\n\t * @ignore\n\t */\n\tprotected parseFormat(format: string, language: Language): any {\n\n\t\t// Check cache\n\t\t// TODO\n\t\t// let cached = this.getCache(format);\n\t\t// if (cached != null) {\n\t\t// \treturn cached;\n\t\t// }\n\n\t\tconst thousandSeparator = language.translateEmpty(\"_thousandSeparator\");\n\t\tconst decimalSeparator = language.translateEmpty(\"_decimalSeparator\")\n\n\t\t// init format parse info holder\n\t\tlet info: any = {\n\t\t\t\"positive\": {\n\t\t\t\t\"thousands\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"interval\": -1,\n\t\t\t\t\t\"separator\": thousandSeparator\n\t\t\t\t},\n\t\t\t\t\"decimals\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"separator\": decimalSeparator\n\t\t\t\t},\n\t\t\t\t\"template\": \"\",\n\t\t\t\t\"source\": \"\",\n\t\t\t\t\"parsed\": false\n\t\t\t},\n\t\t\t\"negative\": {\n\t\t\t\t\"thousands\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"interval\": -1,\n\t\t\t\t\t\"separator\": thousandSeparator\n\t\t\t\t},\n\t\t\t\t\"decimals\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"separator\": decimalSeparator\n\t\t\t\t},\n\t\t\t\t\"template\": \"\",\n\t\t\t\t\"source\": \"\",\n\t\t\t\t\"parsed\": false\n\t\t\t},\n\t\t\t\"zero\": {\n\t\t\t\t\"thousands\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"interval\": -1,\n\t\t\t\t\t\"separator\": thousandSeparator\n\t\t\t\t},\n\t\t\t\t\"decimals\": {\n\t\t\t\t\t\"active\": -1,\n\t\t\t\t\t\"passive\": -1,\n\t\t\t\t\t\"separator\": decimalSeparator\n\t\t\t\t},\n\t\t\t\t\"template\": \"\",\n\t\t\t\t\"source\": \"\",\n\t\t\t\t\"parsed\": false\n\t\t\t}\n\t\t};\n\n\t\t// Escape double vertical bars (that mean display one vertical bar)\n\t\tformat = format.replace(\"||\", $type.PLACEHOLDER2);\n\n\t\t// Split it up and deal with different formats\n\t\tlet parts = format.split(\"|\");\n\t\tinfo.positive.source = parts[0];\n\n\t\tif (typeof parts[2] === \"undefined\") {\n\t\t\tinfo.zero = info.positive;\n\t\t}\n\t\telse {\n\t\t\tinfo.zero.source = parts[2];\n\t\t}\n\n\t\tif (typeof parts[1] === \"undefined\") {\n\t\t\tinfo.negative = info.positive;\n\t\t}\n\t\telse {\n\t\t\tinfo.negative.source = parts[1];\n\t\t}\n\n\t\t// Parse each\n\t\t$object.each(info, (_part, item) => {\n\t\t\t// Already parsed\n\t\t\tif (item.parsed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check cached\n\t\t\t// TODO\n\t\t\t// if (typeof this.getCache(item.source) !== \"undefined\") {\n\t\t\t// \tinfo[part] = this.getCache(item.source);\n\t\t\t// \treturn;\n\t\t\t// }\n\n\t\t\t// Begin parsing\n\t\t\tlet partFormat = item.source;\n\n\t\t\t// Just \"Number\"?\n\t\t\tif (partFormat.toLowerCase() === \"number\") {\n\t\t\t\tpartFormat = this.get(\"numberFormat\", \"#,###.#####\");\n\t\t\t}\n\n\t\t\t// Let TextFormatter split into chunks\n\t\t\tlet chunks = TextFormatter.chunk(partFormat, true);\n\t\t\tfor (let i: number = 0; i < chunks.length; i++) {\n\t\t\t\tlet chunk = chunks[i];\n\n\t\t\t\t// replace back double vertical bar\n\t\t\t\tchunk.text = chunk.text.replace($type.PLACEHOLDER2, \"|\");\n\n\t\t\t\tif (chunk.type === \"value\") {\n\t\t\t\t\t// Parse format\n\n\t\t\t\t\t// Look for codes\n\t\t\t\t\tlet matches: string[] | null = chunk.text.match(/[#0.,]+[ ]?[abespABESP%!]?[abespABESP!]?/);\n\n\t\t\t\t\tif (matches) {\n\t\t\t\t\t\tif (matches === null || matches[0] === \"\") {\n\t\t\t\t\t\t\t// no codes here - assume string\n\t\t\t\t\t\t\t// nothing to do here\n\t\t\t\t\t\t\titem.template += chunk.text;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\n\t\t\t\t\t\t\t// look for the format modifiers at the end\n\t\t\t\t\t\t\tlet mods: string[] | null = matches[0].match(/[abespABESP%!]{2}|[abespABESP%]{1}$/);\n\n\t\t\t\t\t\t\tif (mods) {\n\t\t\t\t\t\t\t\titem.mod = mods[0].toLowerCase();\n\t\t\t\t\t\t\t\titem.modSpacing = matches[0].match(/[ ]{1}[abespABESP%!]{1}$/) ? true : false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// break the format up\n\t\t\t\t\t\t\tlet a = matches[0].split(\".\");\n\n\t\t\t\t\t\t\t// Deal with thousands\n\t\t\t\t\t\t\tif (a[0] === \"\") {\n\t\t\t\t\t\t\t\t// No directives for thousands\n\t\t\t\t\t\t\t\t// Leave default settings (no formatting)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// Counts\n\t\t\t\t\t\t\t\titem.thousands.active = (a[0].match(/0/g) || []).length;\n\t\t\t\t\t\t\t\titem.thousands.passive = (a[0].match(/\\#/g) || []).length + item.thousands.active;\n\n\t\t\t\t\t\t\t\t// Separator interval\n\t\t\t\t\t\t\t\tlet b = a[0].split(\",\");\n\t\t\t\t\t\t\t\tif (b.length === 1) {\n\t\t\t\t\t\t\t\t\t// No thousands separators\n\t\t\t\t\t\t\t\t\t// Do nothing\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\t// Use length fo the last chunk as thousands length\n\t\t\t\t\t\t\t\t\titem.thousands.interval = (b.pop() || \"\").length;\n\n\t\t\t\t\t\t\t\t\tif (item.thousands.interval === 0) {\n\t\t\t\t\t\t\t\t\t\titem.thousands.interval = -1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Deal with decimals\n\t\t\t\t\t\t\tif (typeof (a[1]) === \"undefined\") {\n\t\t\t\t\t\t\t\t// No directives for decimals\n\t\t\t\t\t\t\t\t// Leave at defaults (no formatting)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// Counts\n\t\t\t\t\t\t\t\titem.decimals.active = (a[1].match(/0/g) || []).length;\n\t\t\t\t\t\t\t\titem.decimals.passive = (a[1].match(/\\#/g) || []).length + item.decimals.active;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Add special code to template\n\t\t\t\t\t\t\titem.template += chunk.text.split(matches[0]).join($type.PLACEHOLDER);\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Quoted string - take it as it is\n\t\t\t\t\titem.template += chunk.text;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Apply style formatting\n\t\t\t//item.template = getTextFormatter().format(item.template, this.outputFormat);\n\n\t\t\t// Save cache\n\t\t\t// TODO\n\t\t\t//this.setCache(item.source, item);\n\n\t\t\t// Mark this as parsed\n\t\t\titem.parsed = true;\n\n\t\t});\n\n\t\t// Save cache (the whole thing)\n\t\t// TODO\n\t\t//this.setCache(format, info);\n\n\t\treturn info;\n\t}\n\n\t/**\n\t * Applies parsed format to a numeric value.\n\t *\n\t * @param value    Value\n\t * @param details  Parsed format as returned by parseFormat()\n\t * @return Formatted number\n\t * @ignore\n\t */\n\tprotected applyFormat(value: number, details: any): string {\n\n\t\t// Use absolute values\n\t\tlet negative: boolean = value < 0;\n\t\tvalue = Math.abs(value);\n\n\t\t// Recalculate according to modifier\n\t\tlet prefix: string = \"\", suffix: string = \"\";\n\t\tlet mods: string[] = details.mod ? details.mod.split(\"\") : [];\n\t\tif (mods.indexOf(\"b\") !== -1) {\n\t\t\tlet a = this.applyPrefix(value, this.get(\"bytePrefixes\")!, mods.indexOf(\"!\") !== -1);\n\t\t\tvalue = a[0];\n\t\t\tprefix = a[1];\n\t\t\tsuffix = a[2];\n\t\t\tif (details.modSpacing) {\n\t\t\t\tsuffix = \" \" + suffix;\n\t\t\t}\n\t\t}\n\t\telse if (mods.indexOf(\"a\") !== -1) {\n\t\t\tlet a = this.applyPrefix(value, value < this.get(\"smallNumberThreshold\")! ? this.get(\"smallNumberPrefixes\")! : this.get(\"bigNumberPrefixes\")!, mods.indexOf(\"!\") !== -1);\n\t\t\tvalue = a[0];\n\t\t\tprefix = a[1];\n\t\t\tsuffix = a[2];\n\t\t\tif (details.modSpacing) {\n\t\t\t\tsuffix = \" \" + suffix;\n\t\t\t}\n\t\t}\n\t\telse if (mods.indexOf(\"p\") !== -1) {\n\t\t\tlet ol = Math.min(value.toString().length + 2, 21);\n\t\t\t//value *= 100;\n\t\t\tvalue = parseFloat(value.toPrecision(ol));\n\t\t\tprefix = this._root.language.translate(\"_percentPrefix\");\n\t\t\tsuffix = this._root.language.translate(\"_percentSuffix\");\n\t\t\tif (prefix == \"\" && suffix == \"\") {\n\t\t\t\tsuffix = \"%\";\n\t\t\t}\n\t\t}\n\t\telse if (mods.indexOf(\"%\") !== -1) {\n\t\t\tlet ol = Math.min(value.toString().length + 2, 21);\n\t\t\tvalue *= 100;\n\t\t\tvalue = parseFloat(value.toPrecision(ol));\n\t\t\tsuffix = \"%\";\n\t\t}\n\t\telse if (mods.indexOf(\"\") !== -1) {\n\t\t\tlet ol = Math.min(value.toString().length + 3, 21);\n\t\t\tvalue *= 1000;\n\t\t\tvalue = parseFloat(value.toPrecision(ol));\n\t\t\tsuffix = \"\";\n\t\t}\n\n\t\t// Round to passive\n\t\tif (mods.indexOf(\"e\") !== -1) {\n\t\t\t// convert the value to exponential\n\t\t\tlet exp: string[];\n\t\t\tif (details.decimals.passive >= 0) {\n\t\t\t\texp = value.toExponential(details.decimals.passive).split(\"e\");\n\t\t\t}\n\t\t\telse {\n\t\t\t\texp = value.toExponential().split(\"e\");\n\t\t\t}\n\t\t\tvalue = Number(exp[0]);\n\t\t\tsuffix = \"e\" + exp[1];\n\t\t\tif (details.modSpacing) {\n\t\t\t\tsuffix = \" \" + suffix;\n\t\t\t}\n\t\t}\n\t\telse if (details.decimals.passive === 0) {\n\t\t\tvalue = Math.round(value);\n\t\t}\n\t\telse if (details.decimals.passive > 0) {\n\t\t\tconst decimals = $utils.decimalPlaces(value);\n\t\t\tif (decimals > 0) {\n\t\t\t\tconst d = Math.pow(10, details.decimals.passive);\n\t\t\t\tvalue = Math.round(parseFloat((value * d).toFixed(decimals))) / d;\n\t\t\t}\n\t\t}\n\n\t\t// Init return value\n\t\tlet res: string = \"\";\n\n\t\t// Calc integer and decimal parts\n\t\tlet a = $type.numberToString(value).split(\".\");\n\n\t\t// Format integers\n\t\tlet ints = a[0];\n\n\t\t// Pad integers to active length\n\t\tif (ints.length < details.thousands.active) {\n\t\t\tints = Array(details.thousands.active - ints.length + 1).join(\"0\") + ints;\n\t\t}\n\n\t\t// Insert thousands separators\n\t\tif (details.thousands.interval > 0) {\n\t\t\tlet ip: string[] = [];\n\t\t\tlet intsr: string = ints.split(\"\").reverse().join(\"\");\n\t\t\tfor (let i = 0, len = ints.length; i <= len; i += details.thousands.interval) {\n\t\t\t\tlet c: string = intsr.substr(i, details.thousands.interval).split(\"\").reverse().join(\"\");\n\t\t\t\tif (c !== \"\") {\n\t\t\t\t\tip.unshift(c);\n\t\t\t\t}\n\t\t\t}\n\t\t\tints = ip.join(details.thousands.separator);\n\t\t}\n\n\t\t// Add integers\n\t\tres += ints;\n\n\t\t// Add decimals\n\t\tif (a.length === 1) {\n\t\t\ta.push(\"\");\n\t\t}\n\t\tlet decs: string = a[1];\n\n\t\t// Fill zeros?\n\t\tif (decs.length < details.decimals.active) {\n\t\t\tdecs += Array(details.decimals.active - decs.length + 1).join(\"0\");\n\t\t}\n\n\t\tif (decs !== \"\") {\n\t\t\tres += details.decimals.separator + decs;\n\t\t}\n\n\t\t// Can't have empty return value\n\t\tif (res === \"\") {\n\t\t\tres = \"0\";\n\t\t}\n\n\t\t// Add minus sign back\n\t\tif (value !== 0 && negative && (mods.indexOf(\"s\") === -1)) {\n\t\t\tres = \"-\" + res;\n\t\t}\n\n\t\t// Add suffixes/prefixes\n\t\tif (prefix) {\n\t\t\tres = prefix + res;\n\t\t}\n\t\tif (suffix) {\n\t\t\tres += suffix;\n\t\t}\n\n\t\treturn res;\n\t}\n\n\n\tprotected applyPrefix(value: number, prefixes: any[], force: boolean = false): any[] {\n\t\tlet newvalue = value;\n\t\tlet prefix = \"\";\n\t\tlet suffix = \"\";\n\t\tlet applied = false;\n\t\tlet k = 1;\n\n\t\tfor (let i = 0, len = prefixes.length; i < len; i++) {\n\t\t\tif (prefixes[i].number <= value) {\n\t\t\t\tif (prefixes[i].number === 0) {\n\t\t\t\t\tnewvalue = 0;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tnewvalue = value / prefixes[i].number;\n\t\t\t\t\tk = prefixes[i].number;\n\t\t\t\t}\n\t\t\t\tprefix = prefixes[i].prefix;\n\t\t\t\tsuffix = prefixes[i].suffix;\n\t\t\t\tapplied = true;\n\t\t\t}\n\t\t}\n\n\n\t\tif (!applied && force && prefixes.length && value != 0) {\n\t\t\t// Prefix was not applied. Use the first prefix.\n\t\t\tnewvalue = value / prefixes[0].number;\n\t\t\tprefix = prefixes[0].prefix;\n\t\t\tsuffix = prefixes[0].suffix;\n\t\t\tapplied = true;\n\t\t}\n\n\t\tif (applied) {\n\t\t\tnewvalue = parseFloat(\n\t\t\t\tnewvalue.toPrecision(\n\t\t\t\t\tMath.min(k.toString().length + Math.floor(newvalue).toString().replace(/[^0-9]*/g, \"\").length, 21)\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\treturn [newvalue, prefix, suffix];\n\t}\n\n\t/**\n\t * Replaces brackets with temporary placeholders.\n\t *\n\t * @ignore Exclude from docs\n\t * @param text  Input text\n\t * @return Escaped text\n\t */\n\tpublic escape(text: string): string {\n\t\treturn text.replace(\"||\", $type.PLACEHOLDER2);\n\t}\n\n\t/**\n\t * Replaces placeholders back to brackets.\n\t *\n\t * @ignore Exclude from docs\n\t * @param text  Escaped text\n\t * @return Unescaped text\n\t */\n\tpublic unescape(text: string): string {\n\t\treturn text.replace($type.PLACEHOLDER2, \"|\");\n\t}\n\n}\n","interface ParsedDate {\n\tyear: number,\n\tmonth: number,\n\tday: number,\n\thour: number,\n\tminute: number,\n\tsecond: number,\n\tmillisecond: number,\n\tweekday: number\n}\n\nfunction parseDate(timezone: Intl.DateTimeFormat, date: Date): ParsedDate {\n\tlet year = 0;\n\tlet month = 0;\n\tlet day = 1;\n\tlet hour = 0;\n\tlet minute = 0;\n\tlet second = 0;\n\tlet millisecond = 0;\n\tlet weekday = 0;\n\n\n\n\ttimezone.formatToParts(date).forEach((x) => {\n\n\t\tswitch (x.type) {\n\t\t\tcase \"year\":\n\t\t\t\tyear = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"month\":\n\t\t\t\tmonth = (+x.value) - 1;\n\t\t\t\tbreak;\n\t\t\tcase \"day\":\n\t\t\t\tday = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"hour\":\n\t\t\t\thour = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"minute\":\n\t\t\t\tminute = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"second\":\n\t\t\t\tsecond = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"fractionalSecond\" as any:\n\t\t\t\tmillisecond = +x.value;\n\t\t\t\tbreak;\n\t\t\tcase \"weekday\":\n\t\t\t\tswitch (x.value) {\n\t\t\t\t\tcase \"Sun\":\n\t\t\t\t\t\tweekday = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Mon\":\n\t\t\t\t\t\tweekday = 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Tue\":\n\t\t\t\t\t\tweekday = 2;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Wed\":\n\t\t\t\t\t\tweekday = 3;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Thu\":\n\t\t\t\t\t\tweekday = 4;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Fri\":\n\t\t\t\t\t\tweekday = 5;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Sat\":\n\t\t\t\t\t\tweekday = 6;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\t});\n\n\tif (hour === 24) {\n\t\thour = 0;\n\t}\n\n\treturn { year, month, day, hour, minute, second, millisecond, weekday };\n}\n\n\nfunction toUTCDate(timezone: Intl.DateTimeFormat, date: Date): number {\n\tconst { year, month, day, hour, minute, second, millisecond } = parseDate(timezone, date);\n\treturn Date.UTC(year, month, day, hour, minute, second, millisecond);\n}\n\n\nexport class Timezone {\n\tprivate _utc: Intl.DateTimeFormat;\n\tprivate _dtf: Intl.DateTimeFormat;\n\n\tpublic readonly name: string | undefined;\n\n\t/**\n\t * Use this method to create an instance of this class.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/#New_element_syntax} for more info\n\t * @param   timezone  IANA timezone\n\t * @return            Instantiated object\n\t */\n\tstatic new<C extends typeof Timezone, T extends InstanceType<C>>(this: C, timezone: string | undefined): T {\n\t\treturn (new this(timezone, true)) as T;\n\t}\n\n\tconstructor(timezone: string | undefined, isReal: boolean) {\n\t\tif (!isReal) {\n\t\t\tthrow new Error(\"You cannot use `new Class()`, instead use `Class.new()`\");\n\t\t}\n\n\t\tthis.name = timezone;\n\n\t\tthis._utc = new Intl.DateTimeFormat(\"en-US\", {\n\t\t\thour12: false,\n\t\t\ttimeZone: \"UTC\",\n\t\t\tyear: \"numeric\",\n\t\t\tmonth: \"2-digit\",\n\t\t\tday: \"2-digit\",\n\t\t\thour: \"2-digit\",\n\t\t\tminute: \"2-digit\",\n\t\t\tsecond: \"2-digit\",\n\t\t\tweekday: \"short\",\n\t\t\tfractionalSecondDigits: 3,\n\t\t} as any);\n\n\t\tthis._dtf = new Intl.DateTimeFormat(\"en-US\", {\n\t\t\thour12: false,\n\t\t\ttimeZone: timezone,\n\t\t\tyear: \"numeric\",\n\t\t\tmonth: \"2-digit\",\n\t\t\tday: \"2-digit\",\n\t\t\thour: \"2-digit\",\n\t\t\tminute: \"2-digit\",\n\t\t\tsecond: \"2-digit\",\n\t\t\tweekday: \"short\",\n\t\t\tfractionalSecondDigits: 3,\n\t\t} as any);\n\t}\n\n\tconvertLocal(date: Date): Date {\n\t\tconst offset = this.offsetUTC(date);\n\t\tconst userOffset = date.getTimezoneOffset();\n\t\tconst output = new Date(date);\n\t\toutput.setUTCMinutes(output.getUTCMinutes() - (offset - userOffset));\n\n\t\tconst newUserOffset = output.getTimezoneOffset();\n\n\t\tif (userOffset != newUserOffset) {\n\t\t\toutput.setUTCMinutes(output.getUTCMinutes() + newUserOffset - userOffset)\n\t\t}\n\n\t\treturn output;\n\t}\n\n\toffsetUTC(date: Date): number {\n\t\tconst utc = toUTCDate(this._utc, date);\n\t\tconst dtf = toUTCDate(this._dtf, date);\n\t\treturn (utc - dtf) / 60000;\n\t}\n\n\tparseDate(date: Date): ParsedDate {\n\t\treturn parseDate(this._dtf, date)\n\t}\n}\n","import type { ILocaleSettings } from \"./Language\"\n\nimport { Entity, IEntitySettings, IEntityPrivate } from \"./Entity\"\nimport { TextFormatter } from \"./TextFormatter\"\nimport { Timezone } from \"./Timezone\"\n\nimport * as $type from \"./Type\"\nimport * as $utils from \"./Utils\";\n\n/**\n * Interface describing parsed date format definition.\n *\n * @ignore\n */\nexport interface DateFormatInfo {\n\t\"template\": string;\n\t\"parts\": any[];\n}\n\nexport interface IDateFormatterSettings extends IEntitySettings {\n\n\t/**\n\t * Should the first letter of the formatted date be capitalized?\n\t *\n\t * @default true\n\t */\n\tcapitalize?: boolean;\n\n\t/**\n\t * A date format to be used when formatting dates.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n\t */\n\tdateFormat?: string | Intl.DateTimeFormatOptions;\n\n\t/**\n\t * An array of data fields that hold date values and should be formatted\n\t * with a [[DateFormatter]].\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/data-placeholders/#Formatting_placeholders} for more info\n\t */\n\tdateFields?: string[];\n\n\t/**\n\t * Locales to use when formatting using `Intl.DateFormatter`.\n\t */\n\tintlLocales?: string;\n\n}\n\nexport interface IDateFormatterPrivate extends IEntityPrivate {\n}\n\ntype Months = \"January\" | \"February\" | \"March\" | \"April\" | \"May\" | \"June\" | \"July\" | \"August\" | \"September\" | \"October\" | \"November\" | \"December\";\ntype ShortMonths = \"Jan\" | \"Feb\" | \"Mar\" | \"Apr\" | \"May(short)\" | \"Jun\" | \"Jul\" | \"Aug\" | \"Sep\" | \"Oct\" | \"Nov\" | \"Dec\";\ntype Weekdays = \"Sunday\" | \"Monday\" | \"Tuesday\" | \"Wednesday\" | \"Thursday\" | \"Friday\" | \"Saturday\";\ntype ShortWeekdays = \"Sun\" | \"Mon\" | \"Tue\" | \"Wed\" | \"Thu\" | \"Fri\" | \"Sat\";\n\n\n/**\n * Date formatter class.\n *\n * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n * @important\n */\nexport class DateFormatter extends Entity {\n\tdeclare public _settings: IDateFormatterSettings;\n\tdeclare public _privateSettings: IDateFormatterPrivate;\n\n\tprotected _setDefaults() {\n\t\t// Defaults\n\t\tthis._setDefault(\"capitalize\", true);\n\t\tthis._setDefault(\"dateFormat\", \"yyyy-MM-dd\");\n\n\t\tsuper._setDefaults();\n\t}\n\n\tpublic _beforeChanged() {\n\t\tsuper._beforeChanged();\n\t}\n\n\t/**\n\t * Formats a source `Date` object into string format\n\t * @param   source          inpout date\n\t * @param   format          Output format\n\t * @param   ignoreTimezone  Ignore timezone?\n\t * @return                  Formatted date\n\t */\n\tpublic format(source: any, format?: string | Intl.DateTimeFormatOptions, ignoreTimezone: boolean = false): string {\n\n\t\t// Locale?\n\t\t// TODO\n\n\t\t// No format passed in or it's empty\n\t\tif (typeof format === \"undefined\" || format === \"\") {\n\t\t\tformat = this.get(\"dateFormat\", \"yyyy-MM-dd\");\n\t\t}\n\n\t\t// Init return value\n\t\tlet formatted;\n\n\t\t// Cast?\n\t\t// TODO: decide if we need to cast\n\t\tlet date: Date = source;\n\n\n\t\t// Is it a built-in format or Intl.DateTimeFormat\n\t\tif ($type.isObject(format)) {\n\n\t\t\ttry {\n\t\t\t\tconst locales = this.get(\"intlLocales\");\n\t\t\t\tif (locales) {\n\t\t\t\t\treturn new Intl.DateTimeFormat(locales, <Intl.DateTimeFormatOptions>format).format(date);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn new Intl.DateTimeFormat(undefined, <Intl.DateTimeFormatOptions>format).format(date);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\treturn \"Invalid\";\n\t\t\t}\n\n\t\t}\n\n\t\t// get format info (it will also deal with parser caching)\n\t\tlet info = this.parseFormat(format);\n\n\t\t// Should we apply custom time zone?\n\t\tconst timezone = this._root.timezone;\n\t\tlet originalDate = date;\n\t\tif (timezone && !this._root.utc && !ignoreTimezone) {\n\t\t\tdate = timezone.convertLocal(date);\n\t\t}\n\n\t\t// Check if it's a valid date\n\t\tif (!$type.isNumber(date.getTime())) {\n\t\t\t// TODO translation\n\t\t\t//return this._t(\"Invalid date\");\n\t\t\treturn \"Invalid date\";\n\t\t}\n\n\t\t// Apply format\n\t\tformatted = this.applyFormat(date, info, ignoreTimezone, originalDate);\n\n\t\t// Capitalize\n\t\tif (this.get(\"capitalize\")) {\n\t\t\tformatted = formatted.replace(\n\t\t\t\t/^.{1}/, formatted.substr(0, 1).toUpperCase()\n\t\t\t);\n\t\t}\n\n\t\t// We're done\n\t\treturn formatted;\n\t}\n\n\t/**\n\t * Applies format to Date.\n\t *\n\t * @param date      Date object\n\t * @param info      Parsed format information\n\t * @return Formatted date string\n\t */\n\tprotected applyFormat(date: Date, info: DateFormatInfo, ignoreTimezone: boolean = false, originalDate?: Date): string {\n\n\t\t// Init return value\n\t\tlet res = info.template;\n\n\t\t// Get values\n\t\tlet fullYear: number,\n\t\t\tmonth: number,\n\t\t\tweekday: number,\n\t\t\tday: number,\n\t\t\thours: number,\n\t\t\tminutes: number,\n\t\t\tseconds: number,\n\t\t\tmilliseconds: number,\n\t\t\ttimestamp: number = date.getTime();\n\t\tif (this._root.utc && !ignoreTimezone) {\n\t\t\tfullYear = date.getUTCFullYear();\n\t\t\tmonth = date.getUTCMonth();\n\t\t\tweekday = date.getUTCDay();\n\t\t\tday = date.getUTCDate();\n\t\t\thours = date.getUTCHours();\n\t\t\tminutes = date.getUTCMinutes();\n\t\t\tseconds = date.getUTCSeconds();\n\t\t\tmilliseconds = date.getUTCMilliseconds();\n\t\t}\n\t\telse {\n\t\t\tfullYear = date.getFullYear();\n\t\t\tmonth = date.getMonth();\n\t\t\tweekday = date.getDay();\n\t\t\tday = date.getDate();\n\t\t\thours = date.getHours();\n\t\t\tminutes = date.getMinutes();\n\t\t\tseconds = date.getSeconds();\n\t\t\tmilliseconds = date.getMilliseconds();\n\t\t}\n\n\t\t// Go through each part and format/replace it in template\n\t\tfor (let i = 0, len = info.parts.length; i < len; i++) {\n\t\t\tlet value: string = \"\";\n\t\t\tswitch (info.parts[i]) {\n\n\t\t\t\tcase \"G\":\n\t\t\t\t\tvalue = this._t(\n\t\t\t\t\t\tfullYear < 0\n\t\t\t\t\t\t\t? \"_era_bc\"\n\t\t\t\t\t\t\t: \"_era_ad\"\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"yyyy\":\n\t\t\t\t\tvalue = Math.abs(fullYear).toString();\n\t\t\t\t\tif (fullYear < 0) {\n\t\t\t\t\t\tvalue += this._t(\"_era_bc\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"yyy\":\n\t\t\t\tcase \"yy\":\n\t\t\t\tcase \"y\":\n\t\t\t\t\tvalue = Math.abs(fullYear).toString().substr(-info.parts[i].length);\n\t\t\t\t\tif (fullYear < 0) {\n\t\t\t\t\t\tvalue += this._t(\"_era_bc\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"YYYY\":\n\t\t\t\tcase \"YYY\":\n\t\t\t\tcase \"YY\":\n\t\t\t\tcase \"Y\":\n\t\t\t\t\tlet year = $utils.getWeekYear(date, this._root.utc);\n\t\t\t\t\tif (info.parts[i] == \"YYYY\") {\n\t\t\t\t\t\tvalue = Math.abs(year).toString();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = Math.abs(year).toString().substr(-info.parts[i].length);\n\t\t\t\t\t}\n\t\t\t\t\tif (year < 0) {\n\t\t\t\t\t\tvalue += this._t(\"_era_bc\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"u\":\n\t\t\t\t\t// @todo\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"q\":\n\t\t\t\t\tvalue = \"\" + Math.ceil((date.getMonth() + 1) / 3);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMMMM\":\n\t\t\t\t\tvalue = this._t(this._getMonth(month)).substr(0, 1);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMMM\":\n\t\t\t\t\tvalue = this._t(this._getMonth(month));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMM\":\n\t\t\t\t\tvalue = this._t(this._getShortMonth(month));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MM\":\n\t\t\t\t\tvalue = $utils.padString(month + 1, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"M\":\n\t\t\t\t\tvalue = (month + 1).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ww\":\n\t\t\t\t\tvalue = $utils.padString($utils.getWeek(date, this._root.utc), 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"w\":\n\t\t\t\t\tvalue = $utils.getWeek(date, this._root.utc).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"W\":\n\t\t\t\t\tvalue = $utils.getMonthWeek(date, this._root.utc).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"dd\":\n\t\t\t\t\tvalue = $utils.padString(day, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"d\":\n\t\t\t\t\tvalue = day.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"DD\":\n\t\t\t\tcase \"DDD\":\n\t\t\t\t\tvalue = $utils.padString($utils.getYearDay(date, this._root.utc).toString(), info.parts[i].length, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"D\":\n\t\t\t\t\tvalue = $utils.getYearDay(date, this._root.utc).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"F\":\n\t\t\t\t\t// @todo\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"g\":\n\t\t\t\t\t// @todo\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"t\":\n\t\t\t\t\tvalue = this._root.language.translateFunc(\"_dateOrd\").call(this, day);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"E\":\n\t\t\t\t\tvalue = (weekday || 7).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"EE\":\n\t\t\t\t\tvalue = $utils.padString((weekday || 7).toString(), 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"EEE\":\n\t\t\t\tcase \"eee\":\n\t\t\t\t\tvalue = this._t(this._getShortWeekday(weekday));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"EEEE\":\n\t\t\t\tcase \"eeee\":\n\t\t\t\t\tvalue = this._t(this._getWeekday(weekday));\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"EEEEE\":\n\t\t\t\tcase \"eeeee\":\n\t\t\t\t\tvalue = this._t(this._getShortWeekday(weekday)).substr(0, 1);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"e\":\n\t\t\t\tcase \"ee\":\n\t\t\t\t\tvalue = (weekday - (this._root.locale.firstDayOfWeek || 1) + 1).toString();\n\t\t\t\t\tif (info.parts[i] == \"ee\") {\n\t\t\t\t\t\tvalue = $utils.padString(value, 2, \"0\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"a\":\n\t\t\t\t\tif (hours >= 12) {\n\t\t\t\t\t\tvalue = this._t(\"PM\");\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = this._t(\"AM\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"aa\":\n\t\t\t\t\tif (hours >= 12) {\n\t\t\t\t\t\tvalue = this._t(\"P.M.\");\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = this._t(\"A.M.\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"aaa\":\n\t\t\t\t\tif (hours >= 12) {\n\t\t\t\t\t\tvalue = this._t(\"P\");\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = this._t(\"A\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"h\":\n\t\t\t\t\tvalue = $utils.get12Hours(hours).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"hh\":\n\t\t\t\t\tvalue = $utils.padString($utils.get12Hours(hours), 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"H\":\n\t\t\t\t\tvalue = hours.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"HH\":\n\t\t\t\t\tvalue = $utils.padString(hours, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"K\":\n\t\t\t\t\tvalue = $utils.get12Hours(hours, 0).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"KK\":\n\t\t\t\t\tvalue = $utils.padString($utils.get12Hours(hours, 0), 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"k\":\n\t\t\t\t\tvalue = (hours + 1).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"kk\":\n\t\t\t\t\tvalue = $utils.padString(hours + 1, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"m\":\n\t\t\t\t\tvalue = minutes.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"mm\":\n\t\t\t\t\tvalue = $utils.padString(minutes, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"s\":\n\t\t\t\t\tvalue = seconds.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ss\":\n\t\t\t\t\tvalue = $utils.padString(seconds, 2, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"S\":\n\t\t\t\tcase \"SS\":\n\t\t\t\tcase \"SSS\":\n\t\t\t\t\tvalue = Math.round((milliseconds / 1000) * Math.pow(10, info.parts[i].length)).toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"x\":\n\t\t\t\t\tvalue = timestamp.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"n\":\n\t\t\t\tcase \"nn\":\n\t\t\t\tcase \"nnn\":\n\t\t\t\t\tvalue = $utils.padString(milliseconds, info.parts[i].length, \"0\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"z\":\n\t\t\t\t\tvalue = $utils.getTimeZone(originalDate || date, false, false, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined).replace(/[+-]+[0-9]+$/, \"\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"zz\":\n\t\t\t\t\tvalue = $utils.getTimeZone(originalDate || date, true, false, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"zzz\":\n\t\t\t\t\tvalue = $utils.getTimeZone(originalDate || date, false, true, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined).replace(/[+-]+[0-9]+$/, \"\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"zzzz\":\n\t\t\t\t\tvalue = $utils.getTimeZone(originalDate || date, true, true, this._root.utc, this._root.timezone ? this._root.timezone.name : undefined);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"Z\":\n\t\t\t\tcase \"ZZ\":\n\t\t\t\t\tlet timezone = this._root.utc ? \"UTC\" : this._root.timezone;\n\t\t\t\t\tif (timezone instanceof Timezone) {\n\t\t\t\t\t\ttimezone = timezone.name;\n\t\t\t\t\t}\n\t\t\t\t\tconst offset = timezone ? $utils.getTimezoneOffset(timezone, originalDate || date) : date.getTimezoneOffset();\n\n\t\t\t\t\tlet tz = Math.abs(offset) / 60;\n\t\t\t\t\tlet tzh = Math.floor(tz);\n\t\t\t\t\tlet tzm = tz * 60 - tzh * 60;\n\n\t\t\t\t\tif (this._root.utc) {\n\t\t\t\t\t\ttzh = 0;\n\t\t\t\t\t\ttzm = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (info.parts[i] == \"Z\") {\n\t\t\t\t\t\tvalue = \"GMT\";\n\t\t\t\t\t\tvalue += offset > 0 ? \"-\" : \"+\";\n\t\t\t\t\t\tvalue += $utils.padString(tzh, 2) + \":\" + $utils.padString(tzm, 2);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tvalue = offset > 0 ? \"-\" : \"+\";\n\t\t\t\t\t\tvalue += $utils.padString(tzh, 2) + $utils.padString(tzm, 2);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"i\":\n\t\t\t\t\tvalue = date.toISOString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"I\":\n\t\t\t\t\tvalue = date.toUTCString();\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\t\t\tres = res.replace($type.PLACEHOLDER, value);\n\t\t}\n\n\t\treturn res;\n\t}\n\n\t/**\n\t * Parses format into structured infromation.\n\t *\n\t * @param format Format template\n\t */\n\tprotected parseFormat(format: string): DateFormatInfo {\n\n\t\t// Check cache\n\t\t// TODO: implement caching of the parsed format\n\n\t\t// Init format parse info holder\n\t\tlet info: DateFormatInfo = {\n\t\t\t\"template\": \"\",\n\t\t\t\"parts\": <any>[]\n\t\t};\n\n\t\t// Let TextFormatter split into chunks\n\t\tlet chunks = TextFormatter.chunk(format, true);\n\t\tfor (let i: number = 0; i < chunks.length; i++) {\n\t\t\tlet chunk = chunks[i];\n\n\t\t\tif (chunk.type === \"value\") {\n\n\t\t\t\t// Just \"Date\"?\n\t\t\t\tif (chunk.text.match(/^date$/i)) {\n\t\t\t\t\tlet dateFormat = this.get(\"dateFormat\", \"yyyy-MM-dd\");\n\t\t\t\t\tif (!$type.isString(dateFormat)) {\n\t\t\t\t\t\tdateFormat = \"yyyy-MM-dd\";\n\t\t\t\t\t}\n\t\t\t\t\tchunk.text = dateFormat;\n\t\t\t\t}\n\n\t\t\t\t// Find all possible parts\n\t\t\t\tlet matches = chunk.text.match(/G|yyyy|yyy|yy|y|YYYY|YYY|YY|Y|u|q|MMMMM|MMMM|MMM|MM|M|ww|w|W|dd|d|DDD|DD|D|F|g|EEEEE|EEEE|EEE|EE|E|eeeee|eeee|eee|ee|e|aaa|aa|a|hh|h|HH|H|KK|K|kk|k|mm|m|ss|s|SSS|SS|S|A|zzzz|zzz|zz|z|ZZ|Z|t|x|nnn|nn|n|i|I/g);\n\n\t\t\t\t// Found?\n\t\t\t\tif (matches) {\n\n\t\t\t\t\t// Populate template\n\t\t\t\t\tfor (let x = 0; x < matches.length; x++) {\n\t\t\t\t\t\tinfo.parts.push(matches[x]);\n\t\t\t\t\t\tchunk.text = chunk.text.replace(matches[x], $type.PLACEHOLDER);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Apply to template\n\t\t\tinfo.template += chunk.text;\n\t\t}\n\n\t\t// Save cache\n\t\t// TODO\n\n\t\treturn info;\n\t}\n\n\tprotected _months(): Months[] {\n\t\treturn [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"];\n\t}\n\n\tprotected _getMonth(index: number): Months {\n\t\treturn this._months()[index];\n\t}\n\n\tprotected _shortMonths(): ShortMonths[] {\n\t\treturn [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May(short)\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n\t}\n\n\tprotected _getShortMonth(index: number): ShortMonths {\n\t\treturn this._shortMonths()[index];\n\t}\n\n\tprotected _weekdays(): Weekdays[] {\n\t\treturn [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\n\t}\n\n\tprotected _getWeekday(index: number): Weekdays {\n\t\treturn this._weekdays()[index];\n\t}\n\n\tprotected _shortWeekdays(): ShortWeekdays[] {\n\t\treturn [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n\t}\n\n\tprotected _getShortWeekday(index: number): ShortWeekdays {\n\t\treturn this._shortWeekdays()[index];\n\t}\n\n\tpublic parse(source: any, format: string, utc?: boolean): Date {\n\n\t\t// If UTC is not supplied, use Root setting\n\t\tif (typeof utc === \"undefined\") {\n\t\t\tutc = this._root.utc;\n\t\t}\n\n\t\t// Is it already a Date\n\t\tif (source instanceof Date) {\n\t\t\treturn source;\n\t\t}\n\n\t\t// Is it a numeric timestamp\n\t\tif ($type.isNumber(source)) {\n\t\t\treturn new Date(source);\n\t\t}\n\n\t\t// Are we parsing a timestamp?\n\t\tif (format == \"x\") {\n\t\t\treturn new Date(parseInt(source));\n\t\t}\n\n\t\t// No? Let's check if it's string, and try converting to it if nec\n\t\tif (!$type.isString(source)) {\n\t\t\tsource = source.toString();\n\t\t}\n\n\t\t// Init return value\n\t\tlet res: Date;\n\n\t\t// Init RegEx for parsing\n\t\tlet reg: string = \"\";\n\n\t\t// Clean format\n\t\tformat = $utils.cleanFormat(format);\n\n\t\t// Clip format to length of the source string\n\t\tformat = format.substr(0, source.length);\n\n\t\t// Parse format\n\t\tlet info = this.parseFormat(format);\n\n\t\t// Init parsed items holder\n\t\tlet parsedIndexes = {\n\t\t\t\"year\": -1,\n\t\t\t\"year3\": -1,\n\t\t\t\"year2\": -1,\n\t\t\t\"year1\": -1,\n\t\t\t\"month\": -1,\n\t\t\t\"monthShort\": -1,\n\t\t\t\"monthLong\": -1,\n\t\t\t\"weekdayShort\": -1,\n\t\t\t\"weekdayLong\": -1,\n\t\t\t\"day\": -1,\n\t\t\t\"yearDay\": -1,\n\t\t\t\"week\": -1,\n\t\t\t\"hourBase0\": -1,\n\t\t\t\"hour12Base0\": -1,\n\t\t\t\"hourBase1\": -1,\n\t\t\t\"hour12Base1\": -1,\n\t\t\t\"minute\": -1,\n\t\t\t\"second\": -1,\n\t\t\t\"millisecond\": -1,\n\t\t\t\"millisecondDigits\": -1,\n\t\t\t\"am\": -1,\n\t\t\t\"zone\": -1,\n\t\t\t\"timestamp\": -1,\n\t\t\t\"iso\": -1\n\t\t};\n\n\t\t// Init values\n\t\tlet resValues = {\n\t\t\t\"year\": 1970,\n\t\t\t\"month\": 0,\n\t\t\t\"day\": 1,\n\t\t\t\"hour\": 0,\n\t\t\t\"minute\": 0,\n\t\t\t\"second\": 0,\n\t\t\t\"millisecond\": 0,\n\t\t\t\"timestamp\": <any>null,\n\t\t\t\"offset\": 0,\n\t\t\t\"utc\": utc\n\t\t}\n\n\t\t// Index adjuster\n\t\tlet indexAdjust: number = 0;\n\t\tlet index: number = 0;\n\n\t\t// Iterate through all of the parts\n\t\tfor (let i: number = 0; i < info.parts.length; i++) {\n\n\t\t\t// Set current match index\n\t\t\tindex = i + indexAdjust + 1;\n\n\t\t\tswitch (info.parts[i]) {\n\n\t\t\t\tcase \"yyyy\":\n\t\t\t\tcase \"YYYY\":\n\t\t\t\t\treg += \"([0-9]{4})\";\n\t\t\t\t\tparsedIndexes.year = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"yyy\":\n\t\t\t\tcase \"YYY\":\n\t\t\t\t\treg += \"([0-9]{3})\";\n\t\t\t\t\tparsedIndexes.year3 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"yy\":\n\t\t\t\tcase \"YY\":\n\t\t\t\t\treg += \"([0-9]{2})\";\n\t\t\t\t\tparsedIndexes.year2 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"y\":\n\t\t\t\tcase \"Y\":\n\t\t\t\t\treg += \"([0-9]{1})\";\n\t\t\t\t\tparsedIndexes.year1 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMMM\":\n\t\t\t\t\treg += \"(\" + this.getStringList(this._months()).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.monthLong = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MMM\":\n\t\t\t\t\treg += \"(\" + this.getStringList(this._shortMonths()).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.monthShort = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"MM\":\n\t\t\t\tcase \"M\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.month = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ww\":\n\t\t\t\tcase \"w\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.week = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"dd\":\n\t\t\t\tcase \"d\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.day = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"DDD\":\n\t\t\t\tcase \"DD\":\n\t\t\t\tcase \"D\":\n\t\t\t\t\treg += \"([0-9]{3}|[0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.yearDay = index;\n\t\t\t\t\tbreak;\n\n\n\t\t\t\tcase \"dddd\":\n\t\t\t\t\treg += \"(\" + this.getStringList(this._weekdays()).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.weekdayLong = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ddd\":\n\t\t\t\t\treg += \"(\" + this.getStringList(this._shortWeekdays()).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.weekdayShort = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"aaa\":\n\t\t\t\tcase \"aa\":\n\t\t\t\tcase \"a\":\n\t\t\t\t\t// TODO: fix (escape regex)\n\t\t\t\t\treg += \"(\" + this.getStringList([\"AM\", \"PM\", \"A\\.M\\.\", \"P\\.M\\.\", \"A\", \"P\"]).join(\"|\") + \")\";\n\t\t\t\t\tparsedIndexes.am = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"hh\":\n\t\t\t\tcase \"h\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.hour12Base1 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"HH\":\n\t\t\t\tcase \"H\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.hourBase0 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"KK\":\n\t\t\t\tcase \"K\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.hour12Base0 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"kk\":\n\t\t\t\tcase \"k\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.hourBase1 = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"mm\":\n\t\t\t\tcase \"m\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.minute = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ss\":\n\t\t\t\tcase \"s\":\n\t\t\t\t\treg += \"([0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.second = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"SSS\":\n\t\t\t\tcase \"SS\":\n\t\t\t\tcase \"S\":\n\t\t\t\t\treg += \"([0-9]{3}|[0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.millisecond = index;\n\t\t\t\t\tparsedIndexes.millisecondDigits = info.parts[i].length;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"nnn\":\n\t\t\t\tcase \"nn\":\n\t\t\t\tcase \"n\":\n\t\t\t\t\treg += \"([0-9]{3}|[0-9]{2}|[0-9]{1})\";\n\t\t\t\t\tparsedIndexes.millisecond = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"x\":\n\t\t\t\t\treg += \"([0-9]{1,})\";\n\t\t\t\t\tparsedIndexes.timestamp = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"Z\":\n\t\t\t\t\treg += \"GMT([-+]+[0-9]{2}:[0-9]{2})\";\n\t\t\t\t\tparsedIndexes.zone = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"ZZ\":\n\t\t\t\t\treg += \"([\\\\-+]+[0-9]{2}[0-9]{2})\";\n\t\t\t\t\tparsedIndexes.zone = index;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"i\":\n\t\t\t\t\treg += \"([0-9]{4})-?([0-9]{2})-?([0-9]{2})T?([0-9]{2}):?([0-9]{2}):?([0-9]{2})\\\\.?([0-9]{0,3})([zZ]|[+\\\\-][0-9]{2}:?[0-9]{2}|$)\";\n\t\t\t\t\tparsedIndexes.iso = index;\n\t\t\t\t\tindexAdjust += 7;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"G\":\n\t\t\t\tcase \"YYYY\":\n\t\t\t\tcase \"YYY\":\n\t\t\t\tcase \"YY\":\n\t\t\t\tcase \"Y\":\n\t\t\t\tcase \"MMMMM\":\n\t\t\t\tcase \"W\":\n\t\t\t\tcase \"EEEEE\":\n\t\t\t\tcase \"EEEE\":\n\t\t\t\tcase \"EEE\":\n\t\t\t\tcase \"EE\":\n\t\t\t\tcase \"E\":\n\t\t\t\tcase \"eeeee\":\n\t\t\t\tcase \"eeee\":\n\t\t\t\tcase \"eee\":\n\t\t\t\tcase \"ee\":\n\t\t\t\tcase \"e\":\n\t\t\t\tcase \"zzzz\":\n\t\t\t\tcase \"zzz\":\n\t\t\t\tcase \"zz\":\n\t\t\t\tcase \"z\":\n\t\t\t\tcase \"t\":\n\t\t\t\t\t// Ignore\n\t\t\t\t\tindexAdjust--;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treg += \"[^0-9]*\";\n\t\t}\n\n\t\t// Try matching\n\t\tlet regex = new RegExp(reg);\n\t\tlet matches: RegExpMatchArray = source.match(regex);\n\n\t\tif (matches) {\n\t\t\t// Populate the date object\n\n\t\t\t// Full year\n\t\t\tif (parsedIndexes.year > -1) {\n\t\t\t\tresValues.year = parseInt(matches[parsedIndexes.year]);\n\t\t\t}\n\n\t\t\t// 3-digit year\n\t\t\tif (parsedIndexes.year3 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.year3]);\n\t\t\t\tval += 1000;\n\t\t\t\tresValues.year = val;\n\t\t\t}\n\n\t\t\t// 2-digit year\n\t\t\tif (parsedIndexes.year2 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.year2]);\n\t\t\t\tif (val > 50) {\n\t\t\t\t\tval += 1000;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tval += 2000;\n\t\t\t\t}\n\t\t\t\tresValues.year = val;\n\t\t\t}\n\n\t\t\t// 1-digit year\n\t\t\tif (parsedIndexes.year1 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.year1]);\n\t\t\t\tval = Math.floor((new Date().getFullYear()) / 10) * 10 + val;\n\t\t\t\tresValues.year = val;\n\t\t\t}\n\n\t\t\t// Full month\n\t\t\tif (parsedIndexes.monthLong > -1) {\n\t\t\t\tresValues.month = this.resolveMonth(<any>matches[parsedIndexes.monthLong]);\n\t\t\t}\n\n\t\t\t// Short month\n\t\t\tif (parsedIndexes.monthShort > -1) {\n\t\t\t\tresValues.month = this.resolveShortMonth(<any>matches[parsedIndexes.monthShort]);\n\t\t\t}\n\n\t\t\t// Numeric month\n\t\t\tif (parsedIndexes.month > -1) {\n\t\t\t\tresValues.month = parseInt(matches[parsedIndexes.month]) - 1;\n\t\t\t}\n\n\t\t\t// Weekday\n\t\t\t// @todo\n\n\t\t\t// Week\n\t\t\tif ((parsedIndexes.week > -1) && (parsedIndexes.day === -1)) {\n\t\t\t\t// We parse weeks ONLY if day is not explicitly set\n\t\t\t\t// TODO: this needs work\n\t\t\t\t// (but maybe later - I can hardly imagine anyone passing their dates in weeks)\n\t\t\t\tresValues.month = 0;\n\t\t\t\tresValues.day = $utils.getDayFromWeek(\n\t\t\t\t\tparseInt(matches[parsedIndexes.week]),\n\t\t\t\t\tresValues.year,\n\t\t\t\t\t1,\n\t\t\t\t\tutc\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Day\n\t\t\tif (parsedIndexes.day > -1) {\n\t\t\t\tresValues.day = parseInt(matches[parsedIndexes.day]);\n\t\t\t}\n\n\t\t\t// Year day\n\t\t\tif (parsedIndexes.yearDay > -1) {\n\t\t\t\tresValues.month = 0;\n\t\t\t\tresValues.day = parseInt(matches[parsedIndexes.yearDay]);\n\t\t\t}\n\n\t\t\t// 24 Hour (0-23)\n\t\t\tif (parsedIndexes.hourBase0 > -1) {\n\t\t\t\tresValues.hour = parseInt(matches[parsedIndexes.hourBase0]);\n\t\t\t}\n\n\t\t\t// 24 Hour (1-24)\n\t\t\tif (parsedIndexes.hourBase1 > -1) {\n\t\t\t\tresValues.hour = parseInt(matches[parsedIndexes.hourBase1]) - 1;\n\t\t\t}\n\n\t\t\t// 12 Hour (0-11)\n\t\t\tif (parsedIndexes.hour12Base0 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.hour12Base0]);\n\t\t\t\tif (val == 11) {\n\t\t\t\t\tval = 0;\n\t\t\t\t}\n\t\t\t\tif ((parsedIndexes.am > -1) && !this.isAm(matches[parsedIndexes.am])) {\n\t\t\t\t\tval += 12;\n\t\t\t\t}\n\t\t\t\tresValues.hour = val;\n\t\t\t}\n\n\t\t\t// 12 Hour (1-12)\n\t\t\tif (parsedIndexes.hour12Base1 > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.hour12Base1]);\n\t\t\t\tif (val == 12) {\n\t\t\t\t\tval = 0;\n\t\t\t\t}\n\t\t\t\tif ((parsedIndexes.am > -1) && !this.isAm(matches[parsedIndexes.am])) {\n\t\t\t\t\tval += 12;\n\t\t\t\t}\n\t\t\t\tresValues.hour = val;\n\t\t\t}\n\n\t\t\t// Minute\n\t\t\tif (parsedIndexes.minute > -1) {\n\t\t\t\tresValues.minute = parseInt(matches[parsedIndexes.minute]);\n\t\t\t}\n\n\t\t\t// Second\n\t\t\tif (parsedIndexes.second > -1) {\n\t\t\t\tresValues.second = parseInt(matches[parsedIndexes.second]);\n\t\t\t}\n\n\t\t\t// Millisecond\n\t\t\tif (parsedIndexes.millisecond > -1) {\n\t\t\t\tlet val = parseInt(matches[parsedIndexes.millisecond]);\n\t\t\t\tif (parsedIndexes.millisecondDigits == 2) {\n\t\t\t\t\tval *= 10;\n\t\t\t\t}\n\t\t\t\telse if (parsedIndexes.millisecondDigits == 1) {\n\t\t\t\t\tval *= 100;\n\t\t\t\t}\n\t\t\t\tresValues.millisecond = val;\n\t\t\t}\n\n\t\t\t// Timestamp\n\t\t\tif (parsedIndexes.timestamp > -1) {\n\t\t\t\tresValues.timestamp = parseInt(matches[parsedIndexes.timestamp]);\n\n\t\t\t\tconst ts = new Date(resValues.timestamp);\n\t\t\t\tresValues.year = ts.getUTCFullYear();\n\t\t\t\tresValues.month = ts.getUTCMonth();\n\t\t\t\tresValues.day = ts.getUTCDate();\n\t\t\t\tresValues.hour = ts.getUTCHours();\n\t\t\t\tresValues.minute = ts.getUTCMinutes();\n\t\t\t\tresValues.second = ts.getUTCSeconds();\n\t\t\t\tresValues.millisecond = ts.getUTCMilliseconds();\n\t\t\t}\n\n\t\t\t// Adjust time zone\n\t\t\tif (parsedIndexes.zone > -1) {\n\t\t\t\tresValues.offset = this.resolveTimezoneOffset(new Date(resValues.year, resValues.month, resValues.day), matches[parsedIndexes.zone]);\n\t\t\t}\n\n\t\t\t// ISO\n\t\t\tif (parsedIndexes.iso > -1) {\n\n\t\t\t\tresValues.year = $type.toNumber(matches[parsedIndexes.iso + 0]);\n\t\t\t\tresValues.month = $type.toNumber(matches[parsedIndexes.iso + 1]) - 1;\n\t\t\t\tresValues.day = $type.toNumber(matches[parsedIndexes.iso + 2]);\n\t\t\t\tresValues.hour = $type.toNumber(matches[parsedIndexes.iso + 3]);\n\t\t\t\tresValues.minute = $type.toNumber(matches[parsedIndexes.iso + 4]);\n\t\t\t\tresValues.second = $type.toNumber(matches[parsedIndexes.iso + 5]);\n\t\t\t\tresValues.millisecond = $type.toNumber(matches[parsedIndexes.iso + 6]);\n\n\t\t\t\tif (matches[parsedIndexes.iso + 7] == \"Z\" || matches[parsedIndexes.iso + 7] == \"z\") {\n\t\t\t\t\tresValues.utc = true;\n\t\t\t\t}\n\t\t\t\telse if (matches[parsedIndexes.iso + 7] != \"\") {\n\t\t\t\t\tresValues.offset = this.resolveTimezoneOffset(new Date(resValues.year, resValues.month, resValues.day), matches[parsedIndexes.iso + 7]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Create Date object\n\t\t\tif (resValues.utc) {\n\t\t\t\tres = new Date(Date.UTC(\n\t\t\t\t\tresValues.year,\n\t\t\t\t\tresValues.month,\n\t\t\t\t\tresValues.day,\n\t\t\t\t\tresValues.hour,\n\t\t\t\t\tresValues.minute,\n\t\t\t\t\tresValues.second,\n\t\t\t\t\tresValues.millisecond\n\t\t\t\t));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tres = new Date(\n\t\t\t\t\tresValues.year,\n\t\t\t\t\tresValues.month,\n\t\t\t\t\tresValues.day,\n\t\t\t\t\tresValues.hour,\n\t\t\t\t\tresValues.minute + resValues.offset,\n\t\t\t\t\tresValues.second,\n\t\t\t\t\tresValues.millisecond\n\t\t\t\t);\n\t\t\t}\n\n\t\t}\n\t\telse {\n\t\t\t// Didn't match anything\n\t\t\t// Let's try dropping it into Date constructor and hope for the best\n\t\t\tres = new Date(source);\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tprotected resolveTimezoneOffset(date: Date, zone: string): number {\n\t\tlet value = zone.match(/([+\\-]?)([0-9]{2}):?([0-9]{2})/);\n\t\tif (value) {\n\t\t\tlet match = zone.match(/([+\\-]?)([0-9]{2}):?([0-9]{2})/)!;\n\t\t\tlet dir = match[1];\n\t\t\tlet hour = match[2];\n\t\t\tlet minute = match[3];\n\t\t\tlet offset = parseInt(hour) * 60 + parseInt(minute);\n\n\t\t\t// Adjust offset\n\t\t\t// Making it negative does not seem to make sense, but it's right\n\t\t\t// because of how JavaScript calculates GMT offsets\n\t\t\tif (dir == \"+\") {\n\t\t\t\toffset *= -1;\n\t\t\t}\n\n\t\t\t// Check the difference in offset\n\t\t\tlet originalOffset = (date || new Date()).getTimezoneOffset();\n\t\t\tlet diff = offset - originalOffset;\n\t\t\treturn diff;\n\t\t}\n\t\treturn 0;\n\t}\n\n\t/**\n\t * Resolves month name (i.e. \"December\") into a month number (11).\n\t *\n\t * @param value  Month name\n\t * @return Month number\n\t */\n\tprotected resolveMonth(value: Months): number {\n\n\t\t// Let's try English first\n\t\tlet month: number = this._months().indexOf(value);\n\t\tif (month > -1) {\n\t\t\treturn month;\n\t\t}\n\n\t\t// Try the translation\n\t\tif (!this._root.language.isDefault()) {\n\t\t\tmonth = this._root.language.translateAll(this._months()).indexOf(value);\n\t\t\tif (month > -1) {\n\t\t\t\treturn month\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t/**\n\t * Resolves short month name (i.e. \"Dec\") into a month number.\n\t *\n\t * @param value  Short month name\n\t * @return Month number\n\t */\n\tprotected resolveShortMonth(value: ShortMonths): number {\n\n\t\t// Let's try English first\n\t\tlet month: number = this._shortMonths().indexOf(value);\n\t\tif (month > -1) {\n\t\t\treturn month;\n\t\t}\n\n\t\t// Maybe long month (workaround for May)\n\t\tmonth = this._months().indexOf(<any>value);\n\t\tif (month > -1) {\n\t\t\treturn month;\n\t\t}\n\n\t\t// Try the translation\n\t\tif (this._root.language && !this._root.language.isDefault()) {\n\t\t\tmonth = this._root.language.translateAll(this._shortMonths()).indexOf(value);\n\t\t\tif (month > -1) {\n\t\t\t\treturn month\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\t/**\n\t * Checks if passed in string represents AM/PM notation in many of its\n\t * versions.\n\t *\n\t * @param value  Source string\n\t * @return Is it AM/PM?\n\t */\n\tprotected isAm(value: string): boolean {\n\t\tlet list = this.getStringList([\"AM\", \"A.M.\", \"A\"]);\n\t\treturn list.indexOf(value.toUpperCase()) > -1;\n\t}\n\n\t/**\n\t * Translates list of strings.\n\t *\n\t * @param list  Source strings\n\t * @return Translated strings\n\t */\n\tprotected getStringList(list: Array<keyof ILocaleSettings>): Array<string> {\n\t\tlet res: string[] = [];\n\t\tfor (let i: number = 0; i < list.length; i++) {\n\t\t\t// translate?\n\t\t\tif (this._root.language) {\n\t\t\t\tres.push($utils.escapeForRgex(this._t(list[i])));\n\t\t\t}\n\t\t\telse {\n\t\t\t\tres.push($utils.escapeForRgex(list[i]));\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n\n}\n","import type { TimeUnit } from \"./Time\";\r\n\r\nimport { Entity, IEntitySettings, IEntityPrivate } from \"./Entity\"\r\nimport { TextFormatter } from \"./TextFormatter\";\r\n\r\nimport * as $object from \"./Object\";\r\nimport * as $utils from \"./Utils\";\r\nimport * as $type from \"./Type\";\r\n\r\n\r\nexport interface IDurationFormatterSettings extends IEntitySettings {\r\n\r\n\t/**\r\n\t * A universal duration format to use wherever number needs to be formatted\r\n\t * as a duration.\r\n\t */\r\n\tdurationFormat?: string;\r\n\r\n\t/**\r\n\t * A base value. Any number below it will be considered \"negative\".\r\n\t *\r\n\t * @default 0\r\n\t */\r\n\tnegativeBase?: number;\r\n\r\n\t/**\r\n\t * Identifies what values are used in duration.\r\n\t *\r\n\t * Available options: `\"millisecond\"`, `\"second\"` (default), `\"minute\"`, `\"hour\"`, `\"day\"`, `\"week\"`, `\"month\"`, and `\"year\"`.\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-durations/#Base_unit} for more info\r\n\t * @default \"second\"\r\n\t */\r\n\tbaseUnit?: TimeUnit;\r\n\r\n\t/**\r\n\t * Time unit dependent duration formats.\r\n\t *\r\n\t * Used be [[DurationAxis]].\r\n\t */\r\n\tdurationFormats?: Partial<Record<TimeUnit, Partial<Record<TimeUnit, string>>>>;\r\n\r\n\t/**\r\n\t * An array of data fields that hold duration values and should be formatted\r\n\t * with a [[DurationFormatter]].\r\n\t *\r\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/data-placeholders/#Formatting_placeholders} for more info\r\n\t */\r\n\tdurationFields?: string[];\r\n\r\n}\r\n\r\nexport interface IDurationFormatterPrivate extends IEntityPrivate {\r\n}\r\n\r\n/**\r\n * A class used to format numberic values as time duration.\r\n *\r\n * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-durations/} for more info\r\n */\r\nexport class DurationFormatter extends Entity {\r\n\tdeclare public _settings: IDurationFormatterSettings;\r\n\tdeclare public _privateSettings: IDurationFormatterPrivate;\r\n\r\n\tprotected _setDefaults() {\r\n\t\tconst dmillisecond = \"_duration_millisecond\";\r\n\t\tconst dsecond = \"_duration_second\";\r\n\t\tconst dminute = \"_duration_minute\";\r\n\t\tconst dhour = \"_duration_hour\";\r\n\t\tconst dday = \"_duration_day\";\r\n\t\tconst dweek = \"_duration_week\";\r\n\t\tconst dmonth = \"_duration_month\";\r\n\t\tconst dyear = \"_duration_year\";\r\n\r\n\t\tconst asecond = \"_second\";\r\n\t\tconst aminute = \"_minute\";\r\n\t\tconst ahour = \"_hour\";\r\n\t\tconst aday = \"_day\";\r\n\t\tconst aweek = \"_week\";\r\n\t\tconst amonth = \"_week\";\r\n\t\tconst ayear = \"_year\";\r\n\r\n\t\t// Defaults\r\n\t\tthis._setDefault(\"negativeBase\", 0);\r\n\t\tthis._setDefault(\"baseUnit\", \"second\");\r\n\t\tthis._setDefault(\"durationFormats\", {\r\n\t\t\t\"millisecond\": {\r\n\t\t\t\t\"millisecond\": this._t(dmillisecond),\r\n\t\t\t\t\"second\": this._t((dmillisecond + asecond) as any),\r\n\t\t\t\t\"minute\": this._t((dmillisecond + aminute) as any),\r\n\t\t\t\t\"hour\": this._t((dmillisecond + ahour) as any),\r\n\t\t\t\t\"day\": this._t((dmillisecond + aday) as any),\r\n\t\t\t\t\"week\": this._t((dmillisecond + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dmillisecond + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dmillisecond + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"second\": {\r\n\t\t\t\t\"second\": this._t((dsecond) as any),\r\n\t\t\t\t\"minute\": this._t((dsecond + aminute) as any),\r\n\t\t\t\t\"hour\": this._t((dsecond + ahour) as any),\r\n\t\t\t\t\"day\": this._t((dsecond + aday) as any),\r\n\t\t\t\t\"week\": this._t((dsecond + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dsecond + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dsecond + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"minute\": {\r\n\t\t\t\t\"minute\": this._t((dminute) as any),\r\n\t\t\t\t\"hour\": this._t((dminute + ahour) as any),\r\n\t\t\t\t\"day\": this._t((dminute + aday) as any),\r\n\t\t\t\t\"week\": this._t((dminute + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dminute + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dminute + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"hour\": {\r\n\t\t\t\t\"hour\": this._t((dhour) as any),\r\n\t\t\t\t\"day\": this._t((dhour + aday) as any),\r\n\t\t\t\t\"week\": this._t((dhour + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dhour + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dhour + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"day\": {\r\n\t\t\t\t\"day\": this._t((dday) as any),\r\n\t\t\t\t\"week\": this._t((dday + aweek) as any),\r\n\t\t\t\t\"month\": this._t((dday + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dday + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"week\": {\r\n\t\t\t\t\"week\": this._t((dweek) as any),\r\n\t\t\t\t\"month\": this._t((dweek + amonth) as any),\r\n\t\t\t\t\"year\": this._t((dweek + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"month\": {\r\n\t\t\t\t\"month\": this._t((dmonth) as any),\r\n\t\t\t\t\"year\": this._t((dmonth + ayear) as any)\r\n\t\t\t},\r\n\t\t\t\"year\": {\r\n\t\t\t\t\"year\": this._t(dyear)\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tsuper._setDefaults();\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * Collection of aliases for units.\r\n\t */\r\n\tprotected _unitAliases: { [index: string]: string } = {\r\n\t\t\"Y\": \"y\",\r\n\t\t\"D\": \"d\",\r\n\t\t\"H\": \"h\",\r\n\t\t\"K\": \"h\",\r\n\t\t\"k\": \"h\",\r\n\t\t\"n\": \"S\"\r\n\t};\r\n\r\n\tpublic _beforeChanged() {\r\n\t\tsuper._beforeChanged();\r\n\t}\r\n\r\n\t/**\r\n\t * Formats the number as duration.\r\n\t *\r\n\t * For example `1000` (base unit seconds) would be converted to `16:40` as in\r\n\t * 16 minutes and 40 seconds.\r\n\t *\r\n\t * @param value   Value to format\r\n\t * @param format  Format to apply\r\n\t * @param base    Override base unit\r\n\t * @return Formatted number\r\n\t */\r\n\tpublic format(value: number | string, format?: string, base?: TimeUnit): string {\r\n\r\n\t\t// no base unit?\r\n\t\tlet baseUnit = base || this.get(\"baseUnit\");\r\n\r\n\t\t// no format passed in or empty\r\n\t\tif (typeof format === \"undefined\" || format === \"\") {\r\n\t\t\tif (this.get(\"durationFormat\") != null) {\r\n\t\t\t\tformat = this.get(\"durationFormat\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tformat = this.getFormat($type.toNumber(value), undefined, baseUnit);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Clean format\r\n\t\tformat = $utils.cleanFormat(format!);\r\n\r\n\t\t// get format info (it will also deal with parser caching)\r\n\t\tlet info = this.parseFormat(format, baseUnit);\r\n\r\n\t\t// cast to number just in case\r\n\t\t// TODO: maybe use better casting\r\n\t\tlet source: number = Number(value);\r\n\r\n\t\t// format and replace the number\r\n\t\tlet details;\r\n\t\tif (source > this.get(\"negativeBase\")) {\r\n\t\t\tdetails = info.positive;\r\n\t\t}\r\n\t\telse if (source < this.get(\"negativeBase\")) {\r\n\t\t\tdetails = info.negative;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdetails = info.zero;\r\n\t\t}\r\n\r\n\r\n\t\t// Format\r\n\t\tlet formatted = this.applyFormat(source, details);\r\n\r\n\t\t// Apply color?\r\n\t\tif (details.color !== \"\") {\r\n\t\t\tformatted = \"[\" + details.color + \"]\" + formatted + \"[/]\";\r\n\t\t}\r\n\r\n\t\treturn formatted;\r\n\t}\r\n\r\n\t/**\r\n\t * Parses supplied format into structured object which can be used to format\r\n\t * the number.\r\n\t *\r\n\t * @param format  Format string, i.e. \"#,###.00\"\r\n\t * @param base    Override base unit\r\n\t * @return Parsed information\r\n\t */\r\n\tprotected parseFormat(format: string, base?: TimeUnit): any {\r\n\r\n\t\t// Check cache\r\n\t\t// TODO\r\n\t\t// let cached = this.getCache(format);\r\n\t\t// if (cached != null) {\r\n\t\t// \treturn cached;\r\n\t\t// }\r\n\r\n\t\t// no base unit?\r\n\t\tlet baseUnit = base || this.get(\"baseUnit\");\r\n\r\n\t\t// Initialize duration parsing info\r\n\t\tlet info = {\r\n\t\t\t\"positive\": {\r\n\t\t\t\t\"color\": \"\",\r\n\t\t\t\t\"template\": \"\",\r\n\t\t\t\t\"parts\": <any>[],\r\n\t\t\t\t\"source\": \"\",\r\n\t\t\t\t\"baseUnit\": baseUnit,\r\n\t\t\t\t\"parsed\": false,\r\n\t\t\t\t\"absolute\": false\r\n\t\t\t},\r\n\t\t\t\"negative\": {\r\n\t\t\t\t\"color\": \"\",\r\n\t\t\t\t\"template\": \"\",\r\n\t\t\t\t\"parts\": <any>[],\r\n\t\t\t\t\"source\": \"\",\r\n\t\t\t\t\"baseUnit\": baseUnit,\r\n\t\t\t\t\"parsed\": false,\r\n\t\t\t\t\"absolute\": false\r\n\t\t\t},\r\n\t\t\t\"zero\": {\r\n\t\t\t\t\"color\": \"\",\r\n\t\t\t\t\"template\": \"\",\r\n\t\t\t\t\"parts\": <any>[],\r\n\t\t\t\t\"source\": \"\",\r\n\t\t\t\t\"baseUnit\": baseUnit,\r\n\t\t\t\t\"parsed\": false,\r\n\t\t\t\t\"absolute\": false\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// Escape double vertical bars (that mean display one vertical bar)\r\n\t\tformat = format.replace(\"||\", $type.PLACEHOLDER2);\r\n\r\n\t\t// Split it up and deal with different formats\r\n\t\tlet parts = format.split(\"|\");\r\n\t\tinfo.positive.source = parts[0];\r\n\r\n\t\tif (typeof parts[2] === \"undefined\") {\r\n\t\t\tinfo.zero = info.positive;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinfo.zero.source = parts[2];\r\n\t\t}\r\n\r\n\t\tif (typeof parts[1] === \"undefined\") {\r\n\t\t\tinfo.negative = info.positive;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinfo.negative.source = parts[1];\r\n\t\t}\r\n\r\n\t\t// Parse each\r\n\t\t$object.each(info, (_part, item) => {\r\n\t\t\t// Already parsed\r\n\t\t\tif (item.parsed) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Check cached\r\n\t\t\t// TODO\r\n\t\t\t// if (typeof this.getCache(item.source) !== \"undefined\") {\r\n\t\t\t// \tinfo[part] = this.getCache(item.source);\r\n\t\t\t// \treturn;\r\n\t\t\t// }\r\n\r\n\t\t\t// Begin parsing\r\n\t\t\tlet partFormat: string = item.source;\r\n\r\n\t\t\t// Check for [] directives\r\n\t\t\tlet dirs: string[] | null = [];\r\n\t\t\tdirs = item.source.match(/^\\[([^\\]]*)\\]/);\r\n\t\t\tif (dirs && dirs.length && dirs[0] !== \"\") {\r\n\t\t\t\tpartFormat = item.source.substr(dirs[0].length);\r\n\t\t\t\titem.color = dirs[1];\r\n\t\t\t}\r\n\r\n\r\n\t\t\t// Let TextFormatter split into chunks\r\n\t\t\tlet chunks = TextFormatter.chunk(partFormat, true);\r\n\t\t\tfor (let i: number = 0; i < chunks.length; i++) {\r\n\t\t\t\tlet chunk = chunks[i];\r\n\r\n\t\t\t\t// replace back double vertical bar\r\n\t\t\t\tchunk.text = chunk.text.replace($type.PLACEHOLDER2, \"|\");\r\n\r\n\t\t\t\tif (chunk.type === \"value\") {\r\n\r\n\t\t\t\t\t// Just \"Duration\"?\r\n\t\t\t\t\t// if (chunk.text.toLowerCase() === \"duration\") {\r\n\t\t\t\t\t// \tchunk.text = durationFormat;\r\n\t\t\t\t\t// }\r\n\r\n\t\t\t\t\t// Check for \"a\" (absolute) modifier\r\n\t\t\t\t\tif (chunk.text.match(/[yYMdDwhHKkmsSn]+a/)) {\r\n\t\t\t\t\t\titem.absolute = true;\r\n\t\t\t\t\t\tchunk.text = chunk.text.replace(/([yYMdDwhHKkmsSn]+)a/, \"$1\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Find all possible parts\r\n\t\t\t\t\tlet matches = chunk.text.match(/y+|Y+|M+|d+|D+|w+|h+|H+|K+|k+|m+|s+|S+|n+/g);\r\n\r\n\t\t\t\t\tif (matches) {\r\n\t\t\t\t\t\t// Populate template\r\n\t\t\t\t\t\tfor (let x = 0; x < matches.length; x++) {\r\n\t\t\t\t\t\t\t// Is it an alias?\r\n\t\t\t\t\t\t\tif (matches[x] == null) {\r\n\t\t\t\t\t\t\t\tmatches[x] = this._unitAliases[matches[x]];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\titem.parts.push(matches[x]);\r\n\t\t\t\t\t\t\tchunk.text = chunk.text.replace(matches[x], $type.PLACEHOLDER);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Apply to template\r\n\t\t\t\titem.template += chunk.text;\r\n\t\t\t}\r\n\r\n\t\t\t// Apply style formatting\r\n\t\t\t//item.template = TextFormatter.format(item.template, this.outputFormat);\r\n\r\n\t\t\t// Save cache\r\n\t\t\t// TODO\r\n\t\t\t//this.setCache(item.source, item);\r\n\r\n\t\t\t// Mark this as parsed\r\n\t\t\titem.parsed = true;\r\n\t\t});\r\n\r\n\t\t// Save cache (the whole thing)\r\n\t\t// TODO\r\n\t\t//this.setCache(format, info);\r\n\r\n\t\treturn info;\r\n\t}\r\n\r\n\t/**\r\n\t * Applies parsed format to a numeric value.\r\n\t *\r\n\t * @param value    Value\r\n\t * @param details  Parsed format as returned by {parseFormat}\r\n\t * @return Formatted duration\r\n\t */\r\n\tprotected applyFormat(value: number, details: any): string {\r\n\r\n\t\t// Use absolute values\r\n\t\tlet negative = !details.absolute && (value < this.get(\"negativeBase\"));\r\n\t\tvalue = Math.abs(value);\r\n\r\n\r\n\t\t// Recalculate to milliseconds\r\n\t\tlet tstamp = this.toTimeStamp(value, details.baseUnit);\r\n\r\n\t\t// Init return value\r\n\t\tlet res = details.template;\r\n\t\tconst values: any  = {\r\n\t\t\tmillisecond: 0,\r\n\t\t\tsecond: 0,\r\n\t\t\tminute: 0,\r\n\t\t\thour: 0,\r\n\t\t\tday: 0,\r\n\t\t\tweek: 0,\r\n\t\t\tmonth: 0,\r\n\t\t\tyear: 0\r\n\t\t};\r\n\r\n\t\t// Iterate through duration parts\r\n\t\tfor (let i = 0, len = details.parts.length; i < len; i++) {\r\n\r\n\t\t\t// Gather the part\r\n\t\t\tlet part = details.parts[i];\r\n\t\t\tlet unit: any = this._toTimeUnit(part.substr(0, 1));\r\n\r\n\t\t\t// Calculate current unit value\r\n\t\t\tlet ints: number;\r\n\t\t\tconst unitValue = this._getUnitValue(unit!);\r\n\t\t\tif (i < (len -1)) {\r\n\t\t\t\tints = Math.floor(tstamp / unitValue);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tints = Math.round(tstamp / unitValue);\r\n\t\t\t}\r\n\r\n\t\t\tvalues[unit] += ints;\r\n\r\n\t\t\t// Reduce timestamp\r\n\t\t\ttstamp -= ints * unitValue;\r\n\t\t}\r\n\r\n\t\t// Check if we have full unit that we need to bump up to higher unit\r\n\t\t$object.each(values, (unit, value) => {\r\n\t\t\tif (unit == \"millisecond\" && value == 1000) {\r\n\t\t\t\tvalues[\"second\"]++;\r\n\t\t\t\tvalues[\"millisecond\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"second\" && value == 60) {\r\n\t\t\t\tvalues[\"minute\"]++;\r\n\t\t\t\tvalues[\"second\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"minute\" && value == 60) {\r\n\t\t\t\tvalues[\"hour\"]++;\r\n\t\t\t\tvalues[\"minute\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"hour\" && value == 24) {\r\n\t\t\t\tvalues[\"day\"]++;\r\n\t\t\t\tvalues[\"hour\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"day\" && value == 7 && details.parts.indexOf(\"w\") !== -1) {\r\n\t\t\t\tvalues[\"week\"]++;\r\n\t\t\t\tvalues[\"day\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"day\" && value == 30) {\r\n\t\t\t\tvalues[\"month\"]++;\r\n\t\t\t\tvalues[\"day\"] = 0;\r\n\t\t\t}\r\n\t\t\telse if (unit == \"month\" && value == 12) {\r\n\t\t\t\tvalues[\"year\"]++;\r\n\t\t\t\tvalues[\"month\"] = 0;\r\n\t\t\t}\r\n\t\t\t// if (val > 0) {\r\n\t\t\t// \tres = res.replace($type.PLACEHOLDER, $utils.padString(val, 2, \"0\"));\r\n\t\t\t// }\r\n\t\t\t// else {\r\n\t\t\t// \tres = res.replace($type.PLACEHOLDER, \"\");\r\n\t\t\t// }\r\n\t\t});\r\n\r\n\t\t// Iterate again\r\n\t\tfor (let i = 0, len = details.parts.length; i < len; i++) {\r\n\t\t\t// Gather the part\r\n\t\t\tlet part = details.parts[i];\r\n\t\t\tlet unit: any = this._toTimeUnit(part.substr(0, 1));\r\n\t\t\tlet digits = part.length;\r\n\r\n\t\t\t// Calculate current unit value\r\n\t\t\tres = res.replace($type.PLACEHOLDER, $utils.padString(values[unit], digits, \"0\"));\r\n\t\t}\r\n\r\n\r\n\t\t// Reapply negative sign\r\n\t\tif (negative) {\r\n\t\t\tres = \"-\" + res;\r\n\t\t}\r\n\r\n\t\treturn res;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts numeric value to timestamp in milliseconds.\r\n\t *\r\n\t * @param value     A source value\r\n\t * @param baseUnit  Base unit the source value is in: \"q\", \"s\", \"i\", \"h\", \"d\", \"w\", \"m\", \"y\"\r\n\t * @return Value representation as a timestamp in milliseconds\r\n\t */\r\n\tpublic toTimeStamp(value: number, baseUnit: TimeUnit): number {\r\n\t\treturn value * this._getUnitValue(baseUnit);\r\n\t}\r\n\r\n\tprotected _toTimeUnit(code: string): TimeUnit | undefined {\r\n\t\tswitch (code) {\r\n\t\t\tcase \"S\":\r\n\t\t\t\treturn \"millisecond\";\r\n\t\t\tcase \"s\":\r\n\t\t\t\treturn \"second\";\r\n\t\t\tcase \"m\":\r\n\t\t\t\treturn \"minute\";\r\n\t\t\tcase \"h\":\r\n\t\t\t\treturn \"hour\";\r\n\t\t\tcase \"d\":\r\n\t\t\t\treturn \"day\";\r\n\t\t\tcase \"w\":\r\n\t\t\t\treturn \"week\";\r\n\t\t\tcase \"M\":\r\n\t\t\t\treturn \"month\";\r\n\t\t\tcase \"y\":\r\n\t\t\t\treturn \"year\";\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Returns appropriate default format for the value.\r\n\t *\r\n\t * If `maxValue` is sepcified, it will use that value to determine the time\r\n\t * unit for the format.\r\n\t *\r\n\t * For example if your `baseUnit` is `\"second\"` and you pass in `10`, you\r\n\t * will get `\"10\"`.\r\n\t *\r\n\t * However, you might want it to be formatted in the context of bigger scale,\r\n\t * say 10 minutes (600 seconds). If you pass in `600` as `maxValue`, all\r\n\t * values, including small ones will use format with minutes, e.g.:\r\n\t * `00:10`, `00:50`, `12: 30`, etc.\r\n\t *\r\n\t * @param value     Value to format\r\n\t * @param maxValue  Maximum value to be used to determine format\r\n\t * @param baseUnit  Base unit of the value\r\n\t * @return Format\r\n\t */\r\n\tpublic getFormat(value: number, maxValue?: number, baseUnit?: TimeUnit): string {\r\n\r\n\t\t// Is format override set?\r\n\t\tif (this.get(\"durationFormat\") != null) {\r\n\t\t\treturn this.get(\"durationFormat\")!;\r\n\t\t}\r\n\r\n\t\t// Get base unit\r\n\t\tif (!baseUnit) {\r\n\t\t\tbaseUnit = this.get(\"baseUnit\");\r\n\t\t}\r\n\r\n\t\tif (maxValue != null && value != maxValue) {\r\n\t\t\tvalue = Math.abs(value);\r\n\t\t\tmaxValue = Math.abs(maxValue);\r\n\t\t\tlet maxUnit = this.getValueUnit(Math.max(value, maxValue), baseUnit);\r\n\t\t\treturn (<any>this.get(\"durationFormats\"))[baseUnit!][maxUnit!];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet unit = this.getValueUnit(value, baseUnit);\r\n\t\t\treturn (<any>this.get(\"durationFormats\"))[baseUnit!][unit!];\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns value's closest denominator time unit, e.g 100 seconds is\r\n\t * `\"minute\"`, while 59 seconds would still be `second`.\r\n\t *\r\n\t * @param value     Source duration value\r\n\t * @param baseUnit  Base unit\r\n\t * @return Denominator\r\n\t */\r\n\tpublic getValueUnit(value: number, baseUnit?: TimeUnit): TimeUnit | undefined {\r\n\r\n\t\t// Get base unit\r\n\t\tif (!baseUnit) {\r\n\t\t\tbaseUnit = this.get(\"baseUnit\");\r\n\t\t}\r\n\r\n\t\t// Convert to milliseconds\r\n\t\tlet currentUnit: any;\r\n\t\tlet ms = this.getMilliseconds(value, baseUnit);\r\n\t\t$object.eachContinue(this._getUnitValues(), (key, val) => {\r\n\t\t\tif (key == baseUnit || currentUnit) {\r\n\t\t\t\tlet num = ms / val;\r\n\t\t\t\tif (num <= 1) {\r\n\t\t\t\t\tif (!currentUnit) {\r\n\t\t\t\t\t\tcurrentUnit = key;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tcurrentUnit = key;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\treturn currentUnit;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts value to milliseconds according to `baseUnit`.\r\n\t *\r\n\t * @param value     Source duration value\r\n\t * @param baseUnit  Base unit\r\n\t * @return Value in milliseconds\r\n\t */\r\n\tpublic getMilliseconds(value: number, baseUnit?: TimeUnit): number {\r\n\r\n\t\t// Get base unit\r\n\t\tif (!baseUnit) {\r\n\t\t\tbaseUnit = this.get(\"baseUnit\");\r\n\t\t}\r\n\r\n\t\treturn value * this._getUnitValue(baseUnit!);\r\n\t}\r\n\r\n\tprotected _getUnitValue(timeUnit: TimeUnit): number {\r\n\t\treturn this._getUnitValues()[timeUnit];\r\n\t}\r\n\r\n\tprotected _getUnitValues(): any {\r\n\t\treturn {\r\n\t\t\t\"millisecond\": 1,\r\n\t\t\t\"second\": 1000,\r\n\t\t\t\"minute\": 60000,\r\n\t\t\t\"hour\": 3600000,\r\n\t\t\t\"day\": 86400000,\r\n\t\t\t\"week\": 604800000,\r\n\t\t\t\"month\": 2592000000,\r\n\t\t\t\"year\": 31536000000,\r\n\t\t};\r\n\t}\r\n\r\n}\r\n","/**\n * amCharts 5 locale\n * \n * Locale: en\n * Language: International English\n * Author: Martynas Majeris\n *\n * Follow instructions in [on this page](https://www.amcharts.com/docs/v5/tutorials/creating-translations/) to make corrections or add new translations.\n *\n * ---\n * Edit but leave the header section above this line. You can remove any\n * subsequent comment sections.\n * ---\n *\n * Use this file as a template to create translations. Leave the key part in\n * English intact. Fill the value with a translation.\n *\n * Empty string means no translation, so default \"International English\"\n * will be used.\n *\n * If you need the translation to literally be an empty string, use `null`\n * instead.\n *\n * IMPORTANT:\n * When translating make good effort to keep the translation length\n * at least the same chartcount as the English, especially for short prompts.\n *\n * Having significantly longer prompts may distort the actual charts.\n *\n * NOTE:\n * Some prompts - like months or weekdays - come in two versions: full and\n * shortened.\n *\n * If there's no official shortened version of these in your language, and it\n * would not be possible to invent such short versions that don't seem weird\n * to native speakers of that language, fill those with the same as full\n * version.\n *\n * PLACEHOLDERS:\n * Some prompts have placeholders like \"%1\". Those will be replaced by actual\n * values during translation and should be retained in the translated prompts.\n *\n * Placeholder positions may be changed to better suit structure of the\n * sentence.\n *\n * For example \"From %1 to %2\", when actually used will replace \"%1\" with an\n * actual value representing range start, and \"%2\" will be replaced by end\n * value.\n *\n * E.g. in a Scrollbar for Value axis \"From %1 to %2\" will become\n * \"From 100 to 200\". You may translate \"From\" and \"to\", as well as re-arrange\n * the order of the prompt itself, but make sure the \"%1\" and \"%2\" remain, in\n * places where they will make sense.\n *\n * Save the file as language_LOCALE, i.e. `en_GB.ts`, `fr_FR.ts`, etc.\n */\nexport default {\n\t\"firstDayOfWeek\": 1,\n\t\n\t// Number formatting options.\n\t// \n\t// Please check with the local standards which separator is accepted to be\n\t// used for separating decimals, and which for thousands.\n\t\"_decimalSeparator\": \".\",\n\t\"_thousandSeparator\": \",\",\n\n\t// Position of the percent sign in numbers\n\t\"_percentPrefix\": null,\n\t\"_percentSuffix\": \"%\",\n\n\t// Suffixes for numbers\n\t// When formatting numbers, big or small numers might be reformatted to\n\t// shorter version, by applying a suffix.\n\t// \n\t// For example, 1000000 might become \"1m\".\n\t// Or 1024 might become \"1KB\" if we're formatting byte numbers.\n\t// \n\t// This section defines such suffixes for all such cases.\n\t\"_big_number_suffix_3\": \"k\",\n\t\"_big_number_suffix_6\": \"M\",\n\t\"_big_number_suffix_9\": \"G\",\n\t\"_big_number_suffix_12\": \"T\",\n\t\"_big_number_suffix_15\": \"P\",\n\t\"_big_number_suffix_18\": \"E\",\n\t\"_big_number_suffix_21\": \"Z\",\n\t\"_big_number_suffix_24\": \"Y\",\n\n\t\"_small_number_suffix_3\": \"m\",\n\t\"_small_number_suffix_6\": \"\",\n\t\"_small_number_suffix_9\": \"n\",\n\t\"_small_number_suffix_12\": \"p\",\n\t\"_small_number_suffix_15\": \"f\",\n\t\"_small_number_suffix_18\": \"a\",\n\t\"_small_number_suffix_21\": \"z\",\n\t\"_small_number_suffix_24\": \"y\",\n\n\t\"_byte_suffix_B\": \"B\",\n\t\"_byte_suffix_KB\": \"KB\",\n\t\"_byte_suffix_MB\": \"MB\",\n\t\"_byte_suffix_GB\": \"GB\",\n\t\"_byte_suffix_TB\": \"TB\",\n\t\"_byte_suffix_PB\": \"PB\",\n\n\t// Default date formats for various periods.\n\t// \n\t// This should reflect official or de facto formatting universally accepted\n\t// in the country translation is being made for\n\t// Available format codes here:\n\t// https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/#Format_codes\n\t// \n\t// This will be used when formatting date/time for particular granularity,\n\t// e.g. \"_date_hour\" will be shown whenever we need to show time as hours.\n\t// \n\t// \"date\" is used as in default date format when showing standalone dates.\n\t\"_date\": \"yyyy-MM-dd\",\n\t\"_date_millisecond\": \"mm:ss SSS\",\n\t\"_date_millisecond_full\": \"HH:mm:ss SSS\",\n\t\"_date_second\": \"HH:mm:ss\",\n\t\"_date_second_full\": \"HH:mm:ss\",\n\t\"_date_minute\": \"HH:mm\",\n\t\"_date_minute_full\": \"HH:mm - MMM dd, yyyy\",\n\t\"_date_hour\": \"HH:mm\",\n\t\"_date_hour_short\": \"HH\",\n\t\"_date_hour_full\": \"HH:mm - MMM dd, yyyy\",\n\t\"_date_day\": \"MMM dd\",\n\t\"_date_day_full\": \"MMM dd, yyyy\",\n\t\"_date_week\": \"ww\",\n\t\"_date_week_full\": \"MMM dd, yyyy\",\n\t\"_date_month\": \"MMM\",\n\t\"_date_month_full\": \"MMM, yyyy\",\n\t\"_date_year\": \"yyyy\",\n\n\t// Default duration formats for various base units.\n\t// \n\t// This will be used by DurationFormatter to format numeric values into\n\t// duration.\n\t// \n\t// Notice how each duration unit comes in several versions. This is to ensure\n\t// that each base unit is shown correctly.\n\t// \n\t// For example, if we have baseUnit set to \"second\", meaning our duration is\n\t// in seconds.\n\t// \n\t// If we pass in `50` to formatter, it will know that we have just 50 seconds\n\t// (less than a minute) so it will use format in `\"_duration_second\"` (\"ss\"),\n\t// and the formatted result will be in like `\"50\"`.\n\t// \n\t// If we pass in `70`, which is more than a minute, the formatter will switch\n\t// to `\"_duration_second_minute\"` (\"mm:ss\"), resulting in \"01:10\" formatted\n\t// text.\n\t// \n\t// Available codes here:\n\t// https://www.amcharts.com/docs/v4/concepts/formatters/formatting-duration/#Available_Codes\n\t\"_duration_millisecond\": \"SSS\",\n\t\"_duration_millisecond_second\": \"ss.SSS\",\n\t\"_duration_millisecond_minute\": \"mm:ss SSS\",\n\t\"_duration_millisecond_hour\": \"hh:mm:ss SSS\",\n\t\"_duration_millisecond_day\": \"d'd' mm:ss SSS\",\n\t\"_duration_millisecond_week\": \"d'd' mm:ss SSS\",\n\t\"_duration_millisecond_month\": \"M'm' dd'd' mm:ss SSS\",\n\t\"_duration_millisecond_year\": \"y'y' MM'm' dd'd' mm:ss SSS\",\n\n\t\"_duration_second\": \"ss\",\n\t\"_duration_second_minute\": \"mm:ss\",\n\t\"_duration_second_hour\": \"hh:mm:ss\",\n\t\"_duration_second_day\": \"d'd' hh:mm:ss\",\n\t\"_duration_second_week\": \"d'd' hh:mm:ss\",\n\t\"_duration_second_month\": \"M'm' dd'd' hh:mm:ss\",\n\t\"_duration_second_year\": \"y'y' MM'm' dd'd' hh:mm:ss\",\n\n\t\"_duration_minute\": \"mm\",\n\t\"_duration_minute_hour\": \"hh:mm\",\n\t\"_duration_minute_day\": \"d'd' hh:mm\",\n\t\"_duration_minute_week\": \"d'd' hh:mm\",\n\t\"_duration_minute_month\": \"M'm' dd'd' hh:mm\",\n\t\"_duration_minute_year\": \"y'y' MM'm' dd'd' hh:mm\",\n\n\t\"_duration_hour\": \"hh'h'\",\n\t\"_duration_hour_day\": \"d'd' hh'h'\",\n\t\"_duration_hour_week\": \"d'd' hh'h'\",\n\t\"_duration_hour_month\": \"M'm' dd'd' hh'h'\",\n\t\"_duration_hour_year\": \"y'y' MM'm' dd'd' hh'h'\",\n\n\t\"_duration_day\": \"d'd'\",\n\t\"_duration_day_week\": \"d'd'\",\n\t\"_duration_day_month\": \"M'm' dd'd'\",\n\t\"_duration_day_year\": \"y'y' MM'm' dd'd'\",\n\n\t\"_duration_week\": \"w'w'\",\n\t\"_duration_week_month\": \"w'w'\",\n\t\"_duration_week_year\": \"w'w'\",\n\n\t\"_duration_month\": \"M'm'\",\n\t\"_duration_month_year\": \"y'y' MM'm'\",\n\n\t\"_duration_year\": \"y'y'\",\n\n\t// Era translations\n\t\"_era_ad\": \"AD\",\n\t\"_era_bc\": \"BC\",\n\n\t// Day part, used in 12-hour formats, e.g. 5 P.M.\n\t// Please note that these come in 3 variants:\n\t// * one letter (e.g. \"A\")\n\t// * two letters (e.g. \"AM\")\n\t// * two letters with dots (e.g. \"A.M.\")\n\t// \n\t// All three need to to be translated even if they are all the same. Some\n\t// users might use one, some the other.\n\t\"A\": \"\",\n\t\"P\": \"\",\n\t\"AM\": \"\",\n\t\"PM\": \"\",\n\t\"A.M.\": \"\",\n\t\"P.M.\": \"\",\n\n\t// Date-related stuff.\n\t// \n\t// When translating months, if there's a difference, use the form which is\n\t// best for a full date, e.g. as you would use it in \"2018 January 1\".\n\t// \n\t// Note that May is listed twice. This is because in English May is the same\n\t// in both long and short forms, while in other languages it may not be the\n\t// case. Translate \"May\" to full word, while \"May(short)\" to shortened\n\t// version.\n\t// \n\t// Should month names and weekdays be capitalized or not?\n\t// \n\t// Rule of thumb is this: if the names should always be capitalized,\n\t// regardless of name position within date (\"January\", \"21st January 2018\",\n\t// etc.) use capitalized names. Otherwise enter all lowercase.\n\t// \n\t// The date formatter will automatically capitalize names if they are the\n\t// first (or only) word in resulting date.\n\t\"January\": \"\",\n\t\"February\": \"\",\n\t\"March\": \"\",\n\t\"April\": \"\",\n\t\"May\": \"\",\n\t\"June\": \"\",\n\t\"July\": \"\",\n\t\"August\": \"\",\n\t\"September\": \"\",\n\t\"October\": \"\",\n\t\"November\": \"\",\n\t\"December\": \"\",\n\t\"Jan\": \"\",\n\t\"Feb\": \"\",\n\t\"Mar\": \"\",\n\t\"Apr\": \"\",\n\t\"May(short)\": \"May\",\n\t\"Jun\": \"\",\n\t\"Jul\": \"\",\n\t\"Aug\": \"\",\n\t\"Sep\": \"\",\n\t\"Oct\": \"\",\n\t\"Nov\": \"\",\n\t\"Dec\": \"\",\n\n\t// Weekdays.\n\t\"Sunday\": \"\",\n\t\"Monday\": \"\",\n\t\"Tuesday\": \"\",\n\t\"Wednesday\": \"\",\n\t\"Thursday\": \"\",\n\t\"Friday\": \"\",\n\t\"Saturday\": \"\",\n\t\"Sun\": \"\",\n\t\"Mon\": \"\",\n\t\"Tue\": \"\",\n\t\"Wed\": \"\",\n\t\"Thu\": \"\",\n\t\"Fri\": \"\",\n\t\"Sat\": \"\",\n\n\t// Date ordinal function.\n\t// \n\t// This is used when adding number ordinal when formatting days in dates.\n\t// \n\t// E.g. \"January 1st\", \"February 2nd\".\n\t// \n\t// The function accepts day number, and returns a string to be added to the\n\t// day, like in default English translation, if we pass in 2, we will receive\n\t// \"nd\" back.\n\t\"_dateOrd\": function(day: number): string {\n\t\tlet res = \"th\";\n\t\tif ((day < 11) || (day > 13)) {\n\t\t\tswitch (day % 10) {\n\t\t\t\tcase 1:\n\t\t\t\t\tres = \"st\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 2:\n\t\t\t\t\tres = \"nd\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 3:\n\t\t\t\t\tres = \"rd\"\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t},\n\n\t// Various chart controls.\n\t// Shown as a tooltip on zoom out button.\n\t\"Zoom Out\": \"\",\n\n\t// Timeline buttons\n\t\"Play\": \"\",\n\t\"Stop\": \"\",\n\n\t// Chart's Legend screen reader title.\n\t\"Legend\": \"\",\n\n\t// Legend's item screen reader indicator.\n\t\"Press ENTER to toggle\": \"\",\n\n\t// Shown when the chart is busy loading something.\n\t\"Loading\": \"\",\n\n\t// Shown as the first button in the breadcrumb navigation, e.g.:\n\t// Home > First level > ...\n\t\"Home\": \"\",\n\n\t// Chart types.\n\t// Those are used as default screen reader titles for the main chart element\n\t// unless developer has set some more descriptive title.\n\t\"Chart\": \"\",\n\t\"Serial chart\": \"\",\n\t\"X/Y chart\": \"\",\n\t\"Pie chart\": \"\",\n\t\"Gauge chart\": \"\",\n\t\"Radar chart\": \"\",\n\t\"Sankey diagram\": \"\",\n\t\"Flow diagram\": \"\",\n\t\"Chord diagram\": \"\",\n\t\"TreeMap chart\": \"\",\n\t\"Force directed tree\": \"\",\n\t\"Sliced chart\": \"\",\n\n\t// Series types.\n\t// Used to name series by type for screen readers if they do not have their\n\t// name set.\n\t\"Series\": \"\",\n\t\"Candlestick Series\": \"\",\n\t\"OHLC Series\": \"\",\n\t\"Column Series\": \"\",\n\t\"Line Series\": \"\",\n\t\"Pie Slice Series\": \"\",\n\t\"Funnel Series\": \"\",\n\t\"Pyramid Series\": \"\",\n\t\"X/Y Series\": \"\",\n\n\t// Map-related stuff.\n\t\"Map\": \"\",\n\t\"Press ENTER to zoom in\": \"\",\n\t\"Press ENTER to zoom out\": \"\",\n\t\"Use arrow keys to zoom in and out\": \"\",\n\t\"Use plus and minus keys on your keyboard to zoom in and out\": \"\",\n\n\t// Export-related stuff.\n\t// These prompts are used in Export menu labels.\n\t// \n\t// \"Export\" is the top-level menu item.\n\t// \n\t// \"Image\", \"Data\", \"Print\" as second-level indicating type of export\n\t// operation.\n\t// \n\t// Leave actual format untranslated, unless you absolutely know that they\n\t// would convey more meaning in some other way.\n\t\"Export\": \"\",\n\t\"Image\": \"\",\n\t\"Data\": \"\",\n\t\"Print\": \"\",\n\t\"Press ENTER or use arrow keys to navigate\": \"\",\n\t\"Press ENTER to open\": \"\",\n\t\"Press ENTER to print.\": \"\",\n\t\"Press ENTER to export as %1.\": \"\",\n\t\"(Press ESC to close this message)\": \"\",\n\t\"Image Export Complete\": \"\",\n\t\"Export operation took longer than expected. Something might have gone wrong.\": \"\",\n\t\"Saved from\": \"\",\n\t\"PNG\": \"\",\n\t\"JPG\": \"\",\n\t\"GIF\": \"\",\n\t\"SVG\": \"\",\n\t\"PDF\": \"\",\n\t\"JSON\": \"\",\n\t\"CSV\": \"\",\n\t\"XLSX\": \"\",\n\t\"HTML\": \"\",\n\n\t// Scrollbar-related stuff.\n\t// \n\t// Scrollbar is a control which can zoom and pan the axes on the chart.\n\t// \n\t// Each scrollbar has two grips: left or right (for horizontal scrollbar) or\n\t// upper and lower (for vertical one).\n\t// \n\t// Prompts change in relation to whether Scrollbar is vertical or horizontal.\n\t// \n\t// The final section is used to indicate the current range of selection.\n\t\"Use TAB to select grip buttons or left and right arrows to change selection\": \"\",\n\t\"Use left and right arrows to move selection\": \"\",\n\t\"Use left and right arrows to move left selection\": \"\",\n\t\"Use left and right arrows to move right selection\": \"\",\n\t\"Use TAB select grip buttons or up and down arrows to change selection\": \"\",\n\t\"Use up and down arrows to move selection\": \"\",\n\t\"Use up and down arrows to move lower selection\": \"\",\n\t\"Use up and down arrows to move upper selection\": \"\",\n\t\"From %1 to %2\": \"\",\n\t\"From %1\": \"\",\n\t\"To %1\": \"\",\n\n\t// Data loader-related.\n\t\"No parser available for file: %1\": \"\",\n\t\"Error parsing file: %1\": \"\",\n\t\"Unable to load file: %1\": \"\",\n\t\"Invalid date\": \"\",\n\n\t// Common actions\n\t\"Close\": \"\",\n\t\"Minimize\": \"\",\n\t\"Confirm\": \"\"\n\n};","import { Entity, IEntitySettings, IEntityPrivate } from \"./Entity\"\nimport * as $array from \"./Array\"\nimport * as $object from \"./Object\"\nimport en from \"../../../locales/en\";\n\n/**\n * Defines properties that exist for the locale.\n *\n * @ignore\n */\nexport interface ILocaleSettings {\n\t\"firstDayOfWeek\"?: number,\n\n\t// number formatter related\n\t\"_decimalSeparator\"?: string;\n\t\"_thousandSeparator\"?: string;\n\n\t\"_percentPrefix\"?: string | null;\n\t\"_percentSuffix\"?: string | null;\n\n\t\"_big_number_suffix_3\"?: string;\n\t\"_big_number_suffix_6\"?: string;\n\t\"_big_number_suffix_9\"?: string;\n\t\"_big_number_suffix_12\"?: string;\n\t\"_big_number_suffix_15\"?: string;\n\t\"_big_number_suffix_18\"?: string;\n\t\"_big_number_suffix_21\"?: string;\n\t\"_big_number_suffix_24\"?: string;\n\n\t\"_small_number_suffix_24\"?: string;\n\t\"_small_number_suffix_21\"?: string;\n\t\"_small_number_suffix_18\"?: string;\n\t\"_small_number_suffix_15\"?: string;\n\t\"_small_number_suffix_12\"?: string;\n\t\"_small_number_suffix_9\"?: string;\n\t\"_small_number_suffix_6\"?: string;\n\t\"_small_number_suffix_3\"?: string;\n\n\t\"_byte_suffix_B\"?: string;\n\t\"_byte_suffix_KB\"?: string;\n\t\"_byte_suffix_MB\"?: string;\n\t\"_byte_suffix_GB\"?: string;\n\t\"_byte_suffix_TB\"?: string;\n\t\"_byte_suffix_PB\"?: string;\n\n\t// Default date formats for various periods\n\t\"_date\"?: string;\n\t\"_date_millisecond\"?: string;\n\t\"_date_millisecond_full\"?: string;\n\t\"_date_second\"?: string;\n\t\"_date_second_full\"?: string;\n\t\"_date_minute\"?: string;\n\t\"_date_minute_full\"?: string;\n\t\"_date_hour\"?: string;\n\t\"_date_hour_short\"?: string;\n\t\"_date_hour_full\"?: string;\n\t\"_date_day\"?: string;\n\t\"_date_day_full\"?: string;\n\t\"_date_week\"?: string;\n\t\"_date_week_full\"?: string;\n\t\"_date_month\"?: string;\n\t\"_date_month_full\"?: string;\n\t\"_date_year\"?: string;\n\n\t// Default duration formats for various base units\n\t\"_duration_millisecond\"?: string;\n\t\"_duration_millisecond_second\"?: string;\n\t\"_duration_millisecond_minute\"?: string;\n\t\"_duration_millisecond_hour\"?: string;\n\t\"_duration_millisecond_day\"?: string;\n\t\"_duration_millisecond_week\"?: string;\n\t\"_duration_millisecond_month\"?: string;\n\t\"_duration_millisecond_year\"?: string;\n\n\t\"_duration_second\"?: string;\n\t\"_duration_second_minute\"?: string;\n\t\"_duration_second_hour\"?: string;\n\t\"_duration_second_day\"?: string;\n\t\"_duration_second_week\"?: string;\n\t\"_duration_second_month\"?: string;\n\t\"_duration_second_year\"?: string;\n\n\t\"_duration_minute\"?: string;\n\t\"_duration_minute_hour\"?: string;\n\t\"_duration_minute_day\"?: string;\n\t\"_duration_minute_week\"?: string;\n\t\"_duration_minute_month\"?: string;\n\t\"_duration_minute_year\"?: string;\n\n\t\"_duration_hour\"?: string;\n\t\"_duration_hour_day\"?: string;\n\t\"_duration_hour_week\"?: string;\n\t\"_duration_hour_month\"?: string;\n\t\"_duration_hour_year\"?: string;\n\n\t\"_duration_day\"?: string;\n\t\"_duration_day_week\"?: string;\n\t\"_duration_day_month\"?: string;\n\t\"_duration_day_year\"?: string;\n\n\t\"_duration_week\"?: string;\n\t\"_duration_week_month\"?: string;\n\t\"_duration_week_year\"?: string;\n\n\t\"_duration_month\"?: string;\n\t\"_duration_month_year\"?: string;\n\n\t\"_duration_year\"?: string;\n\n\t// Era\n\t\"_era_ad\"?: string;\n\t\"_era_bc\"?: string;\n\n\t// Period\n\t\"A\"?: string;\n\t\"P\"?: string;\n\t\"AM\"?: string;\n\t\"PM\"?: string;\n\t\"A.M.\"?: string;\n\t\"P.M.\"?: string;\n\n\t// Dates\n\t\"January\"?: string;\n\t\"February\"?: string;\n\t\"March\"?: string;\n\t\"April\"?: string;\n\t\"May\"?: string;\n\t\"June\"?: string;\n\t\"July\"?: string;\n\t\"August\"?: string;\n\t\"September\"?: string;\n\t\"October\"?: string;\n\t\"November\"?: string;\n\t\"December\"?: string;\n\t\"Jan\"?: string;\n\t\"Feb\"?: string;\n\t\"Mar\"?: string;\n\t\"Apr\"?: string;\n\t\"May(short)\"?: string;\n\t\"Jun\"?: string;\n\t\"Jul\"?: string;\n\t\"Aug\"?: string;\n\t\"Sep\"?: string;\n\t\"Oct\"?: string;\n\t\"Nov\"?: string;\n\t\"Dec\"?: string;\n\t\"Sunday\"?: string;\n\t\"Monday\"?: string;\n\t\"Tuesday\"?: string;\n\t\"Wednesday\"?: string;\n\t\"Thursday\"?: string;\n\t\"Friday\"?: string;\n\t\"Saturday\"?: string;\n\t\"Sun\"?: string;\n\t\"Mon\"?: string;\n\t\"Tue\"?: string;\n\t\"Wed\"?: string;\n\t\"Thu\"?: string;\n\t\"Fri\"?: string;\n\t\"Sat\"?: string;\n\n\t// Chart elements\n\t\"Zoom Out\"?: string;\n\t\"Play\"?: string;\n\t\"Stop\"?: string;\n\t\"Legend\"?: string;\n\t\"Press ENTER to toggle\"?: string;\n\t\"Loading\"?: string;\n\t\"%1 shown\"?: string;\n\t\"%1 hidden\"?: string;\n\n\t// Chart types\n\t\"Chart\"?: string;\n\t\"Serial chart\"?: string;\n\t\"X/Y chart\"?: string;\n\t\"Pie chart\"?: string;\n\t\"Sunburst chart\"?: string;\n\t\"Gauge chart\"?: string;\n\t\"Radar chart\"?: string;\n\t\"Sankey diagram\"?: string;\n\t\"Flow diagram\"?: string;\n\t\"Chord diagram\"?: string;\n\t\"TreeMap chart\"?: string;\n\t\"Force directed tree\"?: string;\n\t\"Sliced chart\"?: string;\n\n\t// Series types\n\t\"Series\"?: string;\n\t\"Candlestick Series\"?: string;\n\t\"OHLC Series\"?: string;\n\t\"Column Series\"?: string;\n\t\"Line Series\"?: string;\n\t\"Pie Slice Series\"?: string;\n\t\"Funnel Series\"?: string;\n\t\"Pyramid Series\"?: string;\n\t\"X/Y Series\"?: string;\n\n\t// Map-related\n\t\"Map\"?: string;\n\t\"Press ENTER to zoom in\"?: string;\n\t\"Press ENTER to zoom out\"?: string;\n\t\"Use arrow keys to zoom in and out\"?: string;\n\t\"Use plus and minus keys on your keyboard to zoom in and out\"?: string;\n\t\"Home\"?: string;\n\t\"Zoom level changed to %1\"?: string;\n\n\t// Export-related\n\t\"Export\"?: string;\n\t\"Image\"?: string;\n\t\"Data\"?: string;\n\t\"Print\"?: string;\n\t\"Press ENTER or use arrow keys to navigate\"?: string;\n\t\"Press ENTER to open\"?: string;\n\t\"Press ENTER to print.\"?: string;\n\t\"Press ENTER to export as %1.\"?: string;\n\t\"(Press ESC to close this message)\"?: string;\n\t\"Image Export Complete\"?: string;\n\t\"Export operation took longer than expected. Something might have gone wrong.\"?: string;\n\t\"Saved from\"?: string;\n\t\"PNG\"?: string;\n\t\"JPG\"?: string;\n\t\"GIF\"?: string;\n\t\"SVG\"?: string;\n\t\"PDF\"?: string;\n\t\"JSON\"?: string;\n\t\"CSV\"?: string;\n\t\"XLSX\"?: string;\n\t\"HTML\"?: string;\n\n\t// Scrollbar-related\n\t\"Use TAB to select grip buttons or left and right arrows to change selection\"?: string;\n\t\"Use left and right arrows to move selection\"?: string;\n\t\"Use left and right arrows to move left selection\"?: string;\n\t\"Use left and right arrows to move right selection\"?: string;\n\t\"Use TAB select grip buttons or up and down arrows to change selection\"?: string;\n\t\"Use up and down arrows to move selection\"?: string;\n\t\"Use up and down arrows to move lower selection\"?: string;\n\t\"Use up and down arrows to move upper selection\"?: string;\n\t\"From %1 to %2\"?: string;\n\t\"From %1\"?: string;\n\t\"To %1\"?: string;\n\n\t// Data loader-related\n\t\"No parser available for file: %1\"?: string;\n\t\"Error parsing file: %1\"?: string;\n\t\"Unable to load file: %1\"?: string;\n\t\"Invalid date\"?: string;\n\n\t// Common actions\n\t\"Close\"?: string;\n\t\"Minimize\"?: string;\n\t\"Confirm\"?: string;\n\n\t\"Venn Series\"?: string;\n\t\"Venn Diagram\"?: string;\n\n}\n\n/**\n * Defines functions that exist for the locale.\n *\n * @ignore\n */\nexport interface ILocaleFunctions {\n\t// ordinal function\n\t\"_dateOrd\": (day: number) => string;\n}\n\n/**\n * Defines all of the defaults for locale properties.\n * @ignore\n */\nexport interface ILocaleDefault extends ILocaleSettings, ILocaleFunctions { }\n\n/**\n * Defines locale interface.\n *\n * @ignore\n */\nexport interface ILocale extends Partial<ILocaleDefault> { };\n\nexport interface ILanguageSettings extends IEntitySettings {\n}\n\nexport interface ILanguagePrivate extends IEntityPrivate {\n\n\t/**\n\t * A locale for International English (default).\n\t */\n\tdefaultLocale: ILocale;\n\n}\n\n/**\n * Add localization functionality.\n */\nexport class Language extends Entity {\n\tdeclare public _settings: ILanguageSettings;\n\tdeclare public _privateSettings: ILanguagePrivate;\n\n\tprotected _setDefaults() {\n\t\tthis.setPrivate(\"defaultLocale\", en);\n\t\tsuper._setDefaults();\n\t}\n\n\t/**\n\t * Returns a prompt translation.\n\t * \n\t * @param   prompt   Prompt to translate\n\t * @param   locale   Target locale\n\t * @param   ...rest  Parameters\n\t * @return           Translation\n\t */\n\tpublic translate<Key extends keyof ILocaleSettings>(prompt: Key, locale?: ILocale, ...rest: Array<string>): string {\n\n\t\t// Get langauge\n\t\tif (!locale) {\n\t\t\tlocale = this._root.locale || this.getPrivate(\"defaultLocale\");\n\t\t}\n\n\t\t// Init translation\n\t\tlet translation: string = prompt;\n\t\tlet value = locale[prompt];\n\n\t\t// Try to look for the translation\n\t\tif (value === null) {\n\t\t\ttranslation = \"\";\n\t\t}\n\t\telse if (value != null) {\n\t\t\t// It might be an empty string\n\t\t\tif (value) {\n\t\t\t\ttranslation = <string>value!;\n\t\t\t}\n\t\t}\n\t\telse if (locale !== this.getPrivate(\"defaultLocale\")) {\n\t\t\t// Try to look in default language\n\t\t\treturn this.translate(prompt, this.getPrivate(\"defaultLocale\"), ...rest);\n\t\t}\n\n\t\t// Replace %1, %2, etc params\n\t\tif (rest.length) {\n\t\t\tfor (let len = rest.length, i = 0; i < len; ++i) {\n\t\t\t\ttranslation = translation.split(\"%\" + (i + 1)).join(rest[i]);\n\t\t\t}\n\t\t}\n\n\t\t// Return the translation\n\t\treturn translation;\n\t}\n\n\t/**\n\t * Returns a prompt translation, including custom prompts.\n\t * \n\t * @param   prompt   Prompt to translate\n\t * @param   locale   Target locale\n\t * @param   ...rest  Parameters\n\t * @return           Translation\n\t */\n\tpublic translateAny(prompt: string, locale?: ILocale, ...rest: Array<string>): string {\n\t\treturn this.translate(<any>prompt, locale, ...rest);\n\t}\n\n\t/**\n\t * Add a custom prompt to locale.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/creating-translations/#Extending_locale_with_custom_prompts}\n\t * @param  prompt       Source prompt\n\t * @param  translation  Tanslation\n\t * @param  locale       Target locale\n\t */\n\tpublic setTranslationAny(prompt: string, translation: string, locale?: ILocale): void {\n\t\tconst localeTarget = locale || this._root.locale;\n\t\t(<any>localeTarget)[prompt] = translation;\n\t}\n\n\t/**\n\t * Add a batch of custom prompts.\n\t *\n\t * @since 5.3.3\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/creating-translations/#Extending_locale_with_custom_prompts}\n\t * @param  translations  Translations\n\t * @param  locale        Target locale\n\t */\n\tpublic setTranslationsAny(translations: { [index: string]: any }, locale?: ILocale): void {\n\t\t$object.each(translations, (key, val) => {\n\t\t\tthis.setTranslationAny(key as string, val, locale);\n\t\t});\n\t}\n\n\tpublic translateEmpty<Key extends keyof ILocaleSettings>(prompt: Key, locale?: ILocale, ...rest: Array<string>): string {\n\t\tlet translation = this.translate(prompt, locale, ...rest);\n\t\treturn translation == prompt ? \"\" : translation;\n\t}\n\n\tpublic translateFunc<Key extends keyof ILocaleFunctions>(prompt: Key, locale?: ILocale): ILocaleFunctions[Key] {\n\n\t\tif ((<any>this._root.locale)[prompt]) {\n\t\t\treturn (<any>this._root.locale)[prompt];\n\t\t}\n\n\t\t// Try to look in default language\n\t\tif (locale !== this.getPrivate(\"defaultLocale\")) {\n\t\t\treturn this.translateFunc(prompt, this.getPrivate(\"defaultLocale\"));\n\t\t}\n\n\t\t// Fail - return empty function\n\t\treturn (): string => {\n\t\t\treturn \"\";\n\t\t};\n\t}\n\n\t/**\n\t * Translates a btach of prompts.\n\t * \n\t * @param  list    Array of prompts to translate\n\t * @param  locale  Target locale\n\t * @return         Array of translations\n\t */\n\tpublic translateAll<Key extends keyof ILocaleSettings>(list: Array<Key>, locale?: ILocale): Array<string> {\n\t\t// Translate all items in the list\n\t\tif (!this.isDefault()) {\n\t\t\treturn $array.map(list, (x) => this.translate(x, locale));\n\n\t\t} else {\n\t\t\treturn list;\n\t\t}\n\t}\n\n\t/**\n\t * Returns `true` if the currently selected locale is a default locale.\n\t *\n\t * @return `true` if locale is default; `false` if it is not.\n\t */\n\tpublic isDefault(): boolean {\n\t\treturn this.getPrivate(\"defaultLocale\") === this._root.locale;\n\t}\n\n}\n","/**\n * Modified from Pixi:\n *\n * The MIT License\n *\n * Copyright (c) 2013-2017 Mathew Groves, Chad Engler\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nimport type { IPoint } from \"./IPoint\";\n\n/**\n * @ignore\n */\nexport class Matrix {\n\tpublic a: number;\n\tpublic b: number;\n\tpublic c: number;\n\tpublic d: number;\n\tpublic tx: number;\n\tpublic ty: number;\n\n\tconstructor(a = 1, b = 0, c = 0, d = 1, tx = 0, ty = 0) {\n\t\tthis.a = a;\n\t\tthis.b = b;\n\t\tthis.c = c;\n\t\tthis.d = d;\n\t\tthis.tx = tx;\n\t\tthis.ty = ty;\n\t}\n\n\t/**\n\t * Sets the matrix based on all the available properties\n\t */\n\tsetTransform(x: number, y: number, pivotX: number, pivotY: number, rotation: number, scale: number = 1): void {\n\t\tthis.a = Math.cos(rotation) * scale;\n\t\tthis.b = Math.sin(rotation) * scale;\n\t\tthis.c = -Math.sin(rotation) * scale;\n\t\tthis.d = Math.cos(rotation) * scale;\n\t\tthis.tx = x - ((pivotX * this.a) + (pivotY * this.c));\n\t\tthis.ty = y - ((pivotX * this.b) + (pivotY * this.d));\n\t}\n\n\t/**\n\t * Get a new position with the current transformation applied.\n\t * Can be used to go from a child's coordinate space to the world coordinate space. (e.g. rendering)\n\t */\n\tapply(origin: IPoint): IPoint {\n\t\treturn {\n\t\t\tx: (this.a * origin.x) + (this.c * origin.y) + this.tx,\n\t\t\ty: (this.b * origin.x) + (this.d * origin.y) + this.ty\n\t\t};\n\t}\n\n\t/**\n\t * Get a new position with the inverse of the current transformation applied.\n\t * Can be used to go from the world coordinate space to a child's coordinate space. (e.g. input)\n\t */\n\tapplyInverse(origin: IPoint): IPoint {\n\t\tconst id = 1 / ((this.a * this.d) + (this.c * -this.b));\n\n\t\treturn {\n\t\t\tx: (this.d * id * origin.x) + (-this.c * id * origin.y) + (((this.ty * this.c) - (this.tx * this.d)) * id),\n\t\t\ty: (this.a * id * origin.y) + (-this.b * id * origin.x) + (((-this.ty * this.a) + (this.tx * this.b)) * id)\n\t\t};\n\t}\n\n\t/**\n\t * Appends the given Matrix to this Matrix.\n\t */\n\tappend(matrix: Matrix): void {\n\t\tconst a1 = this.a;\n\t\tconst b1 = this.b;\n\t\tconst c1 = this.c;\n\t\tconst d1 = this.d;\n\t\tthis.a = (matrix.a * a1) + (matrix.b * c1);\n\t\tthis.b = (matrix.a * b1) + (matrix.b * d1);\n\t\tthis.c = (matrix.c * a1) + (matrix.d * c1);\n\t\tthis.d = (matrix.c * b1) + (matrix.d * d1);\n\t\tthis.tx = (matrix.tx * a1) + (matrix.ty * c1) + this.tx;\n\t\tthis.ty = (matrix.tx * b1) + (matrix.ty * d1) + this.ty;\n\t}\n\n\t/**\n\t * Prepends the given Matrix to this Matrix.\n\t */\n\tprepend(matrix: Matrix): void {\n\t\tconst tx1 = this.tx;\n\t\tif (matrix.a !== 1 || matrix.b !== 0 || matrix.c !== 0 || matrix.d !== 1) {\n\t\t\tconst a1 = this.a;\n\t\t\tconst c1 = this.c;\n\t\t\tthis.a = (a1 * matrix.a) + (this.b * matrix.c);\n\t\t\tthis.b = (a1 * matrix.b) + (this.b * matrix.d);\n\t\t\tthis.c = (c1 * matrix.a) + (this.d * matrix.c);\n\t\t\tthis.d = (c1 * matrix.b) + (this.d * matrix.d);\n\t\t}\n\t\tthis.tx = (tx1 * matrix.a) + (this.ty * matrix.c) + matrix.tx;\n\t\tthis.ty = (tx1 * matrix.b) + (this.ty * matrix.d) + matrix.ty;\n\t}\n\n\t/**\n\t * Copies the other matrix's properties into this matrix\n\t */\n\tcopyFrom(matrix: Matrix): void {\n\t\tthis.a = matrix.a;\n\t\tthis.b = matrix.b;\n\t\tthis.c = matrix.c;\n\t\tthis.d = matrix.d;\n\t\tthis.tx = matrix.tx;\n\t\tthis.ty = matrix.ty;\n\t}\n}\n\n","var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar TAU = Math.PI * 2;\n\nvar mapToEllipse = function mapToEllipse(_ref, rx, ry, cosphi, sinphi, centerx, centery) {\n  var x = _ref.x,\n      y = _ref.y;\n\n  x *= rx;\n  y *= ry;\n\n  var xp = cosphi * x - sinphi * y;\n  var yp = sinphi * x + cosphi * y;\n\n  return {\n    x: xp + centerx,\n    y: yp + centery\n  };\n};\n\nvar approxUnitArc = function approxUnitArc(ang1, ang2) {\n  // If 90 degree circular arc, use a constant\n  // as derived from http://spencermortensen.com/articles/bezier-circle\n  var a = ang2 === 1.5707963267948966 ? 0.551915024494 : ang2 === -1.5707963267948966 ? -0.551915024494 : 4 / 3 * Math.tan(ang2 / 4);\n\n  var x1 = Math.cos(ang1);\n  var y1 = Math.sin(ang1);\n  var x2 = Math.cos(ang1 + ang2);\n  var y2 = Math.sin(ang1 + ang2);\n\n  return [{\n    x: x1 - y1 * a,\n    y: y1 + x1 * a\n  }, {\n    x: x2 + y2 * a,\n    y: y2 - x2 * a\n  }, {\n    x: x2,\n    y: y2\n  }];\n};\n\nvar vectorAngle = function vectorAngle(ux, uy, vx, vy) {\n  var sign = ux * vy - uy * vx < 0 ? -1 : 1;\n\n  var dot = ux * vx + uy * vy;\n\n  if (dot > 1) {\n    dot = 1;\n  }\n\n  if (dot < -1) {\n    dot = -1;\n  }\n\n  return sign * Math.acos(dot);\n};\n\nvar getArcCenter = function getArcCenter(px, py, cx, cy, rx, ry, largeArcFlag, sweepFlag, sinphi, cosphi, pxp, pyp) {\n  var rxsq = Math.pow(rx, 2);\n  var rysq = Math.pow(ry, 2);\n  var pxpsq = Math.pow(pxp, 2);\n  var pypsq = Math.pow(pyp, 2);\n\n  var radicant = rxsq * rysq - rxsq * pypsq - rysq * pxpsq;\n\n  if (radicant < 0) {\n    radicant = 0;\n  }\n\n  radicant /= rxsq * pypsq + rysq * pxpsq;\n  radicant = Math.sqrt(radicant) * (largeArcFlag === sweepFlag ? -1 : 1);\n\n  var centerxp = radicant * rx / ry * pyp;\n  var centeryp = radicant * -ry / rx * pxp;\n\n  var centerx = cosphi * centerxp - sinphi * centeryp + (px + cx) / 2;\n  var centery = sinphi * centerxp + cosphi * centeryp + (py + cy) / 2;\n\n  var vx1 = (pxp - centerxp) / rx;\n  var vy1 = (pyp - centeryp) / ry;\n  var vx2 = (-pxp - centerxp) / rx;\n  var vy2 = (-pyp - centeryp) / ry;\n\n  var ang1 = vectorAngle(1, 0, vx1, vy1);\n  var ang2 = vectorAngle(vx1, vy1, vx2, vy2);\n\n  if (sweepFlag === 0 && ang2 > 0) {\n    ang2 -= TAU;\n  }\n\n  if (sweepFlag === 1 && ang2 < 0) {\n    ang2 += TAU;\n  }\n\n  return [centerx, centery, ang1, ang2];\n};\n\nvar arcToBezier = function arcToBezier(_ref2) {\n  var px = _ref2.px,\n      py = _ref2.py,\n      cx = _ref2.cx,\n      cy = _ref2.cy,\n      rx = _ref2.rx,\n      ry = _ref2.ry,\n      _ref2$xAxisRotation = _ref2.xAxisRotation,\n      xAxisRotation = _ref2$xAxisRotation === undefined ? 0 : _ref2$xAxisRotation,\n      _ref2$largeArcFlag = _ref2.largeArcFlag,\n      largeArcFlag = _ref2$largeArcFlag === undefined ? 0 : _ref2$largeArcFlag,\n      _ref2$sweepFlag = _ref2.sweepFlag,\n      sweepFlag = _ref2$sweepFlag === undefined ? 0 : _ref2$sweepFlag;\n\n  var curves = [];\n\n  if (rx === 0 || ry === 0) {\n    return [];\n  }\n\n  var sinphi = Math.sin(xAxisRotation * TAU / 360);\n  var cosphi = Math.cos(xAxisRotation * TAU / 360);\n\n  var pxp = cosphi * (px - cx) / 2 + sinphi * (py - cy) / 2;\n  var pyp = -sinphi * (px - cx) / 2 + cosphi * (py - cy) / 2;\n\n  if (pxp === 0 && pyp === 0) {\n    return [];\n  }\n\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n\n  var lambda = Math.pow(pxp, 2) / Math.pow(rx, 2) + Math.pow(pyp, 2) / Math.pow(ry, 2);\n\n  if (lambda > 1) {\n    rx *= Math.sqrt(lambda);\n    ry *= Math.sqrt(lambda);\n  }\n\n  var _getArcCenter = getArcCenter(px, py, cx, cy, rx, ry, largeArcFlag, sweepFlag, sinphi, cosphi, pxp, pyp),\n      _getArcCenter2 = _slicedToArray(_getArcCenter, 4),\n      centerx = _getArcCenter2[0],\n      centery = _getArcCenter2[1],\n      ang1 = _getArcCenter2[2],\n      ang2 = _getArcCenter2[3];\n\n  // If 'ang2' == 90.0000000001, then `ratio` will evaluate to\n  // 1.0000000001. This causes `segments` to be greater than one, which is an\n  // unecessary split, and adds extra points to the bezier curve. To alleviate\n  // this issue, we round to 1.0 when the ratio is close to 1.0.\n\n\n  var ratio = Math.abs(ang2) / (TAU / 4);\n  if (Math.abs(1.0 - ratio) < 0.0000001) {\n    ratio = 1.0;\n  }\n\n  var segments = Math.max(Math.ceil(ratio), 1);\n\n  ang2 /= segments;\n\n  for (var i = 0; i < segments; i++) {\n    curves.push(approxUnitArc(ang1, ang2));\n    ang1 += ang2;\n  }\n\n  return curves.map(function (curve) {\n    var _mapToEllipse = mapToEllipse(curve[0], rx, ry, cosphi, sinphi, centerx, centery),\n        x1 = _mapToEllipse.x,\n        y1 = _mapToEllipse.y;\n\n    var _mapToEllipse2 = mapToEllipse(curve[1], rx, ry, cosphi, sinphi, centerx, centery),\n        x2 = _mapToEllipse2.x,\n        y2 = _mapToEllipse2.y;\n\n    var _mapToEllipse3 = mapToEllipse(curve[2], rx, ry, cosphi, sinphi, centerx, centery),\n        x = _mapToEllipse3.x,\n        y = _mapToEllipse3.y;\n\n    return { x1: x1, y1: y1, x2: x2, y2: y2, x: x, y: y };\n  });\n};\n\nexport default arcToBezier;","/** @ignore *//** */\n\nimport {\n\tIRenderer, IContainer, IDisplayObject, IGraphics, IRendererEvents, IMargin,\n\tIText, ITextStyle, IRadialText, IPicture, IRendererEvent, ILayer, ICanvasOptions, BlendMode, IPointerEvent, Id\n} from \"./Renderer\";\nimport type { IBounds } from \"../../util/IBounds\";\nimport type { IPoint } from \"../../util/IPoint\";\nimport { Color } from \"../../util/Color\";\nimport { Matrix } from \"../../util/Matrix\";\nimport { Percent, percent } from \"../../util/Percent\";\n//import { Throttler } from \"../../util/Throttler\";\nimport { ArrayDisposer, Disposer, DisposerClass, IDisposer, CounterDisposer, MultiDisposer } from \"../../util/Disposer\";\nimport { TextFormatter, ITextChunk } from \"../../util/TextFormatter\";\nimport * as $utils from \"../../util/Utils\";\nimport * as $array from \"../../util/Array\";\nimport * as $object from \"../../util/Object\";\nimport * as $type from \"../../util/Type\";\nimport * as $math from \"../../util/Math\";\nimport arcToBezier from 'svg-arc-to-cubic-bezier';\n\n\n/**\n * @ignore\n */\nfunction checkArgs(name: string, actual: number, expected: number) {\n\tif (actual !== expected) {\n\t\tthrow new Error(\"Required \" + expected + \" arguments for \" + name + \" but got \" + actual);\n\t}\n}\n\n/**\n * @ignore\n */\nfunction checkMinArgs(name: string, actual: number, expected: number) {\n\tif (actual < expected) {\n\t\tthrow new Error(\"Required at least \" + expected + \" arguments for \" + name + \" but got \" + actual);\n\t}\n}\n\n/**\n * @ignore\n */\nfunction checkEvenArgs(name: string, actual: number, expected: number) {\n\tcheckMinArgs(name, actual, expected);\n\n\tif ((actual % expected) !== 0) {\n\t\tthrow new Error(\"Arguments for \" + name + \" must be in pairs of \" + expected);\n\t}\n}\n\n/**\n * @ignore\n * This splits the flag so that way 0017 will be processed as 0 0 17\n *\n * This is important for weird paths like `M17 5A1 1 0 0017 30 1 1 0 0017 5`\n */\nfunction splitArcFlags(args: Array<string>) {\n\tfor (let i = 0; i < args.length; i += 7) {\n\t\tlet index = i + 3;\n\t\tlet flag = args[index];\n\n\t\tif (flag.length > 1) {\n\t\t\tconst a = /^([01])([01])(.*)$/.exec(flag);\n\n\t\t\tif (a !== null) {\n\t\t\t\targs.splice(index, 0, a[1]);\n\t\t\t\t++index;\n\n\t\t\t\targs.splice(index, 0, a[2]);\n\t\t\t\t++index;\n\n\t\t\t\tif (a[3].length > 0) {\n\t\t\t\t\targs[index] = a[3];\n\n\t\t\t\t} else {\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t++index;\n\n\t\tflag = args[index];\n\n\t\tif (flag.length > 1) {\n\t\t\tconst a = /^([01])(.+)$/.exec(flag);\n\n\t\t\tif (a !== null) {\n\t\t\t\targs.splice(index, 0, a[1]);\n\t\t\t\t++index;\n\n\t\t\t\targs[index] = a[2];\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nfunction assertBinary(value: number): 0 | 1 {\n\tif (value === 0 || value === 1) {\n\t\treturn value;\n\n\t} else {\n\t\tthrow new Error(\"Flag must be 0 or 1\");\n\t}\n}\n\n//  1 -> 0xffffff * (2 / 2)\n//  2 -> 0xffffff * (1 / 2)\n//\n//  3 -> 0xffffff * (3 / 4)\n//  4 -> 0xffffff * (1 / 4)\n//\n//  5 -> 0xffffff * (7 / 8)\n//  6 -> 0xffffff * (5 / 8)\n//  7 -> 0xffffff * (3 / 8)\n//  8 -> 0xffffff * (1 / 8)\n//\n//  9 -> 0xffffff * (15 / 16)\n// 10 -> 0xffffff * (13 / 16)\n// 11 -> 0xffffff * (11 / 16)\n// 12 -> 0xffffff *  (9 / 16)\n// 13 -> 0xffffff *  (7 / 16)\n// 14 -> 0xffffff *  (5 / 16)\n// 15 -> 0xffffff *  (3 / 16)\n// 16 -> 0xffffff *  (1 / 16)\n// @todo remove this old color distribution algo if the new one pans out\n/*function distributeId(id: number): number {\n\tif (id === 1) {\n\t\treturn 0x000001;\n\n\t} else {\n\t\t// Finds the closest power of 2\n\t\tconst base = Math.pow(2, Math.ceil(Math.log(id) / Math.log(2)));\n\n\t\t// Translates the id into an odd fraction index\n\t\tconst index = ((base - id) * 2) + 1;\n\n\t\t// TODO is Math.round correct ?\n\t\treturn Math.round(0xffffff * (index / base));\n\t}\n}*/\n\n/**\n * Function by smeans:\n * https://lowcode.life/generating-unique-contrasting-colors-in-javascript/\n * @ignore\n */\nfunction distributeId(id: number): number {\n\tconst rgb = [0, 0, 0];\n\n\tfor (let i = 0; i < 24; i++) {\n\t\trgb[i % 3] <<= 1;\n\t\trgb[i % 3] |= id & 0x01;\n\t\tid >>= 1;\n\t}\n\n\treturn (rgb[0] | 0) + (rgb[1] << 8) + (rgb[2] << 16);\n}\n\n/**\n * @ignore\n */\nfunction eachTargets(hitTarget: CanvasDisplayObject, f: (target: CanvasDisplayObject) => boolean): void {\n\tfor (; ;) {\n\t\tif (hitTarget.interactive) {\n\t\t\tif (!f(hitTarget)) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (hitTarget._parent) {\n\t\t\thitTarget = hitTarget._parent;\n\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\n// TODO feature detection for mouse/touch/pointer\n/**\n * @ignore\n */\nfunction onPointerEvent(element: EventTarget, name: string, f: (event: Array<IPointerEvent>, target: Node | null) => void): IDisposer {\n\treturn $utils.addEventListener(element, $utils.getRendererEvent(name), (event: MouseEvent | TouchEvent) => {\n\t\tconst target = $utils.getEventTarget(event);\n\n\t\tlet touches = (<any>event).touches;\n\t\tif (touches) {\n\t\t\tif (touches.length == 0) {\n\t\t\t\ttouches = (<any>event).changedTouches;\n\t\t\t}\n\n\t\t\tf($array.copy(<TouchList>touches), target);\n\n\t\t} else {\n\t\t\tf([<MouseEvent>event], target);\n\t\t}\n\t});\n}\n\n/**\n * @ignore\n */\nfunction isTainted(image: HTMLImageElement): boolean {\n\tconst canvas = document.createElement(\"canvas\");\n\tcanvas.width = 1;\n\tcanvas.height = 1;\n\tconst context = canvas.getContext(\"2d\", { willReadFrequently: true })! as CanvasRenderingContext2D;\n\tcontext.drawImage(image, 0, 0, 1, 1);\n\n\ttry {\n\t\tcontext.getImageData(0, 0, 1, 1);\n\t\treturn false;\n\t}\n\tcatch (err) {\n\t\tconsole.warn(\"Image \\\"\" + image.src + \"\\\" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors\");\n\t\treturn true;\n\t}\n}\n\n/**\n * This is needed to workaround a bug in iOS which causes it to not GC canvas elements.\n *\n * @ignore\n */\nfunction clearCanvas(view: HTMLCanvasElement) {\n\tview.width = 0;\n\tview.height = 0;\n\tview.style.width = \"0px\";\n\tview.style.height = \"0px\";\n}\n\n\n/**\n * Aligns the coordinate to the pixel, so it renders crisp\n *\n * @ignore\n */\nfunction crisp(x: number): number {\n\treturn Math.floor(x) + .5;\n}\n\n/**\n * @ignore\n */\nexport class CanvasPivot implements IPoint {\n\tprotected _x: number = 0;\n\tprotected _y: number = 0;\n\n\tget x(): number {\n\t\treturn this._x;\n\t}\n\n\tget y(): number {\n\t\treturn this._y;\n\t}\n\n\tset x(value: number) {\n\t\tthis._x = value;\n\t}\n\n\tset y(value: number) {\n\t\tthis._y = value;\n\t}\n}\n\n\ninterface IStatus {\n\tlayer: CanvasLayer;\n\tinactive: boolean | null;\n}\n\n/**\n * @ignore\n */\nexport class CanvasDisplayObject extends DisposerClass implements IDisplayObject, IDisposer {\n\tpublic _layer?: CanvasLayer;\n\n\tpublic mask: CanvasGraphics | null = null;\n\tpublic visible: boolean = true;\n\tpublic exportable?: boolean = true;\n\tpublic interactive: boolean = false;\n\tpublic inactive: boolean | null = null;\n\tpublic wheelable: boolean = false;\n\tpublic cancelTouch: boolean = false;\n\tpublic isMeasured: boolean = false;\n\tpublic buttonMode: boolean = false;\n\tpublic alpha: number = 1;\n\tpublic compoundAlpha: number = 1;\n\tpublic angle: number = 0;\n\tpublic scale: number = 1;\n\tpublic x: number = 0;\n\tpublic y: number = 0;\n\tpublic crisp: boolean = false;\n\tpublic pivot: CanvasPivot = new CanvasPivot();\n\n\tpublic filter?: string;\n\n\tpublic cursorOverStyle?: string;\n\tpublic _replacedCursorStyle?: string;\n\n\tpublic _localMatrix: Matrix = new Matrix();\n\tpublic _matrix: Matrix = new Matrix();\n\t// TODO can this be replaced with _localMatrix ?\n\tprotected _uMatrix: Matrix = new Matrix();\n\n\tpublic _renderer: CanvasRenderer;\n\tpublic _parent: CanvasContainer | undefined;\n\n\tprotected _localBounds: IBounds | undefined;\n\tprotected _bounds: IBounds | undefined;\n\tpublic _colorId: string | undefined;\n\n\tconstructor(renderer: CanvasRenderer) {\n\t\tsuper();\n\t\tthis._renderer = renderer;\n\t}\n\n\tprotected subStatus(status: IStatus): IStatus {\n\t\treturn {\n\t\t\tinactive: (this.inactive == null ? status.inactive : this.inactive),\n\t\t\tlayer: this._layer || status.layer,\n\t\t};\n\t}\n\n\tprotected _dispose(): void {\n\t\tthis._renderer._removeObject(this);\n\t\tthis.getLayer().dirty = true;\n\t}\n\n\tpublic getCanvas(): HTMLCanvasElement {\n\t\treturn this.getLayer().view;\n\t}\n\n\tpublic getLayer(): CanvasLayer {\n\t\tlet self: CanvasDisplayObject = this;\n\n\t\tfor (; ;) {\n\t\t\tif (self._layer) {\n\t\t\t\treturn self._layer;\n\n\t\t\t} else if (self._parent) {\n\t\t\t\tself = self._parent;\n\n\t\t\t} else {\n\t\t\t\treturn this._renderer.defaultLayer;\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic setLayer(order: number | undefined, margin: IMargin | undefined): void {\n\t\tif (order == null) {\n\t\t\tthis._layer = undefined;\n\n\t\t} else {\n\t\t\tconst visible = true;\n\t\t\tthis._layer = this._renderer.getLayer(order, visible);\n\t\t\tthis._layer.visible = visible;\n\t\t\tthis._layer.margin = margin;\n\t\t\tif (margin) {\n\t\t\t\t$utils.setInteractive(this._layer.view, false);\n\t\t\t}\n\n\t\t\tthis._renderer._ghostLayer.setMargin(this._renderer.layers);\n\n\t\t\tif (this._parent) {\n\t\t\t\tthis._parent.registerChildLayer(this._layer);\n\t\t\t}\n\n\t\t\tthis._layer.dirty = true;\n\t\t\tthis._renderer.resizeLayer(this._layer);\n\t\t\tthis._renderer.resizeGhost();\n\t\t}\n\t}\n\n\tpublic markDirtyLayer(): void {\n\t\tthis.getLayer().dirty = true;\n\t}\n\n\tpublic clear(): void {\n\t\tthis.invalidateBounds();\n\t}\n\n\tpublic invalidateBounds(): void {\n\t\tthis._localBounds = undefined;\n\t}\n\n\tpublic _addBounds(_bounds: IBounds): void { }\n\n\tprotected _getColorId(): string {\n\t\tif (this._colorId === undefined) {\n\t\t\tthis._colorId = this._renderer.paintId(this);\n\t\t}\n\n\t\treturn this._colorId;\n\t}\n\n\tprotected _isInteractive(status: IStatus): boolean {\n\t\treturn !status.inactive && (this.interactive || this._renderer._forceInteractive > 0);\n\t}\n\n\tprotected _isInteractiveMask(status: IStatus): boolean {\n\t\treturn this._isInteractive(status);\n\t}\n\n\tpublic contains(child: CanvasDisplayObject): boolean {\n\t\tfor (; ;) {\n\t\t\tif (child === this) {\n\t\t\t\treturn true;\n\n\t\t\t} else if (child._parent) {\n\t\t\t\tchild = child._parent;\n\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\ttoGlobal(point: IPoint): IPoint {\n\t\treturn this._matrix.apply(point);\n\t}\n\n\ttoLocal(point: IPoint): IPoint {\n\t\treturn this._matrix.applyInverse(point);\n\t}\n\n\tpublic getLocalMatrix(): Matrix {\n\t\tthis._uMatrix.setTransform(0, 0, this.pivot.x, this.pivot.y, this.angle * Math.PI / 180, this.scale);\n\t\treturn this._uMatrix;\n\t}\n\n\tgetLocalBounds(): IBounds {\n\t\tif (!this._localBounds) {\n\n\t\t\tconst bn = 10000000;\n\t\t\tthis._localBounds = {\n\t\t\t\tleft: bn,\n\t\t\t\ttop: bn,\n\t\t\t\tright: -bn,\n\t\t\t\tbottom: -bn\n\t\t\t};\n\n\t\t\tthis._addBounds(this._localBounds);\n\t\t}\n\t\treturn this._localBounds;\n\t}\n\n\tgetAdjustedBounds(bounds: IBounds): IBounds {\n\t\tthis._setMatrix();\n\n\t\tconst matrix = this.getLocalMatrix();\n\n\t\tconst p0 = matrix.apply({ x: bounds.left, y: bounds.top });\n\t\tconst p1 = matrix.apply({ x: bounds.right, y: bounds.top });\n\t\tconst p2 = matrix.apply({ x: bounds.right, y: bounds.bottom });\n\t\tconst p3 = matrix.apply({ x: bounds.left, y: bounds.bottom });\n\n\t\treturn {\n\t\t\tleft: Math.min(p0.x, p1.x, p2.x, p3.x),\n\t\t\ttop: Math.min(p0.y, p1.y, p2.y, p3.y),\n\t\t\tright: Math.max(p0.x, p1.x, p2.x, p3.x),\n\t\t\tbottom: Math.max(p0.y, p1.y, p2.y, p3.y)\n\t\t}\n\t}\n\n\ton<C, Key extends keyof IRendererEvents>(key: Key, callback: (this: C, event: IRendererEvents[Key]) => void, context?: C): IDisposer {\n\t\tif (this.interactive) {\n\t\t\treturn this._renderer._addEvent(this, key, callback, context);\n\n\t\t} else {\n\t\t\treturn new Disposer(() => { });\n\t\t}\n\t}\n\n\tpublic _setMatrix(): void {\n\t\t// TODO only calculate this if it has actually changed\n\t\tthis._localMatrix.setTransform(\n\t\t\tthis.x,\n\t\t\tthis.y,\n\t\t\tthis.pivot.x,\n\t\t\tthis.pivot.y,\n\t\t\t// Converts degrees to radians\n\t\t\tthis.angle * Math.PI / 180,\n\t\t\tthis.scale\n\t\t);\n\n\t\tthis._matrix.copyFrom(this._localMatrix);\n\n\t\tif (this._parent) {\n\t\t\t// TODO only calculate this if it has actually changed\n\t\t\tthis._matrix.prepend(this._parent._matrix);\n\t\t}\n\t}\n\n\tpublic _transform(context: CanvasRenderingContext2D, resolution: number): void {\n\t\tconst m = this._matrix;\n\t\tlet tx = m.tx * resolution;\n\t\tlet ty = m.ty * resolution;\n\t\tif (this.crisp) {\n\t\t\ttx = crisp(tx);\n\t\t\tty = crisp(ty);\n\t\t}\n\n\t\tcontext.setTransform(\n\t\t\tm.a * resolution,\n\t\t\tm.b * resolution,\n\t\t\tm.c * resolution,\n\t\t\tm.d * resolution,\n\t\t\ttx,\n\t\t\tty)\n\n\t}\n\n\tpublic _transformMargin(context: CanvasRenderingContext2D, resolution: number, margin: IMargin): void {\n\t\tconst m = this._matrix;\n\t\tcontext.setTransform(\n\t\t\tm.a * resolution,\n\t\t\tm.b * resolution,\n\t\t\tm.c * resolution,\n\t\t\tm.d * resolution,\n\t\t\t(m.tx + margin.left) * resolution,\n\t\t\t(m.ty + margin.top) * resolution\n\t\t);\n\t}\n\n\tpublic _transformLayer(context: CanvasRenderingContext2D, resolution: number, layer: CanvasLayer): void {\n\t\tif (layer.margin) {\n\t\t\tthis._transformMargin(context, layer.scale || resolution, layer.margin);\n\n\t\t} else {\n\t\t\tthis._transform(context, layer.scale || resolution);\n\t\t}\n\t}\n\n\tpublic render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tif (this.visible && (this.exportable !== false || !this._renderer._omitTainted)) {\n\t\t\tthis._setMatrix();\n\n\t\t\tconst subStatus = this.subStatus(status);\n\n\t\t\tconst resolution = this._renderer.resolution;\n\n\t\t\tconst layers = this._renderer.layers;\n\t\t\tconst ghostLayer = this._renderer._ghostLayer;\n\t\t\tconst ghostContext = ghostLayer.context;\n\n\t\t\tconst mask = this.mask;\n\t\t\tif (mask) {\n\t\t\t\tmask._setMatrix();\n\t\t\t}\n\n\t\t\t// TODO improve this\n\t\t\t$array.each(layers, (layer) => {\n\t\t\t\tif (layer) {\n\t\t\t\t\tconst context = layer.context;\n\t\t\t\t\tcontext.save();\n\n\t\t\t\t\t// We must apply the mask before we transform the element\n\t\t\t\t\tif (mask) {\n\t\t\t\t\t\tmask._transformLayer(context, resolution, layer);\n\t\t\t\t\t\tmask._runPath(context);\n\t\t\t\t\t\tcontext.clip();\n\t\t\t\t\t}\n\n\t\t\t\t\tcontext.globalAlpha = this.compoundAlpha * this.alpha;\n\n\t\t\t\t\tthis._transformLayer(context, resolution, layer);\n\n\t\t\t\t\tif (this.filter) {\n\t\t\t\t\t\tcontext.filter = this.filter;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tghostContext.save();\n\n\t\t\t// We must apply the mask before we transform the element\n\t\t\tif (mask && this._isInteractiveMask(subStatus)) {\n\t\t\t\tmask._transformMargin(ghostContext, resolution, ghostLayer.margin);\n\t\t\t\tmask._runPath(ghostContext);\n\t\t\t\tghostContext.clip();\n\t\t\t}\n\n\t\t\tthis._transformMargin(ghostContext, resolution, ghostLayer.margin);\n\t\t\tif ((subStatus.layer.order > 0) && !targetGhostLayer) {\n\t\t\t\t$array.move(this._renderer._deferredGhostLayers, subStatus.layer.order);\n\t\t\t}\n\t\t\tthis._render(subStatus, targetGhostLayer);\n\n\t\t\tghostContext.restore();\n\n\t\t\t$array.each(layers, (layer) => {\n\t\t\t\tif (layer) {\n\t\t\t\t\tlayer.context.restore();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected _render(status: IStatus, _targetGhostLayer: number = 0): void {\n\t\tif (this.exportable === false) {\n\t\t\tstatus.layer.tainted = true;\n\t\t}\n\t}\n\n\tprotected _ghostOnly(targetGhostLayer: number = 0): boolean {\n\t\treturn targetGhostLayer > 0 ? true : false;\n\t}\n\n\tprotected _drawGhost(status: IStatus, targetGhostLayer: number = 0): boolean {\n\t\tconst interactive = this._isInteractive(status);\n\t\tconst order = status.layer.order || 0;\n\t\treturn interactive && ((order == 0 && !this._ghostOnly(targetGhostLayer)) || order == targetGhostLayer) ? true : false;\n\t}\n\n\thovering(): boolean {\n\t\treturn this._renderer._hovering.has(this);\n\t}\n\n\tdragging(): boolean {\n\t\treturn this._renderer._dragging.some((x) => x.value === this);\n\t}\n\n\n\tpublic shouldCancelTouch(): boolean {\n\t\tconst renderer = this._renderer;\n\t\tif (renderer.tapToActivate && !renderer._touchActive) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this.cancelTouch) {\n\t\t\treturn true;\n\t\t}\n\t\telse if (this._parent) {\n\t\t\treturn this._parent.shouldCancelTouch();\n\t\t}\n\t\treturn false;\n\t}\n\n}\n\n/**\n * @ignore\n */\nexport class CanvasContainer extends CanvasDisplayObject implements IContainer {\n\tpublic interactiveChildren: boolean = true;\n\tprivate _childLayers?: CanvasLayer[];\n\n\tprotected _children: Array<CanvasDisplayObject> = [];\n\n\tprotected _isInteractiveMask(status: IStatus): boolean {\n\t\treturn this.interactiveChildren || super._isInteractiveMask(status);\n\t}\n\n\taddChild(child: CanvasDisplayObject): void {\n\t\tchild._parent = this;\n\t\tthis._children.push(child);\n\t\tif (child._layer) {\n\t\t\tthis.registerChildLayer(child._layer);\n\t\t}\n\t}\n\n\taddChildAt(child: CanvasDisplayObject, index: number): void {\n\t\tchild._parent = this;\n\t\tthis._children.splice(index, 0, child);\n\t\tif (child._layer) {\n\t\t\tthis.registerChildLayer(child._layer);\n\t\t}\n\t}\n\n\tremoveChild(child: CanvasDisplayObject): void {\n\t\tchild._parent = undefined;\n\t\t$array.removeFirst(this._children, child);\n\t}\n\n\tprotected _render(status: IStatus, targetGhostLayer: number): void {\n\t\tsuper._render(status);\n\n\t\tconst renderer = this._renderer;\n\n\t\tif (this.interactive && this.interactiveChildren) {\n\t\t\t++renderer._forceInteractive;\n\t\t}\n\n\t\t$array.each(this._children, (child) => {\n\t\t\tchild.compoundAlpha = this.compoundAlpha * this.alpha;\n\t\t\tchild.render(status, targetGhostLayer);\n\t\t});\n\n\t\tif (this.interactive && this.interactiveChildren) {\n\t\t\t--renderer._forceInteractive;\n\t\t}\n\t}\n\n\tregisterChildLayer(layer: CanvasLayer): void {\n\t\tif (!this._childLayers) {\n\t\t\tthis._childLayers = [];\n\t\t}\n\t\t$array.pushOne(this._childLayers, layer);\n\t\tif (this._parent) {\n\t\t\tthis._parent.registerChildLayer(layer);\n\t\t}\n\t}\n\n\tpublic markDirtyLayer(deep: boolean = false): void {\n\t\tsuper.markDirtyLayer();\n\t\tif (deep && this._childLayers) {\n\t\t\t$array.each(this._childLayers, (layer) => layer.dirty = true);\n\t\t}\n\t}\n\n\tprotected _dispose() {\n\t\tsuper._dispose();\n\t\tif (this._childLayers) {\n\t\t\t$array.each(this._childLayers, (layer) => {\n\t\t\t\tlayer.dirty = true;\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nfunction setPoint(bounds: IBounds, point: IPoint): void {\n\tbounds.left = Math.min(bounds.left, point.x);\n\tbounds.top = Math.min(bounds.top, point.y);\n\tbounds.right = Math.max(bounds.right, point.x);\n\tbounds.bottom = Math.max(bounds.bottom, point.y);\n}\n\n/**\n * @ignore\n */\nabstract class Op {\n\tpublic colorize(_context: CanvasRenderingContext2D, _forceColor: string | undefined): void { }\n\n\tpublic colorizeGhost(context: CanvasRenderingContext2D, forceColor: string | undefined): void {\n\t\tthis.colorize(context, forceColor);\n\t}\n\n\tpublic path(_context: CanvasRenderingContext2D): void { }\n\n\tpublic pathGhost(context: CanvasRenderingContext2D): void {\n\t\tthis.path(context);\n\t}\n\n\tpublic addBounds(_bounds: IBounds): void { }\n}\n\n/**\n * @ignore\n */\nclass BeginPath extends Op {\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.beginPath();\n\t}\n}\n\n/**\n * @ignore\n */\nclass BeginFill extends Op {\n\tconstructor(public color: string | CanvasGradient | CanvasPattern) { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, forceColor: string | undefined): void {\n\t\tif (forceColor !== undefined) {\n\t\t\tcontext.fillStyle = forceColor;\n\n\t\t} else {\n\t\t\tcontext.fillStyle = this.color;\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nclass EndFill extends Op {\n\tconstructor(public clearShadow: boolean) { super(); }\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.fill();\n\t\tif (this.clearShadow) {\n\t\t\tcontext.shadowColor = \"\";\n\t\t\tcontext.shadowBlur = 0;\n\t\t\tcontext.shadowOffsetX = 0;\n\t\t\tcontext.shadowOffsetY = 0;\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nclass EndStroke extends Op {\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.stroke();\n\t}\n}\n\n/**\n * @ignore\n */\nclass LineStyle extends Op {\n\tconstructor(public width: number, public color: string | CanvasGradient | CanvasPattern, public lineJoin?: \"miter\" | \"round\" | \"bevel\", public lineCap?: \"butt\" | \"round\" | \"square\") { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, forceColor: string | undefined): void {\n\t\tif (forceColor !== undefined) {\n\t\t\tcontext.strokeStyle = forceColor;\n\n\t\t} else {\n\t\t\tcontext.strokeStyle = this.color;\n\t\t}\n\n\t\tcontext.lineWidth = this.width;\n\t\tif (this.lineJoin) {\n\t\t\tcontext.lineJoin = this.lineJoin;\n\t\t}\n\n\t\tif (this.lineCap) {\n\t\t\tcontext.lineCap = this.lineCap;\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\nclass LineDash extends Op {\n\tconstructor(public dash: number[]) { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.setLineDash(this.dash);\n\t}\n}\n\n/**\n * @ignore\n */\nclass LineDashOffset extends Op {\n\tconstructor(public dashOffset: number) { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tcontext.lineDashOffset = this.dashOffset;\n\t}\n}\n\n/**\n * @ignore\n */\nclass DrawRect extends Op {\n\tconstructor(public x: number, public y: number, public width: number, public height: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.rect(this.x, this.y, this.width, this.height);\n\t}\n\n\tpublic addBounds(bounds: IBounds): void {\n\t\tconst l = this.x;\n\t\tconst t = this.y;\n\t\tconst r = l + this.width;\n\t\tconst b = t + this.height;\n\n\t\tsetPoint(bounds, { x: l, y: t });\n\t\tsetPoint(bounds, { x: r, y: t });\n\t\tsetPoint(bounds, { x: l, y: b });\n\t\tsetPoint(bounds, { x: r, y: b });\n\t}\n}\n\n/**\n * @ignore\n */\nclass DrawCircle extends Op {\n\tconstructor(public x: number, public y: number, public radius: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.moveTo(this.x + this.radius, this.y);\n\t\tcontext.arc(this.x, this.y, this.radius, 0, 2 * Math.PI);\n\t}\n\n\t// TODO handle skewing and rotation\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x - this.radius, y: this.y - this.radius });\n\t\tsetPoint(bounds, { x: this.x + this.radius, y: this.y + this.radius });\n\t}\n}\n\n/**\n * @ignore\n */\nclass DrawEllipse extends Op {\n\tconstructor(public x: number, public y: number, public radiusX: number, public radiusY: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.ellipse(0, 0, this.radiusX, this.radiusY, 0, 0, Math.PI * 2);\n\t}\n\n\t// TODO handle skewing and rotation\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x - this.radiusX, y: this.y - this.radiusY });\n\t\tsetPoint(bounds, { x: this.x + this.radiusX, y: this.y + this.radiusY });\n\t}\n}\n\n/**\n * @ignore\n */\nclass Arc extends Op {\n\tconstructor(\n\t\tpublic cx: number,\n\t\tpublic cy: number,\n\t\tpublic radius: number,\n\t\tpublic startAngle: number,\n\t\tpublic endAngle: number,\n\t\tpublic anticlockwise: boolean,\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tif (this.radius > 0) {\n\t\t\tcontext.arc(this.cx, this.cy, this.radius, this.startAngle, this.endAngle, this.anticlockwise);\n\t\t}\n\t}\n\n\tpublic addBounds(bounds: IBounds): void {\n\t\tlet arcBounds = $math.getArcBounds(this.cx, this.cy, this.startAngle * $math.DEGREES, this.endAngle * $math.DEGREES, this.radius);\n\t\tsetPoint(bounds, { x: arcBounds.left, y: arcBounds.top });\n\t\tsetPoint(bounds, { x: arcBounds.right, y: arcBounds.bottom });\n\t}\n}\n\n/**\n * @ignore\n */\nclass ArcTo extends Op {\n\tconstructor(\n\t\tpublic x1: number,\n\t\tpublic y1: number,\n\t\tpublic x2: number,\n\t\tpublic y2: number,\n\t\tpublic radius: number,\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tif (this.radius > 0) {\n\t\t\tcontext.arcTo(this.x1, this.y1, this.x2, this.y2, this.radius);\n\t\t}\n\t}\n\n\t// TODO: add points\n\tpublic addBounds(_bounds: IBounds): void {\n\t\t/*\n\t\t// not finished\n\t\thttps://math.stackexchange.com/questions/1781438/finding-the-center-of-a-circle-given-two-points-and-a-radius-algebraically\n\n\t\tif (prevPoint) {\n\t\t\tlet x1 = prevPoint.x;\n\t\t\tlet y1 = prevPoint.y;\n\t\t\tlet x2 = this.x2;\n\t\t\tlet y2 = this.y2;\n\t\t\tlet r = this.radius;\n\n\t\t\tlet xa = (x2 - x1) / 2;\n\t\t\tlet ya = (y2 - y1) / 2;\n\n\t\t\tlet x0 = x1 + xa;\n\t\t\tlet y0 = y1 + ya;\n\n\t\t\tlet a = Math.hypot(xa, ya);\n\t\t\tlet b = Math.sqrt(r * r - a * a);\n\n\t\t\tlet cx = x0 + b * ya / a;\n\t\t\tlet cy = y0 - b * xa / a;\n\n\t\t\tconsole.log(cx, cy);\n\t\t}*/\n\t}\n}\n\n/**\n * @ignore\n */\nclass LineTo extends Op {\n\tconstructor(public x: number, public y: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.lineTo(this.x, this.y);\n\t}\n\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x, y: this.y });\n\t}\n}\n\n/**\n * @ignore\n */\nclass MoveTo extends Op {\n\tconstructor(public x: number, public y: number) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.moveTo(this.x, this.y);\n\t}\n\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x, y: this.y });\n\t}\n}\n\n/**\n * @ignore\n */\nclass ClosePath extends Op {\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.closePath();\n\t}\n}\n\n/**\n * @ignore\n */\nclass BezierCurveTo extends Op {\n\tconstructor(\n\t\tpublic cpX: number,\n\t\tpublic cpY: number,\n\t\tpublic cpX2: number,\n\t\tpublic cpY2: number,\n\t\tpublic toX: number,\n\t\tpublic toY: number,\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.bezierCurveTo(this.cpX, this.cpY, this.cpX2, this.cpY2, this.toX, this.toY);\n\t}\n\n\t// TODO: OK?\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.cpX, y: this.cpY });\n\t\tsetPoint(bounds, { x: this.cpX2, y: this.cpY2 });\n\t\tsetPoint(bounds, { x: this.toX, y: this.toY });\n\t}\n}\n\n/**\n * @ignore\n */\nclass QuadraticCurveTo extends Op {\n\tconstructor(\n\t\tpublic cpX: number,\n\t\tpublic cpY: number,\n\t\tpublic toX: number,\n\t\tpublic toY: number,\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.quadraticCurveTo(this.cpX, this.cpY, this.toX, this.toY);\n\t}\n\n\t// TODO: OK?\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.cpX, y: this.cpY });\n\t\tsetPoint(bounds, { x: this.toX, y: this.toY });\n\t}\n}\n\n/**\n * @ignore\n */\nclass Shadow extends Op {\n\tconstructor(\n\t\tpublic color: string,\n\t\tpublic blur: number,\n\t\tpublic offsetX: number,\n\t\tpublic offsetY: number,\n\t\tpublic opacity?: number\n\t) { super(); }\n\n\tpublic colorize(context: CanvasRenderingContext2D, _forceColor: string | undefined): void {\n\t\tif (this.opacity) {\n\t\t\tcontext.fillStyle = this.color;\n\t\t}\n\t\tcontext.shadowColor = this.color;\n\t\tcontext.shadowBlur = this.blur;\n\t\tcontext.shadowOffsetX = this.offsetX;\n\t\tcontext.shadowOffsetY = this.offsetY;\n\t}\n\n\tpublic colorizeGhost(_context: CanvasRenderingContext2D, _forceColor: string | undefined): void {}\n}\n\n/**\n * @ignore\n */\nclass GraphicsImage extends Op {\n\tconstructor(\n\t\tpublic image: HTMLImageElement | HTMLCanvasElement,\n\t\tpublic width: number,\n\t\tpublic height: number,\n\t\tpublic x: number,\n\t\tpublic y: number\n\t) { super(); }\n\n\tpublic path(context: CanvasRenderingContext2D): void {\n\t\tcontext.drawImage(this.image, this.x, this.y, this.width, this.height);\n\t}\n\n\t// TODO: OK?\n\tpublic addBounds(bounds: IBounds): void {\n\t\tsetPoint(bounds, { x: this.x, y: this.y });\n\t\tsetPoint(bounds, { x: this.width, y: this.height });\n\t}\n}\n\n/**\n * @ignore\n */\nexport class CanvasGraphics extends CanvasDisplayObject implements IGraphics {\n\tprotected _operations: Array<Op> = [];\n\n\tpublic blendMode: BlendMode = BlendMode.NORMAL;\n\n\tprotected _hasShadows: boolean = false;\n\tprotected _fillAlpha?: number;\n\tprotected _strokeAlpha?: number;\n\n\tclear(): void {\n\t\tsuper.clear();\n\t\tthis._operations.length = 0;\n\t}\n\n\tprotected _pushOp(op: Op): void {\n\t\tthis._operations.push(op);\n\t}\n\n\tbeginFill(color?: Color | CanvasGradient | CanvasPattern, alpha: number = 1): void {\n\t\tthis._fillAlpha = alpha;\n\t\tif (color) {\n\t\t\tif (color instanceof Color) {\n\t\t\t\tthis._pushOp(new BeginFill(color.toCSS(alpha)));\n\n\t\t\t} else {\n\t\t\t\tthis.isMeasured = true;\n\t\t\t\tthis._pushOp(new BeginFill(color));\n\t\t\t}\n\t\t} else {\n\t\t\tthis._pushOp(new BeginFill(\"rgba(0, 0, 0, \" + alpha + \")\"));\n\t\t}\n\t}\n\n\tendFill(): void {\n\t\tthis._pushOp(new EndFill(this._hasShadows));\n\t}\n\n\tendStroke(): void {\n\t\tthis._pushOp(new EndStroke());\n\t}\n\n\tbeginPath(): void {\n\t\tthis._pushOp(new BeginPath());\n\t}\n\n\tlineStyle(width: number = 0, color?: Color | CanvasGradient | CanvasPattern, alpha: number = 1, lineJoin?: \"miter\" | \"round\" | \"bevel\", lineCap?: \"butt\" | \"round\" | \"square\"): void {\n\t\tthis._strokeAlpha = alpha;\n\t\tif (color) {\n\t\t\tif (color instanceof Color) {\n\t\t\t\tthis._pushOp(new LineStyle(width, color.toCSS(alpha), lineJoin, lineCap));\n\t\t\t} else {\n\t\t\t\tthis._pushOp(new LineStyle(width, color, lineJoin, lineCap));\n\t\t\t}\n\t\t} else {\n\t\t\tthis._pushOp(new LineStyle(width, \"rgba(0, 0, 0, \" + alpha + \")\", lineJoin, lineCap));\n\t\t}\n\t}\n\n\tsetLineDash(dash?: number[]): void {\n\t\tthis._pushOp(new LineDash(dash ? dash : []));\n\t}\n\n\tsetLineDashOffset(dashOffset: number = 0): void {\n\t\tthis._pushOp(new LineDashOffset(dashOffset));\n\t}\n\n\tdrawRect(x: number, y: number, width: number, height: number): void {\n\t\tthis._pushOp(new DrawRect(x, y, width, height));\n\t}\n\n\tdrawCircle(x: number, y: number, radius: number): void {\n\t\tthis._pushOp(new DrawCircle(x, y, radius));\n\t}\n\n\tdrawEllipse(x: number, y: number, radiusX: number, radiusY: number): void {\n\t\tthis._pushOp(new DrawEllipse(x, y, radiusX, radiusY));\n\t}\n\n\tarc(cx: number, cy: number, radius: number, startAngle: number, endAngle: number, anticlockwise: boolean = false): void {\n\t\tthis._pushOp(new Arc(cx, cy, radius, startAngle, endAngle, anticlockwise));\n\t}\n\n\tarcTo(x1: number, y1: number, x2: number, y2: number, radius: number): void {\n\t\tthis._pushOp(new ArcTo(x1, y1, x2, y2, radius));\n\t}\n\n\tlineTo(x: number, y: number): void {\n\t\tthis._pushOp(new LineTo(x, y));\n\t}\n\n\tmoveTo(x: number, y: number): void {\n\t\tthis._pushOp(new MoveTo(x, y));\n\t}\n\n\tbezierCurveTo(cpX: number, cpY: number, cpX2: number, cpY2: number, toX: number, toY: number): void {\n\t\tthis._pushOp(new BezierCurveTo(cpX, cpY, cpX2, cpY2, toX, toY));\n\t}\n\n\tquadraticCurveTo(cpX: number, cpY: number, toX: number, toY: number): void {\n\t\tthis._pushOp(new QuadraticCurveTo(cpX, cpY, toX, toY));\n\t}\n\n\tclosePath(): void {\n\t\tthis._pushOp(new ClosePath());\n\t}\n\n\tshadow(color: Color, blur: number = 0, offsetX: number = 0, offsetY: number = 0, opacity?: number): void {\n\t\tthis._hasShadows = true;\n\t\tthis._pushOp(new Shadow(opacity ? color.toCSS(opacity) : color.toCSS(this._fillAlpha || this._strokeAlpha), blur, offsetX, offsetY));\n\t}\n\n\timage(image: HTMLImageElement | HTMLCanvasElement, width: number, height: number, x: number, y: number): void {\n\t\tthis._pushOp(new GraphicsImage(image, width, height, x, y));\n\t}\n\n\t// https://svgwg.org/svg2-draft/paths.html#DProperty\n\t// TODO better error checking\n\tsvgPath(path: string): void {\n\t\tlet x = 0;\n\t\tlet y = 0;\n\t\tlet cpx: number | null = null;\n\t\tlet cpy: number | null = null;\n\t\tlet qcpx: number | null = null;\n\t\tlet qcpy: number | null = null;\n\n\t\tconst SEGMENTS_REGEXP = /([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g;\n\t\tconst ARGS_REGEXP = /[\\u0009\\u0020\\u000A\\u000C\\u000D]*([\\+\\-]?[0-9]*\\.?[0-9]+(?:[eE][\\+\\-]?[0-9]+)?)[\\u0009\\u0020\\u000A\\u000C\\u000D]*,?/g;\n\n\t\tlet match;\n\n\t\twhile ((match = SEGMENTS_REGEXP.exec(path)) !== null) {\n\t\t\tconst name = match[1];\n\t\t\tconst rest = match[2];\n\n\t\t\tconst args: Array<string> = [];\n\n\t\t\twhile ((match = ARGS_REGEXP.exec(rest)) !== null) {\n\t\t\t\targs.push(match[1]);\n\t\t\t}\n\n\t\t\t// Reset control point\n\t\t\tif (name !== \"S\" && name !== \"s\" && name !== \"C\" && name !== \"c\") {\n\t\t\t\tcpx = null;\n\t\t\t\tcpy = null;\n\t\t\t}\n\n\t\t\t// Reset control point\n\t\t\tif (name !== \"Q\" && name !== \"q\" && name !== \"T\" && name !== \"t\") {\n\t\t\t\tqcpx = null;\n\t\t\t\tqcpy = null;\n\t\t\t}\n\n\t\t\tswitch (name) {\n\t\t\t\tcase \"M\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tx = +args[0];\n\t\t\t\t\ty = +args[1];\n\t\t\t\t\tthis.moveTo(x, y);\n\n\t\t\t\t\tfor (let i = 2; i < args.length; i += 2) {\n\t\t\t\t\t\tx = +args[i];\n\t\t\t\t\t\ty = +args[i + 1];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"m\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tx += +args[0];\n\t\t\t\t\ty += +args[1];\n\t\t\t\t\tthis.moveTo(x, y);\n\n\t\t\t\t\tfor (let i = 2; i < args.length; i += 2) {\n\t\t\t\t\t\tx += +args[i];\n\t\t\t\t\t\ty += +args[i + 1];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"L\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 2) {\n\t\t\t\t\t\tx = +args[i];\n\t\t\t\t\t\ty = +args[i + 1];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"l\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 2) {\n\t\t\t\t\t\tx += +args[i];\n\t\t\t\t\t\ty += +args[i + 1];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"H\":\n\t\t\t\t\tcheckMinArgs(name, args.length, 1);\n\t\t\t\t\tfor (let i = 0; i < args.length; ++i) {\n\t\t\t\t\t\tx = +args[i];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"h\":\n\t\t\t\t\tcheckMinArgs(name, args.length, 1);\n\t\t\t\t\tfor (let i = 0; i < args.length; ++i) {\n\t\t\t\t\t\tx += +args[i];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"V\":\n\t\t\t\t\tcheckMinArgs(name, args.length, 1);\n\t\t\t\t\tfor (let i = 0; i < args.length; ++i) {\n\t\t\t\t\t\ty = +args[i];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"v\":\n\t\t\t\t\tcheckMinArgs(name, args.length, 1);\n\t\t\t\t\tfor (let i = 0; i < args.length; ++i) {\n\t\t\t\t\t\ty += +args[i];\n\t\t\t\t\t\tthis.lineTo(x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"C\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 6);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 6) {\n\t\t\t\t\t\tconst x1 = +args[i];\n\t\t\t\t\t\tconst y1 = +args[i + 1];\n\t\t\t\t\t\tcpx = +args[i + 2];\n\t\t\t\t\t\tcpy = +args[i + 3];\n\t\t\t\t\t\tx = +args[i + 4];\n\t\t\t\t\t\ty = +args[i + 5];\n\t\t\t\t\t\tthis.bezierCurveTo(x1, y1, cpx, cpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"c\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 6);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 6) {\n\t\t\t\t\t\tconst x1 = +args[i] + x;\n\t\t\t\t\t\tconst y1 = +args[i + 1] + y;\n\t\t\t\t\t\tcpx = +args[i + 2] + x;\n\t\t\t\t\t\tcpy = +args[i + 3] + y;\n\t\t\t\t\t\tx += +args[i + 4];\n\t\t\t\t\t\ty += +args[i + 5];\n\t\t\t\t\t\tthis.bezierCurveTo(x1, y1, cpx, cpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"S\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 4);\n\t\t\t\t\tif (cpx === null || cpy === null) {\n\t\t\t\t\t\tcpx = x;\n\t\t\t\t\t\tcpy = y;\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 4) {\n\t\t\t\t\t\tconst x1 = 2 * x - cpx;\n\t\t\t\t\t\tconst y1 = 2 * y - cpy;\n\t\t\t\t\t\tcpx = +args[i];\n\t\t\t\t\t\tcpy = +args[i + 1];\n\t\t\t\t\t\tx = +args[i + 2];\n\t\t\t\t\t\ty = +args[i + 3];\n\t\t\t\t\t\tthis.bezierCurveTo(x1, y1, cpx, cpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"s\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 4);\n\t\t\t\t\tif (cpx === null || cpy === null) {\n\t\t\t\t\t\tcpx = x;\n\t\t\t\t\t\tcpy = y;\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 4) {\n\t\t\t\t\t\tconst x1 = 2 * x - cpx;\n\t\t\t\t\t\tconst y1 = 2 * y - cpy;\n\t\t\t\t\t\tcpx = +args[i] + x;\n\t\t\t\t\t\tcpy = +args[i + 1] + y;\n\t\t\t\t\t\tx += +args[i + 2];\n\t\t\t\t\t\ty += +args[i + 3];\n\t\t\t\t\t\tthis.bezierCurveTo(x1, y1, cpx, cpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"Q\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 4);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 4) {\n\t\t\t\t\t\tqcpx = +args[i];\n\t\t\t\t\t\tqcpy = +args[i + 1];\n\t\t\t\t\t\tx = +args[i + 2];\n\t\t\t\t\t\ty = +args[i + 3];\n\t\t\t\t\t\tthis.quadraticCurveTo(qcpx, qcpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"q\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 4);\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 4) {\n\t\t\t\t\t\tqcpx = +args[i] + x;\n\t\t\t\t\t\tqcpy = +args[i + 1] + y;\n\t\t\t\t\t\tx += +args[i + 2];\n\t\t\t\t\t\ty += +args[i + 3];\n\t\t\t\t\t\tthis.quadraticCurveTo(qcpx, qcpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"T\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tif (qcpx === null || qcpy === null) {\n\t\t\t\t\t\tqcpx = x;\n\t\t\t\t\t\tqcpy = y;\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 2) {\n\t\t\t\t\t\tqcpx = 2 * x - qcpx;\n\t\t\t\t\t\tqcpy = 2 * y - qcpy;\n\t\t\t\t\t\tx = +args[i];\n\t\t\t\t\t\ty = +args[i + 1];\n\t\t\t\t\t\tthis.quadraticCurveTo(qcpx, qcpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"t\":\n\t\t\t\t\tcheckEvenArgs(name, args.length, 2);\n\t\t\t\t\tif (qcpx === null || qcpy === null) {\n\t\t\t\t\t\tqcpx = x;\n\t\t\t\t\t\tqcpy = y;\n\t\t\t\t\t}\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 2) {\n\t\t\t\t\t\tqcpx = 2 * x - qcpx;\n\t\t\t\t\t\tqcpy = 2 * y - qcpy;\n\t\t\t\t\t\tx += +args[i];\n\t\t\t\t\t\ty += +args[i + 1];\n\t\t\t\t\t\tthis.quadraticCurveTo(qcpx, qcpy, x, y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"A\":\n\t\t\t\tcase \"a\":\n\t\t\t\t\tconst relative = (name === \"a\");\n\n\t\t\t\t\tsplitArcFlags(args);\n\t\t\t\t\tcheckEvenArgs(name, args.length, 7);\n\n\t\t\t\t\tfor (let i = 0; i < args.length; i += 7) {\n\t\t\t\t\t\tlet cx = +args[i + 5];\n\t\t\t\t\t\tlet cy = +args[i + 6];\n\n\t\t\t\t\t\tif (relative) {\n\t\t\t\t\t\t\tcx += x;\n\t\t\t\t\t\t\tcy += y;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst bs = arcToBezier({\n\t\t\t\t\t\t\tpx: x,\n\t\t\t\t\t\t\tpy: y,\n\t\t\t\t\t\t\trx: +args[i],\n\t\t\t\t\t\t\try: +args[i + 1],\n\t\t\t\t\t\t\txAxisRotation: +args[i + 2],\n\t\t\t\t\t\t\tlargeArcFlag: assertBinary(+args[i + 3]),\n\t\t\t\t\t\t\tsweepFlag: assertBinary(+args[i + 4]),\n\t\t\t\t\t\t\tcx,\n\t\t\t\t\t\t\tcy,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$array.each(bs, (b) => {\n\t\t\t\t\t\t\tthis.bezierCurveTo(b.x1, b.y1, b.x2, b.y2, b.x, b.y);\n\t\t\t\t\t\t\tx = b.x;\n\t\t\t\t\t\t\ty = b.y;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Z\":\n\t\t\t\tcase \"z\":\n\t\t\t\t\tcheckArgs(name, args.length, 0);\n\t\t\t\t\tthis.closePath();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\n\tpublic _runPath(context: CanvasRenderingContext2D): void {\n\t\tcontext.beginPath();\n\n\t\t$array.each(this._operations, (op) => {\n\t\t\top.path(context);\n\t\t});\n\t}\n\n\tprotected _render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tsuper._render(status);\n\n\t\tconst layerDirty = status.layer.dirty;\n\t\tconst interactive = this._isInteractive(status);\n\t\tconst ghostOnly = this._ghostOnly(targetGhostLayer);\n\t\tconst drawGhost = this._drawGhost(status, targetGhostLayer);\n\n\t\tif (layerDirty || interactive || ghostOnly) {\n\n\t\t\tconst context = status.layer.context;\n\t\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\n\t\t\tif (layerDirty && !ghostOnly) {\n\t\t\t\tcontext.globalCompositeOperation = this.blendMode;\n\t\t\t\tcontext.beginPath();\n\t\t\t}\n\n\t\t\tlet color: string | undefined;\n\n\t\t\tif (drawGhost) {\n\t\t\t\tghostContext.beginPath();\n\t\t\t\tcolor = this._getColorId();\n\t\t\t}\n\n\t\t\t$array.each(this._operations, (op) => {\n\t\t\t\tif (layerDirty && !ghostOnly) {\n\t\t\t\t\top.path(context);\n\t\t\t\t\top.colorize(context, undefined);\n\t\t\t\t}\n\n\t\t\t\tif (drawGhost) {\n\t\t\t\t\top.pathGhost(ghostContext);\n\t\t\t\t\top.colorizeGhost(ghostContext, color);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic renderDetached(context: CanvasRenderingContext2D): void {\n\t\tif (this.visible) {\n\t\t\tthis._setMatrix();\n\n\t\t\tcontext.save();\n\n\t\t\t// We must apply the mask before we transform the element\n\t\t\tconst mask = this.mask;\n\t\t\tif (mask) {\n\t\t\t\tmask._setMatrix();\n\t\t\t\tmask._transform(context, 1);\n\t\t\t\tmask._runPath(context);\n\t\t\t\tcontext.clip();\n\t\t\t}\n\n\t\t\t// TODO handle compoundAlpha somehow ?\n\t\t\tcontext.globalAlpha = this.compoundAlpha * this.alpha;\n\n\t\t\tthis._transform(context, 1);\n\n\t\t\tif (this.filter) {\n\t\t\t\tcontext.filter = this.filter;\n\t\t\t}\n\n\t\t\tcontext.globalCompositeOperation = this.blendMode;\n\n\t\t\tcontext.beginPath();\n\n\t\t\t$array.each(this._operations, (op) => {\n\t\t\t\top.path(context);\n\t\t\t\top.colorize(context, undefined);\n\t\t\t});\n\n\t\t\tcontext.restore();\n\t\t}\n\t}\n\n\tpublic _addBounds(bounds: IBounds): void {\n\t\tif (this.visible && this.isMeasured) {\n\t\t\t$array.each(this._operations, (op) => {\n\t\t\t\top.addBounds(bounds);\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\ninterface ILineChunk {\n\tstyle: string | undefined,\n\tfill: Color | undefined,\n\ttext: string,\n\twidth: number,\n\theight: number,\n\tleft: number,\n\tright: number,\n\tascent: number,\n\toffsetX: number,\n\toffsetY: number,\n\ttextDecoration: string | undefined,\n\tverticalAlign?: \"baseline\" | \"sub\" | \"super\"\n}\n\n/**\n * @ignore\n */\ninterface ILine {\n\toffsetY: number,\n\tascent: number,\n\twidth: number,\n\theight: number,\n\tleft: number,\n\tright: number,\n\ttextChunks: Array<ILineChunk>,\n}\n\n/**\n * @ignore\n */\nexport class CanvasText extends CanvasDisplayObject implements IText {\n\tpublic text: string;\n\tpublic style: CanvasTextStyle;\n\tpublic resolution: number = 1;\n\tpublic textVisible: boolean = true;\n\tpublic truncated?: boolean;\n\n\tprotected _textInfo: Array<ILine> | undefined;\n\tprotected _originalScale?: number = 1;\n\n\tconstructor(renderer: CanvasRenderer, text: string, style: CanvasTextStyle) {\n\t\tsuper(renderer);\n\t\tthis.text = text;\n\t\tthis.style = style;\n\t}\n\n\tpublic invalidateBounds(): void {\n\t\tsuper.invalidateBounds();\n\t\tthis._textInfo = undefined;\n\t}\n\n\tpublic invalidateVisibility(): void {\n\t\tthis.textVisible = true;\n\t\tthis.scale = this._originalScale || 1;\n\t}\n\n\tprivate _shared(context: CanvasRenderingContext2D) {\n\t\tif (this.style.textAlign) {\n\t\t\tcontext.textAlign = this.style.textAlign;\n\t\t}\n\n\t\tif (this.style.direction) {\n\t\t\tcontext.direction = this.style.direction;\n\t\t}\n\n\t\tif (this.style.textBaseline) {\n\t\t\tcontext.textBaseline = this.style.textBaseline;\n\t\t}\n\n\t}\n\n\tprotected _prerender(status: IStatus, ignoreGhost = false, ignoreFontWeight = false): void {\n\t\tsuper._render(status);\n\n\t\tconst context = status.layer.context;\n\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\n\t\t// Font style\n\n\t\tconst style = this.style;\n\t\tlet fontStyle = this._getFontStyle(undefined, ignoreFontWeight);\n\n\t\tcontext.font = fontStyle;\n\t\tif (this._isInteractive(status) && !ignoreGhost) {\n\t\t\tghostContext.font = fontStyle;\n\t\t}\n\n\t\t// Other parameters\n\t\tif (style.fill) {\n\t\t\tif (style.fill instanceof Color) {\n\t\t\t\tcontext.fillStyle = style.fill.toCSS(style.fillOpacity != undefined ? style.fillOpacity : 1);\n\t\t\t} else {\n\t\t\t\tcontext.fillStyle = style.fill;\n\t\t\t}\n\t\t}\n\n\t\tif (style.shadowColor) {\n\t\t\tstatus.layer.context.shadowColor = style.shadowColor.toCSS(style.shadowOpacity || 1);\n\t\t}\n\t\tif (style.shadowBlur) {\n\t\t\tstatus.layer.context.shadowBlur = style.shadowBlur;\n\t\t}\n\t\tif (style.shadowOffsetX) {\n\t\t\tstatus.layer.context.shadowOffsetX = style.shadowOffsetX;\n\t\t}\n\t\tif (style.shadowOffsetY) {\n\t\t\tstatus.layer.context.shadowOffsetY = style.shadowOffsetY;\n\t\t}\n\n\t\tthis._shared(context);\n\n\t\tif (this._isInteractive(status) && !ignoreGhost) {\n\t\t\tghostContext.fillStyle = this._getColorId();\n\t\t\tthis._shared(ghostContext);\n\t\t}\n\t}\n\n\tprotected _getFontStyle(style2?: ITextStyle, ignoreFontWeight = false): string {\n\n\t\t// Process defaults\n\t\tconst style = this.style;\n\t\tlet fontStyle: string[] = [];\n\n\t\tif (style2 && style2.fontVariant) {\n\t\t\tfontStyle.push(style2.fontVariant);\n\t\t}\n\t\telse if (style.fontVariant) {\n\t\t\tfontStyle.push(style.fontVariant);\n\t\t}\n\n\t\tif (!ignoreFontWeight) {\n\t\t\tif (style2 && style2.fontWeight) {\n\t\t\t\tfontStyle.push(style2.fontWeight);\n\t\t\t}\n\t\t\telse if (style.fontWeight) {\n\t\t\t\tfontStyle.push(style.fontWeight);\n\t\t\t}\n\t\t}\n\n\t\tif (style2 && style2.fontStyle) {\n\t\t\tfontStyle.push(style2.fontStyle);\n\t\t}\n\t\telse if (style.fontStyle) {\n\t\t\tfontStyle.push(style.fontStyle);\n\t\t}\n\n\t\tif (style2 && style2.fontSize) {\n\t\t\tif ($type.isNumber(style2.fontSize)) {\n\t\t\t\tstyle2.fontSize = style2.fontSize + \"px\";\n\t\t\t}\n\t\t\tfontStyle.push(style2.fontSize);\n\t\t}\n\t\telse if (style.fontSize) {\n\t\t\tif ($type.isNumber(style.fontSize)) {\n\t\t\t\tstyle.fontSize = style.fontSize + \"px\";\n\t\t\t}\n\t\t\tfontStyle.push(style.fontSize);\n\t\t}\n\n\t\tif (style2 && style2.fontFamily) {\n\t\t\tfontStyle.push(style2.fontFamily);\n\t\t}\n\t\telse if (style.fontFamily) {\n\t\t\tfontStyle.push(style.fontFamily);\n\t\t}\n\t\telse if (fontStyle.length) {\n\t\t\tfontStyle.push(\"Arial\");\n\t\t}\n\n\t\treturn fontStyle.join(\" \");\n\t}\n\n\tprotected _render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\t// We need measurements in order to properly position text for alignment\n\t\tif (!this._textInfo) {\n\t\t\tthis._measure(status);\n\t\t}\n\n\t\tif (this.textVisible) {\n\n\t\t\tconst interactive = this._isInteractive(status);\n\t\t\tconst context = status.layer.context;\n\t\t\tconst layerDirty = status.layer.dirty;\n\t\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\n\t\t\tconst ghostOnly = this._ghostOnly(targetGhostLayer);\n\t\t\tconst drawGhost = this._drawGhost(status, targetGhostLayer);\n\n\t\t\tcontext.save();\n\t\t\tghostContext.save();\n\t\t\tthis._prerender(status);\n\n\t\t\t// const lines = this.text.toString().replace(/\\r/g, \"\").split(/\\n/);\n\t\t\t// const x = this._localBounds && (this._localBounds.left < 0) ? Math.abs(this._localBounds.left) : 0;\n\n\t\t\t// Process text info produced by _measure()\n\t\t\t$array.each(this._textInfo!, (line, _index) => {\n\t\t\t\t$array.each(line.textChunks, (chunk, _index) => {\n\n\t\t\t\t\t// Set style\n\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tghostContext.save();\n\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.font = chunk.style;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this._isInteractive(status)) {\n\t\t\t\t\t\t\tghostContext.font = chunk.style;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.fillStyle = chunk.fill.toCSS();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Color does not affect ghostContext so we not set it\n\t\t\t\t\t}\n\n\t\t\t\t\t// Draw text\n\t\t\t\t\tif (layerDirty && !ghostOnly) {\n\t\t\t\t\t\tcontext.fillText(chunk.text, chunk.offsetX, line.offsetY + chunk.offsetY);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Draw underline\n\t\t\t\t\tif (chunk.textDecoration == \"underline\" || chunk.textDecoration == \"line-through\") {\n\n\t\t\t\t\t\tlet thickness = 1;\n\t\t\t\t\t\tlet offset = 1;\n\t\t\t\t\t\tlet fontSize = chunk.height;\n\n\t\t\t\t\t\tconst oversizedBehavior = this.style.oversizedBehavior || \"\";\n\t\t\t\t\t\tif ([\"truncate\", \"wrap\", \"wrap-no-break\"].indexOf(oversizedBehavior) > -1) {\n\t\t\t\t\t\t\t// Measure actual width of the text so the line fits\n\t\t\t\t\t\t\tconst metrics = this._measureText(chunk.text, context);\n\t\t\t\t\t\t\tchunk.width = metrics.actualBoundingBoxLeft + metrics.actualBoundingBoxRight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet offsetX = chunk.offsetX;\n\t\t\t\t\t\tswitch (this.style.textAlign) {\n\t\t\t\t\t\t\tcase \"right\":\n\t\t\t\t\t\t\tcase \"end\":\n\t\t\t\t\t\t\t\toffsetX -= chunk.width;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"center\":\n\t\t\t\t\t\t\t\toffsetX -= chunk.width / 2;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\t\tconst format = TextFormatter.getTextStyle(chunk.style);\n\t\t\t\t\t\t\tswitch (format.fontWeight) {\n\t\t\t\t\t\t\t\tcase \"bolder\":\n\t\t\t\t\t\t\t\tcase \"bold\":\n\t\t\t\t\t\t\t\tcase \"700\":\n\t\t\t\t\t\t\t\tcase \"800\":\n\t\t\t\t\t\t\t\tcase \"900\":\n\t\t\t\t\t\t\t\t\tthickness = 2;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (fontSize) {\n\t\t\t\t\t\t\toffset = fontSize / 20;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet y: number;\n\n\t\t\t\t\t\tif (chunk.textDecoration == \"line-through\") {\n\t\t\t\t\t\t\ty = thickness + line.offsetY + chunk.offsetY - chunk.height / 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\ty = thickness + offset * 1.5 + line.offsetY + chunk.offsetY;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\t\tcontext.beginPath();\n\t\t\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\t\t\tcontext.strokeStyle = chunk.fill.toCSS();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (this.style.fill && this.style.fill instanceof Color) {\n\t\t\t\t\t\t\t\tcontext.strokeStyle = this.style.fill.toCSS();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcontext.lineWidth = thickness * offset;\n\t\t\t\t\t\t\tcontext.moveTo(offsetX, y);\n\t\t\t\t\t\t\tcontext.lineTo(offsetX + chunk.width, y);\n\t\t\t\t\t\t\tcontext.stroke();\n\t\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (interactive && this.interactive && drawGhost) {\n\t\t\t\t\t\t// Draw text in ghost canvas ONLY if it is set as interactive\n\t\t\t\t\t\t// explicitly. This way we avoid hit test anomalies caused by anti\n\t\t\t\t\t\t// aliasing of text.\n\t\t\t\t\t\tghostContext.fillText(chunk.text, chunk.offsetX, line.offsetY + chunk.offsetY);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t// Color does not affect ghostContext so we not set it\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reset style\n\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t}\n\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tcontext.restore();\n\t\t\tghostContext.restore();\n\t\t}\n\t}\n\n\tpublic _addBounds(bounds: IBounds): void {\n\t\tif (this.visible && this.isMeasured) {\n\t\t\t//if (this._textVisible) {\n\t\t\tconst x = this._measure({\n\t\t\t\tinactive: this.inactive,\n\t\t\t\tlayer: this.getLayer(),\n\t\t\t});\n\t\t\tsetPoint(bounds, { x: x.left, y: x.top });\n\t\t\tsetPoint(bounds, { x: x.right, y: x.bottom });\n\t\t\t//}\n\t\t}\n\t}\n\n\tprotected _ignoreFontWeight(): boolean {\n\t\treturn /apple/i.test(navigator.vendor);\n\t}\n\n\tpublic _measure(status: IStatus): IBounds {\n\t\tconst context = status.layer.context;\n\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\t\tconst rtl = this.style.direction == \"rtl\";\n\n\t\t// Reset text info\n\t\tthis._textInfo = [];\n\n\t\t// Init\n\t\tconst oversizedBehavior = this.style.oversizedBehavior;\n\t\tconst maxWidth = this.style.maxWidth!;\n\n\t\tconst truncate = $type.isNumber(maxWidth) && oversizedBehavior == \"truncate\";\n\t\tconst wrap = $type.isNumber(maxWidth) && (oversizedBehavior == \"wrap\" || oversizedBehavior == \"wrap-no-break\");\n\n\t\t// Pre-render\n\t\tcontext.save();\n\t\tghostContext.save();\n\t\tthis._prerender(status, true, this._ignoreFontWeight());\n\n\t\t// Get default font metrix\n\t\tconst refText = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 \";\n\n\t\t// Split up text into lines\n\t\tconst lines = this.text.toString().replace(/\\r/g, \"\").split(/\\n/);\n\t\tlet styleRestored = true;\n\t\tlet minX = 0;\n\t\tlet maxX = 0;\n\n\t\t// Iterate through the lines\n\t\tlet offsetY = 0;\n\t\tlet currentStyle: string | undefined;\n\t\t$array.each(lines, (line, _index) => {\n\n\t\t\t// Split up line into format/value chunks\n\t\t\tlet chunks: ITextChunk[];\n\t\t\tif (line == \"\") {\n\t\t\t\tchunks = [{\n\t\t\t\t\ttype: \"value\",\n\t\t\t\t\ttext: \"\"\n\t\t\t\t}];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tchunks = TextFormatter.chunk(line, false, this.style.ignoreFormatting);\n\t\t\t}\n\n\t\t\twhile (chunks.length > 0) {\n\n\t\t\t\t// Init line object\n\t\t\t\tlet lineInfo: ILine = {\n\t\t\t\t\toffsetY: offsetY,\n\t\t\t\t\tascent: 0,\n\t\t\t\t\twidth: 0,\n\t\t\t\t\theight: 0,\n\t\t\t\t\tleft: 0,\n\t\t\t\t\tright: 0,\n\t\t\t\t\ttextChunks: []\n\t\t\t\t};\n\n\t\t\t\t// Measure reference text\n\t\t\t\tconst metrics = this._measureText(refText, context);\n\n\t\t\t\tconst height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\t\t\t\tlineInfo.height = height;\n\t\t\t\tlineInfo.ascent = metrics.actualBoundingBoxAscent;\n\n\t\t\t\tlet currentFormat: string;\n\t\t\t\tlet currentDecoration: string | undefined = this.style.textDecoration;\n\t\t\t\tlet currentFill: Color | undefined;\n\t\t\t\tlet currentChunkWidth: number | undefined;\n\t\t\t\tlet skipFurtherText = false;\n\t\t\t\tlet firstTextChunk = true;\n\t\t\t\tlet leftoverChunks: Array<ITextChunk> = [];\n\t\t\t\tlet currentVerticalAlign: \"baseline\" | \"sub\" | \"super\" | undefined;\n\t\t\t\t//let offsetX = 0;\n\t\t\t\t//let chunk;\n\n\t\t\t\t//while(chunk = chunks.shift()) {\n\t\t\t\t$array.eachContinue(chunks, (chunk, index) => {\n\n\t\t\t\t\t// Format chunk\n\t\t\t\t\tif (chunk.type == \"format\") {\n\t\t\t\t\t\tif (chunk.text == \"[/]\") {\n\t\t\t\t\t\t\tif (!styleRestored) {\n\t\t\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t\t\t\tstyleRestored = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcurrentFill = undefined;\n\t\t\t\t\t\t\tcurrentStyle = undefined;\n\t\t\t\t\t\t\tcurrentChunkWidth = undefined;\n\t\t\t\t\t\t\tcurrentDecoration = this.style.textDecoration;\n\t\t\t\t\t\t\tcurrentVerticalAlign = undefined\n\t\t\t\t\t\t\tcurrentFormat = chunk.text;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\n\t\t\t\t\t\t\tif (!styleRestored) {\n\t\t\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet format = TextFormatter.getTextStyle(chunk.text);\n\t\t\t\t\t\t\tconst fontStyle = this._getFontStyle(format);\n\t\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\t\tghostContext.save();\n\t\t\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\t\t\tcurrentStyle = fontStyle;\n\t\t\t\t\t\t\tcurrentFormat = chunk.text;\n\t\t\t\t\t\t\tif (format.textDecoration) {\n\t\t\t\t\t\t\t\tcurrentDecoration = format.textDecoration;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (format.fill) {\n\t\t\t\t\t\t\t\tcurrentFill = <Color>format.fill;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ((<any>format).width) {\n\t\t\t\t\t\t\t\tcurrentChunkWidth = $type.toNumber((<any>format).width);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (format.verticalAlign) {\n\t\t\t\t\t\t\t\tcurrentVerticalAlign = format.verticalAlign;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstyleRestored = false;\n\n\t\t\t\t\t\t\t// Measure reference text after change of format\n\t\t\t\t\t\t\tconst metrics = this._measureText(refText, context);\n\t\t\t\t\t\t\tconst height = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\t\t\t\t\t\t\tif (height > lineInfo.height) {\n\t\t\t\t\t\t\t\tlineInfo.height = height;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (metrics.actualBoundingBoxAscent > lineInfo.ascent) {\n\t\t\t\t\t\t\t\tlineInfo.ascent = metrics.actualBoundingBoxAscent;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Text chunk\n\t\t\t\t\telse if (chunk.type == \"value\" && !skipFurtherText) {\n\n\t\t\t\t\t\t// Measure\n\t\t\t\t\t\tconst metrics = this._measureText(chunk.text, context);\n\t\t\t\t\t\tlet chunkWidth = metrics.actualBoundingBoxLeft + metrics.actualBoundingBoxRight;\n\n\t\t\t\t\t\t// Check for fit\n\t\t\t\t\t\tif (truncate) {\n\n\t\t\t\t\t\t\tthis.truncated = undefined;\n\n\t\t\t\t\t\t\t// Break words?\n\t\t\t\t\t\t\tlet breakWords = firstTextChunk || this.style.breakWords || false;\n\n\t\t\t\t\t\t\t// Measure ellipsis and check if it fits\n\t\t\t\t\t\t\tconst ellipsis = this.style.ellipsis || \"\";\n\t\t\t\t\t\t\tconst ellipsisMetrics = this._measureText(ellipsis, context);\n\t\t\t\t\t\t\tconst ellipsisWidth = ellipsisMetrics.actualBoundingBoxLeft + ellipsisMetrics.actualBoundingBoxRight;\n\n\t\t\t\t\t\t\t// Check fit\n\t\t\t\t\t\t\tif ((lineInfo.width + chunkWidth) > maxWidth) {\n\t\t\t\t\t\t\t\tconst excessWidth = maxWidth - lineInfo.width - ellipsisWidth;\n\t\t\t\t\t\t\t\tchunk.text = this._truncateText(context, chunk.text, excessWidth, breakWords);\n\t\t\t\t\t\t\t\tchunk.text += ellipsis;\n\t\t\t\t\t\t\t\tskipFurtherText = true;\n\t\t\t\t\t\t\t\tthis.truncated = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (wrap) {\n\t\t\t\t\t\t\t// Check fit\n\t\t\t\t\t\t\tif ((lineInfo.width + chunkWidth) > maxWidth) {\n\t\t\t\t\t\t\t\tconst excessWidth = maxWidth - lineInfo.width;\n\t\t\t\t\t\t\t\tconst tmpText = this._truncateText(\n\t\t\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\t\t\tchunk.text,\n\t\t\t\t\t\t\t\t\texcessWidth,\n\t\t\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t\t\t(firstTextChunk && this.style.oversizedBehavior != \"wrap-no-break\")\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tif (tmpText == \"\") {\n\t\t\t\t\t\t\t\t\t// Unable to fit a single letter - hide the whole label\n\t\t\t\t\t\t\t\t\tthis.textVisible = true;\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//skipFurtherText = true;\n\n\t\t\t\t\t\t\t\t//Add remaining chunks for the next line\n\t\t\t\t\t\t\t\tleftoverChunks = chunks.slice(index + 1);\n\n\t\t\t\t\t\t\t\t//Add remaining text of current chunk if it was forced-cut\n\t\t\t\t\t\t\t\tif ($utils.trim(tmpText) != $utils.trim(chunk.text)) {\n\t\t\t\t\t\t\t\t\tleftoverChunks.unshift({\n\t\t\t\t\t\t\t\t\t\ttype: \"value\",\n\t\t\t\t\t\t\t\t\t\ttext: chunk.text.substr(tmpText.length)\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (currentFormat) {\n\t\t\t\t\t\t\t\t\t\tleftoverChunks.unshift({\n\t\t\t\t\t\t\t\t\t\t\ttype: \"format\",\n\t\t\t\t\t\t\t\t\t\t\ttext: currentFormat\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Set current chunk (truncated)\n\t\t\t\t\t\t\t\tchunk.text = $utils.trim(tmpText);\n\n\t\t\t\t\t\t\t\tchunks = [];\n\t\t\t\t\t\t\t\tskipFurtherText = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Chunk width?\n\t\t\t\t\t\tlet leftBoundMod = 1;\n\t\t\t\t\t\tlet rightBoundMod = 1;\n\t\t\t\t\t\tif (currentStyle && currentChunkWidth && (currentChunkWidth > chunkWidth)) {\n\t\t\t\t\t\t\t// increase horizontal bounding boxes accordingly\n\t\t\t\t\t\t\tconst boundsMod = chunkWidth / currentChunkWidth\n\t\t\t\t\t\t\tswitch (this.style.textAlign) {\n\t\t\t\t\t\t\t\tcase \"right\":\n\t\t\t\t\t\t\t\tcase \"end\":\n\t\t\t\t\t\t\t\t\tleftBoundMod = boundsMod;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase \"center\":\n\t\t\t\t\t\t\t\t\tleftBoundMod = boundsMod;\n\t\t\t\t\t\t\t\t\trightBoundMod = boundsMod;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\trightBoundMod = boundsMod;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchunkWidth = currentChunkWidth;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst chunkHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\n\t\t\t\t\t\tif (chunkHeight > lineInfo.height) {\n\t\t\t\t\t\t\tlineInfo.height = chunkHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (metrics.actualBoundingBoxAscent > lineInfo.ascent) {\n\t\t\t\t\t\t\tlineInfo.ascent = metrics.actualBoundingBoxAscent;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlineInfo.width += chunkWidth;\n\t\t\t\t\t\tlineInfo.left += metrics.actualBoundingBoxLeft / leftBoundMod;\n\t\t\t\t\t\tlineInfo.right += metrics.actualBoundingBoxRight / rightBoundMod;\n\t\t\t\t\t\tlineInfo.textChunks.push({\n\t\t\t\t\t\t\tstyle: currentStyle,\n\t\t\t\t\t\t\tfill: currentFill,\n\t\t\t\t\t\t\ttext: chunk.text,\n\t\t\t\t\t\t\twidth: chunkWidth,\n\t\t\t\t\t\t\theight: chunkHeight,\n\t\t\t\t\t\t\tleft: metrics.actualBoundingBoxLeft,\n\t\t\t\t\t\t\tright: metrics.actualBoundingBoxRight,\n\t\t\t\t\t\t\tascent: metrics.actualBoundingBoxAscent,\n\t\t\t\t\t\t\toffsetX: 0,\n\t\t\t\t\t\t\toffsetY: 0,\n\t\t\t\t\t\t\ttextDecoration: currentDecoration,\n\t\t\t\t\t\t\tverticalAlign: currentVerticalAlign\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t//offsetX += chunkWidth;\n\n\t\t\t\t\t\tfirstTextChunk = false;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif (leftoverChunks) {\n\t\t\t\t\t\t//return false;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\n\t\t\t\t\t//}\n\t\t\t\t});\n\n\t\t\t\tif (this.style.lineHeight instanceof Percent) {\n\t\t\t\t\tlineInfo.height *= this.style.lineHeight.value;\n\t\t\t\t\tlineInfo.ascent *= this.style.lineHeight.value;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlineInfo.height *= this.style.lineHeight || 1.2;\n\t\t\t\t\tlineInfo.ascent *= this.style.lineHeight || 1.2;\n\t\t\t\t}\n\n\t\t\t\tif (minX < lineInfo.left) {\n\t\t\t\t\tminX = lineInfo.left;\n\t\t\t\t}\n\n\t\t\t\tif (maxX < lineInfo.right) {\n\t\t\t\t\tmaxX = lineInfo.right;\n\t\t\t\t}\n\n\t\t\t\tthis._textInfo!.push(lineInfo);\n\n\t\t\t\t//lineInfo.offsetY += lineInfo.ascent;\n\t\t\t\toffsetY += lineInfo.height;\n\n\t\t\t\t// Reset chunks so that it can proceed to the next line\n\t\t\t\tchunks = leftoverChunks || [];\n\t\t\t}\n\n\t\t});\n\n\t\tif (!styleRestored) {\n\t\t\tcontext.restore();\n\t\t\tghostContext.restore();\n\t\t}\n\n\t\t// Adjust chunk internal offsets\n\t\t$array.each(this._textInfo, (lineInfo, _index: number) => {\n\t\t\tlet currentChunkOffset = 0\n\t\t\t$array.each(lineInfo.textChunks, (chunk) => {\n\t\t\t\tchunk.offsetX = currentChunkOffset + chunk.left - lineInfo.left;\n\t\t\t\tchunk.offsetY += lineInfo.height - lineInfo.height * (this.style.baselineRatio || 0.19);\n\t\t\t\tcurrentChunkOffset += chunk.width * (rtl ? -1 : 1);\n\n\t\t\t\tif (chunk.verticalAlign) {\n\t\t\t\t\tswitch (chunk.verticalAlign) {\n\t\t\t\t\t\tcase \"super\":\n\t\t\t\t\t\t\tchunk.offsetY -= lineInfo.height / 2 - chunk.height / 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"sub\":\n\t\t\t\t\t\t\tchunk.offsetY += chunk.height / 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\tconst bounds = {\n\t\t\tleft: rtl ? -maxX : -minX,\n\t\t\ttop: 0,\n\t\t\tright: rtl ? minX : maxX,\n\t\t\tbottom: offsetY,\n\t\t};\n\n\n\t\t// We need to fit?\n\t\tif (oversizedBehavior !== \"none\") {\n\t\t\tconst ratio = this._fitRatio(bounds);\n\t\t\tif (ratio < 1) {\n\t\t\t\tif (oversizedBehavior == \"fit\") {\n\t\t\t\t\tif ($type.isNumber(this.style.minScale) && (ratio < this.style.minScale)) {\n\t\t\t\t\t\tthis.textVisible = false;\n\t\t\t\t\t\tbounds.left = 0;\n\t\t\t\t\t\tbounds.top = 0;\n\t\t\t\t\t\tbounds.right = 0;\n\t\t\t\t\t\tbounds.bottom = 0;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (!this._originalScale) {\n\t\t\t\t\t\t\tthis._originalScale = this.scale;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.scale = ratio;\n\t\t\t\t\t\tthis.textVisible = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (oversizedBehavior == \"hide\") {\n\t\t\t\t\tthis.textVisible = false;\n\t\t\t\t\tbounds.left = 0;\n\t\t\t\t\tbounds.top = 0;\n\t\t\t\t\tbounds.right = 0;\n\t\t\t\t\tbounds.bottom = 0;\n\t\t\t\t}\n\t\t\t\telse {\n\n\t\t\t\t\tswitch (this.style.textAlign) {\n\t\t\t\t\t\tcase \"right\":\n\t\t\t\t\t\tcase \"end\":\n\t\t\t\t\t\t\tbounds.left = rtl ? maxWidth : -maxWidth;\n\t\t\t\t\t\t\tbounds.right = 0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"center\":\n\t\t\t\t\t\t\tbounds.left = -maxWidth / 2;\n\t\t\t\t\t\t\tbounds.right = maxWidth / 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbounds.left = 0;\n\t\t\t\t\t\t\tbounds.right = rtl ? -maxWidth : maxWidth;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.scale = this._originalScale || 1;\n\t\t\t\t\tthis._originalScale = undefined;\n\t\t\t\t\tthis.textVisible = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.scale = this._originalScale || 1;\n\t\t\t\tthis._originalScale = undefined;\n\t\t\t\tthis.textVisible = true;\n\t\t\t}\n\t\t}\n\n\t\tcontext.restore();\n\t\tghostContext.restore();\n\n\t\treturn bounds;\n\t}\n\n\tprotected _fitRatio(bounds: IBounds): number {\n\t\tconst maxW = this.style.maxWidth;\n\t\tconst maxH = this.style.maxHeight;\n\t\tif (!$type.isNumber(maxW) && !$type.isNumber(maxH)) {\n\t\t\treturn 1;\n\t\t}\n\t\tconst w = bounds.right - bounds.left;\n\t\tconst h = bounds.bottom - bounds.top;\n\t\treturn Math.min(maxW! / w || 1, maxH! / h || 1);\n\t}\n\n\tprotected _truncateText(context: CanvasRenderingContext2D, text: string, maxWidth: number, breakWords: boolean = false, fallbackBreakWords: boolean = true): string {\n\t\tlet width: number;\n\t\tdo {\n\t\t\tif (breakWords) {\n\t\t\t\ttext = text.slice(0, -1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet tmp = text.replace(/[^,;:!?\\\\\\/\\s]+[,;:!?\\\\\\/\\s]*$/g, \"\");\n\t\t\t\tif ((tmp == \"\" || tmp === text) && fallbackBreakWords) {\n\t\t\t\t\tbreakWords = true;\n\t\t\t\t}\n\t\t\t\telse if (tmp == \"\") {\n\t\t\t\t\treturn text;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\ttext = tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst metrics = this._measureText(text, context);\n\t\t\twidth = metrics.actualBoundingBoxLeft + metrics.actualBoundingBoxRight;\n\t\t} while ((width > maxWidth) && text != \"\");\n\t\treturn text;\n\t}\n\n\tprotected _measureText(text: string, context: CanvasRenderingContext2D): TextMetrics {\n\t\tlet metrics = context.measureText(text);\n\t\tlet fakeMetrics: any = {};\n\t\tif (metrics.actualBoundingBoxAscent == null) {\n\t\t\tconst div = document.createElement(\"div\");\n\t\t\tdiv.innerText = text;\n\t\t\tdiv.style.visibility = \"hidden\";\n\t\t\tdiv.style.position = \"absolute\";\n\t\t\tdiv.style.top = \"-1000000px;\"\n\t\t\tdiv.style.fontFamily = this.style.fontFamily || \"\";\n\t\t\tdiv.style.fontSize = this.style.fontSize + \"\";\n\t\t\tdocument.body.appendChild(div);\n\t\t\tconst bbox = div.getBoundingClientRect();\n\t\t\tdocument.body.removeChild(div);\n\t\t\tconst h = bbox.height;\n\t\t\tconst w = metrics.width;\n\t\t\tlet left = 0;\n\t\t\tlet right = w;\n\n\t\t\tfakeMetrics = {\n\t\t\t\tactualBoundingBoxAscent: h,\n\t\t\t\tactualBoundingBoxDescent: 0,\n\t\t\t\tactualBoundingBoxLeft: left,\n\t\t\t\tactualBoundingBoxRight: right,\n\t\t\t\tfontBoundingBoxAscent: h,\n\t\t\t\tfontBoundingBoxDescent: 0,\n\t\t\t\twidth: w\n\t\t\t}\n\t\t\t//return fake;\n\t\t}\n\t\telse {\n\t\t\tfakeMetrics = {\n\t\t\t\tactualBoundingBoxAscent: metrics.actualBoundingBoxAscent,\n\t\t\t\tactualBoundingBoxDescent: metrics.actualBoundingBoxDescent,\n\t\t\t\tactualBoundingBoxLeft: metrics.actualBoundingBoxLeft,\n\t\t\t\tactualBoundingBoxRight: metrics.actualBoundingBoxRight,\n\t\t\t\tfontBoundingBoxAscent: metrics.actualBoundingBoxAscent,\n\t\t\t\tfontBoundingBoxDescent: metrics.actualBoundingBoxDescent,\n\t\t\t\twidth: metrics.width\n\t\t\t}\n\t\t}\n\n\t\tconst w = metrics.width;\n\t\tswitch (this.style.textAlign) {\n\t\t\tcase \"right\":\n\t\t\tcase \"end\":\n\t\t\t\tfakeMetrics.actualBoundingBoxLeft = w;\n\t\t\t\tfakeMetrics.actualBoundingBoxRight = 0;\n\t\t\t\tbreak;\n\t\t\tcase \"center\":\n\t\t\t\tfakeMetrics.actualBoundingBoxLeft = w / 2;\n\t\t\t\tfakeMetrics.actualBoundingBoxRight = w / 2;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfakeMetrics.actualBoundingBoxLeft = 0;\n\t\t\t\tfakeMetrics.actualBoundingBoxRight = w;\n\t\t}\n\n\t\treturn fakeMetrics;\n\t}\n\n}\n\n/**\n * @ignore\n */\nexport class CanvasTextStyle implements ITextStyle {\n\t//public wordWrapWidth: number = 100;\n\tpublic fill?: Color | CanvasGradient | CanvasPattern;\n\tpublic fillOpacity?: number;\n\tpublic textAlign?: \"start\" | \"end\" | \"left\" | \"right\" | \"center\";\n\tpublic fontFamily?: string;\n\tpublic fontSize?: string | number;\n\tpublic fontWeight?: 'normal' | 'bold' | 'bolder' | 'lighter' | '100' | '200' | '300' | '400' | '500' | '600' | '700' | '800' | '900'\n\tpublic fontStyle?: 'normal' | 'italic' | 'oblique';\n\tpublic fontVariant?: \"normal\" | \"small-caps\";\n\tpublic textDecoration?: \"underline\" | \"line-through\";\n\tpublic shadowColor?: Color | null;\n\tpublic shadowBlur?: number;\n\tpublic shadowOffsetX?: number;\n\tpublic shadowOffsetY?: number;\n\tpublic shadowOpacity?: number;\n\t// leading?: number;\n\t// letterSpacing?: number;\n\tpublic lineHeight?: number | Percent = percent(120);\n\tpublic baselineRatio?: number = 0.19;\n\t// padding?: number;\n\t// stroke?: number;\n\t// strokeThickness?: number;\n\t// trim?: number;\n\t// wordWrap?: boolean;\n\tpublic direction?: \"ltr\" | \"rtl\";\n\tpublic textBaseline?: \"top\" | \"hanging\" | \"middle\" | \"alphabetic\" | \"ideographic\" | \"bottom\";\n\tpublic oversizedBehavior?: \"none\" | \"hide\" | \"fit\" | \"wrap\" | \"wrap-no-break\" | \"truncate\" = \"none\";\n\tpublic breakWords?: boolean = false;\n\tpublic ellipsis?: string = \"\";\n\tpublic maxWidth?: number;\n\tpublic maxHeight?: number;\n\tpublic minScale?: number;\n\tpublic ignoreFormatting?: boolean = false;\n}\n\n/**\n * @ignore\n */\nexport class CanvasRadialText extends CanvasText implements IRadialText {\n\tpublic textType?: \"regular\" | \"circular\" | \"radial\" | \"aligned\" | \"adjusted\" = \"circular\";\n\tpublic radius?: number;\n\tpublic startAngle?: number;\n\tpublic inside?: boolean = false;\n\tpublic orientation?: \"inward\" | \"outward\" | \"auto\" = \"auto\";\n\tpublic kerning?: number = 0;\n\n\tprivate _textReversed: boolean = false;\n\n\tpublic _render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tswitch (this.textType) {\n\t\t\tcase \"circular\":\n\t\t\t\tthis._renderCircular(status, targetGhostLayer);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tsuper._render(status, targetGhostLayer);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tpublic _renderCircular(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tif (this.textVisible) {\n\t\t\tthis._prerender(status);\n\n\t\t\tconst interactive = this._isInteractive(status);\n\t\t\tconst context = status.layer.context;\n\t\t\tconst layerDirty = status.layer.dirty;\n\t\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\n\t\t\t// Savepoint\n\t\t\tcontext.save();\n\t\t\tif (interactive) {\n\t\t\t\tghostContext.save();\n\t\t\t}\n\n\t\t\t// We need measurements in order to properly position text for alignment\n\t\t\tif (!this._textInfo) {\n\t\t\t\tthis._measure(status);\n\t\t\t}\n\n\t\t\t// Init\n\t\t\tlet radius = (this.radius || 0);\n\t\t\tlet startAngle = (this.startAngle || 0);\n\t\t\tlet deltaAngle = 0;\n\t\t\tlet orientation = this.orientation;\n\t\t\tlet inward = orientation == \"auto\" ? \"auto\" : orientation == \"inward\";\n\t\t\tconst inside = this.inside;\n\t\t\tconst align = this.style.textAlign || \"left\";\n\t\t\tconst kerning = this.kerning || 0;\n\t\t\tlet clockwise = align == \"left\" ? 1 : -1;\n\t\t\tconst shouldReverse = !this._textReversed;\n\n\t\t\tconst ghostOnly = this._ghostOnly(targetGhostLayer);\n\t\t\tconst drawGhost = this._drawGhost(status, targetGhostLayer);\n\n\t\t\t// Check if we need to invert the whole stuff\n\t\t\tif (inward == \"auto\") {\n\t\t\t\t// Calc max angle so we know whether we need to flip it\n\t\t\t\tlet maxAngle = 0;\n\t\t\t\tlet midAngle = 0;\n\t\t\t\t$array.each(this._textInfo!, (line, _index) => {\n\t\t\t\t\tconst deltaAngle = startAngle + (line.width / (radius - line.height)) / 2 * -clockwise;\n\t\t\t\t\tif (deltaAngle > maxAngle) {\n\t\t\t\t\t\tmaxAngle = deltaAngle;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (align == \"left\") {\n\t\t\t\t\tmidAngle = (maxAngle + deltaAngle / 2) * $math.DEGREES;\n\t\t\t\t}\n\t\t\t\telse if (align == \"right\") {\n\t\t\t\t\tmidAngle = (maxAngle - deltaAngle / 2) * $math.DEGREES;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tmidAngle = startAngle * $math.DEGREES;\n\t\t\t\t}\n\t\t\t\tmidAngle = $math.normalizeAngle(midAngle);\n\t\t\t\tinward = (midAngle >= 270) || (midAngle <= 90);\n\t\t\t}\n\n\t\t\tif (inward == true && shouldReverse) {\n\t\t\t\tthis._textInfo!.reverse();\n\t\t\t\tthis._textReversed = true;\n\t\t\t}\n\n\t\t\t// if ((inward == false && align == \"left\") || (inward == true && align == \"right\")) {\n\t\t\t// \tclockwise *= -1;\n\t\t\t// }\n\n\t\t\t// Process text info produced by _measure()\n\t\t\t$array.each(this._textInfo!, (line, _index) => {\n\n\t\t\t\tconst textHeight = line.height;\n\n\t\t\t\t// Adjust radius (for `inside = false`)\n\t\t\t\t// Radius adjustment for `inside = false` is below the line calculation\n\t\t\t\tif (!inside) {\n\t\t\t\t\tradius += textHeight;\n\t\t\t\t}\n\n\t\t\t\t// Reverse letters if we're painting them counter-clockwise\n\t\t\t\tif (((clockwise == -1 && inward) || (clockwise == 1 && !inward)) && shouldReverse) {\n\t\t\t\t\tline.textChunks.reverse();\n\t\t\t\t}\n\n\t\t\t\t// Init angles\n\t\t\t\tlet lineStartAngle = startAngle;\n\t\t\t\tdeltaAngle = 0;\n\n\t\t\t\t// Adjust for center-align\n\t\t\t\tif (align == \"center\") {\n\t\t\t\t\tlineStartAngle += (line.width / (radius - textHeight)) / 2 * -clockwise;\n\t\t\t\t\tdeltaAngle = lineStartAngle - startAngle;\n\t\t\t\t}\n\n\t\t\t\t// if (inward == \"auto\") {\n\t\t\t\t// \tlet midAngle;\n\t\t\t\t// \tif (align == \"left\") {\n\t\t\t\t// \t\tmidAngle = (lineStartAngle + deltaAngle / 2) * $math.DEGREES;\n\t\t\t\t// \t}\n\t\t\t\t// \telse if () {\n\t\t\t\t// \t\tmidAngle = (lineStartAngle - deltaAngle / 2) * $math.DEGREES;\n\t\t\t\t// \t}\n\t\t\t\t// \tinward = (midAngle >= 270) || (midAngle <= 90);\n\t\t\t\t// }\n\n\t\t\t\t// Rotate letters if they are facing outward\n\t\t\t\tlineStartAngle += (Math.PI * (inward ? 0 : 1)); // Rotate 180 if outward\n\n\t\t\t\t// Savepoint\n\t\t\t\tcontext.save();\n\t\t\t\tif (interactive) {\n\t\t\t\t\tghostContext.save();\n\t\t\t\t}\n\n\t\t\t\t// Assume starting angle\n\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\tcontext.rotate(lineStartAngle);\n\t\t\t\t}\n\t\t\t\tif (interactive) {\n\t\t\t\t\tghostContext.rotate(lineStartAngle);\n\t\t\t\t}\n\n\t\t\t\tlet angleShift = 0;\n\t\t\t\t$array.each(line.textChunks, (chunk, _index) => {\n\n\t\t\t\t\t// Draw the letter\n\t\t\t\t\tconst char = chunk.text;\n\t\t\t\t\tconst charWidth = chunk.width;\n\n\t\t\t\t\t// Rotate half a letter\n\t\t\t\t\tangleShift = (charWidth / 2) / (radius - textHeight) * clockwise;\n\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\tcontext.rotate(angleShift);\n\t\t\t\t\t}\n\t\t\t\t\tif (interactive) {\n\t\t\t\t\t\tghostContext.rotate(angleShift);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Set style\n\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tghostContext.save();\n\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.font = chunk.style;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (interactive) {\n\t\t\t\t\t\t\tghostContext.font = chunk.style;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\t\tcontext.fillStyle = chunk.fill.toCSS();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Color does not affect ghostContext so we not set it\n\t\t\t\t\t}\n\n\t\t\t\t\t// Center letters\n\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\tcontext.textBaseline = \"middle\";\n\t\t\t\t\t\tcontext.textAlign = \"center\";\n\t\t\t\t\t}\n\t\t\t\t\tif (interactive) {\n\t\t\t\t\t\tghostContext.textBaseline = \"middle\";\n\t\t\t\t\t\tghostContext.textAlign = \"center\";\n\t\t\t\t\t}\n\n\t\t\t\t\t// Plop the letter\n\t\t\t\t\tif (layerDirty && !ghostOnly) {\n\t\t\t\t\t\tcontext.fillText(char, 0, (inward ? 1 : -1) * (0 - radius + textHeight / 2));\n\t\t\t\t\t}\n\t\t\t\t\tif (interactive && drawGhost) {\n\t\t\t\t\t\tghostContext.fillText(char, 0, (inward ? 1 : -1) * (0 - radius + textHeight / 2));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (chunk.fill) {\n\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t// Color does not affect ghostContext so we not set it\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reset style\n\t\t\t\t\tif (chunk.style) {\n\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Rotate half a letter and add spacing\n\t\t\t\t\tangleShift = (charWidth / 2 + kerning) / (radius - textHeight) * clockwise;\n\t\t\t\t\tif (!ghostOnly) {\n\t\t\t\t\t\tcontext.rotate(angleShift);\n\t\t\t\t\t}\n\t\t\t\t\tif (interactive) {\n\t\t\t\t\t\tghostContext.rotate(angleShift);\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\t// Restore angle\n\t\t\t\tcontext.restore();\n\t\t\t\tif (interactive) {\n\t\t\t\t\tghostContext.restore();\n\t\t\t\t}\n\n\t\t\t\t// Adjust radius (for `inside = true`)\n\t\t\t\tif (inside) {\n\t\t\t\t\tradius -= textHeight;\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\t// Restore\n\t\t\tcontext.restore();\n\t\t\tif (interactive) {\n\t\t\t\tghostContext.restore();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _measure(status: IStatus): IBounds {\n\t\tswitch (this.textType) {\n\t\t\tcase \"circular\":\n\t\t\t\treturn this._measureCircular(status);\n\t\t\tdefault:\n\t\t\t\treturn super._measure(status);\n\t\t}\n\t}\n\n\tpublic _measureCircular(status: IStatus): IBounds {\n\t\tconst context = status.layer.context;\n\t\tconst ghostContext = this._renderer._ghostLayer.context;\n\t\tconst rtl = this.style.direction == \"rtl\";\n\n\t\tconst oversizedBehavior = this.style.oversizedBehavior;\n\t\tconst maxWidth = this.style.maxWidth!;\n\n\t\tconst truncate = $type.isNumber(maxWidth) && oversizedBehavior == \"truncate\";\n\t\tconst ellipsis = this.style.ellipsis || \"\";\n\t\tlet ellipsisMetrics: TextMetrics;\n\t\t//const wrap = $type.isNumber(maxWidth) && (oversizedBehavior == \"wrap\" || oversizedBehavior == \"wrap-no-break\");\n\n\n\t\t// Reset text info\n\t\tthis.textVisible = true;\n\t\tthis._textInfo = [];\n\t\tthis._textReversed = false;\n\n\t\t// Pre-render\n\t\tcontext.save();\n\t\tghostContext.save();\n\t\tthis._prerender(status, true);\n\n\t\t// Split up text into lines\n\t\tconst lines = this.text.toString().replace(/\\r/g, \"\").split(/\\n/);\n\t\tlet styleRestored = true;\n\t\tlet totalWidth = 0;\n\n\t\t// Iterate through the lines\n\t\tlet offsetY = 0;\n\t\t$array.each(lines, (line, _index) => {\n\n\t\t\t// Split up line into format/value chunks\n\t\t\tlet chunks = TextFormatter.chunk(line, false, this.style.ignoreFormatting);\n\n\t\t\t// Init line object\n\t\t\tlet lineInfo: ILine = {\n\t\t\t\toffsetY: offsetY,\n\t\t\t\tascent: 0,\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t\tleft: 0,\n\t\t\t\tright: 0,\n\t\t\t\ttextChunks: []\n\t\t\t};\n\n\t\t\tlet currentStyle: string | undefined;\n\t\t\tlet currentFill: Color | undefined;\n\t\t\tlet currentChunkWidth: number | undefined;\n\n\t\t\t//while(chunk = chunks.shift()) {\n\t\t\t$array.each(chunks, (chunk, _index) => {\n\n\t\t\t\t// Format chunk\n\t\t\t\tif (chunk.type == \"format\") {\n\t\t\t\t\tif (chunk.text == \"[/]\") {\n\t\t\t\t\t\tif (!styleRestored) {\n\t\t\t\t\t\t\tcontext.restore();\n\t\t\t\t\t\t\tghostContext.restore();\n\t\t\t\t\t\t\tstyleRestored = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentFill = undefined;\n\t\t\t\t\t\tcurrentStyle = undefined;\n\t\t\t\t\t\tcurrentChunkWidth = undefined;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tlet format = TextFormatter.getTextStyle(chunk.text);\n\t\t\t\t\t\tconst fontStyle = this._getFontStyle(format);\n\t\t\t\t\t\tcontext.save();\n\t\t\t\t\t\tghostContext.save();\n\t\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\t\tcurrentStyle = fontStyle;\n\t\t\t\t\t\tif (format.fill) {\n\t\t\t\t\t\t\tcurrentFill = <Color>format.fill;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ((<any>format).width) {\n\t\t\t\t\t\t\tcurrentChunkWidth = $type.toNumber((<any>format).width);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstyleRestored = false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (truncate) {\n\t\t\t\t\t\tellipsisMetrics = this._measureText(ellipsis, context);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Text format\n\t\t\t\telse if (chunk.type == \"value\") {\n\n\t\t\t\t\t// Measure each letter\n\t\t\t\t\tlet chars = chunk.text.match(/./ug) || [];\n\t\t\t\t\tif (rtl) {\n\t\t\t\t\t\tchars = $utils.splitString(chunk.text);\n\t\t\t\t\t\tchars.reverse();\n\t\t\t\t\t}\n\n\t\t\t\t\tfor (let i = 0; i < chars.length; i++) {\n\n\t\t\t\t\t\tconst char = chars[i];\n\n\t\t\t\t\t\t// Measure\n\t\t\t\t\t\tconst metrics = this._measureText(char, context);\n\t\t\t\t\t\tlet chunkWidth = metrics.width;\n\n\t\t\t\t\t\t// Chunk width?\n\t\t\t\t\t\tif (currentStyle && currentChunkWidth && (currentChunkWidth > chunkWidth)) {\n\t\t\t\t\t\t\tchunkWidth = currentChunkWidth;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst chunkHeight = metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent;\n\t\t\t\t\t\tif (chunkHeight > lineInfo.height) {\n\t\t\t\t\t\t\tlineInfo.height = chunkHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (metrics.actualBoundingBoxAscent > lineInfo.ascent) {\n\t\t\t\t\t\t\tlineInfo.ascent = metrics.actualBoundingBoxAscent;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttotalWidth += chunkWidth;\n\n\t\t\t\t\t\t// Handle oversized behavior\n\t\t\t\t\t\tif (truncate) {\n\t\t\t\t\t\t\t// Measure ellipsis and check if it fits\n\t\t\t\t\t\t\tif (!ellipsisMetrics) {\n\t\t\t\t\t\t\t\tellipsisMetrics = this._measureText(ellipsis, context);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconst ellipsisWidth = ellipsisMetrics.actualBoundingBoxLeft + ellipsisMetrics.actualBoundingBoxRight;\n\t\t\t\t\t\t\t//totalWidth += ellipsisWidth;\n\t\t\t\t\t\t\tif ((totalWidth + ellipsisWidth) > maxWidth) {\n\t\t\t\t\t\t\t\tif (lineInfo.textChunks.length == 1) {\n\t\t\t\t\t\t\t\t\tthis.textVisible = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t\tlineInfo.width += ellipsisWidth;\n\t\t\t\t\t\t\t\t\tlineInfo.left += ellipsisMetrics.actualBoundingBoxLeft;\n\t\t\t\t\t\t\t\t\tlineInfo.right += ellipsisMetrics.actualBoundingBoxRight;\n\t\t\t\t\t\t\t\t\tlineInfo.textChunks.push({\n\t\t\t\t\t\t\t\t\t\tstyle: currentStyle,\n\t\t\t\t\t\t\t\t\t\tfill: currentFill,\n\t\t\t\t\t\t\t\t\t\ttext: ellipsis,\n\t\t\t\t\t\t\t\t\t\twidth: ellipsisWidth,\n\t\t\t\t\t\t\t\t\t\theight: chunkHeight + ellipsisMetrics.actualBoundingBoxDescent,\n\t\t\t\t\t\t\t\t\t\tleft: ellipsisMetrics.actualBoundingBoxLeft,\n\t\t\t\t\t\t\t\t\t\tright: ellipsisMetrics.actualBoundingBoxRight,\n\t\t\t\t\t\t\t\t\t\tascent: ellipsisMetrics.actualBoundingBoxAscent,\n\t\t\t\t\t\t\t\t\t\toffsetX: 0,\n\t\t\t\t\t\t\t\t\t\toffsetY: chunkHeight,\n\t\t\t\t\t\t\t\t\t\ttextDecoration: undefined\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlineInfo.width += chunkWidth;\n\t\t\t\t\t\tlineInfo.left += metrics.actualBoundingBoxLeft;\n\t\t\t\t\t\tlineInfo.right += metrics.actualBoundingBoxRight;\n\t\t\t\t\t\tlineInfo.textChunks.push({\n\t\t\t\t\t\t\tstyle: currentStyle,\n\t\t\t\t\t\t\tfill: currentFill,\n\t\t\t\t\t\t\ttext: char,\n\t\t\t\t\t\t\twidth: chunkWidth,\n\t\t\t\t\t\t\theight: chunkHeight + metrics.actualBoundingBoxDescent,\n\t\t\t\t\t\t\tleft: metrics.actualBoundingBoxLeft,\n\t\t\t\t\t\t\tright: metrics.actualBoundingBoxRight,\n\t\t\t\t\t\t\tascent: metrics.actualBoundingBoxAscent,\n\t\t\t\t\t\t\toffsetX: 0,\n\t\t\t\t\t\t\toffsetY: chunkHeight,\n\t\t\t\t\t\t\ttextDecoration: undefined\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (rtl) {\n\t\t\t\t\t\t\t// @todo still needed?\n\t\t\t\t\t\t\t//break;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (this.style.lineHeight instanceof Percent) {\n\t\t\t\tlineInfo.height *= this.style.lineHeight.value;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlineInfo.height *= this.style.lineHeight || 1.2;\n\t\t\t}\n\n\t\t\tthis._textInfo!.push(lineInfo);\n\n\t\t\t//lineInfo.offsetY += lineInfo.ascent;\n\t\t\toffsetY += lineInfo.height;\n\n\n\t\t});\n\n\t\tif (!styleRestored) {\n\t\t\tcontext.restore();\n\t\t\tghostContext.restore();\n\t\t}\n\n\n\t\tif (oversizedBehavior == \"hide\" && (totalWidth > maxWidth)) {\n\t\t\tthis.textVisible = false;\n\t\t}\n\n\t\t// Adjust chunk internal offsets\n\t\t$array.each(this._textInfo, (lineInfo) => {\n\t\t\t$array.each(lineInfo.textChunks, (chunk) => {\n\t\t\t\tchunk.offsetY += Math.round((lineInfo.height - chunk.height + (lineInfo.ascent - chunk.ascent)) / 2);\n\t\t\t});\n\t\t});\n\n\t\tcontext.restore();\n\t\tghostContext.restore();\n\n\t\treturn {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0,\n\t\t};\n\t}\n\n}\n\n/**\n * @ignore\n */\nexport class CanvasImage extends CanvasDisplayObject implements IPicture {\n\tpublic width: number | undefined;\n\tpublic height: number | undefined;\n\tpublic image: HTMLImageElement | undefined;\n\tpublic tainted?: boolean;\n\n\tpublic shadowColor?: Color;\n\tpublic shadowBlur?: number;\n\tpublic shadowOffsetX?: number;\n\tpublic shadowOffsetY?: number;\n\tpublic shadowOpacity?: number;\n\n\tprotected _imageMask: HTMLCanvasElement | undefined;\n\n\tconstructor(renderer: CanvasRenderer, image: HTMLImageElement | undefined) {\n\t\tsuper(renderer);\n\t\tthis.image = image;\n\t}\n\n\tprotected _dispose(): void {\n\t\tsuper._dispose();\n\n\t\tif (this._imageMask) {\n\t\t\tclearCanvas(this._imageMask);\n\t\t}\n\t}\n\n\tgetLocalBounds(): IBounds {\n\t\tif (!this._localBounds) {\n\n\n\t\t\tlet w = 0;\n\t\t\tlet h = 0;\n\n\t\t\tif (this.width) {\n\t\t\t\tw = this.width;\n\t\t\t}\n\t\t\tif (this.height) {\n\t\t\t\th = this.height;\n\t\t\t}\n\n\t\t\tthis._localBounds = {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0,\n\t\t\t\tright: w,\n\t\t\t\tbottom: h\n\t\t\t};\n\n\t\t\tthis._addBounds(this._localBounds);\n\t\t}\n\t\treturn this._localBounds;\n\t}\n\n\tprotected _render(status: IStatus, targetGhostLayer: number = 0): void {\n\t\tsuper._render(status);\n\n\t\tif (this.image) {\n\t\t\tif (this.tainted === undefined) {\n\t\t\t\tthis.tainted = isTainted(this.image);\n\t\t\t\tstatus.layer.tainted = true;\n\t\t\t}\n\n\t\t\tif (this.tainted && this._renderer._omitTainted) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst ghostOnly = this._ghostOnly(targetGhostLayer);\n\t\t\tconst drawGhost = this._drawGhost(status, targetGhostLayer);\n\n\t\t\tif (status.layer.dirty && !ghostOnly) {\n\n\t\t\t\tif (this.shadowColor) {\n\t\t\t\t\tstatus.layer.context.shadowColor = this.shadowColor.toCSS(this.shadowOpacity || 1);\n\t\t\t\t}\n\t\t\t\tif (this.shadowBlur) {\n\t\t\t\t\tstatus.layer.context.shadowBlur = this.shadowBlur;\n\t\t\t\t}\n\t\t\t\tif (this.shadowOffsetX) {\n\t\t\t\t\tstatus.layer.context.shadowOffsetX = this.shadowOffsetX;\n\t\t\t\t}\n\t\t\t\tif (this.shadowOffsetY) {\n\t\t\t\t\tstatus.layer.context.shadowOffsetY = this.shadowOffsetY;\n\t\t\t\t}\n\n\t\t\t\t// TODO should this round ?\n\t\t\t\tconst width = this.width || this.image.naturalWidth;\n\t\t\t\tconst height = this.height || this.image.naturalHeight;\n\n\t\t\t\tstatus.layer.context.drawImage(this.image, 0, 0, width, height);\n\t\t\t}\n\n\t\t\tif (this.interactive && this._isInteractive(status) && drawGhost) {\n\t\t\t\tconst mask = this._getMask(this.image);\n\n\t\t\t\tthis._renderer._ghostLayer.context.drawImage(mask, 0, 0);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tsuper.clear();\n\t\tthis.image = undefined;\n\t\tthis._imageMask = undefined;\n\t}\n\n\tprotected _getMask(image: HTMLImageElement): HTMLCanvasElement {\n\t\tif (this._imageMask === undefined) {\n\t\t\t// TODO should this round ?\n\t\t\tconst width = this.width || image.naturalWidth;\n\t\t\tconst height = this.height || image.naturalHeight;\n\n\t\t\t// We need to create a second canvas because destination-in clears out the entire canvas\n\t\t\tconst canvas = document.createElement(\"canvas\");\n\t\t\tcanvas.width = width;\n\t\t\tcanvas.height = height;\n\n\t\t\tconst context = canvas.getContext(\"2d\")!;\n\n\t\t\tcontext.imageSmoothingEnabled = false;\n\n\t\t\tcontext.fillStyle = this._getColorId();\n\t\t\tcontext.fillRect(0, 0, width, height);\n\n\t\t\tif (!isTainted(image)) {\n\t\t\t\tcontext.globalCompositeOperation = \"destination-in\";\n\t\t\t\tcontext.drawImage(image, 0, 0, width, height);\n\t\t\t}\n\n\t\t\tthis._imageMask = canvas;\n\t\t}\n\n\t\treturn this._imageMask;\n\t}\n\n}\n\n/**\n * @ignore\n */\nexport class CanvasRendererEvent<A> implements IRendererEvent<A> {\n\tpublic id: Id;\n\tpublic simulated: boolean = false;\n\tpublic native: boolean = true;\n\n\tconstructor(public event: A, public originalPoint: IPoint, public point: IPoint, public bbox: DOMRect) {\n\t\tif ($utils.supports(\"touchevents\") && event instanceof Touch) {\n\t\t\tthis.id = event.identifier;\n\n\t\t} else {\n\t\t\tthis.id = null;\n\t\t}\n\t}\n}\n\n/**\n * @ignore\n */\ninterface IEvent<Key extends keyof IRendererEvents> {\n\tobject: CanvasDisplayObject;\n\tcontext: unknown;\n\tcallback: (event: IRendererEvents[Key]) => void;\n\tdisposed: boolean;\n}\n\n/**\n * @ignore\n */\ninterface IEvents<Key extends keyof IRendererEvents> {\n\tdisposer: IDisposer;\n\tcallbacks: Array<IEvent<Key>>;\n\tdispatching: boolean;\n\tcleanup: boolean;\n}\n\n/**\n * @ignore\n */\nexport class CanvasRenderer extends ArrayDisposer implements IRenderer, IDisposer {\n\tpublic view: HTMLElement = document.createElement(\"div\");\n\tprotected _layerDom: HTMLElement = document.createElement(\"div\");\n\n\tpublic layers: Array<CanvasLayer> = [];\n\tpublic _dirtyLayers: Array<CanvasLayer> = [];\n\tpublic defaultLayer: CanvasLayer = this.getLayer(0);\n\n\tpublic _ghostLayer: GhostLayer = new GhostLayer();\n\n\tpublic _deferredGhostLayers: Array<number> = [];\n\n\tprotected _patternCanvas: HTMLCanvasElement = document.createElement(\"canvas\");\n\tprotected _patternContext: CanvasRenderingContext2D = this._patternCanvas.getContext(\"2d\")!;\n\n\tprotected _realWidth: number = 0;\n\tprotected _realHeight: number = 0;\n\n\tprotected _calculatedWidth: number = 0;\n\tprotected _calculatedHeight: number = 0;\n\n\tpublic resolution: number;\n\tpublic interactionsEnabled: boolean = true;\n\n\tprotected _listeners: { [key: string]: CounterDisposer } = {};\n\tprotected _events: { [Key in keyof IRendererEvents]?: IEvents<Key> } = {};\n\n\tprotected _colorId: number = 0;\n\tprotected _colorMap: { [color: string]: CanvasDisplayObject } = {};\n\n\tpublic _forceInteractive: number = 0;\n\tpublic _omitTainted: boolean = false;\n\n\t// TODO this should store the Id as well\n\tpublic _hovering: Set<CanvasDisplayObject> = new Set();\n\tpublic _dragging: Array<{ id: Id, value: CanvasDisplayObject }> = [];\n\tpublic _mousedown: Array<{ id: Id, value: CanvasDisplayObject }> = [];\n\n\tprotected _lastPointerMoveEvent: { events: Array<IPointerEvent>, target: Node | null, native: boolean } | undefined;\n\n\tpublic tapToActivate: boolean = false;\n\tpublic tapToActivateTimeout: number = 3000;\n\tpublic _touchActive: boolean = false;\n\tprotected _touchActiveTimeout?: number;\n\n\t/*protected _mouseMoveThrottler: Throttler = new Throttler(() => {\n\t\tthis._dispatchGlobalMousemove(this._lastPointerMoveEvent.event, this._lastPointerMoveEvent.native);\n\t});\n\t*/\n\n\tpublic resetImageArray() {\n\t\tthis._ghostLayer.imageArray = undefined;\n\t}\n\n\tconstructor(resolution?: number) {\n\t\tsuper();\n\n\t\tif (resolution == null) {\n\t\t\tthis.resolution = window.devicePixelRatio;\n\t\t} else {\n\t\t\tthis.resolution = resolution;\n\t\t}\n\n\t\tthis.view.style.position = \"absolute\";\n\t\tthis.view.setAttribute(\"aria-hidden\", \"true\");\n\t\tthis.view.appendChild(this._layerDom);\n\n\t\tthis._disposers.push(new Disposer(() => {\n\t\t\t$object.each(this._events, (_key, events) => {\n\t\t\t\tevents.disposer.dispose();\n\t\t\t});\n\n\t\t\t$array.each(this.layers, (layer) => {\n\t\t\t\tclearCanvas(layer.view);\n\n\t\t\t\tif (layer.exportableView) {\n\t\t\t\t\tclearCanvas(layer.exportableView);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tclearCanvas(this._ghostLayer.view);\n\t\t\tclearCanvas(this._patternCanvas);\n\t\t}));\n\n\t\t/*\n\t\tthis._disposers.push($utils.addEventListener(this._ghostLayer.view, \"click\", (originalEvent: MouseEvent) => {\n\t\t\tconst event = this.getEvent(originalEvent);\n\t\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox);\n\t\t\tconsole.debug(target);\n\t\t}));\n\t\t*/\n\n\t\t// Monitor for possible pixel ratio changes (when page is zoomed)\n\t\tthis._disposers.push($utils.onZoom(() => {\n\t\t\tif (resolution == null) {\n\t\t\t\tthis.resolution = window.devicePixelRatio;\n\t\t\t}\n\t\t}));\n\n\t\t// We need this in order top prevent default touch gestures when dragging\n\t\t// draggable elements\n\t\tif ($utils.supports(\"touchevents\")) {\n\t\t\tconst listener = (ev: any) => {\n\t\t\t\tif (this._dragging.length !== 0) {\n\t\t\t\t\t$array.eachContinue(this._dragging, (item) => {\n\t\t\t\t\t\tif (item.value.shouldCancelTouch()) {\n\t\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// If touch down happends, delay touch out\n\t\t\t\tif (this._touchActiveTimeout) {\n\t\t\t\t\tthis._delayTouchDeactivate();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis._disposers.push($utils.addEventListener(window, \"touchstart\", listener, { passive: false }));\n\t\t\tthis._disposers.push($utils.addEventListener(this.view, \"touchstart\", listener, { passive: false }));\n\n\t\t\tthis._disposers.push($utils.addEventListener(this.view, \"touchmove\", () => {\n\t\t\t\t// If touch is moving, delay touch out\n\t\t\t\tif (this._touchActiveTimeout) {\n\t\t\t\t\tthis._delayTouchDeactivate();\n\t\t\t\t}\n\t\t\t}, { passive: true }));\n\n\t\t\tthis._disposers.push($utils.addEventListener(window, \"click\", (_ev: any) => {\n\t\t\t\tthis._touchActive = false;\n\t\t\t}, { passive: true }));\n\n\t\t\tthis._disposers.push($utils.addEventListener(this.view, \"click\", (_ev: any) => {\n\t\t\t\twindow.setTimeout(() => {\n\t\t\t\t\tthis._touchActive = true;\n\t\t\t\t\tthis._delayTouchDeactivate();\n\t\t\t\t}, 100);\n\t\t\t}, { passive: true }));\n\n\t\t}\n\n\t\t// Prevent scrolling of the window when hovering on \"wheelable\" object\n\t\tif ($utils.supports(\"wheelevents\")) {\n\t\t\tthis._disposers.push($utils.addEventListener(this.view, \"wheel\", (ev) => {\n\t\t\t\tlet prevent = false;\n\t\t\t\tthis._hovering.forEach((obj) => {\n\t\t\t\t\tif (obj.wheelable) {\n\t\t\t\t\t\tprevent = true;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (prevent) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t}\n\t\t\t}, { passive: false }));\n\t\t}\n\n\t}\n\n\tprotected _delayTouchDeactivate(): void {\n\t\tif (this._touchActiveTimeout) {\n\t\t\tclearTimeout(this._touchActiveTimeout);\n\t\t}\n\t\tif (this.tapToActivateTimeout > 0) {\n\t\t\tthis._touchActiveTimeout = window.setTimeout(() => {\n\t\t\t\tthis._touchActive = false;\n\t\t\t}, this.tapToActivateTimeout);\n\t\t}\n\t}\n\n\tpublic get debugGhostView(): boolean {\n\t\treturn !!this._ghostLayer.view.parentNode;\n\t}\n\n\tpublic set debugGhostView(value: boolean) {\n\t\tif (value) {\n\t\t\tif (!this._ghostLayer.view.parentNode) {\n\t\t\t\tthis.view.appendChild(this._ghostLayer.view);\n\t\t\t}\n\n\t\t} else {\n\t\t\tif (this._ghostLayer.view.parentNode) {\n\t\t\t\tthis._ghostLayer.view.parentNode.removeChild(this._ghostLayer.view);\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateLinearGradient(x1: number, y1: number, x2: number, y2: number): CanvasGradient {\n\t\treturn this.defaultLayer.context.createLinearGradient(x1, y1, x2, y2);\n\t}\n\n\tcreateRadialGradient(x1: number, y1: number, radius1: number, x2: number, y2: number, radius2: number): CanvasGradient {\n\t\treturn this.defaultLayer.context.createRadialGradient(x1, y1, radius1, x2, y2, radius2);\n\t}\n\n\tcreatePattern(graphics: CanvasGraphics, background: CanvasGraphics, repetition: string, width: number, height: number): CanvasPattern {\n\t\t// const patternCanvas = document.createElement(\"canvas\");\n\t\t// const patternContext = patternCanvas.getContext(\"2d\")!;\n\t\t// patternCanvas.width = width;\n\t\t// patternCanvas.height = height;\n\t\t// if (fill) {\n\t\t// \tpatternContext.fillStyle = fill.toCSS();\n\t\t// \tpatternContext.fillRect(0, 0, patternCanvas.width, patternCanvas.height);\n\t\t// }\n\n\t\t// const layer = {\n\t\t// \tview: patternCanvas,\n\t\t// \tcontext: patternContext,\n\t\t// \tvisible: true,\n\t\t// \torder: 0,\n\t\t// \twidth: width,\n\t\t// \theight: height,\n\t\t// \tdirty: true\n\t\t// };\n\n\t\t// // patternContext.arc(0, 0, 50, 0, .5 * Math.PI);\n\t\t// // patternContext.stroke();\n\n\t\t// image.targetLayer = layer;\n\t\t// image.render(layer);\n\n\t\t//this._layerDom.appendChild(patternCanvas);\n\n\t\tthis._patternCanvas.width = width;\n\t\tthis._patternCanvas.height = height;\n\n\t\tthis._patternContext.clearRect(0, 0, width, height);\n\n\t\t// patternCanvas.style.width = width * this.resolution + \"px\";\n\t\t// patternCanvas.style.height = height * this.resolution + \"px\";\n\n\t\tbackground.renderDetached(this._patternContext);\n\t\tgraphics.renderDetached(this._patternContext);\n\n\t\treturn this._patternContext.createPattern(this._patternCanvas, repetition)!;\n\t}\n\n\n\n\tmakeContainer(): CanvasContainer {\n\t\treturn new CanvasContainer(this);\n\t}\n\n\tmakeGraphics(): CanvasGraphics {\n\t\treturn new CanvasGraphics(this);\n\t}\n\n\tmakeText(text: string, style: CanvasTextStyle): CanvasText {\n\t\treturn new CanvasText(this, text, style);\n\t}\n\n\tmakeTextStyle(): CanvasTextStyle {\n\t\treturn new CanvasTextStyle();\n\t}\n\n\tmakeRadialText(text: string, style: CanvasTextStyle): CanvasRadialText {\n\t\treturn new CanvasRadialText(this, text, style);\n\t}\n\n\tmakePicture(image: HTMLImageElement | undefined): CanvasImage {\n\t\treturn new CanvasImage(this, image);\n\t}\n\n\tresizeLayer(layer: CanvasLayer) {\n\t\tlayer.resize(this._calculatedWidth, this._calculatedHeight, this._calculatedWidth, this._calculatedHeight, this.resolution);\n\t}\n\n\tresizeGhost() {\n\t\tthis._ghostLayer.resize(this._calculatedWidth, this._calculatedHeight, this._calculatedWidth, this._calculatedHeight, this.resolution);\n\t}\n\n\tresize(realWidth: number, realHeight: number, calculatedWidth: number, calculatedHeight: number): void {\n\t\tthis._realWidth = realWidth;\n\t\tthis._realHeight = realHeight;\n\n\t\tthis._calculatedWidth = calculatedWidth;\n\t\tthis._calculatedHeight = calculatedHeight;\n\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer) {\n\t\t\t\tlayer.dirty = true;\n\t\t\t\tthis.resizeLayer(layer);\n\t\t\t}\n\t\t});\n\n\t\tthis.resizeGhost();\n\n\t\tthis.view.style.width = calculatedWidth + \"px\";\n\t\tthis.view.style.height = calculatedHeight + \"px\";\n\t}\n\n\tprivate createDetachedLayer(willReadFrequently: boolean = false): CanvasLayer {\n\t\tconst view = document.createElement(\"canvas\");\n\t\tconst context = view.getContext(\"2d\", { willReadFrequently: willReadFrequently })! as CanvasRenderingContext2D;\n\n\t\tconst layer = new CanvasLayer(view, context);\n\n\t\tview.style.position = \"absolute\";\n\t\tview.style.top = \"0px\";\n\t\tview.style.left = \"0px\";\n\n\t\treturn layer;\n\t}\n\n\tgetLayerByOrder(order: number): CanvasLayer | undefined {\n\t\tconst layers = this.layers;\n\t\tconst length = layers.length;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst layer = layers[i];\n\t\t\tif (layer.order == order) {\n\t\t\t\treturn layer;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetLayer(order: number, visible: boolean = true): CanvasLayer {\n\t\tlet existingLayer = this.getLayerByOrder(order);\n\t\tif (existingLayer) {\n\t\t\treturn existingLayer;\n\t\t}\n\n\t\tconst layer = this.createDetachedLayer(order == 99);\n\t\tlayer.order = order;\n\t\tlayer.visible = visible;\n\n\t\tlayer.view.className = \"am5-layer-\" + order;\n\n\t\tif (layer.visible) {\n\t\t\tthis.resizeLayer(layer);\n\t\t}\n\n\t\tconst layers = this.layers;\n\n\t\tlayers.push(layer);\n\n\t\tlayers.sort((a, b) => {\n\t\t\tif (a.order > b.order) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse if (a.order < b.order) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t});\n\n\t\tconst length = layers.length;\n\t\tconst layerIndex = $array.indexOf(layers, layer);\n\t\tlet next;\n\n\t\tfor (let i = layerIndex + 1; i < length; i++) {\n\t\t\tif (layers[i].visible) {\n\t\t\t\tnext = layers[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (layer.visible) {\n\t\t\tif (next === undefined) {\n\t\t\t\tthis._layerDom.appendChild(layer.view);\n\n\t\t\t} else {\n\t\t\t\tthis._layerDom.insertBefore(layer.view, next.view);\n\t\t\t}\n\t\t}\n\n\t\treturn layer;\n\t}\n\n\trender(root: CanvasDisplayObject): void {\n\n\t\tthis._dirtyLayers.length = 0;\n\t\tthis._deferredGhostLayers = [];\n\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer) {\n\t\t\t\tif (layer.dirty && layer.visible) {\n\t\t\t\t\tthis._dirtyLayers.push(layer);\n\t\t\t\t\tlayer.clear();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._ghostLayer.clear();\n\n\t\troot.render({\n\t\t\tinactive: null,\n\t\t\tlayer: this.defaultLayer,\n\t\t});\n\n\t\tconst deferredGhostLayers = this._deferredGhostLayers;\n\t\tif (deferredGhostLayers.length) {\n\t\t\tdeferredGhostLayers.sort((a, b) => a - b);\n\t\t\t$array.each(deferredGhostLayers, (layerx) => {\n\t\t\t\troot.render({\n\t\t\t\t\tinactive: null,\n\t\t\t\t\tlayer: this.defaultLayer\n\t\t\t\t}, layerx);\n\t\t\t});\n\t\t}\n\n\t\tthis._ghostLayer.context.restore();\n\n\t\t//setTimeout(() => {\n\n\t\t// Remove this after the Chrome bug is fixed:\n\t\t// https://bugs.chromium.org/p/chromium/issues/detail?id=1279394\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer) {\n\t\t\t\tconst context = layer.context;\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(0, 0);\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t});\n\n\t\t$array.each(this._dirtyLayers, (layer) => {\n\t\t\tlayer.context.restore();\n\t\t\tlayer.dirty = false;\n\t\t});\n\t\t//}, 100)\n\n\t\tif (this._hovering.size && this._lastPointerMoveEvent) {\n\t\t\tconst { events, target, native } = this._lastPointerMoveEvent;\n\n\t\t\t//this._mouseMoveThrottler.run();\n\n\t\t\t$array.each(events, (event) => {\n\t\t\t\tthis._dispatchGlobalMousemove(event, target, native);\n\t\t\t});\n\t\t}\n\t}\n\n\tpaintId(obj: CanvasDisplayObject): string {\n\t\tconst id = distributeId(++this._colorId);\n\t\tconst color = Color.fromHex(id).toCSS();\n\t\tthis._colorMap[color] = obj;\n\t\treturn color;\n\t}\n\n\t_removeObject(obj: CanvasDisplayObject): void {\n\t\tif (obj._colorId !== undefined) {\n\t\t\tdelete this._colorMap[obj._colorId];\n\t\t}\n\t}\n\n\t// protected _identifyObjectByColor(colorId: number): CanvasDisplayObject | undefined {\n\t// \treturn this._colorMap[colorId];\n\t// }\n\n\tprotected _adjustBoundingBox(bbox: DOMRect): DOMRect {\n\t\tconst margin = this._ghostLayer.margin;\n\n\t\treturn new DOMRect(\n\t\t\t-margin.left,\n\t\t\t-margin.top,\n\t\t\tbbox.width + margin.left + margin.right,\n\t\t\tbbox.height + margin.top + margin.bottom,\n\t\t);\n\t}\n\n\tpublic getEvent<A extends IPointerEvent>(originalEvent: A, adjustPoint: boolean = true): CanvasRendererEvent<A> {\n\t\tconst bbox = this.view.getBoundingClientRect();\n\n\t\tconst x = originalEvent.clientX || 0;\n\t\tconst y = originalEvent.clientY || 0;\n\n\t\tconst widthScale = this._calculatedWidth / this._realWidth;\n\t\tconst heightScale = this._calculatedHeight / this._realHeight;\n\n\t\tconst originalPoint: IPoint = {\n\t\t\tx: x - bbox.left,\n\t\t\ty: y - bbox.top,\n\t\t};\n\n\t\tconst point: IPoint = {\n\t\t\tx: (x - (adjustPoint ? bbox.left : 0)) * widthScale,\n\t\t\ty: (y - (adjustPoint ? bbox.top : 0)) * heightScale,\n\t\t};\n\n\t\treturn new CanvasRendererEvent(\n\t\t\toriginalEvent,\n\t\t\toriginalPoint,\n\t\t\tpoint,\n\t\t\tthis._adjustBoundingBox(bbox),\n\t\t);\n\t}\n\n\t_getHitTarget(point: IPoint, bbox: DOMRect, target: Node | null): CanvasDisplayObject | undefined | false {\n\t\tif (bbox.width === 0 || bbox.height === 0 || point.x < bbox.left || point.x > bbox.right || point.y < bbox.top || point.y > bbox.bottom) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!target || !this._layerDom.contains(target)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst pixel = this._ghostLayer.getImageData(point, bbox);\n\n\t\tif (pixel.data[0] === 0 && pixel.data[1] === 0 && pixel.data[2] === 0) {\n\t\t\treturn false;\n\t\t}\n\t\tconst colorId = Color.fromRGB(pixel.data[0], pixel.data[1], pixel.data[2]).toCSS();\n\t\tconst hit = this._colorMap[colorId];\n\n\t\treturn hit;\n\t}\n\n\tgetObjectAtPoint(point: IPoint): CanvasDisplayObject | undefined {\n\t\tconst data = this._ghostLayer.getImageArray(point);\n\n\t\tif (data[0] === 0 && data[1] === 0 && data[2] === 0) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst colorId = Color.fromRGB(data[0], data[1], data[2]).toCSS();\n\t\tconst hit = this._colorMap[colorId];\n\n\t\treturn hit;\n\t}\n\n\t_withEvents<Key extends keyof IRendererEvents>(key: Key, f: (events: IEvents<Key>) => void): void {\n\t\tconst events = this._events[key] as IEvents<Key> | undefined;\n\n\t\tif (events !== undefined) {\n\t\t\tevents.dispatching = true;\n\n\t\t\ttry {\n\t\t\t\tf(events);\n\n\t\t\t} finally {\n\t\t\t\tevents.dispatching = false;\n\n\t\t\t\tif (events.cleanup) {\n\t\t\t\t\tevents.cleanup = false;\n\n\t\t\t\t\t$array.keepIf(events.callbacks, (callback) => {\n\t\t\t\t\t\treturn !callback.disposed;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (events.callbacks.length === 0) {\n\t\t\t\t\t\tevents.disposer.dispose();\n\t\t\t\t\t\tdelete this._events[key];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t_dispatchEventAll<Key extends keyof IRendererEvents>(key: Key, event: IRendererEvents[Key]): void {\n\t\tif (!this.interactionsEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._withEvents(key, (events) => {\n\t\t\t$array.each(events.callbacks, (callback) => {\n\t\t\t\tif (!callback.disposed) {\n\t\t\t\t\tcallback.callback.call(callback.context, event);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\t_dispatchEvent<Key extends keyof IRendererEvents>(key: Key, target: CanvasDisplayObject, event: IRendererEvents[Key]): boolean {\n\t\tif (!this.interactionsEnabled) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet dispatched = false;\n\n\t\tthis._withEvents(key, (events) => {\n\t\t\t$array.each(events.callbacks, (callback) => {\n\t\t\t\tif (!callback.disposed && callback.object === target) {\n\t\t\t\t\tcallback.callback.call(callback.context, event);\n\t\t\t\t\tdispatched = true;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\treturn dispatched;\n\t}\n\n\t_dispatchMousedown(originalEvent: IPointerEvent, originalTarget: Node | null): void {\n\t\tconst button = (<PointerEvent>originalEvent).button;\n\t\tif (button != 0 && button != 2 && button != 1 && button !== undefined) {\n\t\t\t// Ignore non-primary mouse buttons\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = this.getEvent(originalEvent);\n\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\n\n\t\tif (target) {\n\t\t\tconst id = event.id;\n\n\t\t\tlet dragged = false;\n\n\t\t\teachTargets(target, (obj) => {\n\t\t\t\tconst info = { id: id, value: obj };\n\n\t\t\t\tthis._mousedown.push(info);\n\n\t\t\t\tif (!dragged && this._dispatchEvent(\"pointerdown\", obj, event)) {\n\t\t\t\t\t// Only dispatch the first element which matches\n\t\t\t\t\tdragged = true;\n\n\t\t\t\t\tconst has = this._dragging.some((x) => {\n\t\t\t\t\t\treturn x.value === obj && x.id === id;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (!has) {\n\t\t\t\t\t\tthis._dragging.push(info);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatchGlobalMousemove(originalEvent: IPointerEvent, originalTarget: Node | null, native: boolean): void {\n\t\tconst event = this.getEvent(originalEvent);\n\n\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\t\tevent.native = native;\n\n\t\tif (target) {\n\t\t\tthis._hovering.forEach((obj) => {\n\t\t\t\tif (!obj.contains(target)) {\n\t\t\t\t\tthis._hovering.delete(obj);\n\t\t\t\t\tif (obj.cursorOverStyle) {\n\t\t\t\t\t\t$utils.setStyle(document.body, \"cursor\", obj._replacedCursorStyle!);\n\t\t\t\t\t}\n\t\t\t\t\tthis._dispatchEvent(\"pointerout\", obj, event);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (event.native) {\n\t\t\t\teachTargets(target, (obj) => {\n\t\t\t\t\tif (!this._hovering.has(obj)) {\n\t\t\t\t\t\tthis._hovering.add(obj);\n\t\t\t\t\t\tif (obj.cursorOverStyle) {\n\t\t\t\t\t\t\tobj._replacedCursorStyle = $utils.getStyle(document.body, \"cursor\");\n\t\t\t\t\t\t\t$utils.setStyle(document.body, \"cursor\", obj.cursorOverStyle);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._dispatchEvent(\"pointerover\", obj, event);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t//} else if (target === false) {\n\t\t} else {\n\t\t\tthis._hovering.forEach((obj) => {\n\t\t\t\tif (obj.cursorOverStyle) {\n\t\t\t\t\t$utils.setStyle(document.body, \"cursor\", obj._replacedCursorStyle!);\n\t\t\t\t}\n\t\t\t\tthis._dispatchEvent(\"pointerout\", obj, event);\n\t\t\t});\n\n\t\t\tthis._hovering.clear();\n\t\t}\n\t\tthis._dispatchEventAll(\"globalpointermove\", event);\n\t}\n\n\tremoveHovering(graphics: CanvasGraphics) {\n\t\tthis._hovering.delete(graphics);\n\t\tif (graphics.cursorOverStyle) {\n\t\t\t$utils.setStyle(document.body, \"cursor\", graphics._replacedCursorStyle!);\n\t\t}\n\t}\n\n\t_dispatchGlobalMouseup(originalEvent: IPointerEvent, native: boolean): void {\n\t\tconst event = this.getEvent(originalEvent);\n\t\tevent.native = native;\n\t\t//const target = this._getHitTarget(event.originalPoint);\n\t\tthis._dispatchEventAll(\"globalpointerup\", event);\n\t}\n\n\t_dispatchDragMove(originalEvent: IPointerEvent): void {\n\t\tif (this._dragging.length !== 0) {\n\t\t\tconst event = this.getEvent(originalEvent);\n\t\t\tconst id = event.id;\n\n\t\t\tthis._dragging.forEach((obj) => {\n\t\t\t\tif (obj.id === id) {\n\t\t\t\t\tthis._dispatchEvent(\"pointermove\", obj.value, event);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatchDragEnd(originalEvent: IPointerEvent, originalTarget: Node | null): void {\n\t\tconst button = (<PointerEvent>originalEvent).button;\n\t\tlet clickevent: \"click\" | \"rightclick\" | \"middleclick\";\n\t\tif (button == 0 || button === undefined) {\n\t\t\tclickevent = \"click\";\n\t\t}\n\t\telse if (button == 2) {\n\t\t\tclickevent = \"rightclick\";\n\t\t}\n\t\telse if (button == 1) {\n\t\t\tclickevent = \"middleclick\";\n\t\t}\n\t\telse {\n\t\t\t// Ignore non-primary mouse buttons\n\t\t\treturn;\n\t\t}\n\n\t\tconst event = this.getEvent(originalEvent);\n\t\tconst id = event.id;\n\n\t\tif (this._mousedown.length !== 0) {\n\t\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\n\t\t\tif (target) {\n\t\t\t\tthis._mousedown.forEach((obj) => {\n\t\t\t\t\tif (obj.id === id && obj.value.contains(target)) {\n\t\t\t\t\t\tthis._dispatchEvent(clickevent, obj.value, event);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._mousedown.length = 0;\n\t\t}\n\n\t\tif (this._dragging.length !== 0) {\n\t\t\tthis._dragging.forEach((obj) => {\n\t\t\t\tif (obj.id === id) {\n\t\t\t\t\tthis._dispatchEvent(\"pointerup\", obj.value, event);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._dragging.length = 0;\n\t\t}\n\t}\n\n\t_dispatchDoubleClick(originalEvent: IPointerEvent, originalTarget: Node | null): void {\n\t\tconst event = this.getEvent(originalEvent);\n\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\n\t\tif (target) {\n\t\t\teachTargets(target, (obj) => {\n\t\t\t\tif (this._dispatchEvent(\"dblclick\", obj, event)) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t_dispatchWheel(originalEvent: WheelEvent, originalTarget: Node | null): void {\n\t\tconst event = this.getEvent(originalEvent);\n\t\tconst target = this._getHitTarget(event.originalPoint, event.bbox, originalTarget);\n\n\t\tif (target) {\n\t\t\teachTargets(target, (obj) => {\n\t\t\t\tif (this._dispatchEvent(\"wheel\", obj, event)) {\n\t\t\t\t\treturn false;\n\t\t\t\t} else {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t_makeSharedEvent(key: string, f: () => IDisposer): IDisposer {\n\t\tif (this._listeners[key] === undefined) {\n\t\t\tconst listener = f();\n\n\t\t\tthis._listeners[key] = new CounterDisposer(() => {\n\t\t\t\tdelete this._listeners[key];\n\t\t\t\tlistener.dispose();\n\t\t\t});\n\t\t}\n\n\t\treturn this._listeners[key].increment();\n\t}\n\n\t_onPointerEvent(name: string, f: (event: Array<IPointerEvent>, target: Node | null, native: boolean) => void): IDisposer {\n\t\tlet native = false;\n\t\tlet timer: number | null = null;\n\n\t\tfunction clear() {\n\t\t\ttimer = null;\n\t\t\tnative = false;\n\t\t}\n\n\t\treturn new MultiDisposer([\n\t\t\tnew Disposer(() => {\n\t\t\t\tif (timer !== null) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t}\n\n\t\t\t\tclear();\n\t\t\t}),\n\n\t\t\t$utils.addEventListener(this.view, $utils.getRendererEvent(name), (_) => {\n\t\t\t\tnative = true;\n\n\t\t\t\tif (timer !== null) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t}\n\n\t\t\t\ttimer = window.setTimeout(clear, 0);\n\t\t\t}),\n\n\t\t\tonPointerEvent(window, name, (ev, target) => {\n\t\t\t\tif (timer !== null) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = null;\n\t\t\t\t}\n\n\t\t\t\tf(ev, target, native);\n\n\t\t\t\tnative = false;\n\t\t\t}),\n\t\t]);\n\t}\n\n\t// This ensures that only a single DOM event is added (e.g. only a single mousemove event listener)\n\t_initEvent(key: keyof IRendererEvents): IDisposer | undefined {\n\t\tswitch (key) {\n\t\t\tcase \"globalpointermove\":\n\t\t\tcase \"pointerover\":\n\t\t\tcase \"pointerout\":\n\t\t\t\treturn this._makeSharedEvent(\"pointermove\", () => {\n\t\t\t\t\tconst listener = (events: Array<IPointerEvent>, target: Node | null, native: boolean) => {\n\t\t\t\t\t\tthis._lastPointerMoveEvent = { events, target, native };\n\n\t\t\t\t\t\t$array.each(events, (event) => {\n\t\t\t\t\t\t\tthis._dispatchGlobalMousemove(event, target, native);\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\n\t\t\t\t\treturn new MultiDisposer([\n\t\t\t\t\t\tthis._onPointerEvent(\"pointerdown\", listener),\n\t\t\t\t\t\tthis._onPointerEvent(\"pointermove\", listener),\n\t\t\t\t\t]);\n\t\t\t\t});\n\t\t\tcase \"globalpointerup\":\n\t\t\t\treturn this._makeSharedEvent(\"pointerup\", () => {\n\t\t\t\t\tconst mouseup = this._onPointerEvent(\"pointerup\", (events, target, native) => {\n\t\t\t\t\t\t$array.each(events, (event) => {\n\t\t\t\t\t\t\tthis._dispatchGlobalMouseup(event, native);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis._lastPointerMoveEvent = { events, target, native };\n\t\t\t\t\t});\n\n\t\t\t\t\tconst pointercancel = this._onPointerEvent(\"pointercancel\", (events, target, native) => {\n\t\t\t\t\t\t$array.each(events, (event) => {\n\t\t\t\t\t\t\tthis._dispatchGlobalMouseup(event, native);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis._lastPointerMoveEvent = { events, target, native };\n\t\t\t\t\t});\n\n\t\t\t\t\treturn new Disposer(() => {\n\t\t\t\t\t\tmouseup.dispose();\n\t\t\t\t\t\tpointercancel.dispose();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\tcase \"click\":\n\t\t\tcase \"rightclick\":\n\t\t\tcase \"middleclick\":\n\t\t\tcase \"pointerdown\":\n\t\t\t/*\n\t\t\t\treturn this._makeSharedEvent(\"pointerdown\", () => {\n\t\t\t\t\treturn this._onPointerEvent(\"pointerdown\", (event, target, native) => {\n\t\t\t\t\t\tthis._lastPointerMoveEvent = { event, target, native };\n\t\t\t\t\t\tthis._dispatchMousedown(event)\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t*/\n\t\t\tcase \"pointermove\":\n\t\t\tcase \"pointerup\":\n\t\t\t\treturn this._makeSharedEvent(\"pointerdown\", () => {\n\t\t\t\t\t//const throttler = new Throttler();\n\n\t\t\t\t\tconst mousedown = this._onPointerEvent(\"pointerdown\", (events, target) => {\n\t\t\t\t\t\t$array.each(events, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchMousedown(ev, target);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\t// TODO handle throttling properly for multitouch\n\t\t\t\t\tconst mousemove = this._onPointerEvent(\"pointermove\", (ev: Array<IPointerEvent>) => {\n\t\t\t\t\t\t//throttler.throttle(() => {\n\t\t\t\t\t\t$array.each(ev, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchDragMove(ev);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst mouseup = this._onPointerEvent(\"pointerup\", (ev: Array<IPointerEvent>, target) => {\n\t\t\t\t\t\t$array.each(ev, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchDragEnd(ev, target);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\tconst pointercancel = this._onPointerEvent(\"pointercancel\", (ev: Array<IPointerEvent>, target) => {\n\t\t\t\t\t\t$array.each(ev, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchDragEnd(ev, target);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\treturn new Disposer(() => {\n\t\t\t\t\t\tmousedown.dispose();\n\t\t\t\t\t\tmousemove.dispose();\n\t\t\t\t\t\tmouseup.dispose();\n\t\t\t\t\t\tpointercancel.dispose();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\tcase \"dblclick\":\n\t\t\t\treturn this._makeSharedEvent(\"dblclick\", () => {\n\t\t\t\t\treturn this._onPointerEvent(\"dblclick\", (ev, target) => {\n\t\t\t\t\t\t$array.each(ev, (ev) => {\n\t\t\t\t\t\t\tthis._dispatchDoubleClick(ev, target);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\tcase \"wheel\":\n\t\t\t\treturn this._makeSharedEvent(\"wheel\", () => {\n\t\t\t\t\treturn $utils.addEventListener(this.view, $utils.getRendererEvent(\"wheel\"), (event: WheelEvent) => {\n\t\t\t\t\t\tthis._dispatchWheel(event, $utils.getEventTarget(event));\n\t\t\t\t\t}, { passive: false });\n\t\t\t\t});\n\t\t}\n\t}\n\n\t_addEvent<C, Key extends keyof IRendererEvents>(object: CanvasDisplayObject, key: Key, callback: (this: C, event: IRendererEvents[Key]) => void, context?: C): IDisposer {\n\t\tlet events: IEvents<Key> | undefined = this._events[key] as any;\n\n\t\tif (events === undefined) {\n\t\t\tevents = this._events[key] = {\n\t\t\t\tdisposer: this._initEvent(key)!,\n\t\t\t\tcallbacks: [],\n\t\t\t\tdispatching: false,\n\t\t\t\tcleanup: false,\n\t\t\t};\n\t\t}\n\n\t\tconst listener = { object, context, callback, disposed: false };\n\n\t\tevents!.callbacks.push(listener);\n\n\t\treturn new Disposer(() => {\n\t\t\tlistener.disposed = true;\n\n\t\t\tif (events!.dispatching) {\n\t\t\t\tevents!.cleanup = true;\n\n\t\t\t} else {\n\t\t\t\t$array.removeFirst(events!.callbacks, listener);\n\n\t\t\t\tif (events!.callbacks.length === 0) {\n\t\t\t\t\tevents!.disposer.dispose();\n\t\t\t\t\tdelete this._events[key];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic getCanvas(root: CanvasDisplayObject, options?: ICanvasOptions): HTMLCanvasElement {\n\n\t\t// Make sure everything is rendered\n\t\tthis.render(root);\n\n\t\tif (!options) {\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet scale: number = this.resolution;\n\n\t\tlet canvasWidth = Math.floor(this._calculatedWidth * this.resolution);\n\t\tlet canvasHeight = Math.floor(this._calculatedHeight * this.resolution);\n\n\t\t// Check if we need to scale\n\t\tif (options.minWidth && (options.minWidth > canvasWidth)) {\n\t\t\tlet minScale = options.minWidth / canvasWidth;\n\t\t\tif (minScale > scale) {\n\t\t\t\tscale = minScale * this.resolution;\n\t\t\t}\n\t\t}\n\n\t\tif (options.minHeight && (options.minHeight > canvasHeight)) {\n\t\t\tlet minScale = options.minHeight / canvasHeight;\n\t\t\tif (minScale > scale) {\n\t\t\t\tscale = minScale * this.resolution;\n\t\t\t}\n\t\t}\n\n\t\tif (options.maxWidth && (options.maxWidth < canvasWidth)) {\n\t\t\tlet maxScale = options.maxWidth / canvasWidth;\n\t\t\tif (maxScale < scale) {\n\t\t\t\tscale = maxScale * this.resolution;\n\t\t\t}\n\t\t}\n\n\t\tif (options.maxHeight && (options.maxHeight > canvasHeight)) {\n\t\t\tlet maxScale = options.maxHeight / canvasHeight;\n\t\t\tif (maxScale < scale) {\n\t\t\t\tscale = maxScale * this.resolution;\n\t\t\t}\n\t\t}\n\n\t\t// Check if we need to compensate for pixel ratio\n\t\tif (options.maintainPixelRatio) {\n\t\t\tscale /= this.resolution;\n\t\t}\n\n\t\t// Init list canvases to remove from DOM after export\n\t\tconst canvases: HTMLCanvasElement[] = [];\n\n\t\t// Set up new canvas for export\n\t\tlet forceRender = false;\n\t\tconst canvas = document.createElement(\"canvas\");\n\t\tif (scale != this.resolution) {\n\t\t\tforceRender = true;\n\t\t\tcanvasWidth = canvasWidth * scale / this.resolution;\n\t\t\tcanvasHeight = canvasHeight * scale / this.resolution;\n\t\t}\n\n\t\tcanvas.width = canvasWidth;\n\t\tcanvas.height = canvasHeight;\n\n\t\t// Add to DOM so it inherits CSS\n\t\tcanvas.style.position = \"fixed\";\n\t\tcanvas.style.top = \"-10000px\";\n\t\tthis.view.appendChild(canvas);\n\t\tcanvases.push(canvas);\n\n\t\t// Context\n\t\tconst context = canvas.getContext(\"2d\")!;\n\n\t\tlet width = 0;\n\t\tlet height = 0;\n\t\tlet needRerender = false;\n\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer && layer.visible) {\n\t\t\t\tif (layer.tainted || forceRender) {\n\t\t\t\t\tneedRerender = true;\n\n\t\t\t\t\tlayer.exportableView = layer.view;\n\t\t\t\t\tlayer.exportableContext = layer.context;\n\n\t\t\t\t\tlayer.view = document.createElement(\"canvas\");\n\n\t\t\t\t\t// Add to DOM so it inherits CSS\n\t\t\t\t\tlayer.view.style.position = \"fixed\";\n\t\t\t\t\tlayer.view.style.top = \"-10000px\";\n\t\t\t\t\tthis.view.appendChild(layer.view);\n\t\t\t\t\tcanvases.push(layer.view);\n\n\t\t\t\t\tlet extraX = 0;\n\t\t\t\t\tlet extraY = 0;\n\t\t\t\t\tif (layer.margin) {\n\t\t\t\t\t\textraX += layer.margin.left || 0 + layer.margin.right || 0;\n\t\t\t\t\t\textraY += layer.margin.top || 0 + layer.margin.bottom || 0;\n\t\t\t\t\t}\n\n\t\t\t\t\tlayer.view.width = canvasWidth + extraX;\n\t\t\t\t\tlayer.view.height = canvasHeight + extraY;\n\n\t\t\t\t\tlayer.context = layer.view.getContext(\"2d\")!;\n\n\t\t\t\t\tlayer.dirty = true;\n\t\t\t\t\tlayer.scale = scale;\n\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tif (needRerender) {\n\t\t\tthis._omitTainted = true;\n\t\t\tthis.render(root);\n\t\t\tthis._omitTainted = false;\n\t\t}\n\n\t\t$array.each(this.layers, (layer) => {\n\t\t\tif (layer && layer.visible) {\n\n\t\t\t\t// Layer is fine. Just plop it into our target canvas\n\t\t\t\tlet x = 0;\n\t\t\t\tlet y = 0;\n\t\t\t\tif (layer.margin) {\n\t\t\t\t\tx = -(layer.margin.left || 0) * this.resolution;\n\t\t\t\t\ty = -(layer.margin.top || 0) * this.resolution;\n\t\t\t\t}\n\t\t\t\tcontext.drawImage(layer.view, x, y);\n\n\t\t\t\t// Restore layer original canvas\n\t\t\t\tif (layer.exportableView) {\n\t\t\t\t\tlayer.view = layer.exportableView;\n\t\t\t\t\tlayer.exportableView = undefined;\n\t\t\t\t}\n\n\t\t\t\tif (layer.exportableContext) {\n\t\t\t\t\tlayer.context = layer.exportableContext;\n\t\t\t\t\tlayer.exportableContext = undefined;\n\t\t\t\t}\n\n\t\t\t\tif (width < layer.view.clientWidth) {\n\t\t\t\t\twidth = layer.view.clientWidth;\n\t\t\t\t}\n\t\t\t\tif (height < layer.view.clientHeight) {\n\t\t\t\t\theight = layer.view.clientHeight;\n\t\t\t\t}\n\n\t\t\t\tlayer.scale = undefined;\n\t\t\t}\n\t\t});\n\n\t\tcanvas.style.width = width + \"px\";\n\t\tcanvas.style.height = height + \"px\";\n\n\t\t$array.each(canvases, (canvas) => {\n\t\t\tcanvas.style.position = \"\";\n\t\t\tcanvas.style.top = \"\";\n\t\t\tthis.view.removeChild(canvas);\n\t\t})\n\t\treturn canvas;\n\t}\n}\n\n\nclass GhostLayer {\n\tpublic view: HTMLCanvasElement;\n\tpublic context: CanvasRenderingContext2D;\n\tpublic margin: IMargin = {\n\t\tleft: 0,\n\t\tright: 0,\n\t\ttop: 0,\n\t\tbottom: 0,\n\t};\n\n\tprivate _resolution: number = 1;\n\tprivate _width: number = 0;\n\tprivate _height: number = 0;\n\n\tpublic imageArray?: Uint8ClampedArray;\n\n\tconstructor() {\n\t\tthis.view = document.createElement(\"canvas\");\n\t\tthis.context = this.view.getContext(\"2d\", { alpha: false, willReadFrequently: true })! as CanvasRenderingContext2D;\n\t\tthis.context.imageSmoothingEnabled = false;\n\n\t\tthis.view.style.position = \"absolute\";\n\t\tthis.view.style.top = \"0px\";\n\t\tthis.view.style.left = \"0px\";\n\t}\n\n\tresize(canvasWidth: number, canvasHeight: number, domWidth: number, domHeight: number, resolution: number) {\n\t\tthis._resolution = resolution;\n\n\t\tcanvasWidth += (this.margin.left + this.margin.right);\n\t\tcanvasHeight += (this.margin.top + this.margin.bottom);\n\n\t\t// TODO this should take into account calculateSize\n\t\tdomWidth += (this.margin.left + this.margin.right);\n\t\tdomHeight += (this.margin.top + this.margin.bottom);\n\n\t\tthis.view.style.left = -this.margin.left + \"px\";\n\t\tthis.view.style.top = -this.margin.top + \"px\";\n\n\t\tthis._width = Math.floor(canvasWidth * resolution);\n\t\tthis._height = Math.floor(canvasHeight * resolution);\n\n\t\tthis.view.width = this._width;\n\t\tthis.view.style.width = domWidth + \"px\";\n\n\t\tthis.view.height = this._height;\n\t\tthis.view.style.height = domHeight + \"px\";\n\t}\n\n\tgetImageData(point: IPoint, bbox: DOMRect): ImageData {\n\t\treturn this.context.getImageData(\n\t\t\t// TODO should this round ?\n\t\t\tMath.round(((point.x - bbox.left) / bbox.width) * this._width),\n\t\t\tMath.round(((point.y - bbox.top) / bbox.height) * this._height),\n\t\t\t1,\n\t\t\t1,\n\t\t);\n\t}\n\n\tgetImageArray(point: IPoint): Array<number> {\n\n\t\tif (!this.imageArray) {\n\t\t\tthis.imageArray = this.context.getImageData(0, 0, this._width, this._height).data;\n\t\t}\n\n\t\tconst data = this.imageArray;\n\n\t\tconst x = Math.round(point.x * this._resolution);\n\t\tconst y = Math.round(point.y * this._resolution);\n\n\t\tconst i = (y * this._width + x) * 4;\n\t\treturn [data[i], data[i + 1], data[i + 2], data[i + 3]];\n\t}\n\n\tsetMargin(layers: Array<CanvasLayer>): void {\n\t\tthis.margin.left = 0;\n\t\tthis.margin.right = 0;\n\t\tthis.margin.top = 0;\n\t\tthis.margin.bottom = 0;\n\n\t\t$array.each(layers, (layer) => {\n\t\t\tif (layer.margin) {\n\t\t\t\tthis.margin.left = Math.max(this.margin.left, layer.margin.left);\n\t\t\t\tthis.margin.right = Math.max(this.margin.right, layer.margin.right);\n\t\t\t\tthis.margin.top = Math.max(this.margin.top, layer.margin.top);\n\t\t\t\tthis.margin.bottom = Math.max(this.margin.bottom, layer.margin.bottom);\n\t\t\t}\n\t\t});\n\t}\n\n\tclear() {\n\t\tthis.context.save();\n\t\tthis.context.fillStyle = '#000';\n\t\tthis.context.fillRect(0, 0, this._width, this._height);\n\t}\n}\n\n\n/**\n * @ignore\n */\nexport class CanvasLayer implements ILayer {\n\tpublic view: HTMLCanvasElement;\n\tpublic context: CanvasRenderingContext2D;\n\tpublic tainted: boolean = true;\n\tpublic margin: IMargin | undefined;\n\tpublic order: number = 0;\n\tpublic visible: boolean = true;\n\tpublic width: number | undefined;\n\tpublic height: number | undefined;\n\tpublic scale: number | undefined;\n\tpublic dirty: boolean = true;\n\tpublic exportableView: HTMLCanvasElement | undefined;\n\tpublic exportableContext: CanvasRenderingContext2D | undefined;\n\n\tprivate _width: number = 0;\n\tprivate _height: number = 0;\n\n\tconstructor(view: HTMLCanvasElement, context: CanvasRenderingContext2D) {\n\t\tthis.view = view;\n\t\tthis.context = context;\n\t}\n\n\tresize(canvasWidth: number, canvasHeight: number, domWidth: number, domHeight: number, resolution: number) {\n\t\t// TODO should this take into account calculateSize ?\n\t\tif (this.width != null) {\n\t\t\tcanvasWidth = this.width;\n\t\t\tdomWidth = this.width;\n\t\t}\n\n\t\t// TODO should this take into account calculateSize ?\n\t\tif (this.height != null) {\n\t\t\tcanvasHeight = this.height;\n\t\t\tdomHeight = this.height;\n\t\t}\n\n\t\tif (this.margin) {\n\t\t\tcanvasWidth += (this.margin.left + this.margin.right);\n\t\t\tcanvasHeight += (this.margin.top + this.margin.bottom);\n\n\t\t\t// TODO this should take into account calculateSize\n\t\t\tdomWidth += (this.margin.left + this.margin.right);\n\t\t\tdomHeight += (this.margin.top + this.margin.bottom);\n\n\t\t\tthis.view.style.left = -this.margin.left + \"px\";\n\t\t\tthis.view.style.top = -this.margin.top + \"px\";\n\n\t\t} else {\n\t\t\tthis.view.style.left = \"0px\";\n\t\t\tthis.view.style.top = \"0px\";\n\t\t}\n\n\t\tthis._width = Math.floor(canvasWidth * resolution);\n\t\tthis._height = Math.floor(canvasHeight * resolution);\n\n\t\tthis.view.width = this._width;\n\t\tthis.view.style.width = domWidth + \"px\";\n\n\t\tthis.view.height = this._height;\n\t\tthis.view.style.height = domHeight + \"px\";\n\t}\n\n\tclear() {\n\t\tthis.context.save();\n\t\tthis.context.clearRect(0, 0, this._width, this._height);\n\t}\n}\n","import type { IAnimation } from \"./util/Animation\";\nimport type { Entity } from \"./util/Entity\";\nimport type { Sprite } from \"./render/Sprite\";\nimport type { Theme } from \"./Theme\";\nimport type { IPoint } from \"./util/IPoint\";\nimport type { IRenderer, IPointerEvent } from \"./render/backend/Renderer\";\nimport type { Timezone } from \"./util/Timezone\";\n\nimport { AnimationState } from \"./util/Animation\";\nimport { Container } from \"./render/Container\";\nimport { Text } from \"./render/Text\";\nimport { HorizontalLayout } from \"./render/HorizontalLayout\";\nimport { VerticalLayout } from \"./render/VerticalLayout\";\nimport { GridLayout } from \"./render/GridLayout\";\nimport { IDisposer, Disposer } from \"./util/Disposer\";\nimport { ResizeSensor } from \"./util/ResizeSensor\";\nimport { InterfaceColors } from \"./util/InterfaceColors\";\nimport { Graphics } from \"./render/Graphics\";\nimport { Rectangle } from \"./render/Rectangle\";\nimport { Tooltip } from \"./render/Tooltip\";\nimport { NumberFormatter } from \"./util/NumberFormatter\";\nimport { DateFormatter } from \"./util/DateFormatter\";\nimport { DurationFormatter } from \"./util/DurationFormatter\";\nimport { ILocale, Language } from \"./util/Language\";\nimport { Events, EventDispatcher } from \"./util/EventDispatcher\";\nimport { DefaultTheme } from \"../themes/DefaultTheme\";\nimport { CanvasRenderer } from \"./render/backend/CanvasRenderer\";\nimport { p100, percent, isPercent, Percent } from \"./util/Percent\";\nimport { color } from \"./util/Color\";\nimport { populateString } from \"./util/PopulateString\";\nimport { registry } from \"./Registry\";\n\nimport * as $order from \"./util/Order\";\nimport * as $array from \"./util/Array\";\nimport * as $object from \"./util/Object\";\nimport * as $utils from \"./util/Utils\";\nimport * as $type from \"./util/Type\";\n\n\nimport en from \"../../locales/en\";\n\n\nfunction rAF(fps: number | undefined, callback: (currentTime: number) => void): void {\n\tif (fps == null) {\n\t\trequestAnimationFrame(callback);\n\n\t} else {\n\t\tsetTimeout(() => {\n\t\t\trequestAnimationFrame(callback);\n\t\t}, 1000 / fps);\n\t}\n}\n\n\n/**\n * @ignore\n */\ninterface IParent extends Entity {\n\t_prepareChildren(): void;\n\t_updateChildren(): void;\n\t_childrenUpdt: boolean;\n\t_childrenPrep: boolean;\n}\n\ninterface IBounds extends Entity {\n\tdepth(): number;\n\t_updateBounds(): void;\n}\n\n\nexport interface ISize {\n\twidth: number,\n\theight: number,\n}\n\n\nexport interface IRootEvents {\n\tframestarted: {\n\t\ttimestamp: number;\n\t};\n\tframeended: {\n\t\ttimestamp: number;\n\t};\n}\n\n\nexport interface IRootSettings {\n\n\t/**\n\t * Indicates whether chart should use \"safe\" resolution on some memory-limiting\n\t * platforms such as Safari.\n\t *\n\t * @default true\n\t */\n\tuseSafeResolution?: boolean;\n\n\t/**\n\t * Allows defining margins around chart area for tooltips to go outside the\n\t * chart itself.\n\t *\n\t * @since 5.2.24\n\t */\n\ttooltipContainerBounds?: { top: number, left: number, right: number, bottom: number };\n\n\t/**\n\t * Set to `false` to disable all accessibility features.\n\t *\n\t * NOTE: once disabled, accessibility cannot be re-enabled on a live `Root` object.\n\t *\n\t * @default true\n\t * @since 5.3.0\n\t */\n\taccessible?: boolean;\n\n\t/**\n\t * If set to `true`, the parent inner `<div>` element will become a focusable\n\t * element.\n\t *\n\t * @since 5.3.17\n\t * @default false\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/#Accessibility_of_Root_element} for more info\n\t */\n\tfocusable?: boolean;\n\n\t/**\n\t * Distance between focused element and its highlight square in pixels.\n\t *\n\t * @since 5.6.0\n\t * @default 2\n\t */\n\tfocusPadding?: number;\n\n\t/**\n\t * If set to some string, it will be used as inner `<div>` ARIA-LABEL.\n\t *\n\t * Should be used in conjuction with `focusable`.\n\t *\n\t * @since 5.3.17\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/#Accessibility_of_Root_element} for more info\n\t */\n\tariaLabel?: string;\n\n\t/**\n\t * Allows setting a \"role\" for the inner `<div>`.\n\t *\n\t * @since 5.3.17\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/#Accessibility_of_Root_element} for more info\n\t */\n\trole?: string;\n\n\t/**\n\t * Allows for specifying a custom width / height for the chart.\n\t *\n\t * This function will be called automatically when the chart is resized.\n\t */\n\tcalculateSize?: (dimensions: DOMRect) => ISize;\n}\n\n\n// TODO implement Disposer\n/**\n * Root element of the chart.\n *\n * @see {@link https://www.amcharts.com/docs/v5/getting-started/#Root_element} for more info\n */\nexport class Root implements IDisposer {\n\n\t/**\n\t * A reference to original chart container (div element).\n\t */\n\tpublic dom: HTMLElement;\n\tpublic _inner: HTMLElement;\n\n\tprotected _settings: IRootSettings;\n\tprotected _isDirty: boolean = false;\n\tprotected _isDirtyParents: boolean = false;\n\tprotected _isDirtyAnimation: boolean = false;\n\tprotected _dirty: { [id: number]: Entity } = {};\n\tprotected _dirtyParents: { [id: number]: IParent } = {};\n\tprotected _dirtyBounds: { [id: number]: IBounds } = {};\n\tprotected _dirtyPositions: { [id: number]: Sprite } = {};\n\n\tprotected _ticker: ((currentTime: number) => void) | null = null;\n\tprotected _tickers: Array<(currentTime: number) => void> = [];\n\n\tprotected _updateTick: boolean = true;\n\n\t/**\n\t * Root's event dispatcher.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/events/} for more info\n\t */\n\tpublic events: EventDispatcher<Events<this, IRootEvents>> = new EventDispatcher();\n\n\t/**\n\t * @ignore\n\t * @todo needs description\n\t */\n\tpublic animationTime: number | null = null;\n\n\tprivate _animations: Array<IAnimation> = [];\n\n\tpublic _renderer: IRenderer;\n\n\tpublic _rootContainer!: Container;\n\n\t/**\n\t * Main content container.\n\t */\n\tpublic container!: Container;\n\n\t/**\n\t * A [[Container]] used to display tooltips in.\n\t */\n\tpublic tooltipContainer!: Container\n\tprotected _tooltipContainerSettings!: { top: number, left: number, right: number, bottom: number };\n\n\tpublic _tooltip!: Tooltip;\n\n\t// Locale-related\n\n\t/**\n\t * @ignore\n\t */\n\tpublic language: Language = Language.new(this, {});\n\n\t/**\n\t * Locale used by the chart.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/locales/}\n\t */\n\tpublic locale: ILocale = en;\n\n\t// Date-time related\n\n\t/**\n\t * Use UTC when formatting date/time.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/#utc-and-time-zones} for more info\n\t */\n\tpublic utc: boolean = false;\n\n\t/**\n\t * If set, will format date/time in specific time zone.\n\t *\n\t * The value should be named time zone, e.g.:\n\t * `\"America/Vancouver\"`, `\"Australia/Sydney\"`, `\"UTC\"`.\n\t *\n\t * NOTE: Using time zone feature may noticeable affect performance of the\n\t * chart, especially with large data sets, since every single date will need\n\t * to be recalculated.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#time-zone} for more info\n\t * @since 5.1.0\n\t */\n\tpublic timezone?: Timezone;\n\n\t/**\n\t * The maximum FPS that the Root will run at.\n\t *\n\t * If `undefined` it will run at the highest FPS.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Performance} for more info\n\t */\n\tpublic fps: number | undefined;\n\n\t/**\n\t * Number formatter.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-numbers/} for more info\n\t */\n\tpublic numberFormatter: NumberFormatter = NumberFormatter.new(this, {});\n\n\t/**\n\t * Date/time formatter.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n\t */\n\tpublic dateFormatter: DateFormatter = DateFormatter.new(this, {});\n\n\t/**\n\t * Duration formatter.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/formatters/formatting-dates/} for more info\n\t */\n\tpublic durationFormatter: DurationFormatter = DurationFormatter.new(this, {});\n\n\n\t// Accessibility\n\n\t/**\n\t * Global tab index for using for the whole chart\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\n\t */\n\tpublic tabindex: number = 0;\n\n\t//@todo maybe make this better\n\tprotected _tabindexes: Sprite[] = [];\n\n\tprotected _a11yD: boolean = false;\n\tprotected _focusElementDirty: boolean = false;\n\tprotected _focusElementContainer: HTMLDivElement | undefined;\n\tprotected _focusedSprite: Sprite | undefined;\n\tprotected _isShift: boolean | undefined;\n\tprotected _keyboardDragPoint: IPoint | undefined;\n\tprotected _tooltipElementContainer: HTMLDivElement | undefined;\n\tprotected _readerAlertElement: HTMLDivElement | undefined;\n\tprotected _skipNextGroupJump: boolean = true;\n\n\tpublic _logo?: Container;\n\n\tpublic _tooltipDiv: HTMLDivElement | undefined;\n\n\t/**\n\t * Used for dynamically-created CSS and JavaScript with strict source policies.\n\t */\n\tpublic nonce?: string;\n\n\t/**\n\t * Special color set to be used for various controls.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/colors-gradients-and-patterns/#Interface_colors} for more info\n\t */\n\tpublic interfaceColors: InterfaceColors;\n\n\t/**\n\t * An instance of vertical layout object that can be used to set `layout` setting\n\t * of a [[Container]].\n\t *\n\t * @default VerticalLayout.new()\n\t */\n\tpublic verticalLayout: VerticalLayout = VerticalLayout.new(this, {});\n\n\t/**\n\t * An instance of horizontal layout object that can be used to set `layout` setting\n\t * of a [[Container]].\n\t *\n\t * @default HorizontalLayout.new()\n\t */\n\tpublic horizontalLayout: VerticalLayout = HorizontalLayout.new(this, {});\n\n\t/**\n\t * An instance of grid layout object that can be used to set `layout` setting\n\t * of a [[Container]].\n\t *\n\t * @default VerticalLayout.new()\n\t */\n\tpublic gridLayout: VerticalLayout = GridLayout.new(this, {});\n\n\tpublic _paused: boolean = false;\n\n\t/**\n\t * Indicates whether chart should resized automatically when parent container\n\t * width and/or height changes.\n\t *\n\t * If disabled (`autoResize = false`) you can make the chart resize manually\n\t * by calling root element's `resize()` method.\n\t */\n\tpublic autoResize: boolean = true;\n\n\tprotected _fontHash: string = \"\";\n\n\tprotected _isDisposed: boolean = false;\n\tprotected _disposers: Array<IDisposer> = [];\n\n\tprotected _resizeSensorDisposer?: IDisposer;\n\n\tpublic _tooltips: Array<Tooltip> = [];\n\n\tprotected _htmlElementContainer: HTMLDivElement | undefined;\n\tprotected _htmlEnabledContainers: Container[] = [];\n\n\t/**\n\t * Entities that have their `id` setting set.\n\t *\n\t * @since 5.11.0\n\t */\n\tpublic entitiesById: { [index: string]: any } = {};\n\n\tprotected _systemTooltip!: Tooltip;\n\n\tprotected constructor(id: string | HTMLElement, settings: IRootSettings = {}, isReal: boolean) {\n\n\t\tif (!isReal) {\n\t\t\tthrow new Error(\"You cannot use `new Class()`, instead use `Class.new()`\");\n\t\t}\n\n\t\tthis._settings = settings;\n\n\t\tif (settings.accessible == false) {\n\t\t\tthis._a11yD = true;\n\t\t}\n\n\t\tif (settings.useSafeResolution == null) {\n\t\t\tsettings.useSafeResolution = true;\n\t\t}\n\n\t\tlet resolution;\n\n\t\tif (settings.useSafeResolution) {\n\t\t\tresolution = $utils.getSafeResolution();\n\t\t}\n\n\t\tthis._renderer = new CanvasRenderer(resolution);\n\n\t\tlet dom: HTMLElement | null;\n\n\t\tif (id instanceof HTMLElement) {\n\t\t\tdom = id;\n\t\t}\n\t\telse {\n\t\t\tdom = document.getElementById(id);\n\t\t}\n\n\t\t$array.each(registry.rootElements, (root) => {\n\t\t\tif (root.dom === dom) {\n\t\t\t\tif (registry.autoDispose) {\n\t\t\t\t\troot.dispose();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthrow new Error(\"You cannot have multiple Roots on the same DOM node\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.interfaceColors = InterfaceColors.new(this, {});\n\n\t\tif (dom === null) {\n\t\t\tthrow new Error(\"Could not find HTML element with id `\" + id + \"`\");\n\t\t}\n\n\t\tthis.dom = dom;\n\n\t\tlet inner: HTMLDivElement = document.createElement(\"div\");\n\t\tinner.style.position = \"relative\";\n\t\tinner.style.width = \"100%\";\n\t\tinner.style.height = \"100%\";\n\t\tdom.appendChild(inner);\n\n\t\tconst tooltipContainerBounds = settings.tooltipContainerBounds;\n\t\tif (tooltipContainerBounds) {\n\t\t\tthis._tooltipContainerSettings = tooltipContainerBounds;\n\t\t}\n\n\t\tthis._inner = inner;\n\n\t\tthis._updateComputedStyles();\n\n\t\tregistry.rootElements.push(this);\n\t}\n\n\n\tpublic static new(id: string | HTMLElement, settings?: IRootSettings): Root {\n\t\tconst root = new Root(id, settings, true);\n\t\troot._init();\n\t\treturn root;\n\t}\n\n\tpublic moveDOM(id: string | HTMLElement): void {\n\t\tlet dom: HTMLElement | null;\n\n\t\tif (id instanceof HTMLElement) {\n\t\t\tdom = id;\n\t\t}\n\t\telse {\n\t\t\tdom = document.getElementById(id);\n\t\t}\n\n\t\tif (dom) {\n\t\t\twhile (this.dom.childNodes.length > 0) {\n\t\t\t\tdom.appendChild(this.dom.childNodes[0]);\n\t\t\t}\n\t\t\tthis.dom = dom;\n\t\t\tthis._initResizeSensor();\n\t\t\tthis.resize();\n\t\t}\n\n\t}\n\n\n\tprotected _handleLogo(): void {\n\t\tif (this._logo) {\n\t\t\tconst w = this.dom.offsetWidth;\n\t\t\tconst h = this.dom.offsetHeight;\n\t\t\tif ((w <= 150) || (h <= 60)) {\n\t\t\t\tthis._logo.hide();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._logo.show();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _showBranding(): void {\n\t\tif (!this._logo) {\n\t\t\tconst logo = this.tooltipContainer.children.push(Container.new(this, {\n\t\t\t\tinteractive: true,\n\t\t\t\tinteractiveChildren: false,\n\t\t\t\tposition: \"absolute\",\n\t\t\t\tsetStateOnChildren: true,\n\t\t\t\tpaddingTop: 9,\n\t\t\t\tpaddingRight: 9,\n\t\t\t\tpaddingBottom: 9,\n\t\t\t\tpaddingLeft: 9,\n\t\t\t\tscale: .6,\n\t\t\t\ty: percent(100),\n\t\t\t\tcenterY: p100,\n\t\t\t\ttooltipY: 10,\n\t\t\t\ttooltipText: \"Created using amCharts 5\",\n\t\t\t\ttooltipX: p100,\n\t\t\t\tcursorOverStyle: \"pointer\",\n\t\t\t\tbackground: Rectangle.new(this, {\n\t\t\t\t\tfill: color(0x474758),\n\t\t\t\t\tfillOpacity: 0,\n\t\t\t\t\ttooltipY: 5\n\t\t\t\t})\n\t\t\t}));\n\n\n\t\t\tlogo.set(\"tooltip\", this.systemTooltip);\n\n\t\t\tlogo.events.on(\"click\", () => {\n\t\t\t\twindow.open(\"https://www.amcharts.com/\", \"_blank\");\n\t\t\t});\n\n\t\t\tlogo.states.create(\"hover\", {});\n\n\t\t\tconst m = logo.children.push(Graphics.new(this, {\n\t\t\t\tstroke: color(0xcccccc),\n\t\t\t\tstrokeWidth: 3,\n\t\t\t\tsvgPath: \"M5 25 L13 25h13.6c3.4 0 6 0 10.3-4.3s5.2-12 8.6-12c3.4 0 4.3 8.6 7.7 8.6M83.4 25H79.8c-3.4 0-6 0-10.3-4.3s-5.2-12-8.6-12-4.3 8.6-7.7 8.6\"\n\t\t\t}));\n\n\t\t\tm.states.create(\"hover\", { stroke: color(0x3CABFF) });\n\n\t\t\tconst a = logo.children.push(Graphics.new(this, {\n\t\t\t\tstroke: color(0x888888),\n\t\t\t\tstrokeWidth: 3,\n\t\t\t\tsvgPath: \"M83.4 25h-31C37 25 39.5 4.4 28.4 4.4S18.9 24.2 4.3 25H0\"\n\t\t\t}));\n\n\t\t\ta.states.create(\"hover\", { stroke: color(0x474758) });\n\n\t\t\tthis._logo = logo;\n\n\t\t\tthis._handleLogo();\n\n\t\t}\n\t}\n\n\tprotected _getRealSize(): DOMRect {\n\t\treturn this.dom.getBoundingClientRect();\n\t}\n\n\tprotected _getCalculatedSize(rect: DOMRect): ISize {\n\t\tif (this._settings.calculateSize) {\n\t\t\treturn this._settings.calculateSize(rect);\n\n\t\t} else {\n\t\t\treturn {\n\t\t\t\twidth: rect.width,\n\t\t\t\theight: rect.height,\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected _init(): void {\n\n\t\tconst settings = this._settings;\n\t\tif (settings.accessible !== false) {\n\t\t\tif (settings.focusable) {\n\t\t\t\tthis._inner.setAttribute(\"focusable\", \"true\");\n\t\t\t\tthis._inner.setAttribute(\"tabindex\", this.tabindex + \"\");\n\t\t\t}\n\n\t\t\tif (settings.ariaLabel) {\n\t\t\t\tthis._inner.setAttribute(\"aria-label\", settings.ariaLabel);\n\t\t\t}\n\n\t\t\tif (settings.role) {\n\t\t\t\tthis._inner.setAttribute(\"role\", settings.role);\n\t\t\t}\n\t\t}\n\n\t\tconst renderer = this._renderer;\n\n\t\tconst rect = this._getRealSize();\n\t\tconst size = this._getCalculatedSize(rect);\n\n\t\tconst width = Math.floor(size.width);\n\t\tconst height = Math.floor(size.height);\n\n\t\tconst realWidth = Math.floor(rect.width);\n\t\tconst realHeight = Math.floor(rect.height);\n\n\t\tconst rootContainer = Container.new(this, {\n\t\t\tvisible: true,\n\t\t\twidth: width,\n\t\t\theight: height,\n\t\t});\n\t\tthis._rootContainer = rootContainer;\n\t\tthis._rootContainer._defaultThemes.push(DefaultTheme.new(this));\n\n\t\tconst container = rootContainer.children.push(Container.new(this, { visible: true, width: p100, height: p100 }));\n\t\tthis.container = container;\n\n\t\trenderer.resize(realWidth, realHeight, width, height);\n\n\t\t//@todo: better appendChild - refer\n\t\tthis._inner.appendChild(renderer.view);\n\n\t\t// TODO: TMP TMP TMP for testing only, remove\n\t\t//renderer.debugGhostView = true;\n\n\t\tthis._initResizeSensor();\n\n\t\t// HTML content holder\n\t\tconst htmlElementContainer = document.createElement(\"div\");\n\t\tthis._htmlElementContainer = htmlElementContainer;\n\t\thtmlElementContainer.className = \"am5-html-container\";\n\t\thtmlElementContainer.style.position = \"absolute\";\n\t\thtmlElementContainer.style.pointerEvents = \"none\";\n\t\tif (!this._tooltipContainerSettings) {\n\t\t\thtmlElementContainer.style.overflow = \"hidden\";\n\t\t}\n\t\tthis._inner.appendChild(htmlElementContainer);\n\n\t\tif (this._a11yD !== true) {\n\n\t\t\t// Create element which is used to make announcements to screen reader\n\t\t\tconst readerAlertElement = document.createElement(\"div\");\n\t\t\treaderAlertElement.className = \"am5-reader-container\";\n\t\t\treaderAlertElement.setAttribute(\"role\", \"alert\");\n\t\t\t// readerAlertElement.style.zIndex = \"-100000\";\n\t\t\t// readerAlertElement.style.opacity = \"0\";\n\t\t\t// readerAlertElement.style.top = \"0\";\n\t\t\treaderAlertElement.style.position = \"absolute\";\n\t\t\treaderAlertElement.style.width = \"1px\";\n\t\t\treaderAlertElement.style.height = \"1px\";\n\t\t\treaderAlertElement.style.overflow = \"hidden\";\n\t\t\treaderAlertElement.style.clip = \"rect(1px, 1px, 1px, 1px)\";\n\t\t\tthis._readerAlertElement = readerAlertElement;\n\t\t\tthis._inner.appendChild(this._readerAlertElement);\n\n\t\t\tconst focusElementContainer = document.createElement(\"div\");\n\t\t\tfocusElementContainer.className = \"am5-focus-container\";\n\t\t\tfocusElementContainer.style.position = \"absolute\";\n\t\t\tfocusElementContainer.style.pointerEvents = \"none\";\n\t\t\tfocusElementContainer.style.top = \"0px\";\n\t\t\tfocusElementContainer.style.left = \"0px\";\n\t\t\tfocusElementContainer.style.overflow = \"hidden\";\n\t\t\tfocusElementContainer.style.width = width + \"px\";\n\t\t\tfocusElementContainer.style.height = height + \"px\";\n\n\t\t\tfocusElementContainer.setAttribute(\"role\", \"graphics-document\");\n\n\t\t\t$utils.setInteractive(focusElementContainer, false);\n\t\t\tthis._focusElementContainer = focusElementContainer;\n\t\t\tthis._inner.appendChild(this._focusElementContainer);\n\n\t\t\tconst tooltipElementContainer = document.createElement(\"div\");\n\t\t\tthis._tooltipElementContainer = tooltipElementContainer;\n\t\t\ttooltipElementContainer.className = \"am5-tooltip-container\";\n\t\t\tthis._inner.appendChild(tooltipElementContainer);\n\n\t\t\t// Add keyboard events for accessibility, e.g. simulating drag with arrow\n\t\t\t// keys and click with ENTER\n\t\t\tif ($utils.supports(\"keyboardevents\")) {\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(window, \"keydown\", (ev: KeyboardEvent) => {\n\t\t\t\t\tconst eventKey = $utils.getEventKey(ev);\n\t\t\t\t\tif (eventKey == \"Shift\") {\n\t\t\t\t\t\tthis._isShift = true;\n\t\t\t\t\t}\n\t\t\t\t\telse if (eventKey == \"Tab\") {\n\t\t\t\t\t\tthis._isShift = ev.shiftKey;\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(window, \"keyup\", (ev: KeyboardEvent) => {\n\t\t\t\t\tconst eventKey = $utils.getEventKey(ev);\n\t\t\t\t\tif (eventKey == \"Shift\") {\n\t\t\t\t\t\tthis._isShift = false;\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(focusElementContainer, \"click\", () => {\n\t\t\t\t\t// Some screen readers convert ENTER (and some SPACE) press whil on\n\t\t\t\t\t// focused element to a \"click\" event, preventing actual \"keydown\"\n\t\t\t\t\t// event from firing. We're using this \"click\" event to still\n\t\t\t\t\t// generate internal click events.\n\t\t\t\t\tconst focusedSprite = this._focusedSprite;\n\t\t\t\t\tif (focusedSprite) {\n\t\t\t\t\t\tconst announceText = focusedSprite.get(\"clickAnnounceText\", \"\");\n\t\t\t\t\t\tif (announceText !== \"\") {\n\t\t\t\t\t\t\tthis.readerAlert(announceText);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst downEvent = renderer.getEvent(new MouseEvent(\"click\"));\n\t\t\t\t\t\tfocusedSprite.events.dispatch(\"click\", {\n\t\t\t\t\t\t\ttype: \"click\",\n\t\t\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(focusElementContainer, \"keydown\", (ev: KeyboardEvent) => {\n\t\t\t\t\tconst focusedSprite = this._focusedSprite;\n\t\t\t\t\tif (focusedSprite) {\n\t\t\t\t\t\tif (ev.key == \"Escape\") {\n\t\t\t\t\t\t\t// ESC pressed - lose current focus\n\t\t\t\t\t\t\t$utils.blur();\n\t\t\t\t\t\t\tthis._focusedSprite = undefined;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet dragOffsetX = 0;\n\t\t\t\t\t\tlet dragOffsetY = 0;\n\t\t\t\t\t\t// TODO: figure out if using bogus MouseEvent is fine, or it will\n\t\t\t\t\t\t// fail on some platforms\n\t\t\t\t\t\tconst eventKey = $utils.getEventKey(ev);\n\t\t\t\t\t\tswitch (eventKey) {\n\t\t\t\t\t\t\tcase \"Enter\":\n\t\t\t\t\t\t\tcase \" \":\n\t\t\t\t\t\t\t\tconst announceText = focusedSprite.get(\"clickAnnounceText\", \"\");\n\t\t\t\t\t\t\t\tif (announceText !== \"\") {\n\t\t\t\t\t\t\t\t\tthis.readerAlert(announceText);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (eventKey == \" \" && focusedSprite.get(\"role\") != \"checkbox\") {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\t\t\tconst downEvent = renderer.getEvent(new MouseEvent(\"mouse\"));\n\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"click\", {\n\t\t\t\t\t\t\t\t\ttype: \"click\",\n\t\t\t\t\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\tcase \"ArrowLeft\":\n\t\t\t\t\t\t\t\tdragOffsetX = -6;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ArrowRight\":\n\t\t\t\t\t\t\t\tdragOffsetX = 6;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ArrowUp\":\n\t\t\t\t\t\t\t\tdragOffsetY = -6;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ArrowDown\":\n\t\t\t\t\t\t\t\tdragOffsetY = 6;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (dragOffsetX != 0 || dragOffsetY != 0) {\n\t\t\t\t\t\t\tev.preventDefault();\n\n\t\t\t\t\t\t\tif (!focusedSprite.isDragging()) {\n\t\t\t\t\t\t\t\t// Start dragging\n\t\t\t\t\t\t\t\tthis._keyboardDragPoint = {\n\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\ty: 0\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tconst downEvent = renderer.getEvent(new MouseEvent(\"mousedown\", {\n\t\t\t\t\t\t\t\t\tclientX: 0,\n\t\t\t\t\t\t\t\t\tclientY: 0\n\t\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\t\tdownEvent.point = {\n\t\t\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\t\t\ty: 0\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tif (focusedSprite.events.isEnabled(\"pointerdown\")) {\n\t\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"pointerdown\", {\n\t\t\t\t\t\t\t\t\t\ttype: \"pointerdown\",\n\t\t\t\t\t\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\t\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\t// Move focus marker\n\t\t\t\t\t\t\t\t//this._positionFocusElement(focusedSprite);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// Move incrementally\n\t\t\t\t\t\t\tconst dragPoint = this._keyboardDragPoint!;\n\t\t\t\t\t\t\tdragPoint.x += dragOffsetX;\n\t\t\t\t\t\t\tdragPoint.y += dragOffsetY;\n\t\t\t\t\t\t\tconst moveEvent = renderer.getEvent(new MouseEvent(\"mousemove\", {\n\t\t\t\t\t\t\t\tclientX: dragPoint.x,\n\t\t\t\t\t\t\t\tclientY: dragPoint.y\n\t\t\t\t\t\t\t}), false);\n\n\t\t\t\t\t\t\tif (focusedSprite.events.isEnabled(\"globalpointermove\")) {\n\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"globalpointermove\", {\n\t\t\t\t\t\t\t\t\ttype: \"globalpointermove\",\n\t\t\t\t\t\t\t\t\toriginalEvent: moveEvent.event,\n\t\t\t\t\t\t\t\t\tpoint: moveEvent.point,\n\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\tthis._disposers.push($utils.addEventListener(focusElementContainer, \"keyup\", (ev: KeyboardEvent) => {\n\t\t\t\t\tif (this._focusedSprite) {\n\t\t\t\t\t\tconst focusedSprite = this._focusedSprite;\n\t\t\t\t\t\tconst eventKey = $utils.getEventKey(ev);\n\t\t\t\t\t\tswitch (eventKey) {\n\t\t\t\t\t\t\tcase \"ArrowLeft\":\n\t\t\t\t\t\t\tcase \"ArrowRight\":\n\t\t\t\t\t\t\tcase \"ArrowUp\":\n\t\t\t\t\t\t\tcase \"ArrowDown\":\n\t\t\t\t\t\t\t\tif (focusedSprite.isDragging()) {\n\t\t\t\t\t\t\t\t\t// Simulate drag stop\n\t\t\t\t\t\t\t\t\tconst dragPoint = this._keyboardDragPoint!;\n\t\t\t\t\t\t\t\t\tconst upEvent = renderer.getEvent(new MouseEvent(\"mouseup\", {\n\t\t\t\t\t\t\t\t\t\tclientX: dragPoint.x,\n\t\t\t\t\t\t\t\t\t\tclientY: dragPoint.y\n\t\t\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\t\t\tif (focusedSprite.events.isEnabled(\"globalpointerup\")) {\n\t\t\t\t\t\t\t\t\t\tfocusedSprite.events.dispatch(\"globalpointerup\", {\n\t\t\t\t\t\t\t\t\t\t\ttype: \"globalpointerup\",\n\t\t\t\t\t\t\t\t\t\t\toriginalEvent: upEvent.event,\n\t\t\t\t\t\t\t\t\t\t\tpoint: upEvent.point,\n\t\t\t\t\t\t\t\t\t\t\tsimulated: true,\n\t\t\t\t\t\t\t\t\t\t\ttarget: focusedSprite\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t//this._positionFocusElement(focusedSprite);\n\t\t\t\t\t\t\t\t\tthis._keyboardDragPoint = undefined;\n\t\t\t\t\t\t\t\t\t// @todo dispatch mouseup event instead of calling dragStop?\n\t\t\t\t\t\t\t\t\t// this._dispatchEvent(\"globalpointerup\", target, upEvent);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse if (focusedSprite.get(\"focusableGroup\")) {\n\t\t\t\t\t\t\t\t\t// Find next item in focusable group\n\t\t\t\t\t\t\t\t\tconst group = focusedSprite.get(\"focusableGroup\");\n\t\t\t\t\t\t\t\t\tconst items = this._tabindexes.filter((item) => {\n\t\t\t\t\t\t\t\t\t\treturn item.get(\"focusableGroup\") == group && item.getPrivate(\"focusable\") !== false && item.isVisibleDeep() ? true : false;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tlet index = items.indexOf(focusedSprite);\n\t\t\t\t\t\t\t\t\tconst lastIndex = items.length - 1;\n\t\t\t\t\t\t\t\t\tindex += (eventKey == \"ArrowRight\" || eventKey == \"ArrowDown\") ? 1 : -1;\n\t\t\t\t\t\t\t\t\tif (index < 0) {\n\t\t\t\t\t\t\t\t\t\tindex = lastIndex;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse if (index > lastIndex) {\n\t\t\t\t\t\t\t\t\t\tindex = 0;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t$utils.focus(items[index].getPrivate(\"focusElement\")!.dom);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"Tab\":\n\t\t\t\t\t\t\t\tconst group = focusedSprite.get(\"focusableGroup\");\n\t\t\t\t\t\t\t\tif (group && this._isShift) {\n\t\t\t\t\t\t\t\t\tif (!this._skipNextGroupJump) {\n\t\t\t\t\t\t\t\t\t\tthis._focusNext(focusedSprite.getPrivate(\"focusElement\")!.dom, -1, group);\n\t\t\t\t\t\t\t\t\t\tthis._skipNextGroupJump = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\n\t\tthis._startTicker();\n\t\tthis.setThemes([]);\n\n\t\tthis._addTooltip();\n\n\t\tif (!this._hasLicense()) {\n\t\t\tthis._showBranding();\n\t\t}\n\t}\n\n\t/**\n\t * Returns an instance of a universal [[Tooltip]] instance.\n\t * @since 5.14.0\n\t */\n\tpublic get systemTooltip() {\n\t\tif (!this._systemTooltip) {\n\t\t\tconst tooltip = Tooltip.new(this, {\n\t\t\t\tthemeTags: [\"system\"]\n\t\t\t});\n\n\t\t\tthis._systemTooltip = tooltip;\n\t\t}\n\t\treturn this._systemTooltip;\n\t}\n\n\tprivate _initResizeSensor(): void {\n\t\tif (this._resizeSensorDisposer) {\n\t\t\tthis._resizeSensorDisposer.dispose();\n\t\t}\n\t\tthis._resizeSensorDisposer = new ResizeSensor(this.dom, () => {\n\t\t\tif (this.autoResize) {\n\t\t\t\tthis.resize();\n\t\t\t}\n\t\t});\n\t\tthis._disposers.push(this._resizeSensorDisposer);\n\t}\n\n\t/**\n\t * If automatic resizing of char is disabled (`root.autoResize = false`), it\n\t * can be resized manually by calling this method.\n\t */\n\tpublic resize(): void {\n\t\tconst rect = this._getRealSize();\n\t\tconst size = this._getCalculatedSize(rect);\n\t\tconst w = Math.floor(size.width);\n\t\tconst h = Math.floor(size.height);\n\n\t\tif (w > 0 && h > 0) {\n\t\t\tconst realWidth = Math.floor(rect.width);\n\t\t\tconst realHeight = Math.floor(rect.height);\n\n\t\t\tconst htmlElementContainer = this._htmlElementContainer!;\n\t\t\thtmlElementContainer.style.width = w + \"px\";\n\t\t\thtmlElementContainer.style.height = h + \"px\";\n\n\t\t\tif (this._a11yD !== true) {\n\t\t\t\tconst focusElementContainer = this._focusElementContainer!;\n\t\t\t\tfocusElementContainer.style.width = w + \"px\";\n\t\t\t\tfocusElementContainer.style.height = h + \"px\";\n\t\t\t}\n\n\t\t\tthis._renderer.resize(realWidth, realHeight, w, h);\n\n\t\t\tconst rootContainer = this._rootContainer;\n\n\t\t\trootContainer.setPrivate(\"width\", w);\n\t\t\trootContainer.setPrivate(\"height\", h);\n\t\t\tthis._render();\n\t\t\tthis._handleLogo();\n\t\t}\n\t}\n\n\tprivate _render() {\n\t\tthis._renderer.render(this._rootContainer._display);\n\n\t\tif (this._focusElementDirty) {\n\t\t\tthis._updateCurrentFocus();\n\t\t\tthis._focusElementDirty = false;\n\t\t}\n\t}\n\n\tprivate _runTickers(currentTime: number) {\n\t\t$array.each(this._tickers, (f) => {\n\t\t\tf(currentTime);\n\t\t});\n\t}\n\n\tprivate _runAnimations(currentTime: number): boolean {\n\t\tlet running = 0;\n\n\t\t$array.keepIf(this._animations, (animation) => {\n\t\t\tconst state = animation._runAnimation(currentTime);\n\n\t\t\tif (state === AnimationState.Stopped) {\n\t\t\t\treturn false;\n\n\t\t\t} else if (state === AnimationState.Playing) {\n\t\t\t\t++running;\n\t\t\t\treturn true;\n\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t\tthis._isDirtyAnimation = false;\n\n\t\treturn running === 0;\n\t}\n\n\tprivate _runDirties() {\n\t\t//console.log(\"tick **************************************************************\");\n\t\tlet allParents: { [id: number]: IParent } = {};\n\n\t\twhile (this._isDirtyParents) {\n\t\t\t// This must be before calling _prepareChildren\n\t\t\tthis._isDirtyParents = false;\n\n\t\t\t$object.keys(this._dirtyParents).forEach((key) => {\n\t\t\t\tconst parent = this._dirtyParents[key];\n\n\t\t\t\tdelete this._dirtyParents[key];\n\n\t\t\t\tif (!parent.isDisposed()) {\n\t\t\t\t\tallParents[parent.uid] = parent;\n\t\t\t\t\tparent._prepareChildren();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$object.keys(allParents).forEach((key) => {\n\t\t\tallParents[key]._updateChildren();\n\t\t});\n\n\n\t\tconst objects: Array<Entity> = [];\n\n\t\t//\t\tconsole.log(\"_beforeChanged\")\n\t\t$object.keys(this._dirty).forEach((key) => {\n\t\t\tconst entity = this._dirty[key];\n\n\t\t\tif (entity.isDisposed()) {\n\t\t\t\tdelete this._dirty[entity.uid];\n\n\t\t\t} else {\n\t\t\t\tobjects.push(entity);\n\t\t\t\tentity._beforeChanged();\n\t\t\t}\n\t\t});\n\n\t\t//\t\tconsole.log(\"_changed\")\n\t\tobjects.forEach((entity) => {\n\t\t\tentity._changed();\n\t\t\tdelete this._dirty[entity.uid];\n\t\t\tentity._clearDirty();\n\t\t});\n\n\t\tthis._isDirty = false;\n\n\t\tconst depths: { [id: number]: number } = {};\n\t\tconst bounds: Array<IBounds> = [];\n\n\t\t$object.keys(this._dirtyBounds).forEach((key) => {\n\t\t\tconst entity = this._dirtyBounds[key];\n\n\t\t\tdelete this._dirtyBounds[key];\n\n\t\t\tif (!entity.isDisposed()) {\n\t\t\t\tdepths[entity.uid] = entity.depth();\n\t\t\t\tbounds.push(entity);\n\t\t\t}\n\t\t});\n\n\t\tthis._positionHTMLElements();\n\n\t\t// High depth -> low depth\n\t\tbounds.sort((x, y) => {\n\t\t\treturn $order.compare(depths[y.uid], depths[x.uid]);\n\t\t});\n\n\t\t//\t\tconsole.log(\"_updateBounds\")\n\t\tbounds.forEach((entity) => {\n\t\t\tentity._updateBounds();\n\t\t});\n\n\t\t//\t\tconsole.log(\"_updatePosition\")\n\t\tconst dirtyPositions = this._dirtyPositions;\n\t\t$object.keys(dirtyPositions).forEach((key) => {\n\t\t\tconst sprite = dirtyPositions[key];\n\n\t\t\tdelete dirtyPositions[key];\n\n\t\t\tif (!sprite.isDisposed()) {\n\t\t\t\tsprite._updatePosition();\n\t\t\t}\n\t\t});\n\n\t\t//\t\tconsole.log(\"_afterChanged\")\n\t\tobjects.forEach((entity) => {\n\t\t\tentity._afterChanged();\n\t\t});\n\n\t\t$object.keys(allParents).forEach((key) => {\n\t\t\tallParents[key]._childrenPrep = false;\n\t\t\tallParents[key]._childrenUpdt = false;\n\t\t});\n\t}\n\n\tprivate _renderFrame(currentTime: number): boolean {\n\t\tif (this._updateTick) {\n\t\t\tif (this.events.isEnabled(\"framestarted\")) {\n\t\t\t\tthis.events.dispatch(\"framestarted\", {\n\t\t\t\t\ttype: \"framestarted\",\n\t\t\t\t\ttarget: this,\n\t\t\t\t\ttimestamp: currentTime,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis._checkComputedStyles();\n\t\t\tthis._runTickers(currentTime);\n\n\t\t\tconst animationDone = this._runAnimations(currentTime);\n\n\t\t\tthis._runDirties();\n\t\t\tthis._render();\n\t\t\tthis._renderer.resetImageArray();\n\t\t\tthis._positionHTMLElements();\n\n\t\t\tif (this.events.isEnabled(\"frameended\")) {\n\t\t\t\tthis.events.dispatch(\"frameended\", {\n\t\t\t\t\ttype: \"frameended\",\n\t\t\t\t\ttarget: this,\n\t\t\t\t\ttimestamp: currentTime,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this._tickers.length === 0 &&\n\t\t\t\tanimationDone &&\n\t\t\t\t!this._isDirtyAnimation &&\n\t\t\t\t!this._isDirty;\n\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tpublic _runTicker(currentTime: number, now?: boolean) {\n\t\tif (!this.isDisposed()) {\n\t\t\tthis.animationTime = currentTime;\n\n\t\t\tconst done = this._renderFrame(currentTime);\n\n\t\t\t// No more work to do\n\t\t\tif (done) {\n\t\t\t\tthis._ticker = null;\n\t\t\t\tthis.animationTime = null;\n\n\t\t\t} else {\n\t\t\t\tif (!this._paused) {\n\t\t\t\t\tif (now) {\n\t\t\t\t\t\tthis._ticker!\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\trAF(this.fps, this._ticker!);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _runTickerNow(timeout: number = 10000) {\n\t\tif (!this.isDisposed()) {\n\t\t\tconst endTime = performance.now() + timeout;\n\n\t\t\tfor (; ;) {\n\t\t\t\tconst currentTime = performance.now();\n\n\t\t\t\tif (currentTime >= endTime) {\n\t\t\t\t\tthis.animationTime = null;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tthis.animationTime = currentTime;\n\n\t\t\t\tconst done = this._renderFrame(currentTime);\n\n\t\t\t\tif (done) {\n\t\t\t\t\tthis.animationTime = null;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _startTicker() {\n\t\tif (this._ticker === null) {\n\t\t\tthis.animationTime = null;\n\n\t\t\tthis._ticker = (currentTime) => {\n\t\t\t\tthis._runTicker(currentTime);\n\t\t\t};\n\n\t\t\trAF(this.fps, this._ticker!);\n\t\t}\n\t}\n\n\t/**\n\t * Returns whether the root is updating or not.\n\t */\n\tpublic get updateTick(): boolean {\n\t\treturn this._updateTick;\n\t}\n\n\t/**\n\t * Enables or disables the root updating.\n\t */\n\tpublic set updateTick(value: boolean) {\n\t\tthis._updateTick = value;\n\n\t\tif (value) {\n\t\t\tthis._startTicker();\n\t\t}\n\t}\n\n\tpublic _addDirtyEntity(entity: Entity) {\n\t\tthis._isDirty = true;\n\n\t\tif (this._dirty[entity.uid] === undefined) {\n\t\t\tthis._dirty[entity.uid] = entity;\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _addDirtyParent(parent: IParent) {\n\t\tthis._isDirty = true;\n\t\tthis._isDirtyParents = true;\n\n\t\tif (this._dirtyParents[parent.uid] === undefined) {\n\t\t\tthis._dirtyParents[parent.uid] = parent;\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _addDirtyBounds(entity: IBounds) {\n\t\tthis._isDirty = true;\n\n\t\tif (this._dirtyBounds[entity.uid] === undefined) {\n\t\t\tthis._dirtyBounds[entity.uid] = entity;\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _addDirtyPosition(sprite: Sprite) {\n\t\tthis._isDirty = true;\n\n\t\tif (this._dirtyPositions[sprite.uid] === undefined) {\n\t\t\tthis._dirtyPositions[sprite.uid] = sprite;\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _addAnimation(animation: IAnimation) {\n\t\tthis._isDirtyAnimation = true;\n\n\t\t// TODO use numeric id instead\n\t\tif (this._animations.indexOf(animation) === -1) {\n\t\t\tthis._animations.push(animation);\n\t\t}\n\n\t\tthis._startTicker();\n\t}\n\n\tpublic _markDirty() {\n\t\tthis._isDirty = true;\n\t}\n\n\tpublic _markDirtyRedraw() {\n\t\tthis.events.once(\"frameended\", () => {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._startTicker();\n\t\t})\n\t}\n\n\tpublic eachFrame(f: (currentTime: number) => void): IDisposer {\n\t\tthis._tickers.push(f);\n\t\tthis._startTicker();\n\n\t\treturn new Disposer(() => {\n\t\t\t$array.removeFirst(this._tickers, f);\n\t\t});\n\t}\n\n\tpublic markDirtyGlobal(container?: Container): void {\n\t\tif (!container) {\n\t\t\tcontainer = this.container;\n\t\t}\n\t\tcontainer.walkChildren((child) => {\n\t\t\tif (child instanceof Container) {\n\t\t\t\tthis.markDirtyGlobal(child);\n\t\t\t}\n\t\t\tchild.markDirty();\n\t\t\tchild.markDirtyBounds();\n\t\t});\n\t}\n\n\t/**\n\t * Returns width of the target container, in pixels.\n\t *\n\t * @return Width\n\t */\n\tpublic width(): number {\n\t\t// TODO make this more efficient, maybe just return the renderer's width ?\n\t\treturn Math.floor(this._getCalculatedSize(this._getRealSize()).width);\n\t}\n\n\t/**\n\t * Returns height of the target container, in pixels.\n\t *\n\t * @return Height\n\t */\n\tpublic height(): number {\n\t\t// TODO make this more efficient, maybe just return the renderer's height ?\n\t\treturn Math.floor(this._getCalculatedSize(this._getRealSize()).height);\n\t}\n\n\t/**\n\t * Disposes root and all the content in it.\n\t */\n\tpublic dispose(): void {\n\t\tif (!this._isDisposed) {\n\t\t\tthis._isDisposed = true;\n\n\t\t\tthis._rootContainer.dispose();\n\t\t\tthis._renderer.dispose();\n\t\t\tthis.horizontalLayout.dispose();\n\t\t\tthis.verticalLayout.dispose();\n\t\t\tthis.interfaceColors.dispose();\n\n\t\t\t$array.each(this._disposers, (x) => {\n\t\t\t\tx.dispose();\n\t\t\t});\n\n\t\t\tif (this._inner) {\n\t\t\t\t$utils.removeElement(this._inner);\n\t\t\t}\n\n\t\t\t$array.remove(registry.rootElements, this);\n\t\t}\n\t}\n\n\t/**\n\t * Returns `true` if root element is disposed.\n\t *\n\t * @return Disposed?\n\t */\n\tpublic isDisposed(): boolean {\n\t\treturn this._isDisposed;\n\t}\n\n\t/**\n\t * Triggers screen reader read out a message.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/accessibility/} for more info\n\t * @param  text  Alert text\n\t */\n\tpublic readerAlert(text: string): void {\n\t\tif (this._a11yD !== true) {\n\t\t\tconst element = this._readerAlertElement!;\n\t\t\ttext = $utils.stripTags(text);\n\t\t\tif (element.innerHTML == text) {\n\t\t\t\telement.innerHTML = \"\";\n\t\t\t}\n\t\t\telement.innerHTML = text;\n\t\t}\n\t}\n\n\t/**\n\t * Sets themes to be used for the chart.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/concepts/themes/} for more info\n\t * @param  themes  A list of themes\n\t */\n\tpublic setThemes(themes: Array<Theme>): void {\n\t\tthis._rootContainer.set(\"themes\", themes);\n\n\t\t// otherwise new themes are not applied\n\t\tconst tooltipContainer = this.tooltipContainer;\n\t\tif (tooltipContainer) {\n\t\t\ttooltipContainer._applyThemes();\n\t\t}\n\n\t\t// @todo review this\n\t\tconst interfaceColors = this.interfaceColors;\n\t\tif (interfaceColors) {\n\t\t\tinterfaceColors._applyThemes();\n\t\t}\n\n\n\t}\n\n\tprotected _addTooltip() {\n\t\tif (!this.tooltipContainer) {\n\t\t\tconst tooltipContainerSettings = this._tooltipContainerSettings;\n\t\t\tconst tooltipContainer = this._rootContainer.children.push(Container.new(this, {\n\t\t\t\tposition: \"absolute\",\n\t\t\t\tisMeasured: false,\n\t\t\t\twidth: p100,\n\t\t\t\theight: p100,\n\t\t\t\tlayer: tooltipContainerSettings ? 35 : 30,\n\t\t\t\tlayerMargin: tooltipContainerSettings ? tooltipContainerSettings : undefined\n\t\t\t}));\n\t\t\tthis.tooltipContainer = tooltipContainer;\n\n\t\t\tconst tooltip = Tooltip.new(this, {});\n\t\t\tthis.container.set(\"tooltip\", tooltip);\n\t\t\ttooltip.hide(0);\n\t\t\tthis._tooltip = tooltip;\n\t\t}\n\t}\n\n\t/**\n\t * Accesibility\n\t */\n\n\tpublic _registerTabindexOrder(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (target.get(\"focusable\")) {\n\t\t\t$array.pushOne(this._tabindexes, target);\n\t\t}\n\t\telse {\n\t\t\t$array.remove(this._tabindexes, target);\n\t\t}\n\t\tthis._invalidateTabindexes();\n\t}\n\n\tpublic _unregisterTabindexOrder(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t$array.remove(this._tabindexes, target);\n\t\tthis._invalidateTabindexes();\n\t}\n\n\tpublic _invalidateTabindexes(): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._tabindexes.sort((a: Sprite, b: Sprite) => {\n\t\t\tconst aindex = a.get(\"tabindexOrder\", 0);\n\t\t\tconst bindex = b.get(\"tabindexOrder\", 0);\n\t\t\tif (aindex == bindex) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse if (aindex > bindex) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t});\n\n\t\tconst groups: Array<string | number> = [];\n\t\t$array.each(this._tabindexes, (item, index) => {\n\t\t\tif (!item.getPrivate(\"focusElement\")) {\n\t\t\t\tthis._makeFocusElement(index, item);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._moveFocusElement(index, item);\n\t\t\t}\n\t\t\tconst group = item.get(\"focusableGroup\");\n\t\t\tif (group && item.getPrivate(\"focusable\") !== false) {\n\t\t\t\tif (groups.indexOf(group) !== -1) {\n\t\t\t\t\t// Non-first element in the group, make it not directly focusable\n\t\t\t\t\titem.getPrivate(\"focusElement\")!.dom.setAttribute(\"tabindex\", \"-1\");\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tgroups.push(group);\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t}\n\n\tpublic _updateCurrentFocus(): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._focusedSprite) {\n\t\t\tthis._decorateFocusElement(this._focusedSprite);\n\t\t\tthis._positionFocusElement(this._focusedSprite);\n\t\t}\n\t}\n\n\tpublic _decorateFocusElement(target: Sprite, focusElement?: HTMLDivElement): void {\n\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Decorate with proper accessibility attributes\n\t\tif (!focusElement) {\n\t\t\tfocusElement = target.getPrivate(\"focusElement\")!.dom;\n\t\t}\n\n\t\tif (!focusElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst role = target.get(\"role\");\n\t\tif (role) {\n\t\t\tfocusElement.setAttribute(\"role\", role);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"role\");\n\t\t}\n\n\t\tconst ariaLabel = target.get(\"ariaLabel\");\n\t\tif (ariaLabel) {\n\t\t\tconst label = populateString(target, ariaLabel);\n\t\t\tfocusElement.setAttribute(\"aria-label\", label);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-label\");\n\t\t}\n\n\t\tconst ariaLive = target.get(\"ariaLive\");\n\t\tif (ariaLive) {\n\t\t\tfocusElement.setAttribute(\"aria-live\", ariaLive);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-live\");\n\t\t}\n\n\t\tconst ariaChecked = target.get(\"ariaChecked\");\n\t\tif (ariaChecked != null && role && [\"checkbox\", \"option\", \"radio\", \"menuitemcheckbox\", \"menuitemradio\", \"treeitem\"].indexOf(role) !== -1) {\n\t\t\tfocusElement.setAttribute(\"aria-checked\", ariaChecked ? \"true\" : \"false\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-checked\");\n\t\t}\n\n\t\tconst ariaCurrent = target.get(\"ariaCurrent\");\n\t\tif (ariaCurrent != null) {\n\t\t\tfocusElement.setAttribute(\"aria-current\", ariaCurrent);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-current\");\n\t\t}\n\n\t\tconst ariaSelected = target.get(\"ariaSelected\");\n\t\tif (ariaSelected != null && role && [\"gridcell\", \"option\", \"row\", \"tab\", \"columnheader\", \"rowheader\", \"treeitem\"].indexOf(role) !== -1) {\n\t\t\tfocusElement.setAttribute(\"aria-selected\", ariaSelected ? \"true\" : \"false\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-selected\");\n\t\t}\n\n\t\tif (target.get(\"ariaHidden\")) {\n\t\t\tfocusElement.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-hidden\");\n\t\t}\n\n\t\tconst ariaOrientation = target.get(\"ariaOrientation\");\n\t\tif (ariaOrientation) {\n\t\t\tfocusElement.setAttribute(\"aria-orientation\", ariaOrientation);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-orientation\");\n\t\t}\n\n\t\tconst ariaValueNow = target.get(\"ariaValueNow\");\n\t\tif (ariaValueNow) {\n\t\t\tfocusElement.setAttribute(\"aria-valuenow\", ariaValueNow);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuenow\");\n\t\t}\n\n\t\tconst ariaValueMin = target.get(\"ariaValueMin\");\n\t\tif (ariaValueMin) {\n\t\t\tfocusElement.setAttribute(\"aria-valuemin\", ariaValueMin);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuemin\");\n\t\t}\n\n\t\tconst ariaValueMax = target.get(\"ariaValueMax\");\n\t\tif (ariaValueMax) {\n\t\t\tfocusElement.setAttribute(\"aria-valuemax\", ariaValueMax);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuemax\");\n\t\t}\n\n\t\tconst ariaValueText = target.get(\"ariaValueText\");\n\t\tif (ariaValueText) {\n\t\t\tfocusElement.setAttribute(\"aria-valuetext\", ariaValueText);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-valuetext\");\n\t\t}\n\n\t\tconst ariaControls = target.get(\"ariaControls\");\n\t\tif (ariaControls) {\n\t\t\tfocusElement.setAttribute(\"aria-controls\", ariaControls);\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"aria-controls\");\n\t\t}\n\n\t\tif (target.get(\"visible\") && target.get(\"opacity\") !== 0 && target.get(\"role\") != \"tooltip\" && !target.isHidden() && target.getPrivate(\"focusable\") !== false && (target.height() || target.width())) {\n\t\t\tif (focusElement.getAttribute(\"tabindex\") != \"-1\") {\n\t\t\t\tfocusElement.setAttribute(\"tabindex\", \"\" + this.tabindex);\n\t\t\t}\n\t\t\tfocusElement.removeAttribute(\"aria-hidden\");\n\t\t}\n\t\telse {\n\t\t\tfocusElement.removeAttribute(\"tabindex\");\n\t\t\tfocusElement.setAttribute(\"aria-hidden\", \"true\");\n\t\t}\n\t}\n\n\tpublic _makeFocusElement(index: number, target: Sprite): void {\n\n\t\tif (target.getPrivate(\"focusElement\") || this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Init\n\t\tconst focusElement = document.createElement(\"div\");\n\t\tif (target.get(\"role\") != \"tooltip\") {\n\t\t\tfocusElement.tabIndex = this.tabindex;\n\t\t}\n\t\tfocusElement.style.position = \"absolute\";\n\t\t$utils.setInteractive(focusElement, false);\n\n\t\tconst disposers: Array<IDisposer> = [];\n\n\t\ttarget.setPrivate(\"focusElement\", {\n\t\t\tdom: focusElement,\n\t\t\tdisposers,\n\t\t});\n\n\t\tthis._decorateFocusElement(target);\n\n\t\tdisposers.push($utils.addEventListener(focusElement, \"focus\", (ev: FocusEvent) => {\n\t\t\tthis._handleFocus(ev);\n\t\t}));\n\n\t\tdisposers.push($utils.addEventListener(focusElement, \"blur\", (ev: FocusEvent) => {\n\t\t\tthis._handleBlur(ev);\n\t\t}));\n\n\t\tthis._moveFocusElement(index, target);\n\n\t}\n\n\tpublic _removeFocusElement(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t$array.remove(this._tabindexes, target);\n\t\tconst focusElement = target.getPrivate(\"focusElement\");\n\t\tif (focusElement) {\n\t\t\tconst container = this._focusElementContainer!;\n\t\t\tcontainer.removeChild(focusElement.dom);\n\t\t\t$array.each(focusElement.disposers, (x) => {\n\t\t\t\tx.dispose();\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic _hideFocusElement(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focusElement = target.getPrivate(\"focusElement\")!;\n\t\tfocusElement.dom.style.display = \"none\";\n\t}\n\n\tprotected _moveFocusElement(index: number, target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get container\n\t\tconst container = this._focusElementContainer!;\n\t\tconst focusElement = target.getPrivate(\"focusElement\")!.dom;\n\n\t\tif (focusElement === this._focusElementContainer!.children[index]) {\n\t\t\t// Nothing to do\n\t\t\treturn;\n\t\t}\n\n\t\tconst next = this._focusElementContainer!.children[index + 1];\n\t\tif (next) {\n\t\t\tcontainer.insertBefore(focusElement, next);\n\t\t}\n\t\telse {\n\t\t\tcontainer.append(focusElement);\n\t\t}\n\t}\n\n\tprotected _positionFocusElement(target: Sprite): void {\n\t\tif (this._a11yD == true || target == undefined) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._focusElementContainer!.scrollTop = 0;\n\n\t\tconst bounds = target.globalBounds();\n\n\t\tlet width = bounds.right == bounds.left ? target.width() : bounds.right - bounds.left;\n\t\tlet height = bounds.top == bounds.bottom ? target.height() : bounds.bottom - bounds.top;\n\n\t\tconst padding = this._settings.focusPadding !== undefined ? this._settings.focusPadding : 2;\n\n\t\tlet x = bounds.left - padding;\n\t\tlet y = bounds.top - padding;\n\n\t\tif (width < 0) {\n\t\t\tx += width;\n\t\t\twidth = Math.abs(width);\n\t\t}\n\n\t\tif (height < 0) {\n\t\t\ty += height;\n\t\t\theight = Math.abs(height);\n\t\t}\n\n\t\tconst focusElement = target.getPrivate(\"focusElement\")!.dom;\n\t\tfocusElement.style.top = y + \"px\";\n\t\tfocusElement.style.left = x + \"px\";\n\t\tfocusElement.style.width = (width + padding * 2) + \"px\";\n\t\tfocusElement.style.height = (height + padding * 2) + \"px\";\n\n\t}\n\n\tprotected _getSpriteByFocusElement(target: any): Sprite | undefined {\n\t\tlet found: Sprite | undefined;\n\t\t$array.eachContinue(this._tabindexes, (item, _index) => {\n\t\t\tif (item.getPrivate(\"focusElement\")!.dom === target) {\n\t\t\t\tfound = item;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\treturn found;\n\t}\n\n\tprotected _handleFocus(ev: FocusEvent): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Get element\n\t\t//const focused = this._tabindexes[index];\n\t\tconst focused = this._getSpriteByFocusElement(ev.target);\n\n\t\tif (!focused) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Jump over hidden elements\n\t\tif (!focused.isVisibleDeep()) {\n\t\t\tthis._focusNext(<HTMLDivElement>ev.target, this._isShift ? -1 : 1);\n\t\t\treturn;\n\t\t}\n\n\t\t// Size and position\n\t\tthis._positionFocusElement(focused);\n\t\t//this._decorateFocusElement(focused);\n\n\t\tthis._focusedSprite = focused;\n\n\t\tif (focused.events.isEnabled(\"focus\")) {\n\t\t\tfocused.events.dispatch(\"focus\", {\n\t\t\t\ttype: \"focus\",\n\t\t\t\toriginalEvent: ev,\n\t\t\t\ttarget: focused\n\t\t\t});\n\t\t}\n\n\t\tif (focused.getPrivate(\"focusElement\")!.dom.tabIndex == -1) {\n\t\t\tthis._skipNextGroupJump = false;\n\t\t}\n\t}\n\n\tprotected _focusNext(el: HTMLDivElement, direction: 1 | -1, group?: string | number): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focusableElements = Array.from(document.querySelectorAll([\n\t\t\t'a[href]',\n\t\t\t'area[href]',\n\t\t\t'button:not([disabled])',\n\t\t\t'details',\n\t\t\t'input:not([disabled])',\n\t\t\t'iframe:not([disabled])',\n\t\t\t'select:not([disabled])',\n\t\t\t'textarea:not([disabled])',\n\t\t\t'[contentEditable=\"\"]',\n\t\t\t'[contentEditable=\"true\"]',\n\t\t\t'[contentEditable=\"TRUE\"]',\n\t\t\t'[tabindex]:not([tabindex^=\"-\"])',\n\t\t\t//':not([disabled])'\n\t\t].join(',')));\n\n\t\tlet index = focusableElements.indexOf(el) + direction;\n\n\t\tif (index < 0) {\n\t\t\tindex = focusableElements.length - 1;\n\t\t}\n\t\telse if (index >= focusableElements.length) {\n\t\t\tindex = 0;\n\t\t}\n\n\t\tconst targetElement = (<HTMLDivElement>focusableElements[index]);\n\n\t\tif (group && direction == -1) {\n\t\t\tconst target = this._getSpriteByFocusElement(targetElement);\n\t\t\tif (target && target.get(\"focusableGroup\") == group) {\n\t\t\t\tthis._focusNext(targetElement, direction);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\ttargetElement.focus();\n\t}\n\n\tprotected _handleBlur(ev: FocusEvent): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focused = this._focusedSprite;\n\t\tif (focused && !focused.isDisposed() && focused.events.isEnabled(\"blur\")) {\n\t\t\tfocused.events.dispatch(\"blur\", {\n\t\t\t\ttype: \"blur\",\n\t\t\t\toriginalEvent: ev,\n\t\t\t\ttarget: focused\n\t\t\t});\n\t\t}\n\n\t\tthis._focusedSprite = undefined;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic updateTooltip(target: Text): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst text = $utils.stripTags(target._getText());\n\t\tlet tooltipElement = target.getPrivate(\"tooltipElement\");\n\t\tif (target.get(\"role\") == \"tooltip\" && text != \"\") {\n\t\t\tif (!tooltipElement) {\n\t\t\t\ttooltipElement = this._makeTooltipElement(target);\n\t\t\t}\n\t\t\tif (tooltipElement.innerHTML != text) {\n\t\t\t\ttooltipElement.innerHTML = text!;\n\t\t\t}\n\t\t\ttooltipElement.setAttribute(\"aria-hidden\", target.isVisibleDeep() ? \"false\" : \"true\");\n\t\t}\n\t\telse if (tooltipElement) {\n\t\t\ttooltipElement.remove();\n\t\t\ttarget.removePrivate(\"tooltipElement\");\n\t\t}\n\t}\n\n\tpublic _makeTooltipElement(target: Text): HTMLDivElement {\n\t\tconst container = this._tooltipElementContainer!;\n\t\tconst tooltipElement = document.createElement(\"div\");\n\t\ttooltipElement.style.position = \"absolute\";\n\t\ttooltipElement.style.width = \"1px\";\n\t\ttooltipElement.style.height = \"1px\";\n\t\ttooltipElement.style.overflow = \"hidden\";\n\t\ttooltipElement.style.clip = \"rect(1px, 1px, 1px, 1px)\";\n\n\t\t$utils.setInteractive(tooltipElement, false);\n\n\t\tthis._decorateFocusElement(target, tooltipElement);\n\t\tcontainer.append(tooltipElement);\n\t\ttarget.setPrivate(\"tooltipElement\", tooltipElement);\n\n\t\treturn tooltipElement;\n\t}\n\n\tpublic _removeTooltipElement(target: Text): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\t\tconst tooltipElement = target.getPrivate(\"tooltipElement\");\n\t\tif (tooltipElement) {\n\t\t\tconst parent = tooltipElement.parentElement;\n\t\t\tif (parent) {\n\t\t\t\tparent.removeChild(tooltipElement);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic _invalidateAccessibility(target: Sprite): void {\n\t\tif (this._a11yD == true) {\n\t\t\treturn;\n\t\t}\n\t\tthis._focusElementDirty = true;\n\t\tconst focusElement = target.getPrivate(\"focusElement\");\n\t\tif (target.get(\"focusable\")) {\n\t\t\tif (focusElement) {\n\t\t\t\tthis._decorateFocusElement(target);\n\t\t\t\tthis._positionFocusElement(target);\n\t\t\t}\n\t\t\t// else {\n\t\t\t// \tthis._renderer._makeFocusElement(0, this);\n\t\t\t// }\n\t\t}\n\t\telse if (focusElement) {\n\t\t\tthis._removeFocusElement(target);\n\t\t}\n\t\t//this.updateCurrentFocus();\n\t}\n\n\t/**\n\t * Returns `true` if `target` is currently focused.\n\t *\n\t * @param   target  Target\n\t * @return          Focused?\n\t */\n\tpublic focused(target: Sprite): boolean {\n\t\treturn this._focusedSprite === target;\n\t}\n\n\t/**\n\t * Converts document coordinates to coordinates withing root element.\n\t *\n\t * @param   point  Document point\n\t * @return         Root point\n\t */\n\tpublic documentPointToRoot(point: IPoint): IPoint {\n\t\tconst rect = this._getRealSize();\n\t\tconst size = this._getCalculatedSize(rect);\n\n\t\tconst scaleWidth = size.width / rect.width;\n\t\tconst scaleHeight = size.height / rect.height;\n\n\t\treturn {\n\t\t\tx: (point.x - rect.left) * scaleWidth,\n\t\t\ty: (point.y - rect.top) * scaleHeight,\n\t\t};\n\t}\n\n\t/**\n\t * Converts root coordinates to document\n\t *\n\t * @param   point  Document point\n\t * @return         Root point\n\t */\n\tpublic rootPointToDocument(point: IPoint): IPoint {\n\t\tconst rect = this._getRealSize();\n\t\tconst size = this._getCalculatedSize(rect);\n\n\t\tconst scaleWidth = size.width / rect.width;\n\t\tconst scaleHeight = size.height / rect.height;\n\n\t\treturn {\n\t\t\tx: (point.x / scaleWidth) + rect.left,\n\t\t\ty: (point.y / scaleHeight) + rect.top\n\t\t};\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic addDisposer<T extends IDisposer>(disposer: T): T {\n\t\tthis._disposers.push(disposer);\n\t\treturn disposer;\n\t}\n\n\tprotected _updateComputedStyles(): boolean {\n\t\tconst styles = window.getComputedStyle(this.dom);\n\t\tlet fontHash = \"\";\n\t\t$object.each(styles, (key, val) => {\n\t\t\tif ($type.isString(key) && key.match(/^font/)) {\n\t\t\t\tfontHash += val;\n\t\t\t}\n\t\t})\n\t\tconst changed = fontHash != this._fontHash;\n\t\tif (changed) {\n\t\t\tthis._fontHash = fontHash;\n\t\t}\n\t\treturn changed;\n\t}\n\n\tprotected _checkComputedStyles(): void {\n\t\tif (this._updateComputedStyles()) {\n\t\t\tthis._invalidateLabelBounds(this.container);\n\t\t}\n\t}\n\n\tprotected _invalidateLabelBounds(target: Sprite): void {\n\t\tif (target instanceof Container) {\n\t\t\ttarget.children.each((child) => {\n\t\t\t\tthis._invalidateLabelBounds(child);\n\t\t\t});\n\t\t}\n\t\telse if (target instanceof Text) {\n\t\t\ttarget.markDirtyBounds();\n\t\t}\n\t}\n\n\t/**\n\t * To all the clever heads out there. Yes, we did not make any attempts to\n\t * scramble this.\n\t *\n\t * This is a part of a tool meant for our users to manage their commercial\n\t * licenses for removal of amCharts branding from charts.\n\t *\n\t * The only legit way to do so is to purchase a commercial license for amCharts:\n\t * https://www.amcharts.com/online-store/\n\t *\n\t * Removing or altering this code, or disabling amCharts branding in any other\n\t * way is against the license and thus illegal.\n\t */\n\tprotected _hasLicense(): boolean {\n\t\tfor (let i = 0; i < registry.licenses.length; i++) {\n\t\t\tif (registry.licenses[i].match(/^AM5C.{5,}/i)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic _licenseApplied(): void {\n\t\tif (this._logo) {\n\t\t\tthis._logo.set(\"forceHidden\", true);\n\t\t}\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic get debugGhostView(): boolean {\n\t\treturn this._renderer.debugGhostView;\n\t}\n\n\t/**\n\t * @ignore\n\t */\n\tpublic set debugGhostView(value: boolean) {\n\t\tthis._renderer.debugGhostView = value;\n\t}\n\n\t/**\n\t * Set this to `true` if you need chart to require first a tap onto it before\n\t * touch gesture related functionality like zoom/pan is turned on.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\n\t * @default false\n\t * @since 5.2.9\n\t * @param  value  Needs a tap to activate touch functions\n\t */\n\tpublic set tapToActivate(value: boolean) {\n\t\tthis._renderer.tapToActivate = value;\n\t}\n\n\t/**\n\t * @return Needs a tap to activate touch functions\n\t */\n\tpublic get tapToActivate(): boolean {\n\t\treturn this._renderer.tapToActivate;\n\t}\n\n\t/**\n\t * If `tapToActivate` is set to `true`, this setting will determine number\n\t * of milliseconds the chart will stay \"active\", before releasing the\n\t * controls back to the page.\n\t *\n\t * @see {@link https://www.amcharts.com/docs/v5/getting-started/root-element/#Touch_related_options} for more info\n\t * @default 3000\n\t * @since 5.2.9\n\t * @param  value  Timeout\n\t */\n\tpublic set tapToActivateTimeout(value: number) {\n\t\tthis._renderer.tapToActivateTimeout = value;\n\t}\n\n\t/**\n\t * @return Timeout\n\t */\n\tpublic get tapToActivateTimeout(): number {\n\t\treturn this._renderer.tapToActivateTimeout;\n\t}\n\n\tpublic _makeHTMLElement(target: Container): HTMLDivElement {\n\n\t\t// Get container\n\t\tconst container = this._htmlElementContainer!;\n\n\t\t// Init\n\t\tconst htmlElement = document.createElement(\"div\");\n\t\ttarget.setPrivate(\"htmlElement\", htmlElement);\n\n\t\t// Should we put this into a wrapper?\n\t\tlet needWrapper: Boolean = false;\n\t\tlet wrapperTarget: Container;\n\t\ttarget._walkParents((parent) => {\n\t\t\tif ((parent as Container).get(\"verticalScrollbar\")) {\n\t\t\t\tneedWrapper = true;\n\t\t\t\twrapperTarget = parent as Container;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tlet htmlElementWrapper: HTMLDivElement;\n\n\t\tif (needWrapper) {\n\t\t\thtmlElementWrapper = document.createElement(\"div\");\n\t\t\ttarget.setPrivate(\"htmlElementWrapper\", htmlElementWrapper);\n\t\t\ttarget.setPrivate(\"wrapperContainer\", wrapperTarget!);\n\n\t\t\thtmlElementWrapper.style.position = \"absolute\";\n\t\t\thtmlElementWrapper.style.overflow = \"hidden\";\n\t\t\thtmlElementWrapper.style.boxSizing = \"border-box\";\n\t\t\thtmlElementWrapper.style.top = \"0px\";\n\t\t\thtmlElementWrapper.style.left = \"0px\";\n\t\t\thtmlElementWrapper.style.width = \"100%\";\n\t\t\thtmlElementWrapper.style.height = \"100%\";\n\n\t\t\twrapperTarget!.events.on(\"boundschanged\", () => {\n\t\t\t\tthis._positionHTMLElement(target);\n\t\t\t});\n\t\t}\n\n\t\t//htmlElement.tabIndex = this.tabindex;\n\t\thtmlElement.style.position = \"absolute\";\n\t\thtmlElement.style.overflow = \"auto\";\n\t\thtmlElement.style.boxSizing = \"border-box\";\n\t\t$utils.setInteractive(htmlElement, target.get(\"interactive\", false));\n\n\t\t// Translate events\n\t\tif (target.events.isEnabled(\"click\")) {\n\t\t\t$utils.setInteractive(htmlElement, true);\n\t\t\tthis._disposers.push($utils.addEventListener<PointerEvent | MouseEvent>(htmlElement, \"click\", (ev: IPointerEvent) => {\n\t\t\t\tconst downEvent = this._renderer.getEvent(ev);\n\t\t\t\ttarget.events.dispatch(\"click\", {\n\t\t\t\t\ttype: \"click\",\n\t\t\t\t\toriginalEvent: downEvent.event,\n\t\t\t\t\tpoint: downEvent.point,\n\t\t\t\t\tsimulated: false,\n\t\t\t\t\ttarget: target\n\t\t\t\t});\n\t\t\t}));\n\t\t}\n\n\t\tthis._positionHTMLElement(target);\n\n\t\tif (needWrapper) {\n\t\t\thtmlElementWrapper!.append(htmlElement);\n\t\t\tcontainer.append(htmlElementWrapper!);\n\t\t}\n\t\telse {\n\t\t\tcontainer.append(htmlElement);\n\t\t}\n\n\t\t$array.pushOne(this._htmlEnabledContainers, target);\n\n\t\treturn htmlElement;\n\t}\n\n\tpublic _positionHTMLElements(): void {\n\t\t$array.each(this._htmlEnabledContainers, (target) => {\n\t\t\tthis._positionHTMLElement(target);\n\t\t});\n\t}\n\n\tpublic _positionHTMLElement(target: Container): void {\n\t\tconst htmlElementWrapper = target.getPrivate(\"htmlElementWrapper\");\n\t\tif (htmlElementWrapper) {\n\t\t\tconst wrapperTarget = target.getPrivate(\"wrapperContainer\");\n\t\t\tif (wrapperTarget) {\n\t\t\t\tconst bounds = wrapperTarget.globalBounds();\n\t\t\t\thtmlElementWrapper.style.clipPath = \"rect(\" + bounds.top + \"px \" + bounds.right + \"px \" + bounds.bottom + \"px \" + bounds.left + \"px)\";\n\t\t\t}\n\t\t}\n\n\t\tconst htmlElement = target.getPrivate(\"htmlElement\");\n\t\tif (htmlElement) {\n\n\t\t\t// Translate settings\n\t\t\tconst visualSettings = [\n\t\t\t\t\"paddingTop\",\n\t\t\t\t\"paddingRight\",\n\t\t\t\t\"paddingBottom\",\n\t\t\t\t\"paddingLeft\",\n\t\t\t\t\"minWidth\",\n\t\t\t\t\"minHeight\",\n\t\t\t\t\"maxWidth\",\n\t\t\t\t\"maxHeight\"\n\t\t\t];\n\t\t\t$array.each(visualSettings, (setting: any) => {\n\t\t\t\tconst value = target.get(setting);\n\t\t\t\tif (value) {\n\t\t\t\t\thtmlElement.style[setting] = value + \"px\";\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\thtmlElement.style[setting] = \"\";\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst strtingSettings = [\n\t\t\t\t\"fontFamily\",\n\t\t\t\t\"fontSize\",\n\t\t\t\t\"fontStyle\",\n\t\t\t\t\"fontWeight\",\n\t\t\t\t\"fontStyle\",\n\t\t\t\t\"fontVariant\",\n\t\t\t\t\"textDecoration\"\n\t\t\t];\n\t\t\t$array.each(strtingSettings, (setting: any) => {\n\t\t\t\tconst value = target.get(setting);\n\t\t\t\tif (value) {\n\t\t\t\t\tif (setting == \"fontSize\" && !$type.isString(value)) {\n\t\t\t\t\t\thtmlElement.style[setting] = value + \"px\";\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\thtmlElement.style[setting] = value + \"\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\thtmlElement.style[setting] = \"\";\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Init and reset scale / rotation\n\t\t\tconst scale = target.compositeScale() || 1;\n\t\t\tconst rotation = target.compositeRotation() || 0;\n\t\t\thtmlElement.style.transform = \"\";\n\t\t\thtmlElement.style.transformOrigin = \"\";\n\n\t\t\t// Deal with opacity\n\t\t\tconst opacity = target.compositeOpacity();\n\t\t\tsetTimeout(() => {\n\t\t\t\thtmlElement.style.opacity = opacity + \"\";\n\t\t\t}, 10);\n\n\t\t\tconst visible = target.isVisibleDeep();\n\t\t\tif (visible) {\n\t\t\t\thtmlElement.style.display = \"block\";\n\t\t\t}\n\n\t\t\t// Deal with position\n\t\t\t// const bounds = target.globalBounds();\n\t\t\t// htmlElement.style.top = (bounds.top) + \"px\";\n\t\t\t// htmlElement.style.left = (bounds.left) + \"px\";\n\t\t\tlet pos = {\n\t\t\t\tx: target.x() + target.get(\"dx\", 0),\n\t\t\t\ty: target.y() + target.get(\"dy\", 0)\n\t\t\t}\n\t\t\tif (target.parent) {\n\t\t\t\tpos = target.parent.toGlobal(pos)\n\t\t\t}\n\t\t\thtmlElement.style.top = pos.y + \"px\";\n\t\t\thtmlElement.style.left = pos.x + \"px\";\n\n\t\t\t// Use width/height if those are set\n\t\t\tconst width = target.get(\"width\");\n\t\t\tconst height = target.get(\"height\");\n\n\t\t\tlet w: number = 0;\n\t\t\tlet h: number = 0;\n\n\t\t\tif (width) {\n\t\t\t\tw = target.width();\n\t\t\t}\n\n\t\t\tif (height) {\n\t\t\t\th = target.height();\n\t\t\t}\n\n\n\t\t\tif (!width || !height) {\n\t\t\t\thtmlElement.style.position = \"fixed\";\n\t\t\t\thtmlElement.style.width = \"\";\n\t\t\t\thtmlElement.style.height = \"\";\n\t\t\t\tconst bbox = htmlElement.getBoundingClientRect();\n\t\t\t\thtmlElement.style.position = \"absolute\";\n\t\t\t\tif (!width) w = bbox.width;\n\t\t\t\tif (!height) h = bbox.height;\n\n\t\t\t\tlet lw = w / scale;\n\t\t\t\tlet lh = h / scale;\n\n\t\t\t\tlet cx = target.get(\"centerX\", 0);\n\t\t\t\tlet cy = target.get(\"centerY\", 0);\n\n\t\t\t\tlet ll = 0;\n\t\t\t\tlet lr = 0;\n\t\t\t\tlet lt = 0;\n\t\t\t\tlet lb = 0;\n\n\t\t\t\tif (cx instanceof Percent) {\n\t\t\t\t\tll = -cx.value * lw;\n\t\t\t\t\tlr = (1 - cx.value) * lw;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tll = -cx;\n\t\t\t\t\tlr = lw - cx;\n\t\t\t\t}\n\n\t\t\t\tif (cy instanceof Percent) {\n\t\t\t\t\tlt = -cy.value * lh;\n\t\t\t\t\tlb = (1 - cy.value) * lh;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlt = -cy;\n\t\t\t\t\tlb = lh - cy;\n\t\t\t\t}\n\n\t\t\t\ttarget._localBounds = { left: ll, right: lr, top: lt, bottom: lb };\n\n\t\t\t\tlet previousBounds = target._adjustedLocalBounds;\n\t\t\t\tlet newBounds = target._display.getAdjustedBounds(target._localBounds);\n\t\t\t\ttarget._adjustedLocalBounds = newBounds;\n\n\t\t\t\t// compare each value of the bounds\n\t\t\t\tif (previousBounds.left !== newBounds.left || previousBounds.right !== newBounds.right || previousBounds.top !== newBounds.top || previousBounds.bottom !== newBounds.bottom) {\n\t\t\t\t\ttarget.markDirtyBounds();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (w > 0) {\n\t\t\t\thtmlElement.style.minWidth = (w) + \"px\";\n\t\t\t}\n\t\t\tif (h > 0) {\n\t\t\t\thtmlElement.style.minHeight = (h) + \"px\";\n\t\t\t}\n\n\t\t\t// Hide or show\n\t\t\tif (!visible || opacity == 0) {\n\t\t\t\thtmlElement.style.display = \"none\";\n\t\t\t}\n\n\t\t\t// Center position\n\t\t\tconst x = target.get(\"centerX\", 0);\n\t\t\tconst originX = isPercent(x) ? (x as Percent).percent + \"%\" : x + \"px\";\n\t\t\tconst y = target.get(\"centerY\", 0);\n\t\t\tconst originY = isPercent(y) ? (y as Percent).percent + \"%\" : y + \"px\";\n\n\t\t\tif (x || y) {\n\t\t\t\thtmlElement.style.transform = \"translate(-\" + originX + \", -\" + originY + \")\" + htmlElement.style.transform;\n\t\t\t}\n\n\t\t\t// Deal with scale\n\t\t\tif (scale != 1) {\n\t\t\t\thtmlElement.style.transform += \"scale(\" + scale + \")\";\n\t\t\t}\n\n\t\t\tif (rotation != 0) {\n\t\t\t\thtmlElement.style.transform += \" rotate(\" + rotation + \"deg)\";\n\t\t\t}\n\n\t\t\tif (htmlElement.style.transform != \"\") {\n\t\t\t\thtmlElement.style.transformOrigin = originX + \" \" + originY;\n\t\t\t\t//htmlElement.style.transformOrigin = \"0% 0%\";\n\t\t\t}\n\n\n\t\t}\n\t}\n\n\tpublic _setHTMLContent(target: Container, html: string): void {\n\t\tlet htmlElement = target.getPrivate(\"htmlElement\");\n\t\tif (!htmlElement) {\n\t\t\thtmlElement = this._makeHTMLElement(target);\n\t\t\tif (!this.autoResize) {\n\t\t\t\tthis.resize();\n\t\t\t}\n\t\t}\n\t\tif (htmlElement.innerHTML != html) {\n\t\t\thtmlElement.innerHTML = html;\n\t\t}\n\t}\n\n\tpublic _removeHTMLContent(target: Container): void {\n\t\tconst htmlElementWrapper = target.getPrivate(\"htmlElementWrapper\");\n\t\tconst htmlElement = target.getPrivate(\"htmlElement\");\n\t\tif (htmlElementWrapper) {\n\t\t\tthis._htmlElementContainer!.removeChild(htmlElementWrapper);\n\t\t\ttarget.removePrivate(\"htmlElement\");\n\t\t\ttarget.removePrivate(\"htmlElementWrapper\");\n\t\t\ttarget.removePrivate(\"wrapperContainer\");\n\t\t}\n\t\telse if (htmlElement) {\n\t\t\tthis._htmlElementContainer!.removeChild(htmlElement);\n\t\t\ttarget.removePrivate(\"htmlElement\");\n\t\t\ttarget.removePrivate(\"wrapperContainer\");\n\t\t}\n\t\t$array.remove(this._htmlEnabledContainers, target);\n\t}\n}\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{Root as a,addLicense as s}from\"@amcharts/amcharts5/index.js\";import\"../../intl.js\";import{getLocale as t,getLocaleLanguage as r}from\"../../intl/locale.js\";s(\"AM5C241025748\");const c=\"en-US\",m=new Map([[\"ar\",()=>import(\"@amcharts/amcharts5/locales/ar.js\")],[\"bg-BG\",()=>import(\"@amcharts/amcharts5/locales/bg_BG.js\")],[\"bs-BA\",()=>import(\"@amcharts/amcharts5/locales/bs_BA.js\")],[\"ca-ES\",()=>import(\"@amcharts/amcharts5/locales/ca_ES.js\")],[\"cs-CZ\",()=>import(\"@amcharts/amcharts5/locales/cs_CZ.js\")],[\"da-DK\",()=>import(\"@amcharts/amcharts5/locales/da_DK.js\")],[\"de-DE\",()=>import(\"@amcharts/amcharts5/locales/de_DE.js\")],[\"de-CH\",()=>import(\"@amcharts/amcharts5/locales/de_CH.js\")],[\"el-GR\",()=>import(\"@amcharts/amcharts5/locales/el_GR.js\")],[\"en-US\",()=>import(\"@amcharts/amcharts5/locales/en_US.js\")],[\"en-CA\",()=>import(\"@amcharts/amcharts5/locales/en_CA.js\")],[\"es-ES\",()=>import(\"@amcharts/amcharts5/locales/es_ES.js\")],[\"et-EE\",()=>import(\"@amcharts/amcharts5/locales/et_EE.js\")],[\"fi-FI\",()=>import(\"@amcharts/amcharts5/locales/fi_FI.js\")],[\"fr-FR\",()=>import(\"@amcharts/amcharts5/locales/fr_FR.js\")],[\"he-IL\",()=>import(\"@amcharts/amcharts5/locales/he_IL.js\")],[\"hr-HR\",()=>import(\"@amcharts/amcharts5/locales/hr_HR.js\")],[\"hu-HU\",()=>import(\"@amcharts/amcharts5/locales/hu_HU.js\")],[\"id-ID\",()=>import(\"@amcharts/amcharts5/locales/id_ID.js\")],[\"it-IT\",()=>import(\"@amcharts/amcharts5/locales/it_IT.js\")],[\"ja-JP\",()=>import(\"@amcharts/amcharts5/locales/ja_JP.js\")],[\"ko-KR\",()=>import(\"@amcharts/amcharts5/locales/ko_KR.js\")],[\"lt-LT\",()=>import(\"@amcharts/amcharts5/locales/lt_LT.js\")],[\"lv-LV\",()=>import(\"@amcharts/amcharts5/locales/lv_LV.js\")],[\"no-NO\",()=>import(\"@amcharts/amcharts5/locales/nb_NO.js\")],[\"nb-NO\",()=>import(\"@amcharts/amcharts5/locales/nb_NO.js\")],[\"nl-NL\",()=>import(\"@amcharts/amcharts5/locales/nl_NL.js\")],[\"pl-PL\",()=>import(\"@amcharts/amcharts5/locales/pl_PL.js\")],[\"pt-BR\",()=>import(\"@amcharts/amcharts5/locales/pt_BR.js\")],[\"pt-PT\",()=>import(\"@amcharts/amcharts5/locales/pt_PT.js\")],[\"ro-RO\",()=>import(\"@amcharts/amcharts5/locales/ro_RO.js\")],[\"ru-RU\",()=>import(\"@amcharts/amcharts5/locales/ru_RU.js\")],[\"sk-SK\",()=>import(\"@amcharts/amcharts5/locales/sk_SK.js\")],[\"sl-SL\",()=>import(\"@amcharts/amcharts5/locales/sl_SL.js\")],[\"sr-RS\",()=>import(\"@amcharts/amcharts5/locales/sr_RS.js\")],[\"sv-SE\",()=>import(\"@amcharts/amcharts5/locales/sv_SE.js\")],[\"th-TH\",()=>import(\"@amcharts/amcharts5/locales/th_TH.js\")],[\"tr-TR\",()=>import(\"@amcharts/amcharts5/locales/tr_TR.js\")],[\"uk-UA\",()=>import(\"@amcharts/amcharts5/locales/uk_UA.js\")],[\"vi-VN\",()=>import(\"@amcharts/amcharts5/locales/vi_VN.js\")],[\"zh-CN\",()=>import(\"@amcharts/amcharts5/locales/zh_Hans.js\")],[\"zh-HK\",()=>import(\"@amcharts/amcharts5/locales/zh_Hant.js\")],[\"zh-TW\",()=>import(\"@amcharts/amcharts5/locales/zh_Hant.js\")]]);function l(a){const s=r(a);if(!s)return null;for(const t of m.keys()){if(r(t)===s)return t}return null}function o(a){return a?m.has(a)?a:l(a)??c:c}async function h(s,r=t()){const c=a.new(s);return c.locale=(await m.get(o(r))()).default,c}export{h as createRoot};\n"],"names":["PointedRectangle","Graphics","_beforeChanged","super","this","isDirty","_clear","_changed","markDirtyBounds","w","width","h","height","cr","get","$math","Math","min","x","y","bwh","xtl","ytl","xbl","d1","d2","display","_display","moveTo","stemX","round","Infinity","lineTo","arcTo","stemY","max","closePath","Object","defineProperty","classNames","concat","className","Tooltip","Container","constructor","root","settings","isReal","arguments","length","undefined","_afterNew","_settings","themeTags","$utils","_setDefaultFn","new","_root","set","_label","children","push","Label","_disposers","events","on","_updateBackground","_updateTextColor","tooltipContainer","hide","label","onPrivate","htmlElement","_ev","_htmlContentHovered","_handleReaderAnnouncement","_tooltips","isVisibleDeep","readerAlert","getAccessibleText","_dispose","$array","_updateChildren","isPrivateDirty","_markDirtyKey","updateBackgroundColor","bg","_keepHoverDp","MultiDisposer","target","parent","getPrivate","hover","unhover","disposers","ev","outEvent","_renderer","getEvent","dispatch","type","originalEvent","event","point","simulated","dispose","_onShow","tooltipTarget","background","fill","stroke","_fillDp","_fillGrDp","fillGradient","_strokeDp","_labelDp","interfaceColors","Color","alternative","_setDataItem","dataItem","updateBackground","container","cw","ch","centerX","Percent","value","centerY","parentW","parentH","xx","yy","layerMargin","left","top","right","bottom","bounds","_updateBounds","_w","_h","pointTo","pointerOrientation","pointerLength","bgStrokeSizeY","bgStrokeSizeX","pointerX","pointerY","boundsW","boundsH","_fx","_fy","animationDuration","animationEasing","animate","key","to","duration","easing","Native","_observer","ResizeObserver","entries","entry","_targets","callback","addTarget","observe","box","removeTarget","unobserve","Raf","_timer","lastTime","loop","currentTime","Date","now","delay","newSize","getBoundingClientRect","size","requestAnimationFrame","cancelAnimationFrame","observer","ResizeSensor","element","_sensor","_element","_listener","isDisposed","_disposed","sensor","InterfaceColors","Entity","NumberFormatter","_setDefaults","_setDefault","bns","sns","bs","_t","suffix","format","precision","formatted","$type","toLowerCase","source","Number","Intl","NumberFormat","e","details","info","parseFormat","language","positive","negative","zero","mod","$object","decimals","active","template","split","join","applyFormat","thousandSeparator","translateEmpty","decimalSeparator","parts","replace","_part","item","parsed","partFormat","chunks","TextFormatter","chunk","i","text","matches","match","mods","modSpacing","a","thousands","passive","b","interval","pop","abs","prefix","indexOf","applyPrefix","ol","toString","parseFloat","toPrecision","translate","exp","toExponential","d","pow","toFixed","res","ints","Array","ip","intsr","reverse","len","c","substr","unshift","separator","decs","prefixes","force","newvalue","applied","k","number","floor","escape","unescape","parseDate","timezone","date","year","month","day","hour","minute","second","millisecond","weekday","formatToParts","forEach","toUTCDate","UTC","Timezone","Error","name","_utc","DateTimeFormat","hour12","timeZone","fractionalSecondDigits","_dtf","convertLocal","offset","offsetUTC","userOffset","getTimezoneOffset","output","setUTCMinutes","getUTCMinutes","newUserOffset","DateFormatter","ignoreTimezone","locales","originalDate","utc","getTime","toUpperCase","fullYear","hours","minutes","seconds","milliseconds","timestamp","getUTCFullYear","getUTCMonth","getUTCDay","getUTCDate","getUTCHours","getUTCSeconds","getUTCMilliseconds","getFullYear","getMonth","getDay","getDate","getHours","getMinutes","getSeconds","getMilliseconds","ceil","_getMonth","_getShortMonth","translateFunc","call","_getShortWeekday","_getWeekday","locale","firstDayOfWeek","tz","tzh","tzm","toISOString","toUTCString","dateFormat","_months","index","_shortMonths","_weekdays","_shortWeekdays","parse","parseInt","reg","parsedIndexes","resValues","indexAdjust","year3","year2","year1","getStringList","monthLong","monthShort","week","yearDay","weekdayLong","weekdayShort","am","hour12Base1","hourBase0","hour12Base0","hourBase1","millisecondDigits","zone","iso","regex","RegExp","val","resolveMonth","resolveShortMonth","isAm","ts","resolveTimezoneOffset","dir","isDefault","translateAll","list","DurationFormatter","dmillisecond","dsecond","dminute","dhour","dday","dweek","dmonth","aminute","ahour","aday","aweek","amonth","ayear","base","baseUnit","getFormat","color","dirs","absolute","_unitAliases","tstamp","toTimeStamp","values","part","unit","_toTimeUnit","unitValue","_getUnitValue","digits","code","maxValue","maxUnit","getValueUnit","currentUnit","ms","_getUnitValues","timeUnit","Language","setPrivate","en","prompt","translation","_len","rest","_key","translateAny","_len2","_key2","setTranslationAny","setTranslationsAny","translations","_len3","_key3","Matrix","tx","ty","setTransform","pivotX","pivotY","rotation","scale","cos","sin","apply","origin","applyInverse","id","append","matrix","a1","b1","c1","prepend","tx1","copyFrom","_slicedToArray","arr","isArray","Symbol","iterator","_arr","_n","_d","_e","_s","_i","next","done","err","sliceIterator","TypeError","TAU","PI","mapToEllipse","_ref","rx","ry","cosphi","sinphi","centerx","centery","approxUnitArc","ang1","ang2","tan","x1","y1","x2","y2","vectorAngle","ux","uy","vx","vy","dot","acos","_ref2","px","py","cx","cy","_ref2$xAxisRotation","xAxisRotation","_ref2$largeArcFlag","largeArcFlag","_ref2$sweepFlag","sweepFlag","curves","pxp","pyp","lambda","sqrt","_getArcCenter","rxsq","rysq","pxpsq","pypsq","radicant","centerxp","centeryp","vx1","vy1","vx2","vy2","getArcCenter","_getArcCenter2","ratio","segments","map","curve","_mapToEllipse","_mapToEllipse2","_mapToEllipse3","checkArgs","actual","expected","checkMinArgs","checkEvenArgs","splitArcFlags","args","flag","exec","splice","assertBinary","eachTargets","hitTarget","f","interactive","_parent","onPointerEvent","touches","changedTouches","isTainted","image","canvas","document","createElement","context","getContext","willReadFrequently","drawImage","getImageData","console","warn","src","clearCanvas","view","style","crisp","CanvasPivot","_x","_y","CanvasDisplayObject","DisposerClass","renderer","subStatus","status","inactive","layer","_layer","_removeObject","getLayer","dirty","getCanvas","self","defaultLayer","setLayer","order","margin","visible","_ghostLayer","setMargin","layers","registerChildLayer","resizeLayer","resizeGhost","markDirtyLayer","clear","invalidateBounds","_localBounds","_addBounds","_bounds","_getColorId","_colorId","paintId","_isInteractive","_forceInteractive","_isInteractiveMask","contains","child","toGlobal","_matrix","toLocal","getLocalMatrix","_uMatrix","pivot","angle","getLocalBounds","bn","getAdjustedBounds","_setMatrix","p0","p1","p2","p3","_addEvent","Disposer","_localMatrix","_transform","resolution","m","_transformMargin","_transformLayer","render","targetGhostLayer","exportable","_omitTainted","ghostLayer","ghostContext","mask","save","_runPath","clip","globalAlpha","compoundAlpha","alpha","filter","_deferredGhostLayers","_render","restore","tainted","_ghostOnly","_drawGhost","hovering","_hovering","has","dragging","_dragging","some","shouldCancelTouch","tapToActivate","_touchActive","cancelTouch","CanvasContainer","interactiveChildren","addChild","_children","addChildAt","removeChild","_childLayers","deep","setPoint","Op","colorize","_context","_forceColor","colorizeGhost","forceColor","path","pathGhost","addBounds","BeginPath","beginPath","BeginFill","fillStyle","EndFill","clearShadow","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","EndStroke","LineStyle","lineJoin","lineCap","strokeStyle","lineWidth","LineDash","dash","setLineDash","LineDashOffset","dashOffset","lineDashOffset","DrawRect","rect","l","t","r","DrawCircle","radius","arc","DrawEllipse","radiusX","radiusY","ellipse","Arc","startAngle","endAngle","anticlockwise","arcBounds","ArcTo","LineTo","MoveTo","ClosePath","BezierCurveTo","cpX","cpY","cpX2","cpY2","toX","toY","bezierCurveTo","QuadraticCurveTo","quadraticCurveTo","Shadow","blur","offsetX","offsetY","opacity","GraphicsImage","CanvasGraphics","BlendMode","NORMAL","_operations","_pushOp","op","beginFill","_fillAlpha","toCSS","isMeasured","endFill","_hasShadows","endStroke","lineStyle","_strokeAlpha","setLineDashOffset","drawRect","drawCircle","drawEllipse","shadow","svgPath","cpx","cpy","qcpx","qcpy","SEGMENTS_REGEXP","ARGS_REGEXP","relative","arcToBezier","layerDirty","ghostOnly","drawGhost","globalCompositeOperation","blendMode","renderDetached","CanvasText","_textInfo","invalidateVisibility","textVisible","_originalScale","_shared","textAlign","direction","textBaseline","_prerender","ignoreGhost","ignoreFontWeight","fontStyle","_getFontStyle","font","fillOpacity","shadowOpacity","style2","fontVariant","fontWeight","fontSize","fontFamily","_measure","line","_index","textChunks","fillText","textDecoration","thickness","oversizedBehavior","metrics","_measureText","actualBoundingBoxLeft","actualBoundingBoxRight","getTextStyle","_ignoreFontWeight","test","navigator","vendor","rtl","maxWidth","truncate","wrap","refText","lines","currentStyle","styleRestored","minX","maxX","ignoreFormatting","lineInfo","ascent","actualBoundingBoxAscent","actualBoundingBoxDescent","currentFormat","currentFill","currentChunkWidth","currentVerticalAlign","currentDecoration","skipFurtherText","firstTextChunk","leftoverChunks","verticalAlign","chunkWidth","truncated","breakWords","ellipsis","ellipsisMetrics","ellipsisWidth","excessWidth","_truncateText","tmpText","slice","leftBoundMod","rightBoundMod","boundsMod","chunkHeight","lineHeight","currentChunkOffset","baselineRatio","_fitRatio","minScale","maxW","maxH","maxHeight","fallbackBreakWords","tmp","measureText","fakeMetrics","div","innerText","visibility","position","body","appendChild","bbox","fontBoundingBoxAscent","fontBoundingBoxDescent","CanvasTextStyle","percent","CanvasRadialText","textType","_renderCircular","deltaAngle","orientation","inward","inside","align","kerning","clockwise","shouldReverse","_textReversed","maxAngle","midAngle","textHeight","lineStartAngle","rotate","angleShift","char","charWidth","_measureCircular","totalWidth","chars","CanvasImage","_imageMask","naturalWidth","naturalHeight","_getMask","imageSmoothingEnabled","fillRect","CanvasRendererEvent","originalPoint","Touch","identifier","CanvasRenderer","ArrayDisposer","GhostLayer","_patternCanvas","Set","window","devicePixelRatio","setAttribute","_layerDom","_events","disposer","exportableView","listener","preventDefault","_touchActiveTimeout","_delayTouchDeactivate","setTimeout","prevent","obj","wheelable","resetImageArray","imageArray","clearTimeout","tapToActivateTimeout","debugGhostView","parentNode","createLinearGradient","createRadialGradient","radius1","radius2","createPattern","graphics","repetition","_patternContext","clearRect","makeContainer","makeGraphics","makeText","makeTextStyle","makeRadialText","makePicture","resize","_calculatedWidth","_calculatedHeight","realWidth","realHeight","calculatedWidth","calculatedHeight","_realWidth","_realHeight","createDetachedLayer","CanvasLayer","getLayerByOrder","existingLayer","sort","insertBefore","_dirtyLayers","deferredGhostLayers","layerx","_lastPointerMoveEvent","native","_dispatchGlobalMousemove","rgb","distributeId","fromHex","_colorMap","_adjustBoundingBox","DOMRect","adjustPoint","clientX","clientY","widthScale","heightScale","_getHitTarget","pixel","data","colorId","fromRGB","getObjectAtPoint","getImageArray","_withEvents","dispatching","cleanup","callbacks","disposed","_dispatchEventAll","interactionsEnabled","_dispatchEvent","dispatched","object","_dispatchMousedown","originalTarget","button","dragged","_mousedown","delete","cursorOverStyle","_replacedCursorStyle","add","removeHovering","_dispatchGlobalMouseup","_dispatchDragMove","_dispatchDragEnd","clickevent","_dispatchDoubleClick","_dispatchWheel","_makeSharedEvent","_listeners","CounterDisposer","increment","_onPointerEvent","timer","_","_initEvent","mouseup","pointercancel","mousedown","mousemove","options","canvasWidth","canvasHeight","minWidth","minHeight","maxScale","maintainPixelRatio","canvases","forceRender","needRerender","exportableContext","extraX","extraY","clientWidth","clientHeight","domWidth","domHeight","_resolution","_width","_height","rAF","fps","Root","dom","EventDispatcher","VerticalLayout","HorizontalLayout","GridLayout","accessible","_a11yD","useSafeResolution","HTMLElement","getElementById","registry","rootElements","autoDispose","inner","tooltipContainerBounds","_tooltipContainerSettings","_inner","_updateComputedStyles","_init","moveDOM","childNodes","_initResizeSensor","_handleLogo","_logo","offsetWidth","offsetHeight","show","_showBranding","logo","setStateOnChildren","paddingTop","paddingRight","paddingBottom","paddingLeft","p100","tooltipY","tooltipText","tooltipX","Rectangle","systemTooltip","open","states","create","strokeWidth","_getRealSize","_getCalculatedSize","calculateSize","focusable","tabindex","ariaLabel","role","rootContainer","_rootContainer","_defaultThemes","DefaultTheme","htmlElementContainer","_htmlElementContainer","pointerEvents","overflow","readerAlertElement","_readerAlertElement","focusElementContainer","_focusElementContainer","tooltipElementContainer","_tooltipElementContainer","eventKey","_isShift","shiftKey","focusedSprite","_focusedSprite","announceText","downEvent","MouseEvent","dragOffsetX","dragOffsetY","isDragging","_keyboardDragPoint","isEnabled","dragPoint","moveEvent","upEvent","group","items","_tabindexes","lastIndex","_skipNextGroupJump","_focusNext","_startTicker","setThemes","_addTooltip","_hasLicense","_systemTooltip","tooltip","_resizeSensorDisposer","autoResize","_focusElementDirty","_updateCurrentFocus","_runTickers","_tickers","_runAnimations","running","_animations","animation","state","_runAnimation","AnimationState","Stopped","Playing","_isDirtyAnimation","_runDirties","allParents","_isDirtyParents","_dirtyParents","uid","_prepareChildren","objects","_dirty","entity","_clearDirty","_isDirty","depths","_dirtyBounds","depth","_positionHTMLElements","$order","dirtyPositions","_dirtyPositions","sprite","_updatePosition","_afterChanged","_childrenPrep","_childrenUpdt","_renderFrame","_updateTick","_checkComputedStyles","animationDone","_runTicker","animationTime","_ticker","_paused","_runTickerNow","timeout","endTime","performance","updateTick","_addDirtyEntity","_addDirtyParent","_addDirtyBounds","_addDirtyPosition","_addAnimation","_markDirty","_markDirtyRedraw","once","eachFrame","markDirtyGlobal","walkChildren","markDirty","_isDisposed","horizontalLayout","verticalLayout","innerHTML","themes","_applyThemes","tooltipContainerSettings","_tooltip","_registerTabindexOrder","_invalidateTabindexes","_unregisterTabindexOrder","aindex","bindex","groups","_moveFocusElement","_makeFocusElement","_decorateFocusElement","_positionFocusElement","focusElement","removeAttribute","populateString","ariaLive","ariaChecked","ariaCurrent","ariaSelected","ariaOrientation","ariaValueNow","ariaValueMin","ariaValueMax","ariaValueText","ariaControls","isHidden","getAttribute","tabIndex","_handleFocus","_handleBlur","_removeFocusElement","_hideFocusElement","scrollTop","globalBounds","padding","focusPadding","_getSpriteByFocusElement","found","focused","el","focusableElements","from","querySelectorAll","targetElement","focus","updateTooltip","_getText","tooltipElement","_makeTooltipElement","remove","removePrivate","_removeTooltipElement","parentElement","_invalidateAccessibility","documentPointToRoot","scaleWidth","scaleHeight","rootPointToDocument","addDisposer","styles","getComputedStyle","fontHash","changed","_fontHash","_invalidateLabelBounds","each","Text","licenses","_licenseApplied","_makeHTMLElement","wrapperTarget","htmlElementWrapper","needWrapper","_walkParents","boxSizing","_positionHTMLElement","_htmlEnabledContainers","clipPath","visualSettings","setting","strtingSettings","compositeScale","compositeRotation","transform","transformOrigin","compositeOpacity","pos","lw","lh","ll","lr","lt","lb","previousBounds","_adjustedLocalBounds","newBounds","originX","isPercent","originY","_setHTMLContent","html","_removeHTMLContent","s","Map","o","_l","keys","async","default"],"sourceRoot":""}