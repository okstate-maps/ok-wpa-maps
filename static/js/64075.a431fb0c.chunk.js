"use strict";(self.webpackChunkok_wpa_maps=self.webpackChunkok_wpa_maps||[]).push([[64075],{64075(e,t,r){r.r(t),r.d(t,{registerFunctions:()=>b});var n=r(86560),o=r(26043),i=r(67253),a=r(9861),s=r(43036),l=r(45018),p=r(89189),u=r(56611),c=r(13312),d=r(45417),f=r(65308),h=r(70652),g=r(71334),y=r(9505),m=r(35380),v=r(38156),w=r(68325),A=r(23908),S=r(70414),C=r(85632);let R=null;async function G(e,t){const n=new h.default({portal:e,id:t});return await n.load(),null===R&&(R=await r.e(6560).then(r.bind(r,6560))),await R.fetchKnowledgeGraph(n.url)}function x(e,t,r,n,o){if(null===e)return null;if((0,C.Kg)(e)||(0,C.Et)(e))return e;if((0,s.e)(e))return e.toJSDate();if((0,s.e)(e))return e.toJSDate();if((0,s.f)(e))return e.toStorageFormat();if((0,s.g)(e))return e.toStorageString();if((0,s.n)(e)){const i={};for(const a of e.keys())i[a]=x(e.field(a),t,r,n,o),i[a]instanceof p.A&&o.push({container:i,indexer:a});return i}if((0,C.cy)(e)){const i=e.map(e=>x(e,t,r,n,o));for(let e=0;e<i.length;e++)i[e]instanceof p.A&&o.push({container:i,indexer:e});return i}return(0,s.h)(e)?e.spatialReference.isWGS84?e:e.spatialReference.isWebMercator&&t?(0,d.ci)(e):e:void 0}function M(e,t){if(!e)return null;const r={};for(const n in e)r[n]=k(e[n],t);return r}function k(e,t){var r,n;return null===e?null:(0,C.cy)(e)?e.map(e=>k(e,t)):e instanceof y.A?{graphTypeName:e.typeName,id:e.id,graphType:"entity",properties:M(e.properties,t)}:e instanceof v.A?{graphType:"object",properties:M(e.properties,t)}:e instanceof A.A?{graphTypeName:e.typeName,id:e.id,graphType:"relationship",originId:null!==(r=e.originId)&&void 0!==r?r:null,destinationId:null!==(n=e.destinationId)&&void 0!==n?n:null,properties:M(e.properties,t)}:e instanceof w.A?{graphType:"path",path:e.path?e.path.map(e=>k(e,t)):null}:(0,s.h)(e)?function(e,t){if(!e)return e;if(e.spatialReference.isWGS84&&t.spatialReference.isWebMercator)return(0,d.Gh)(e);if(e.spatialReference.equals(t.spatialReference))return e;throw new a.D$(t,"WrongSpatialReference",null)}(e,t):(0,C.Kg)(e)||(0,C.Et)(e)||(0,C.$P)(e)?e:null}function b(e){"async"===e.mode&&(e.functions.knowledgegraphbyportalitem=function(t,r){return e.standardFunctionAsync(t,r,(e,n,i)=>{var p,u;if((0,s.B)(i,2,2,t,r),null===i[0])throw new a.D$(t,"PortalRequired",r);if(i[0]instanceof o.A){var c;const e=(0,s.u)(i[1]);let r;return r=null!==(c=t.services)&&void 0!==c&&c.portal?t.services.portal:f.A.getDefault(),G((0,l.R)(i[0],r),e)}if(!1===(0,C.Kg)(i[0]))throw new a.D$(t,"InvalidParameter",r);const d=(0,s.u)(i[0]);return G(null!==(p=null===(u=t.services)||void 0===u?void 0:u.portal)&&void 0!==p?p:f.A.getDefault(),d)})},e.signatures.push({name:"knowledgegraphbyportalitem",min:2,max:2}),e.functions.querygraph=function(t,o){return e.standardFunctionAsync(t,o,async(e,l,p)=>{var d,f;(0,s.B)(p,2,4,t,o);const h=p[0];if(!(0,s.o)(h))throw new a.D$(t,"InvalidParameter",o);const y=p[1];if(!(0,C.Kg)(y))throw new a.D$(t,"InvalidParameter",o);null===R&&(R=await r.e(6560).then(r.bind(r,6560)));let v=null;const w=(0,s.J)(p[2],null);if(!(w instanceof i.A||null===w))throw new a.D$(t,"InvalidParameter",o);if(w){let e=[];v=x(w,!0,!1,t,e),e=e.filter(e=>!e.container[e.indexer].spatialReference.isWGS84),e.length>0&&await async function(e){var t;const r=null!==(t=n.A.geometryServiceUrl)&&void 0!==t?t:"";if(!r){(0,u.isLoaded)()||await(0,u.load)();for(const t of e)t.container[t.indexer]=(0,u.project)(t.container[t.indexer],c.A.WGS84);return}const o=e.map(e=>e.container[e.indexer]),i=new S.A({geometries:o,outSpatialReference:c.A.WGS84}),a=await(0,g.C)(r,i);for(let n=0;n<a.length;n++){const t=e[n];t.container[t.indexer]=a[n]}}(e)}const A=(0,s.J)(p[3],!1),G=new m.A({openCypherQuery:y,bindParameters:v,provenanceBehavior:A?"include":"exclude"});(null!==(d=null===h||void 0===h||null===(f=h.serviceDefinition)||void 0===f?void 0:f.currentVersion)&&void 0!==d?d:11.3)>11.2&&(G.outputSpatialReference=t.spatialReference);const M=(await R.executeQueryStreaming(h,G)).resultRowsStream.getReader(),b=[];try{for(;;){const{done:e,value:r}=await M.read();if(e)break;if((0,C.cy)(r))for(const n of r)b.push(k(n,t));else{const e=[];for(const n of r)e.push(k(r[n],t));b.push(e)}}}catch(j){throw j}return i.A.convertJsonToArcade(b,(0,s.K)(t),!1,!0)})},e.signatures.push({name:"querygraph",min:2,max:4}))}},45018(e,t,r){r.d(t,{R:()=>o});var n=r(65308);function o(e,t){return null===e?t:new n.A({url:e.field("url")})}},71334(e,t,r){r.d(t,{C:()=>c});var n=r(89379),o=r(3825),i=r(40565),a=r(19902),s=r(54994),l=r(71838),p=r(70414);const u=(0,i.dp)(p.A);async function c(e,t,r){t=u(t);const i=(0,s.Dl)(e),p=(0,n.A)((0,n.A)({},i.query),{},{f:"json"},t.toJSON()),c=t.outSpatialReference,d=(0,a.$B)(t.geometries[0]),f=(0,s.jV)(p,r);return(0,o.A)(i.path+"/project",f).then(e=>{let{data:{geometries:t}}=e;return(0,l.V)(t,d,c)})}},9505(e,t,r){r.d(t,{A:()=>l});var n=r(6326),o=r(46053),i=(r(81806),r(76460),r(47249),r(87990)),a=r(19247),s=r(27544);let l=class extends s.A{constructor(e){super(e),this.layoutGeometry=null}};(0,n.Cg)([(0,o.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,n.Cg)([(0,i.$)("esri.rest.knowledgeGraph.Entity")],l)},27544(e,t,r){r.d(t,{A:()=>s});var n=r(6326),o=r(46053),i=(r(81806),r(76460),r(47249),r(87990)),a=r(12831);let s=class extends a.A{constructor(e){super(e),this.typeName=null,this.id=null}};(0,n.Cg)([(0,o.MZ)({type:String,json:{write:!0}})],s.prototype,"typeName",void 0),(0,n.Cg)([(0,o.MZ)({type:String,json:{write:!0}})],s.prototype,"id",void 0),s=(0,n.Cg)([(0,i.$)("esri.rest.knowledgeGraph.GraphNamedObject")],s)},12831(e,t,r){r.d(t,{A:()=>s});var n=r(6326),o=r(42553),i=r(46053),a=(r(81806),r(76460),r(47249),r(87990));let s=class extends o.o{constructor(e){super(e),this.properties=null}};(0,n.Cg)([(0,i.MZ)({json:{write:!0}})],s.prototype,"properties",void 0),s=(0,n.Cg)([(0,a.$)("esri.rest.knowledgeGraph.GraphObject")],s)},35380(e,t,r){r.d(t,{A:()=>p});var n=r(6326),o=r(46053),i=(r(81806),r(76460),r(47249),r(87990)),a=r(13312),s=r(91967);let l=class extends s.A{constructor(e){super(e),this.openCypherQuery=""}};(0,n.Cg)([(0,o.MZ)()],l.prototype,"openCypherQuery",void 0),l=(0,n.Cg)([(0,i.$)("esri.rest.knowledgeGraph.GraphQuery")],l);let p=class extends l{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null,this.provenanceBehavior=null}};(0,n.Cg)([(0,o.MZ)()],p.prototype,"bindParameters",void 0),(0,n.Cg)([(0,o.MZ)()],p.prototype,"bindGeometryQuantizationParameters",void 0),(0,n.Cg)([(0,o.MZ)()],p.prototype,"outputQuantizationParameters",void 0),(0,n.Cg)([(0,o.MZ)({type:a.A})],p.prototype,"outputSpatialReference",void 0),(0,n.Cg)([(0,o.MZ)()],p.prototype,"provenanceBehavior",void 0),p=(0,n.Cg)([(0,i.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],p)},38156(e,t,r){r.d(t,{A:()=>a});var n=r(6326),o=(r(76460),r(81806),r(47249),r(50076),r(87990)),i=r(12831);let a=class extends i.A{constructor(e){super(e)}};a=(0,n.Cg)([(0,o.$)("esri.rest.knowledgeGraph.ObjectValue")],a)},68325(e,t,r){r.d(t,{A:()=>l});var n=r(6326),o=r(42553),i=r(46053),a=(r(81806),r(76460),r(47249),r(87990)),s=r(12831);let l=class extends o.o{constructor(e){super(e),this.path=[]}};(0,n.Cg)([(0,i.MZ)({type:[s.A],json:{write:!0}})],l.prototype,"path",void 0),l=(0,n.Cg)([(0,a.$)("esri.rest.knowledgeGraph.Path")],l)},23908(e,t,r){r.d(t,{A:()=>l});var n=r(6326),o=r(46053),i=(r(81806),r(76460),r(47249),r(87990)),a=r(23701),s=r(27544);let l=class extends s.A{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,n.Cg)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"originId",void 0),(0,n.Cg)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"destinationId",void 0),(0,n.Cg)([(0,o.MZ)({type:a.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,n.Cg)([(0,i.$)("esri.rest.knowledgeGraph.Relationship")],l)},70414(e,t,r){r.d(t,{A:()=>u});var n=r(6326),o=r(42553),i=r(46053),a=(r(81806),r(76460),r(47249),r(87990)),s=r(13312),l=r(19902),p=r(80963);let u=class extends o.o{constructor(e){super(e),this.geometries=[],this.outSpatialReference=null,this.transformation=null,this.transformForward=null}toJSON(){const e=this.geometries.map(e=>e.toJSON()),t=this.geometries[0],r={};return r.outSR=(0,p.YX)(this.outSpatialReference),r.inSR=(0,p.YX)(t.spatialReference),r.geometries=JSON.stringify({geometryType:(0,l.$B)(t),geometries:e}),this.transformation&&(r.transformation=this.transformation.wkid||JSON.stringify(this.transformation)),null!=this.transformForward&&(r.transformForward=this.transformForward),r}};(0,n.Cg)([(0,i.MZ)()],u.prototype,"geometries",void 0),(0,n.Cg)([(0,i.MZ)({type:s.A,json:{read:{source:"outSR"}}})],u.prototype,"outSpatialReference",void 0),(0,n.Cg)([(0,i.MZ)()],u.prototype,"transformation",void 0),(0,n.Cg)([(0,i.MZ)()],u.prototype,"transformForward",void 0),u=(0,n.Cg)([(0,a.$)("esri.rest.support.ProjectParameters")],u)}}]);
//# sourceMappingURL=64075.a431fb0c.chunk.js.map